(function(){"use strict";const Ju=Symbol("Comlink.proxy"),us=Symbol("Comlink.endpoint"),ns=Symbol("Comlink.releaseProxy"),Ir=Symbol("Comlink.thrown"),Ku=r=>typeof r=="object"&&r!==null||typeof r=="function",is={canHandle:r=>Ku(r)&&r[Ju],serialize(r){const{port1:e,port2:t}=new MessageChannel;return Lr(r,e),[t,[t]]},deserialize(r){return r.start(),os(r)}},ss={canHandle:r=>Ku(r)&&Ir in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},gt=new Map([["proxy",is],["throw",ss]]);function Lr(r,e=self){e.addEventListener("message",function t(u){if(!u||!u.data)return;const{id:n,type:i,path:s}=Object.assign({path:[]},u.data),a=(u.data.argumentList||[]).map(tt);let o;try{const l=s.slice(0,-1).reduce((c,f)=>c[f],r),h=s.reduce((c,f)=>c[f],r);switch(i){case 0:o=h;break;case 1:l[s.slice(-1)[0]]=tt(u.data.value),o=!0;break;case 2:o=h.apply(l,a);break;case 3:{const c=new h(...a);o=hs(c)}break;case 4:{const{port1:c,port2:f}=new MessageChannel;Lr(r,f),o=cs(c,[c])}break;case 5:o=void 0;break}}catch(l){o={value:l,[Ir]:0}}Promise.resolve(o).catch(l=>({value:l,[Ir]:0})).then(l=>{const[h,c]=Mr(l);e.postMessage(Object.assign(Object.assign({},h),{id:n}),c),i===5&&(e.removeEventListener("message",t),Xu(e))})}),e.start&&e.start()}function as(r){return r.constructor.name==="MessagePort"}function Xu(r){as(r)&&r.close()}function os(r,e){return Hr(r,[],e)}function ir(r){if(r)throw new Error("Proxy has been released and is not useable")}function Hr(r,e=[],t=function(){}){let u=!1;const n=new Proxy(t,{get(i,s){if(ir(u),s===ns)return()=>At(r,{type:5,path:e.map(a=>a.toString())}).then(()=>{Xu(r),u=!0});if(s==="then"){if(e.length===0)return{then:()=>n};const a=At(r,{type:0,path:e.map(o=>o.toString())}).then(tt);return a.then.bind(a)}return Hr(r,[...e,s])},set(i,s,a){ir(u);const[o,l]=Mr(a);return At(r,{type:1,path:[...e,s].map(h=>h.toString()),value:o},l).then(tt)},apply(i,s,a){ir(u);const o=e[e.length-1];if(o===us)return At(r,{type:4}).then(tt);if(o==="bind")return Hr(r,e.slice(0,-1));const[l,h]=Qu(a);return At(r,{type:2,path:e.map(c=>c.toString()),argumentList:l},h).then(tt)},construct(i,s){ir(u);const[a,o]=Qu(s);return At(r,{type:3,path:e.map(l=>l.toString()),argumentList:a},o).then(tt)}});return n}function ls(r){return Array.prototype.concat.apply([],r)}function Qu(r){const e=r.map(Mr);return[e.map(t=>t[0]),ls(e.map(t=>t[1]))]}const Yu=new WeakMap;function cs(r,e){return Yu.set(r,e),r}function hs(r){return Object.assign(r,{[Ju]:!0})}function Mr(r){for(const[e,t]of gt)if(t.canHandle(r)){const[u,n]=t.serialize(r);return[{type:3,name:e,value:u},n]}return[{type:0,value:r},Yu.get(r)||[]]}function tt(r){switch(r.type){case 3:return gt.get(r.name).deserialize(r.value);case 0:return r.value}}function At(r,e,t){return new Promise(u=>{const n=fs();r.addEventListener("message",function i(s){!s.data||!s.data.id||s.data.id!==n||(r.removeEventListener("message",i),u(s.data))}),r.start&&r.start(),r.postMessage(Object.assign({id:n},e),t)})}function fs(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var sr,Ds=new Uint8Array(16);function ds(){if(!sr&&(sr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!sr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sr(Ds)}var ps=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Cs(r){return typeof r=="string"&&ps.test(r)}for(var le=[],jr=0;jr<256;++jr)le.push((jr+256).toString(16).substr(1));function Es(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(le[r[e+0]]+le[r[e+1]]+le[r[e+2]]+le[r[e+3]]+"-"+le[r[e+4]]+le[r[e+5]]+"-"+le[r[e+6]]+le[r[e+7]]+"-"+le[r[e+8]]+le[r[e+9]]+"-"+le[r[e+10]]+le[r[e+11]]+le[r[e+12]]+le[r[e+13]]+le[r[e+14]]+le[r[e+15]]).toLowerCase();if(!Cs(t))throw TypeError("Stringified UUID is invalid");return t}function gs(r,e,t){r=r||{};var u=r.random||(r.rng||ds)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,e){t=t||0;for(var n=0;n<16;++n)e[t+n]=u[n];return e}return Es(u)}class Zu{constructor(){this.listeners=new Set}get hasListeners(){return this.listeners.size>0}dispatch(e){this.listeners.forEach(t=>t(e))}on(e,t=!0){if(this.listeners.add(e),t)return{dispose:()=>{this.off(e)}}}off(e){this.listeners.delete(e)}once(e,t=!1){const u=n=>{e(n),this.off(u)};return this.on(u,t)}disposeListeners(){this.listeners=new Set}}class rt extends Zu{constructor(e=1){super(),this.needsToFireAmount=e,this.firedTimes=0}get fired(){return new Promise(e=>this.once(e,!1))}get hasFired(){return this.firedTimes>=this.needsToFireAmount}setFiredTimes(e){this.firedTimes=e}resetSignal(){this.data=void 0,this.firedTimes=0}dispatch(e){if(this.firedTimes<this.needsToFireAmount&&this.firedTimes++,this.data=e,this.hasFired)return super.dispatch(e)}on(e,t=!0){return this.hasFired&&e(this.data),super.on(e,t)}}function As(){if(!(!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent))||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const u=()=>indexedDB.databases().finally(t);e=setInterval(u,100),u()}).finally(()=>clearInterval(e))}function Ve(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function Ur(r,e){const t=As().then(()=>{const u=indexedDB.open(r);return u.onupgradeneeded=()=>u.result.createObjectStore(e),Ve(u)});return(u,n)=>t.then(i=>n(i.transaction(e,u).objectStore(e)))}let zr;function ut(){return zr||(zr=Ur("keyval-store","keyval")),zr}function Wr(r,e=ut()){return e("readonly",t=>Ve(t.get(r)))}function Gr(r,e,t=ut()){return t("readwrite",u=>(u.put(e,r),Ve(u.transaction)))}function Fs(r,e=ut()){return e("readwrite",t=>(r.forEach(u=>t.put(u[1],u[0])),Ve(t.transaction)))}function ms(r,e=ut()){return e("readonly",t=>Promise.all(r.map(u=>Ve(t.get(u)))))}function ys(r,e=ut()){return e("readwrite",t=>(t.delete(r),Ve(t.transaction)))}function ws(r=ut()){return r("readwrite",e=>(e.clear(),Ve(e.transaction)))}function vs(r,e){return r("readonly",t=>(t.openCursor().onsuccess=function(){!this.result||(e(this.result),this.result.continue())},Ve(t.transaction)))}function Bs(r=ut()){const e=[];return vs(r,t=>e.push(t.key)).then(()=>e)}const bs=Ur("virtual-fs","virtual-fs-store"),xs=r=>Wr(r,bs);class Pt{constructor(e="virtual-fs"){this.storeName=e,this.store=Ur(e,`${e}-store`)}set(e,t){return Gr(e,t,this.store)}get(e){return Wr(e,this.store)}del(e){return ys(e,this.store)}setMany(e){return Fs(e,this.store)}getMany(e){return ms(e,this.store)}clear(){return ws(this.store)}async has(e){return await xs(e)!==void 0}keys(){return Bs(this.store)}}class en{constructor(e,t,u=[],n=gs()){this._name=t,this.basePath=u,this.uuid=n,this._idbWrapper=null,this.parent=null,this.isVirtual=!0,this.setupDone=new rt,e===null?this._idbWrapper=new Pt:e instanceof Pt?this._idbWrapper=e:this.parent=e}get path(){return this.parent?this.parent.path.concat(this.name):this.basePath}get hasParentContext(){return this.path.length>1}get idbKey(){return this.path.length===0?this._name:this.path.join("/")}get idbWrapper(){return this._idbWrapper===null?this.parent.idbWrapper:this._idbWrapper}get name(){return this._name}getParent(){return this.parent}async isSameEntry(e){return e.idbKey===this.idbKey}async queryPermission(e){return"granted"}async requestPermission(e){return"granted"}}const _s=new TextEncoder,tn=Symbol("writeMethod");class Ss{constructor(e){this.fileHandle=e,this.tmpData=new Uint8Array,this.cursorOffset=0,this.locked=!1}async write(e){let t;if(typeof e=="string")t=_s.encode(e);else if(e instanceof Blob)t=await e.arrayBuffer().then(u=>new Uint8Array(u));else if("type"in e){if(e.type==="seek")return await this.seek(e.position);if(e.type==="truncate")return await this.truncate(e.size);if(e.type==="write")return e.position&&await this.seek(e.position),await this.write(e.data);throw new Error(`Unknown data type: ${e.type}`)}else ArrayBuffer.isView(e)?t=new Uint8Array(e.buffer):t=new Uint8Array(e);this.tmpData=new Uint8Array([...this.tmpData.slice(0,this.cursorOffset),...t]),this.cursorOffset=this.tmpData.length}async seek(e){this.cursorOffset=Math.floor(e)}async truncate(e){this.tmpData=this.tmpData.slice(0,e),this.cursorOffset>e&&(this.cursorOffset=e)}async close(){await this.fileHandle[tn](this.tmpData)}async abort(){throw new Error("WriteStream was aborted")}getWriter(){}}var ks=function(r){return Object.prototype.toString.call(r)};function rn(r){return typeof r=="function"&&/native code/.test(r.toString())}var Rs=typeof Symbol<"u"&&rn(Symbol)&&typeof Reflect<"u"&&rn(Reflect.ownKeys),Ft=function(r){return r};function Ae(r,e,t){var u=t.get,n=t.set;Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:u||Ft,set:n||Ft})}function qr(r,e,t,u){Object.defineProperty(r,e,{value:t,enumerable:!!u,writable:!0,configurable:!0})}function mt(r,e){return Object.hasOwnProperty.call(r,e)}function yt(r){return Array.isArray(r)}function un(r){return r!==null&&typeof r=="object"}function Se(r){return ks(r)==="[object Object]"}function nt(r){return typeof r=="function"}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Vr=function(r,e){return Vr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,u){t.__proto__=u}||function(t,u){for(var n in u)Object.prototype.hasOwnProperty.call(u,n)&&(t[n]=u[n])},Vr(r,e)};function $s(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Vr(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function nn(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],u=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&u>=r.length&&(r=void 0),{value:r&&r[u++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Jr,ar=[],sn=function(){function r(e){this.active=!0,this.effects=[],this.cleanups=[],this.vm=e}return r.prototype.run=function(e){if(this.active)try{return this.on(),e()}finally{this.off()}},r.prototype.on=function(){this.active&&(ar.push(this),Jr=this)},r.prototype.off=function(){this.active&&(ar.pop(),Jr=ar[ar.length-1])},r.prototype.stop=function(){this.active&&(this.vm.$destroy(),this.effects.forEach(function(e){return e.stop()}),this.cleanups.forEach(function(e){return e()}),this.active=!1)},r}();(function(r){$s(e,r);function e(t){t===void 0&&(t=!1);var u=this,n=void 0;return Ls(function(){n=hn(Qr())}),u=r.call(this,n)||this,t||Ts(u),u}return e})(sn);function Ts(r,e){var t;if(e=e||Jr,e&&e.active){e.effects.push(r);return}var u=(t=cn())===null||t===void 0?void 0:t.proxy;u&&u.$on("hook:destroyed",function(){return r.stop()})}function Os(r){if(!r.scope){var e=new sn(r.proxy);r.scope=e,r.proxy.$on("hook:destroyed",function(){return e.stop()})}return r.scope}var Kr=void 0;try{var it=require("vue");it&&on(it)?Kr=it:it&&"default"in it&&on(it.default)&&(Kr=it.default)}catch{}var Xr=null,wt=null,Nt=!0,an="__composition_api_installed__";function on(r){return r&&nt(r)&&r.name==="Vue"}function Ps(r){return mt(r,an)}function Qr(){return Xr}function Ns(){var r=Xr||Kr;return r}function Is(r){Xr=r,Object.defineProperty(r,an,{configurable:!0,writable:!0,value:!0})}function Ls(r){var e=Nt;Nt=!1;try{r()}finally{Nt=e}}function Hs(r){!Nt||ln(r&&Zr(r))}function ln(r){if(!!Nt){var e=wt;e==null||e.scope.off(),wt=r,wt==null||wt.scope.on()}}function cn(){return wt}var Yr=new WeakMap;function Zr(r){if(Yr.has(r))return Yr.get(r);var e={proxy:r,update:r.$forceUpdate,uid:r._uid,emit:r.$emit.bind(r),parent:null,root:null};Os(e);var t=["data","props","attrs","refs","vnode","slots"];return t.forEach(function(u){Ae(e,u,{get:function(){return r["$"+u]}})}),Ae(e,"isMounted",{get:function(){return r._isMounted}}),Ae(e,"isUnmounted",{get:function(){return r._isDestroyed}}),Ae(e,"isDeactivated",{get:function(){return r._inactive}}),Ae(e,"emitted",{get:function(){return r._events}}),Yr.set(r,e),r.$parent&&(e.parent=Zr(r.$parent)),r.$root&&(e.root=Zr(r.$root)),e}function hn(r,e){e===void 0&&(e={});var t=r.config.silent;r.config.silent=!0;var u=new r(e);return r.config.silent=t,u}function Ms(r){var e=Qr();return e&&r instanceof e}function js(r,e){return function(){for(var t=[],u=0;u<arguments.length;u++)t[u]=arguments[u];if(!!r.$scopedSlots[e])return r.$scopedSlots[e].apply(r,t)}}function Us(r,e){var t;if(!r)t={};else{if(r._normalized)return r._normalized;t={};for(var u in r)r[u]&&u[0]!=="$"&&(t[u]=!0)}for(var u in e)u in t||(t[u]=!0);return t}var It="composition-api.refKey",fn=new WeakMap,zs=new WeakMap,Ws=new WeakMap,Dn=function(){function r(e){var t=e.get,u=e.set;Ae(this,"value",{get:t,set:u})}return r}();function dn(r,e){var t=new Dn(r),u=Object.seal(t);return Ws.set(u,!0),u}function pn(r){var e;if(Fe(r))return r;var t=An((e={},e[It]=r,e));return dn({get:function(){return t[It]},set:function(u){return t[It]=u}})}function Fe(r){return r instanceof Dn}function Gs(r){if(!Se(r))return r;var e={};for(var t in r)e[t]=qs(r,t);return e}function qs(r,e){var t=r[e];return Fe(t)?t:dn({get:function(){return r[e]},set:function(u){return r[e]=u}})}function vt(r){var e;return Boolean(r&&mt(r,"__ob__")&&typeof r.__ob__=="object"&&((e=r.__ob__)===null||e===void 0?void 0:e.__raw__))}function Lt(r){var e;return Boolean(r&&mt(r,"__ob__")&&typeof r.__ob__=="object"&&!(!((e=r.__ob__)===null||e===void 0)&&e.__raw__))}function eu(r){if(!(!Se(r)||vt(r)||yt(r)||Fe(r)||Ms(r)||fn.has(r))){fn.set(r,!0);for(var e=Object.keys(r),t=0;t<e.length;t++)Vs(r,e[t])}}function Vs(r,e,t){if(e!=="__ob__"&&!vt(r[e])){var u,n,i=Object.getOwnPropertyDescriptor(r,e);if(i){if(i.configurable===!1)return;u=i.get,n=i.set,(!u||n)&&arguments.length===2&&(t=r[e])}eu(t),Ae(r,e,{get:function(){var a=u?u.call(r):t;return e!==It&&Fe(a)?a.value:a},set:function(a){if(!(u&&!n)){var o=u?u.call(r):t;e!==It&&Fe(o)&&!Fe(a)?o.value=a:n?n.call(r,a):t=a,eu(a)}}})}}function Cn(r){var e=Ns(),t;if(e.observable)t=e.observable(r);else{var u=hn(e,{data:{$$state:r}});t=u._data.$$state}return mt(t,"__ob__")||En(t),t}function En(r,e){var t,u;if(e===void 0&&(e=new Set),!e.has(r)){qr(r,"__ob__",Js(r)),e.add(r);try{for(var n=nn(Object.keys(r)),i=n.next();!i.done;i=n.next()){var s=i.value,a=r[s];!(Se(a)||yt(a))||vt(a)||!Object.isExtensible(a)||En(a,e)}}catch(o){t={error:o}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(t)throw t.error}}}}function Js(r){return r===void 0&&(r={}),{value:r,dep:{notify:Ft,depend:Ft,addSub:Ft,removeSub:Ft}}}function gn(){return Cn({}).__ob__}function An(r){if(!un(r)||!(Se(r)||yt(r))||vt(r)||!Object.isExtensible(r))return r;var e=Cn(r);return eu(e),e}function Ks(r){if(!(Se(r)||yt(r))||!Object.isExtensible(r))return r;var e=gn();return e.__raw__=!0,qr(r,"__ob__",e),zs.set(r,!0),r}function Xs(r,e,t){var u=r.__composition_api_state__=r.__composition_api_state__||{};u[e]=t}function Qs(r,e){return(r.__composition_api_state__||{})[e]}var Bt={set:Xs,get:Qs};function Ys(r,e,t){var u=r.$options.props;!(e in r)&&!(u&&mt(u,e))&&(Fe(t)?Ae(r,e,{get:function(){return t.value},set:function(n){t.value=n}}):Ae(r,e,{get:function(){return Lt(t)&&t.__ob__.dep.depend(),t},set:function(n){t=n}}))}function tu(r){var e=Bt.get(r,"rawBindings")||{};if(!(!e||!Object.keys(e).length)){for(var t=r.$refs,u=Bt.get(r,"refs")||[],n=0;n<u.length;n++){var i=u[n],s=e[i];!t[i]&&s&&Fe(s)&&(s.value=null)}for(var a=Object.keys(t),o=[],n=0;n<a.length;n++){var i=a[n],s=e[i];t[i]&&s&&Fe(s)&&(s.value=t[i],o.push(i))}Bt.set(r,"refs",o)}}function Fn(r,e){var t=r.$options._parentVnode;if(!!t){for(var u=Bt.get(r,"slots")||[],n=Us(t.data.scopedSlots,r.$slots),i=0;i<u.length;i++){var s=u[i];n[s]||delete e[s]}for(var a=Object.keys(n),i=0;i<a.length;i++){var s=a[i];e[s]||(e[s]=js(r,s))}Bt.set(r,"slots",a)}}function ru(r,e,t){var u=cn();Hs(r);try{return e(r)}catch(n){if(t)t(n);else throw n}finally{ln(u)}}function Zs(r){r.mixin({beforeCreate:e,mounted:function(){tu(this)},updated:function(){var s;tu(this),!((s=this.$vnode)===null||s===void 0)&&s.context&&tu(this.$vnode.context)}});function e(){var s=this,a=s.$options,o=a.setup,l=a.render;if(l&&(a.render=function(){for(var c=this,f=[],C=0;C<arguments.length;C++)f[C]=arguments[C];return ru(s,function(){return l.apply(c,f)})}),!!o&&!!nt(o)){var h=a.data;a.data=function(){return t(s,s.$props),nt(h)?h.call(s,s):h||{}}}}function t(s,a){a===void 0&&(a={});var o=s.$options.setup,l=i(s);qr(a,"__ob__",gn()),Fn(s,l.slots);var h;if(ru(s,function(){h=o(a,l)}),!!h){if(nt(h)){var c=h;s.$options.render=function(){return Fn(s,l.slots),ru(s,function(){return c()})};return}else if(Se(h)){Lt(h)&&(h=Gs(h)),Bt.set(s,"rawBindings",h);var f=h;Object.keys(f).forEach(function(C){var A=f[C];if(!Fe(A))if(Lt(A))yt(A)&&(A=pn(A));else if(nt(A)){var p=A;A=A.bind(s),Object.keys(p).forEach(function(d){A[d]=p[d]})}else un(A)?n(A)&&u(A):A=pn(A);Ys(s,C,A)});return}}}function u(s,a){if(a===void 0&&(a=new Set),!a.has(s)&&!(!Se(s)||Fe(s)||Lt(s)||vt(s))){var o=Qr(),l=o.util.defineReactive;Object.keys(s).forEach(function(h){var c=s[h];l(s,h,c),c&&(a.add(c),u(c,a))})}}function n(s,a){return a===void 0&&(a=new Map),a.has(s)?a.get(s):(a.set(s,!1),yt(s)&&Lt(s)?(a.set(s,!0),!0):!Se(s)||vt(s)?!1:Object.keys(s).some(function(o){return n(s[o],a)}))}function i(s){var a={slots:{}},o=["root","parent","refs","listeners","isServer","ssrContext"],l=["attrs"],h=["emit"];return o.forEach(function(c){var f="$"+c;Ae(a,c,{get:function(){return s[f]},set:function(){}})}),l.forEach(function(c){var f="$"+c;Ae(a,c,{get:function(){var C,A,p=An({}),d=s[f],D=function(B){Ae(p,B,{get:function(){return s[f][B]}})};try{for(var F=nn(Object.keys(d)),m=F.next();!m.done;m=F.next()){var b=m.value;D(b)}}catch(B){C={error:B}}finally{try{m&&!m.done&&(A=F.return)&&A.call(F)}finally{if(C)throw C.error}}return p},set:function(){}})}),h.forEach(function(c){var f="$"+c;Ae(a,c,{get:function(){return function(){for(var C=[],A=0;A<arguments.length;A++)C[A]=arguments[A];var p=s[f];p.apply(s,C)}}})}),a}}function mn(r,e){if(!r)return e;if(!e)return r;for(var t,u,n,i=Rs?Reflect.ownKeys(r):Object.keys(r),s=0;s<i.length;s++)t=i[s],t!=="__ob__"&&(u=e[t],n=r[t],mt(e,t)?u!==n&&Se(u)&&!Fe(u)&&Se(n)&&!Fe(n)&&mn(n,u):e[t]=n);return e}function ea(r){Ps(r)||(r.config.optionMergeStrategies.setup=function(e,t){return function(n,i){return mn(nt(e)?e(n,i)||{}:void 0,nt(t)?t(n,i)||{}:void 0)}},Is(r),Zs(r))}var ta={install:function(r){return ea(r)}};typeof window<"u"&&window.Vue&&window.Vue.use(ta);class ke extends en{constructor(e,t,u,n=!1,i){super(e,t,i),this.inMemory=n,this.kind="file",this.isFile=!0,this.isDirectory=!1,u?this.setup(u):this.setupDone.dispatch()}get isFileStoredInMemory(){return this.fileData!==void 0}moveData(){if(!this.fileData)throw new Error(`No file data to move to IDB for file "${this.name}"`);const e=this.fileData;return this.fileData=void 0,this.inMemory=!1,e}async setup(e){this.fileData=globalThis.document?Ks(e):e;const t=this.path.join("/").startsWith("data/packages");if(this.inMemory||t&&e.length<5e4)return this.inMemory=!0,this.setupDone.dispatch();(!t||globalThis.document)&&await this.updateIdb(e),this.setupDone.dispatch()}async updateIdb(e){await this.idbWrapper.set(this.idbKey,e),this.fileData=void 0}async loadFromIdb(){if(this.fileData)return this.fileData;let e=await this.idbWrapper.get(this.idbKey);if(e===void 0)throw console.log(this.parent),new Error(`File not found: "${this.path.join("/")}"`);return e}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"file",name:this.name,path:this.path,fileData:this.fileData}}static deserialize(e){return new ke(e.idbWrapper?new Pt(e.idbWrapper):null,e.name,e.fileData,e.fileData!==void 0,e.path)}async isSameEntry(e){return this.parent===null?!1:super.isSameEntry(e)}async removeSelf(e=!0){await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name)}async getFile(){const e=await this.loadFromIdb();return new File([e],this.name)}async createWritable(){return new Ss(this)}async[tn](e){this.inMemory?this.fileData=e:await this.updateIdb(e)}}class me extends en{constructor(e,t,u,n=!1,i=[]){super(e,t,i),this.children=u,this.kind="directory",this.isDirectory=!0,this.isFile=!1,this.updateIdb(n)}get isDirectoryInMemory(){return this.children!==void 0}async moveToIdb(){const e=this.allInMemoryChildren();this.idbWrapper.setMany(e.map(t=>[t.idbKey,t.moveData()]))}moveData(){if(!this.children)throw new Error(`No directory data to move to IDB for directory "${this.name}"`);const e=[...this.children.values()].map(t=>t.name);return this.children=void 0,e}allInMemoryChildren(){if(!this.children)return[];const e=[this];for(const t of this.children.values())t instanceof me?t.isDirectoryInMemory&&e.push(...t.allInMemoryChildren()):t.isFileStoredInMemory&&e.push(t);return e}async updateIdb(e=!1){e&&await this.idbWrapper.clear(),!this.children&&!await this.hasChildren()&&await this.idbWrapper.set(this.idbKey,[]),this.setupDone.dispatch()}async addChild(e){await this.has(e.name)||(this.children?this.children.set(e.name,e):await this.idbWrapper.set(this.idbKey,[...await this.fromIdb(),e.name]))}async fromIdb(){var e;return(e=await this.idbWrapper.get(this.idbKey))!=null?e:[]}async getChildren(){return this.children?[...this.children.values()]:await Promise.all((await this.fromIdb()).map(e=>this.getChild(e)).filter(e=>e!==void 0))}getChildPath(e){return this.path.concat(e).join("/")}async getChild(e){if(this.children)return this.children.get(e);if(await this.has(e)){const t=await this.idbWrapper.get(this.getChildPath(e));if(t instanceof Uint8Array)return new ke(this,e);if(Array.isArray(t))return new me(this,e)}}async deleteChild(e){this.children?this.children.delete(e):await this.idbWrapper.set(this.idbKey,(await this.fromIdb()).filter(t=>t!==e))}async hasChildren(){return this.children?this.children.size>0:(await this.fromIdb()).length>0}async has(e){return this.children?this.children.has(e):(await this.fromIdb()).includes(e)}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"directory",name:this.name,path:this.path,children:this.children?[...this.children.values()].map(e=>e.serialize()):void 0}}static deserialize(e,t=null){var n;const u=new me(t||new Pt(e.idbWrapper),e.name,void 0,!1,e.path);for(const i of(n=e.children)!=null?n:[])i.kind==="directory"?u.addChild(me.deserialize(i,u)):u.addChild(new ke(u,i.name,i.fileData));return u}async getDirectoryHandle(e,{create:t}={}){let u=await this.getChild(e);if(u&&u.kind==="file")throw new Error(`TypeMismatch: Expected directory with name "${e}", found file`);if(!u)if(t)u=new me(this,e,this.children?new Map:void 0),await u.setupDone.fired,await this.addChild(u);else throw new Error(`No file with the name ${e} exists in this folder`);return u}async getFileHandle(e,{create:t,initialData:u}={}){let n=await this.getChild(e);if(n&&n.kind==="directory")throw new Error(`TypeMismatch: Expected file with name "${e}", found directory`);if(!n)if(t)n=new ke(this,e,u!=null?u:new Uint8Array),await n.setupDone.fired,await this.addChild(n);else throw new Error(`No file with the name ${e} exists in this folder`);return n}async removeEntry(e,{recursive:t}={}){const u=await this.getChild(e);if(u){if(u.kind==="directory"&&!t&&await u.hasChildren())throw new Error('Cannot remove directory with children without "recursive" option being set to true')}else throw new Error(`No entry with the name ${e} exists in this folder`);await u.removeSelf(),await this.deleteChild(e)}async resolve(e){const t=[e.name];let u=e.getParent();for(;u!==null&&!await u.isSameEntry(this);)t.unshift(u.name),u=u.getParent();return u===null?null:t}async removeSelf(e=!0){const t=await this.getChildren();for(const u of t)await u.removeSelf(!1);this.children||await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name)}[Symbol.asyncIterator](){return this.entries()}keys(){return this.children?this.children.keys():{childNamesPromise:this.fromIdb(),[Symbol.asyncIterator](){return{i:0,childNamesPromise:this.childNamesPromise,async next(){const e=await this.childNamesPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}entries(){return this.children?this.children.entries():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:[e[this.i].name,e[this.i++]]}:{done:!0}}}}}}values(){return this.children?this.children.values():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}getEntries(){return this.values()}getDirectory(e,t={}){return this.getDirectoryHandle(e,t)}getFile(e,t={}){return this.getFileHandle(e,t)}}gt.set("VirtualFileHandle",{canHandle:r=>r instanceof ke,serialize:r=>[r.serialize(),[]],deserialize:r=>new ke(null,r.name,r.fileData)}),gt.set("VirtualDirectoryHandle",{canHandle:r=>r instanceof me,serialize:r=>[r.serialize(),[]],deserialize:r=>me.deserialize(r)}),gt.set("VirtualDirectoryHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({directory:e})=>e instanceof me),serialize:r=>[r.map(({directory:e,...t})=>({directory:e.serialize(),...t})),[]],deserialize:r=>r.map(({directory:e,...t})=>({directory:me.deserialize(e),...t}))}),gt.set("VirtualFileHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({fileHandle:e})=>e instanceof ke),serialize:r=>[r.map(({fileHandle:e,...t})=>({fileHandle:e.serialize(),...t})),[]],deserialize:r=>r.map(({fileHandle:e,...t})=>({fileHandle:ke.deserialize(e),...t}))});var ra=Object.defineProperty,ua=Object.defineProperties,na=Object.getOwnPropertyDescriptors,yn=Object.getOwnPropertySymbols,ia=Object.prototype.hasOwnProperty,sa=Object.prototype.propertyIsEnumerable,wn=(r,e,t)=>e in r?ra(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,bt=(r,e)=>{for(var t in e||(e={}))ia.call(e,t)&&wn(r,t,e[t]);if(yn)for(var t of yn(e))sa.call(e,t)&&wn(r,t,e[t]);return r},or=(r,e)=>ua(r,na(e));function vn(r,e){for(var t=0,u=r.length-1;u>=0;u--){var n=r[u];n==="."?r.splice(u,1):n===".."?(r.splice(u,1),t++):t&&(r.splice(u,1),t--)}if(e)for(;t--;t)r.unshift("..");return r}var aa=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,uu=function(r){return aa.exec(r).slice(1)};function lr(){for(var r="",e=!1,t=arguments.length-1;t>=-1&&!e;t--){var u=t>=0?arguments[t]:"/";if(typeof u!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!u)continue;r=u+"/"+r,e=u.charAt(0)==="/"}return r=vn(su(r.split("/"),function(n){return!!n}),!e).join("/"),(e?"/":"")+r||"."}function nu(r){var e=iu(r),t=la(r,-1)==="/";return r=vn(su(r.split("/"),function(u){return!!u}),!e).join("/"),!r&&!e&&(r="."),r&&t&&(r+="/"),(e?"/":"")+r}function iu(r){return r.charAt(0)==="/"}function Bn(){var r=Array.prototype.slice.call(arguments,0);return nu(su(r,function(e,t){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function bn(r,e){r=lr(r).substr(1),e=lr(e).substr(1);function t(l){for(var h=0;h<l.length&&l[h]==="";h++);for(var c=l.length-1;c>=0&&l[c]==="";c--);return h>c?[]:l.slice(h,c-h+1)}for(var u=t(r.split("/")),n=t(e.split("/")),i=Math.min(u.length,n.length),s=i,a=0;a<i;a++)if(u[a]!==n[a]){s=a;break}for(var o=[],a=s;a<u.length;a++)o.push("..");return o=o.concat(n.slice(s)),o.join("/")}var xn="/",_n=":";function Sn(r){var e=uu(r),t=e[0],u=e[1];return!t&&!u?".":(u&&(u=u.substr(0,u.length-1)),t+u)}function kn(r,e){var t=uu(r)[2];return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t}function Rn(r){return uu(r)[3]}var oa={extname:Rn,basename:kn,dirname:Sn,sep:xn,delimiter:_n,relative:bn,join:Bn,isAbsolute:iu,normalize:nu,resolve:lr};function su(r,e){if(r.filter)return r.filter(e);for(var t=[],u=0;u<r.length;u++)e(r[u],u,r)&&t.push(r[u]);return t}var la="ab".substr(-1)==="b"?function(r,e,t){return r.substr(e,t)}:function(r,e,t){return e<0&&(e=r.length+e),r.substr(e,t)},au=Object.freeze({__proto__:null,resolve:lr,normalize:nu,isAbsolute:iu,join:Bn,relative:bn,sep:xn,delimiter:_n,dirname:Sn,basename:kn,extname:Rn,default:oa});function $n(){throw new Error("setTimeout has not been defined")}function Tn(){throw new Error("clearTimeout has not been defined")}var Je=$n,Ke=Tn,xt;typeof window<"u"?xt=window:typeof self<"u"?xt=self:xt={},typeof xt.setTimeout=="function"&&(Je=setTimeout),typeof xt.clearTimeout=="function"&&(Ke=clearTimeout);function On(r){if(Je===setTimeout)return setTimeout(r,0);if((Je===$n||!Je)&&setTimeout)return Je=setTimeout,setTimeout(r,0);try{return Je(r,0)}catch{try{return Je.call(null,r,0)}catch{return Je.call(this,r,0)}}}function ca(r){if(Ke===clearTimeout)return clearTimeout(r);if((Ke===Tn||!Ke)&&clearTimeout)return Ke=clearTimeout,clearTimeout(r);try{return Ke(r)}catch{try{return Ke.call(null,r)}catch{return Ke.call(this,r)}}}var Ie=[],_t=!1,st,cr=-1;function ha(){!_t||!st||(_t=!1,st.length?Ie=st.concat(Ie):cr=-1,Ie.length&&Pn())}function Pn(){if(!_t){var r=On(ha);_t=!0;for(var e=Ie.length;e;){for(st=Ie,Ie=[];++cr<e;)st&&st[cr].run();cr=-1,e=Ie.length}st=null,_t=!1,ca(r)}}function fa(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Ie.push(new Nn(r,e)),Ie.length===1&&!_t&&On(Pn)}function Nn(r,e){this.fun=r,this.array=e}Nn.prototype.run=function(){this.fun.apply(null,this.array)};var Da="browser",da="browser",pa=!0,Ca=[],Ea="",ga={},Aa={},Fa={};function at(){}var ma=at,ya=at,wa=at,va=at,Ba=at,ba=at,xa=at;function _a(r){throw new Error("process.binding is not supported")}function Sa(){return"/"}function ka(r){throw new Error("process.chdir is not supported")}function Ra(){return 0}var St=xt.performance||{},$a=St.now||St.mozNow||St.msNow||St.oNow||St.webkitNow||function(){return new Date().getTime()};function Ta(r){var e=$a.call(St)*.001,t=Math.floor(e),u=Math.floor(e%1*1e9);return r&&(t=t-r[0],u=u-r[1],u<0&&(t--,u+=1e9)),[t,u]}var Oa=new Date;function Pa(){var r=new Date,e=r-Oa;return e/1e3}var Na={nextTick:fa,title:Da,browser:pa,env:{NODE_ENV:"production"},argv:Ca,version:Ea,versions:ga,on:ma,addListener:ya,once:wa,off:va,removeListener:Ba,removeAllListeners:ba,emit:xa,binding:_a,cwd:Sa,chdir:ka,umask:Ra,hrtime:Ta,platform:da,release:Aa,config:Fa,uptime:Pa};function Ia(r,e,t){return t={path:e,exports:{},require:function(u,n){return La(u,n==null?t.path:n)}},r(t,t.exports),t.exports}function La(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}const Re="\\\\/",In=`[^${Re}]`,Le="\\.",Ha="\\+",Ma="\\?",hr="\\/",ja="(?=.)",Ln="[^/]",ou=`(?:${hr}|$)`,Hn=`(?:^|${hr})`,lu=`${Le}{1,2}${ou}`,Ua=`(?!${Le})`,za=`(?!${Hn}${lu})`,Wa=`(?!${Le}{0,1}${ou})`,Ga=`(?!${lu})`,qa=`[^.${hr}]`,Va=`${Ln}*?`,Mn={DOT_LITERAL:Le,PLUS_LITERAL:Ha,QMARK_LITERAL:Ma,SLASH_LITERAL:hr,ONE_CHAR:ja,QMARK:Ln,END_ANCHOR:ou,DOTS_SLASH:lu,NO_DOT:Ua,NO_DOTS:za,NO_DOT_SLASH:Wa,NO_DOTS_SLASH:Ga,QMARK_NO_DOT:qa,STAR:Va,START_ANCHOR:Hn},Ja=or(bt({},Mn),{SLASH_LITERAL:`[${Re}]`,QMARK:In,STAR:`${In}*?`,DOTS_SLASH:`${Le}{1,2}(?:[${Re}]|$)`,NO_DOT:`(?!${Le})`,NO_DOTS:`(?!(?:^|[${Re}])${Le}{1,2}(?:[${Re}]|$))`,NO_DOT_SLASH:`(?!${Le}{0,1}(?:[${Re}]|$))`,NO_DOTS_SLASH:`(?!${Le}{1,2}(?:[${Re}]|$))`,QMARK_NO_DOT:`[^.${Re}]`,START_ANCHOR:`(?:^|[${Re}])`,END_ANCHOR:`(?:[${Re}]|$)`}),Ka={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var ot={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ka,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:au.sep,extglobChars(r){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${r.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(r){return r===!0?Ja:Mn}},se=Ia(function(r,e){const{REGEX_BACKSLASH:t,REGEX_REMOVE_BACKSLASH:u,REGEX_SPECIAL_CHARS:n,REGEX_SPECIAL_CHARS_GLOBAL:i}=ot;e.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),e.hasRegexChars=s=>n.test(s),e.isRegexChar=s=>s.length===1&&e.hasRegexChars(s),e.escapeRegex=s=>s.replace(i,"\\$1"),e.toPosixSlashes=s=>s.replace(t,"/"),e.removeBackslashes=s=>s.replace(u,a=>a==="\\"?"":a),e.supportsLookbehinds=()=>{const s=Na.version.slice(1).split(".").map(Number);return s.length===3&&s[0]>=9||s[0]===8&&s[1]>=10},e.isWindows=s=>s&&typeof s.windows=="boolean"?s.windows:au.sep==="\\",e.escapeLast=(s,a,o)=>{const l=s.lastIndexOf(a,o);return l===-1?s:s[l-1]==="\\"?e.escapeLast(s,a,l-1):`${s.slice(0,l)}\\${s.slice(l)}`},e.removePrefix=(s,a={})=>{let o=s;return o.startsWith("./")&&(o=o.slice(2),a.prefix="./"),o},e.wrapOutput=(s,a={},o={})=>{const l=o.contains?"":"^",h=o.contains?"":"$";let c=`${l}(?:${s})${h}`;return a.negated===!0&&(c=`(?:^(?!${c}).*$)`),c}});const{CHAR_ASTERISK:cu,CHAR_AT:Xa,CHAR_BACKWARD_SLASH:Ht,CHAR_COMMA:Qa,CHAR_DOT:hu,CHAR_EXCLAMATION_MARK:fu,CHAR_FORWARD_SLASH:jn,CHAR_LEFT_CURLY_BRACE:Du,CHAR_LEFT_PARENTHESES:du,CHAR_LEFT_SQUARE_BRACKET:Ya,CHAR_PLUS:Za,CHAR_QUESTION_MARK:Un,CHAR_RIGHT_CURLY_BRACE:eo,CHAR_RIGHT_PARENTHESES:zn,CHAR_RIGHT_SQUARE_BRACKET:to}=ot,Wn=r=>r===jn||r===Ht,Gn=r=>{r.isPrefix!==!0&&(r.depth=r.isGlobstar?1/0:1)};var ro=(r,e)=>{const t=e||{},u=r.length-1,n=t.parts===!0||t.scanToEnd===!0,i=[],s=[],a=[];let o=r,l=-1,h=0,c=0,f=!1,C=!1,A=!1,p=!1,d=!1,D=!1,F=!1,m=!1,b=!1,B=!1,_=0,R,S,j={value:"",depth:0,isGlob:!1};const ne=()=>l>=u,v=()=>o.charCodeAt(l+1),W=()=>(R=S,o.charCodeAt(++l));for(;l<u;){S=W();let he;if(S===Ht){F=j.backslashes=!0,S=W(),S===Du&&(D=!0);continue}if(D===!0||S===Du){for(_++;ne()!==!0&&(S=W());){if(S===Ht){F=j.backslashes=!0,W();continue}if(S===Du){_++;continue}if(D!==!0&&S===hu&&(S=W())===hu){if(f=j.isBrace=!0,A=j.isGlob=!0,B=!0,n===!0)continue;break}if(D!==!0&&S===Qa){if(f=j.isBrace=!0,A=j.isGlob=!0,B=!0,n===!0)continue;break}if(S===eo&&(_--,_===0)){D=!1,f=j.isBrace=!0,B=!0;break}}if(n===!0)continue;break}if(S===jn){if(i.push(l),s.push(j),j={value:"",depth:0,isGlob:!1},B===!0)continue;if(R===hu&&l===h+1){h+=2;continue}c=l+1;continue}if(t.noext!==!0&&(S===Za||S===Xa||S===cu||S===Un||S===fu)===!0&&v()===du){if(A=j.isGlob=!0,p=j.isExtglob=!0,B=!0,S===fu&&l===h&&(b=!0),n===!0){for(;ne()!==!0&&(S=W());){if(S===Ht){F=j.backslashes=!0,S=W();continue}if(S===zn){A=j.isGlob=!0,B=!0;break}}continue}break}if(S===cu){if(R===cu&&(d=j.isGlobstar=!0),A=j.isGlob=!0,B=!0,n===!0)continue;break}if(S===Un){if(A=j.isGlob=!0,B=!0,n===!0)continue;break}if(S===Ya){for(;ne()!==!0&&(he=W());){if(he===Ht){F=j.backslashes=!0,W();continue}if(he===to){C=j.isBracket=!0,A=j.isGlob=!0,B=!0;break}}if(n===!0)continue;break}if(t.nonegate!==!0&&S===fu&&l===h){m=j.negated=!0,h++;continue}if(t.noparen!==!0&&S===du){if(A=j.isGlob=!0,n===!0){for(;ne()!==!0&&(S=W());){if(S===du){F=j.backslashes=!0,S=W();continue}if(S===zn){B=!0;break}}continue}break}if(A===!0){if(B=!0,n===!0)continue;break}}t.noext===!0&&(p=!1,A=!1);let z=o,we="",g="";h>0&&(we=o.slice(0,h),o=o.slice(h),c-=h),z&&A===!0&&c>0?(z=o.slice(0,c),g=o.slice(c)):A===!0?(z="",g=o):z=o,z&&z!==""&&z!=="/"&&z!==o&&Wn(z.charCodeAt(z.length-1))&&(z=z.slice(0,-1)),t.unescape===!0&&(g&&(g=se.removeBackslashes(g)),z&&F===!0&&(z=se.removeBackslashes(z)));const E={prefix:we,input:r,start:h,base:z,glob:g,isBrace:f,isBracket:C,isGlob:A,isExtglob:p,isGlobstar:d,negated:m,negatedExtglob:b};if(t.tokens===!0&&(E.maxDepth=0,Wn(S)||s.push(j),E.tokens=s),t.parts===!0||t.tokens===!0){let he;for(let U=0;U<i.length;U++){const ge=he?he+1:h,fe=i[U],de=r.slice(ge,fe);t.tokens&&(U===0&&h!==0?(s[U].isPrefix=!0,s[U].value=we):s[U].value=de,Gn(s[U]),E.maxDepth+=s[U].depth),(U!==0||de!=="")&&a.push(de),he=fe}if(he&&he+1<r.length){const U=r.slice(he+1);a.push(U),t.tokens&&(s[s.length-1].value=U,Gn(s[s.length-1]),E.maxDepth+=s[s.length-1].depth)}E.slashes=i,E.parts=a}return E};const{MAX_LENGTH:fr,POSIX_REGEX_SOURCE:uo,REGEX_NON_SPECIAL_CHARS:no,REGEX_SPECIAL_CHARS_BACKREF:io,REPLACEMENTS:qn}=ot,so=(r,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...r,e);r.sort();const t=`[${r.join("-")}]`;try{new RegExp(t)}catch{return r.map(n=>se.escapeRegex(n)).join("..")}return t},kt=(r,e)=>`Missing ${r}: "${e}" - use "\\\\${e}" to match literal characters`,Vn=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a string");r=qn[r]||r;const t=bt({},e),u=typeof t.maxLength=="number"?Math.min(fr,t.maxLength):fr;let n=r.length;if(n>u)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${u}`);const i={type:"bos",value:"",output:t.prepend||""},s=[i],a=t.capture?"":"?:",o=se.isWindows(e),l=ot.globChars(o),h=ot.extglobChars(l),{DOT_LITERAL:c,PLUS_LITERAL:f,SLASH_LITERAL:C,ONE_CHAR:A,DOTS_SLASH:p,NO_DOT:d,NO_DOT_SLASH:D,NO_DOTS_SLASH:F,QMARK:m,QMARK_NO_DOT:b,STAR:B,START_ANCHOR:_}=l,R=k=>`(${a}(?:(?!${_}${k.dot?p:c}).)*?)`,S=t.dot?"":d,j=t.dot?m:b;let ne=t.bash===!0?R(t):B;t.capture&&(ne=`(${ne})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);const v={input:r,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};r=se.removePrefix(r,v),n=r.length;const W=[],z=[],we=[];let g=i,E;const he=()=>v.index===n-1,U=v.peek=(k=1)=>r[v.index+k],ge=v.advance=()=>r[++v.index]||"",fe=()=>r.slice(v.index+1),de=(k="",Y=0)=>{v.consumed+=k,v.index+=Y},Pe=k=>{v.output+=k.output!=null?k.output:k.value,de(k.value)},nr=()=>{let k=1;for(;U()==="!"&&(U(2)!=="("||U(3)==="?");)ge(),v.start++,k++;return k%2===0?!1:(v.negated=!0,v.start++,!0)},et=k=>{v[k]++,we.push(k)},Ne=k=>{v[k]--,we.pop()},N=k=>{if(g.type==="globstar"){const Y=v.braces>0&&(k.type==="comma"||k.type==="brace"),x=k.extglob===!0||W.length&&(k.type==="pipe"||k.type==="paren");k.type!=="slash"&&k.type!=="paren"&&!Y&&!x&&(v.output=v.output.slice(0,-g.output.length),g.type="star",g.value="*",g.output=ne,v.output+=g.output)}if(W.length&&k.type!=="paren"&&(W[W.length-1].inner+=k.value),(k.value||k.output)&&Pe(k),g&&g.type==="text"&&k.type==="text"){g.value+=k.value,g.output=(g.output||"")+k.value;return}k.prev=g,s.push(k),g=k},Et=(k,Y)=>{const x=or(bt({},h[Y]),{conditions:1,inner:""});x.prev=g,x.parens=v.parens,x.output=v.output;const I=(t.capture?"(":"")+x.open;et("parens"),N({type:k,value:Y,output:v.output?"":A}),N({type:"paren",extglob:!0,value:ge(),output:I}),W.push(x)},Pr=k=>{let Y=k.close+(t.capture?")":""),x;if(k.type==="negate"){let I=ne;k.inner&&k.inner.length>1&&k.inner.includes("/")&&(I=R(t)),(I!==ne||he()||/^\)+$/.test(fe()))&&(Y=k.close=`)$))${I}`),k.inner.includes("*")&&(x=fe())&&/^\.[^\\/.]+$/.test(x)&&(Y=k.close=`)${x})${I})`),k.prev.type==="bos"&&(v.negatedExtglob=!0)}N({type:"paren",extglob:!0,value:E,output:Y}),Ne("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(r)){let k=!1,Y=r.replace(io,(x,I,ue,Ee,ie,Vu)=>Ee==="\\"?(k=!0,x):Ee==="?"?I?I+Ee+(ie?m.repeat(ie.length):""):Vu===0?j+(ie?m.repeat(ie.length):""):m.repeat(ue.length):Ee==="."?c.repeat(ue.length):Ee==="*"?I?I+Ee+(ie?ne:""):ne:I?x:`\\${x}`);return k===!0&&(t.unescape===!0?Y=Y.replace(/\\/g,""):Y=Y.replace(/\\+/g,x=>x.length%2===0?"\\\\":x?"\\":"")),Y===r&&t.contains===!0?(v.output=r,v):(v.output=se.wrapOutput(Y,v,e),v)}for(;!he();){if(E=ge(),E==="\0")continue;if(E==="\\"){const x=U();if(x==="/"&&t.bash!==!0||x==="."||x===";")continue;if(!x){E+="\\",N({type:"text",value:E});continue}const I=/^\\+/.exec(fe());let ue=0;if(I&&I[0].length>2&&(ue=I[0].length,v.index+=ue,ue%2!==0&&(E+="\\")),t.unescape===!0?E=ge():E+=ge(),v.brackets===0){N({type:"text",value:E});continue}}if(v.brackets>0&&(E!=="]"||g.value==="["||g.value==="[^")){if(t.posix!==!1&&E===":"){const x=g.value.slice(1);if(x.includes("[")&&(g.posix=!0,x.includes(":"))){const I=g.value.lastIndexOf("["),ue=g.value.slice(0,I),Ee=g.value.slice(I+2),ie=uo[Ee];if(ie){g.value=ue+ie,v.backtrack=!0,ge(),!i.output&&s.indexOf(g)===1&&(i.output=A);continue}}}(E==="["&&U()!==":"||E==="-"&&U()==="]")&&(E=`\\${E}`),E==="]"&&(g.value==="["||g.value==="[^")&&(E=`\\${E}`),t.posix===!0&&E==="!"&&g.value==="["&&(E="^"),g.value+=E,Pe({value:E});continue}if(v.quotes===1&&E!=='"'){E=se.escapeRegex(E),g.value+=E,Pe({value:E});continue}if(E==='"'){v.quotes=v.quotes===1?0:1,t.keepQuotes===!0&&N({type:"text",value:E});continue}if(E==="("){et("parens"),N({type:"paren",value:E});continue}if(E===")"){if(v.parens===0&&t.strictBrackets===!0)throw new SyntaxError(kt("opening","("));const x=W[W.length-1];if(x&&v.parens===x.parens+1){Pr(W.pop());continue}N({type:"paren",value:E,output:v.parens?")":"\\)"}),Ne("parens");continue}if(E==="["){if(t.nobracket===!0||!fe().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(kt("closing","]"));E=`\\${E}`}else et("brackets");N({type:"bracket",value:E});continue}if(E==="]"){if(t.nobracket===!0||g&&g.type==="bracket"&&g.value.length===1){N({type:"text",value:E,output:`\\${E}`});continue}if(v.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(kt("opening","["));N({type:"text",value:E,output:`\\${E}`});continue}Ne("brackets");const x=g.value.slice(1);if(g.posix!==!0&&x[0]==="^"&&!x.includes("/")&&(E=`/${E}`),g.value+=E,Pe({value:E}),t.literalBrackets===!1||se.hasRegexChars(x))continue;const I=se.escapeRegex(g.value);if(v.output=v.output.slice(0,-g.value.length),t.literalBrackets===!0){v.output+=I,g.value=I;continue}g.value=`(${a}${I}|${g.value})`,v.output+=g.value;continue}if(E==="{"&&t.nobrace!==!0){et("braces");const x={type:"brace",value:E,output:"(",outputIndex:v.output.length,tokensIndex:v.tokens.length};z.push(x),N(x);continue}if(E==="}"){const x=z[z.length-1];if(t.nobrace===!0||!x){N({type:"text",value:E,output:E});continue}let I=")";if(x.dots===!0){const ue=s.slice(),Ee=[];for(let ie=ue.length-1;ie>=0&&(s.pop(),ue[ie].type!=="brace");ie--)ue[ie].type!=="dots"&&Ee.unshift(ue[ie].value);I=so(Ee,t),v.backtrack=!0}if(x.comma!==!0&&x.dots!==!0){const ue=v.output.slice(0,x.outputIndex),Ee=v.tokens.slice(x.tokensIndex);x.value=x.output="\\{",E=I="\\}",v.output=ue;for(const ie of Ee)v.output+=ie.output||ie.value}N({type:"brace",value:E,output:I}),Ne("braces"),z.pop();continue}if(E==="|"){W.length>0&&W[W.length-1].conditions++,N({type:"text",value:E});continue}if(E===","){let x=E;const I=z[z.length-1];I&&we[we.length-1]==="braces"&&(I.comma=!0,x="|"),N({type:"comma",value:E,output:x});continue}if(E==="/"){if(g.type==="dot"&&v.index===v.start+1){v.start=v.index+1,v.consumed="",v.output="",s.pop(),g=i;continue}N({type:"slash",value:E,output:C});continue}if(E==="."){if(v.braces>0&&g.type==="dot"){g.value==="."&&(g.output=c);const x=z[z.length-1];g.type="dots",g.output+=E,g.value+=E,x.dots=!0;continue}if(v.braces+v.parens===0&&g.type!=="bos"&&g.type!=="slash"){N({type:"text",value:E,output:c});continue}N({type:"dot",value:E,output:c});continue}if(E==="?"){if(!(g&&g.value==="(")&&t.noextglob!==!0&&U()==="("&&U(2)!=="?"){Et("qmark",E);continue}if(g&&g.type==="paren"){const I=U();let ue=E;if(I==="<"&&!se.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(g.value==="("&&!/[!=<:]/.test(I)||I==="<"&&!/<([!=]|\w+>)/.test(fe()))&&(ue=`\\${E}`),N({type:"text",value:E,output:ue});continue}if(t.dot!==!0&&(g.type==="slash"||g.type==="bos")){N({type:"qmark",value:E,output:b});continue}N({type:"qmark",value:E,output:m});continue}if(E==="!"){if(t.noextglob!==!0&&U()==="("&&(U(2)!=="?"||!/[!=<:]/.test(U(3)))){Et("negate",E);continue}if(t.nonegate!==!0&&v.index===0){nr();continue}}if(E==="+"){if(t.noextglob!==!0&&U()==="("&&U(2)!=="?"){Et("plus",E);continue}if(g&&g.value==="("||t.regex===!1){N({type:"plus",value:E,output:f});continue}if(g&&(g.type==="bracket"||g.type==="paren"||g.type==="brace")||v.parens>0){N({type:"plus",value:E});continue}N({type:"plus",value:f});continue}if(E==="@"){if(t.noextglob!==!0&&U()==="("&&U(2)!=="?"){N({type:"at",extglob:!0,value:E,output:""});continue}N({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);const x=no.exec(fe());x&&(E+=x[0],v.index+=x[0].length),N({type:"text",value:E});continue}if(g&&(g.type==="globstar"||g.star===!0)){g.type="star",g.star=!0,g.value+=E,g.output=ne,v.backtrack=!0,v.globstar=!0,de(E);continue}let k=fe();if(t.noextglob!==!0&&/^\([^?]/.test(k)){Et("star",E);continue}if(g.type==="star"){if(t.noglobstar===!0){de(E);continue}const x=g.prev,I=x.prev,ue=x.type==="slash"||x.type==="bos",Ee=I&&(I.type==="star"||I.type==="globstar");if(t.bash===!0&&(!ue||k[0]&&k[0]!=="/")){N({type:"star",value:E,output:""});continue}const ie=v.braces>0&&(x.type==="comma"||x.type==="brace"),Vu=W.length&&(x.type==="pipe"||x.type==="paren");if(!ue&&x.type!=="paren"&&!ie&&!Vu){N({type:"star",value:E,output:""});continue}for(;k.slice(0,3)==="/**";){const Nr=r[v.index+4];if(Nr&&Nr!=="/")break;k=k.slice(3),de("/**",3)}if(x.type==="bos"&&he()){g.type="globstar",g.value+=E,g.output=R(t),v.output=g.output,v.globstar=!0,de(E);continue}if(x.type==="slash"&&x.prev.type!=="bos"&&!Ee&&he()){v.output=v.output.slice(0,-(x.output+g.output).length),x.output=`(?:${x.output}`,g.type="globstar",g.output=R(t)+(t.strictSlashes?")":"|$)"),g.value+=E,v.globstar=!0,v.output+=x.output+g.output,de(E);continue}if(x.type==="slash"&&x.prev.type!=="bos"&&k[0]==="/"){const Nr=k[1]!==void 0?"|$":"";v.output=v.output.slice(0,-(x.output+g.output).length),x.output=`(?:${x.output}`,g.type="globstar",g.output=`${R(t)}${C}|${C}${Nr})`,g.value+=E,v.output+=x.output+g.output,v.globstar=!0,de(E+ge()),N({type:"slash",value:"/",output:""});continue}if(x.type==="bos"&&k[0]==="/"){g.type="globstar",g.value+=E,g.output=`(?:^|${C}|${R(t)}${C})`,v.output=g.output,v.globstar=!0,de(E+ge()),N({type:"slash",value:"/",output:""});continue}v.output=v.output.slice(0,-g.output.length),g.type="globstar",g.output=R(t),g.value+=E,v.output+=g.output,v.globstar=!0,de(E);continue}const Y={type:"star",value:E,output:ne};if(t.bash===!0){Y.output=".*?",(g.type==="bos"||g.type==="slash")&&(Y.output=S+Y.output),N(Y);continue}if(g&&(g.type==="bracket"||g.type==="paren")&&t.regex===!0){Y.output=E,N(Y);continue}(v.index===v.start||g.type==="slash"||g.type==="dot")&&(g.type==="dot"?(v.output+=D,g.output+=D):t.dot===!0?(v.output+=F,g.output+=F):(v.output+=S,g.output+=S),U()!=="*"&&(v.output+=A,g.output+=A)),N(Y)}for(;v.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(kt("closing","]"));v.output=se.escapeLast(v.output,"["),Ne("brackets")}for(;v.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(kt("closing",")"));v.output=se.escapeLast(v.output,"("),Ne("parens")}for(;v.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(kt("closing","}"));v.output=se.escapeLast(v.output,"{"),Ne("braces")}if(t.strictSlashes!==!0&&(g.type==="star"||g.type==="bracket")&&N({type:"maybe_slash",value:"",output:`${C}?`}),v.backtrack===!0){v.output="";for(const k of v.tokens)v.output+=k.output!=null?k.output:k.value,k.suffix&&(v.output+=k.suffix)}return v};Vn.fastpaths=(r,e)=>{const t=bt({},e),u=typeof t.maxLength=="number"?Math.min(fr,t.maxLength):fr,n=r.length;if(n>u)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${u}`);r=qn[r]||r;const i=se.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:o,DOTS_SLASH:l,NO_DOT:h,NO_DOTS:c,NO_DOTS_SLASH:f,STAR:C,START_ANCHOR:A}=ot.globChars(i),p=t.dot?c:h,d=t.dot?f:h,D=t.capture?"":"?:",F={negated:!1,prefix:""};let m=t.bash===!0?".*?":C;t.capture&&(m=`(${m})`);const b=S=>S.noglobstar===!0?m:`(${D}(?:(?!${A}${S.dot?l:s}).)*?)`,B=S=>{switch(S){case"*":return`${p}${o}${m}`;case".*":return`${s}${o}${m}`;case"*.*":return`${p}${m}${s}${o}${m}`;case"*/*":return`${p}${m}${a}${o}${d}${m}`;case"**":return p+b(t);case"**/*":return`(?:${p}${b(t)}${a})?${d}${o}${m}`;case"**/*.*":return`(?:${p}${b(t)}${a})?${d}${m}${s}${o}${m}`;case"**/.*":return`(?:${p}${b(t)}${a})?${s}${o}${m}`;default:{const j=/^(.*?)\.(\w+)$/.exec(S);if(!j)return;const ne=B(j[1]);return ne?ne+s+j[2]:void 0}}},_=se.removePrefix(r,F);let R=B(_);return R&&t.strictSlashes!==!0&&(R+=`${a}?`),R};var pu=Vn;const ao=r=>r&&typeof r=="object"&&!Array.isArray(r),Z=(r,e,t=!1)=>{if(Array.isArray(r)){const h=r.map(f=>Z(f,e,t));return f=>{for(const C of h){const A=C(f);if(A)return A}return!1}}const u=ao(r)&&r.tokens&&r.input;if(r===""||typeof r!="string"&&!u)throw new TypeError("Expected pattern to be a non-empty string");const n=e||{},i=se.isWindows(e),s=u?Z.compileRe(r,e):Z.makeRe(r,e,!1,!0),a=s.state;delete s.state;let o=()=>!1;if(n.ignore){const h=or(bt({},e),{ignore:null,onMatch:null,onResult:null});o=Z(n.ignore,h,t)}const l=(h,c=!1)=>{const{isMatch:f,match:C,output:A}=Z.test(h,s,e,{glob:r,posix:i}),p={glob:r,state:a,regex:s,posix:i,input:h,output:A,match:C,isMatch:f};return typeof n.onResult=="function"&&n.onResult(p),f===!1?(p.isMatch=!1,c?p:!1):o(h)?(typeof n.onIgnore=="function"&&n.onIgnore(p),p.isMatch=!1,c?p:!1):(typeof n.onMatch=="function"&&n.onMatch(p),c?p:!0)};return t&&(l.state=a),l};Z.test=(r,e,t,{glob:u,posix:n}={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");if(r==="")return{isMatch:!1,output:""};const i=t||{},s=i.format||(n?se.toPosixSlashes:null);let a=r===u,o=a&&s?s(r):r;return a===!1&&(o=s?s(r):r,a=o===u),(a===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?a=Z.matchBase(r,e,t,n):a=e.exec(o)),{isMatch:Boolean(a),match:a,output:o}},Z.matchBase=(r,e,t,u=se.isWindows(t))=>(e instanceof RegExp?e:Z.makeRe(e,t)).test(au.basename(r)),Z.isMatch=(r,e,t)=>Z(e,t)(r),Z.parse=(r,e)=>Array.isArray(r)?r.map(t=>Z.parse(t,e)):pu(r,or(bt({},e),{fastpaths:!1})),Z.scan=(r,e)=>ro(r,e),Z.compileRe=(r,e,t=!1,u=!1)=>{if(t===!0)return r.output;const n=e||{},i=n.contains?"":"^",s=n.contains?"":"$";let a=`${i}(?:${r.output})${s}`;r&&r.negated===!0&&(a=`^(?!${a}).*$`);const o=Z.toRegex(a,e);return u===!0&&(o.state=r),o},Z.makeRe=(r,e={},t=!1,u=!1)=>{if(!r||typeof r!="string")throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(r[0]==="."||r[0]==="*")&&(n.output=pu.fastpaths(r,e)),n.output||(n=pu(r,e)),Z.compileRe(n,e,t,u)},Z.toRegex=(r,e)=>{try{const t=e||{};return new RegExp(r,t.flags||(t.nocase?"i":""))}catch(t){if(e&&e.debug===!0)throw t;return/$^/}},Z.constants=ot;var oo=Z,lo=oo;function Dr(r,e){return Array.isArray(e)?e.some(t=>Dr(r,t)):lo(e)(r)}function Mt(r,e,t){var u,n;if(e===void 0)return;if(r.length===0)return t(e);if(typeof e!="object"||e===null)return;const i=r.shift();if(i==="**"){for(;r.length>0&&r[0]==="*";)r.shift();const s=["**",...r].join("/"),a=new Set;Jn("",e,a);for(const o of a)Dr(o,s)&&Mt(o.split("/"),e,t)}else if(i.startsWith("*")){let s;i.length>=1&&(s=new RegExp((n=(u=i.match(/(\*{)(.+)(})/))==null?void 0:u[2])!=null?n:".*"));for(const a in e)s&&a.match(s)!==null&&Mt([...r],e[a],t)}else Mt(r,e[i],t)}function Jn(r,e,t){for(const u in e)t.add(`${r}${u}`),typeof e[u]=="object"&&Jn(`${r}${u}/`,e[u],t)}function co(r,e,t){const u=r.length===0||r==="/"?[]:r.split("/");return Mt(u,e,t)}function Kn(r,e,t){const u=r.length===0||r==="/"?[]:r.split("/");if(u.length===0)return;const n=u.pop();Mt(u,e,i=>{if(typeof i=="object")if(n==="*")for(const s in i)i[s]=t(i[s]);else i[n]!==void 0&&(i[n]=t(i[n]))})}function ho(r,e){let t=!1;for(const u of e)if(co(u,r,()=>t=!0),t)return!0;return!1}function jt(r,e){if(Array.isArray(r)&&Array.isArray(e))return r.concat(e);if(Array.isArray(r))return r.concat([e]);if(Array.isArray(e))return e.concat([r]);if(typeof e!="object")return e;let t={};for(const u in r)e[u]===void 0?t[u]=r[u]:t[u]=jt(r[u],e[u]);for(const u in e)r[u]===void 0&&(t[u]=e[u]);return t}function fo(r,e,t){if(e.length===0)return r;let u=r;for(let n=0;n<e.length;n++){if(u===void 0)return t;u=u[e[n]]}return u}function Do(r){return Array.from(r).map(e=>("00"+e.toString(16)).slice(-2)).join("")}async function po(r){return new Uint8Array(await crypto.subtle.digest("sha-1",r))}const Co=new TextEncoder;async function Cu(r){const e=Co.encode(r);if(!e)return"";const t=await po(e);return Do(t)}function Eo(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r==="undefined"?void 0:go(r)?Number(r):typeof r=="string"&&r.startsWith('"')&&r.endsWith('"')?r.slice(1,-1):r}function go(r){return!isNaN(Number(r))}function Xn(r){let e=0,t=0,u=!1,n=0,i=0,s="",a=[];for(;n<r.length;){if(r[n]==="^"&&s[0]==="^"||r[n]==="~"&&s[0]==="~")a.push({startColumn:i,endColumn:n,word:s}),i=n+1,s=r[n];else if(r[n]==='"')s+=r[n],u&&(a.push({startColumn:i,endColumn:n,word:s}),i=n+1,s=""),u=!u;else if(r[n]===" "||r[n]==="	"){if(u){s+=r[n],n++;continue}e===0&&t===0&&s!==""&&(a.push({startColumn:i,endColumn:n,word:s}),i=n+1,s="")}else r[n]==="{"?e++:r[n]==="}"?e--:r[n]==="["?t++:r[n]==="]"&&t--,r[n].trim()!==""&&(s+=r[n]);n++}return a.push({startColumn:i,endColumn:n,word:s}),{tokens:a}}function $e(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function Qn(r,e){for(var t="",u=0,n=-1,i=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(t.length<2||u!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var o=t.lastIndexOf("/");if(o!==t.length-1){o===-1?(t="",u=0):(t=t.slice(0,o),u=t.length-1-t.lastIndexOf("/")),n=a,i=0;continue}}else if(t.length===2||t.length===1){t="",u=0,n=a,i=0;continue}}e&&(t.length>0?t+="/..":t="..",u=2)}else t.length>0?t+="/"+r.slice(n+1,a):t=r.slice(n+1,a),u=a-n-1;n=a,i=0}else s===46&&i!==-1?++i:i=-1}return t}function Ao(r,e){var t=e.dir||e.root,u=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+u:t+r+u:u}var Rt={resolve:function(){for(var e="",t=!1,u,n=arguments.length-1;n>=-1&&!t;n--){var i;n>=0?i=arguments[n]:(u===void 0&&(u=process.cwd()),i=u),$e(i),i.length!==0&&(e=i+"/"+e,t=i.charCodeAt(0)===47)}return e=Qn(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if($e(e),e.length===0)return".";var t=e.charCodeAt(0)===47,u=e.charCodeAt(e.length-1)===47;return e=Qn(e,!t),e.length===0&&!t&&(e="."),e.length>0&&u&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return $e(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var u=arguments[t];$e(u),u.length>0&&(e===void 0?e=u:e+="/"+u)}return e===void 0?".":Rt.normalize(e)},relative:function(e,t){if($e(e),$e(t),e===t||(e=Rt.resolve(e),t=Rt.resolve(t),e===t))return"";for(var u=1;u<e.length&&e.charCodeAt(u)===47;++u);for(var n=e.length,i=n-u,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,o=a-s,l=i<o?i:o,h=-1,c=0;c<=l;++c){if(c===l){if(o>l){if(t.charCodeAt(s+c)===47)return t.slice(s+c+1);if(c===0)return t.slice(s+c)}else i>l&&(e.charCodeAt(u+c)===47?h=c:c===0&&(h=0));break}var f=e.charCodeAt(u+c),C=t.charCodeAt(s+c);if(f!==C)break;f===47&&(h=c)}var A="";for(c=u+h+1;c<=n;++c)(c===n||e.charCodeAt(c)===47)&&(A.length===0?A+="..":A+="/..");return A.length>0?A+t.slice(s+h):(s+=h,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if($e(e),e.length===0)return".";for(var t=e.charCodeAt(0),u=t===47,n=-1,i=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!i){n=s;break}}else i=!1;return n===-1?u?"/":".":u&&n===1?"//":e.slice(0,n)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');$e(e);var u=0,n=-1,i=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,o=-1;for(s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(l===47){if(!i){u=s+1;break}}else o===-1&&(i=!1,o=s+1),a>=0&&(l===t.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=o))}return u===n?n=o:n===-1&&(n=e.length),e.slice(u,n)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!i){u=s+1;break}}else n===-1&&(i=!1,n=s+1);return n===-1?"":e.slice(u,n)}},extname:function(e){$e(e);for(var t=-1,u=0,n=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(o===47){if(!i){u=a+1;break}continue}n===-1&&(i=!1,n=a+1),o===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||n===-1||s===0||s===1&&t===n-1&&t===u+1?"":e.slice(t,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Ao("/",e)},parse:function(e){$e(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var u=e.charCodeAt(0),n=u===47,i;n?(t.root="/",i=1):i=0;for(var s=-1,a=0,o=-1,l=!0,h=e.length-1,c=0;h>=i;--h){if(u=e.charCodeAt(h),u===47){if(!l){a=h+1;break}continue}o===-1&&(l=!1,o=h+1),u===46?s===-1?s=h:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||o===-1||c===0||c===1&&s===o-1&&s===a+1?o!==-1&&(a===0&&n?t.base=t.name=e.slice(1,o):t.base=t.name=e.slice(a,o)):(a===0&&n?(t.name=e.slice(1,s),t.base=e.slice(1,o)):(t.name=e.slice(a,s),t.base=e.slice(a,o)),t.ext=e.slice(s,o)),a>0?t.dir=e.slice(0,a-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Rt.posix=Rt;var L=Rt,Fo=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,mo=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,yo=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Eu={Space_Separator:Fo,ID_Start:mo,ID_Continue:yo},ee={isSpaceSeparator(r){return typeof r=="string"&&Eu.Space_Separator.test(r)},isIdStartChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="$"||r==="_"||Eu.ID_Start.test(r))},isIdContinueChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r>="0"&&r<="9"||r==="$"||r==="_"||r==="\u200C"||r==="\u200D"||Eu.ID_Continue.test(r))},isDigit(r){return typeof r=="string"&&/[0-9]/.test(r)},isHexDigit(r){return typeof r=="string"&&/[0-9A-Fa-f]/.test(r)}};let gu,pe,He,dr,Xe,be,ae,Au,Ut;var wo=function(e,t){gu=String(e),pe="start",He=[],dr=0,Xe=1,be=0,ae=void 0,Au=void 0,Ut=void 0;do ae=vo(),xo[pe]();while(ae.type!=="eof");return typeof t=="function"?Yn({"":Ut},"",t):Ut};function Yn(r,e,t){const u=r[e];if(u!=null&&typeof u=="object")for(const n in u){const i=Yn(u,n,t);i===void 0?delete u[n]:u[n]=i}return t.call(r,e,u)}let O,$,zt,Me,H;function vo(){for(O="default",$="",zt=!1,Me=1;;){H=je();const r=Zn[O]();if(r)return r}}function je(){if(gu[dr])return String.fromCodePoint(gu.codePointAt(dr))}function y(){const r=je();return r===`
`?(Xe++,be=0):r?be+=r.length:be++,r&&(dr+=r.length),r}const Zn={default(){switch(H){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":y();return;case"/":y(),O="comment";return;case void 0:return y(),q("eof")}if(ee.isSpaceSeparator(H)){y();return}return Zn[pe]()},comment(){switch(H){case"*":y(),O="multiLineComment";return;case"/":y(),O="singleLineComment";return}throw V(y())},multiLineComment(){switch(H){case"*":y(),O="multiLineCommentAsterisk";return;case void 0:throw V(y())}y()},multiLineCommentAsterisk(){switch(H){case"*":y();return;case"/":y(),O="default";return;case void 0:throw V(y())}y(),O="multiLineComment"},singleLineComment(){switch(H){case`
`:case"\r":case"\u2028":case"\u2029":y(),O="default";return;case void 0:return y(),q("eof")}y()},value(){switch(H){case"{":case"[":return q("punctuator",y());case"n":return y(),lt("ull"),q("null",null);case"t":return y(),lt("rue"),q("boolean",!0);case"f":return y(),lt("alse"),q("boolean",!1);case"-":case"+":y()==="-"&&(Me=-1),O="sign";return;case".":$=y(),O="decimalPointLeading";return;case"0":$=y(),O="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":$=y(),O="decimalInteger";return;case"I":return y(),lt("nfinity"),q("numeric",1/0);case"N":return y(),lt("aN"),q("numeric",NaN);case'"':case"'":zt=y()==='"',$="",O="string";return}throw V(y())},identifierNameStartEscape(){if(H!=="u")throw V(y());y();const r=Fu();switch(r){case"$":case"_":break;default:if(!ee.isIdStartChar(r))throw ei();break}$+=r,O="identifierName"},identifierName(){switch(H){case"$":case"_":case"\u200C":case"\u200D":$+=y();return;case"\\":y(),O="identifierNameEscape";return}if(ee.isIdContinueChar(H)){$+=y();return}return q("identifier",$)},identifierNameEscape(){if(H!=="u")throw V(y());y();const r=Fu();switch(r){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!ee.isIdContinueChar(r))throw ei();break}$+=r,O="identifierName"},sign(){switch(H){case".":$=y(),O="decimalPointLeading";return;case"0":$=y(),O="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":$=y(),O="decimalInteger";return;case"I":return y(),lt("nfinity"),q("numeric",Me*(1/0));case"N":return y(),lt("aN"),q("numeric",NaN)}throw V(y())},zero(){switch(H){case".":$+=y(),O="decimalPoint";return;case"e":case"E":$+=y(),O="decimalExponent";return;case"x":case"X":$+=y(),O="hexadecimal";return}return q("numeric",Me*0)},decimalInteger(){switch(H){case".":$+=y(),O="decimalPoint";return;case"e":case"E":$+=y(),O="decimalExponent";return}if(ee.isDigit(H)){$+=y();return}return q("numeric",Me*Number($))},decimalPointLeading(){if(ee.isDigit(H)){$+=y(),O="decimalFraction";return}throw V(y())},decimalPoint(){switch(H){case"e":case"E":$+=y(),O="decimalExponent";return}if(ee.isDigit(H)){$+=y(),O="decimalFraction";return}return q("numeric",Me*Number($))},decimalFraction(){switch(H){case"e":case"E":$+=y(),O="decimalExponent";return}if(ee.isDigit(H)){$+=y();return}return q("numeric",Me*Number($))},decimalExponent(){switch(H){case"+":case"-":$+=y(),O="decimalExponentSign";return}if(ee.isDigit(H)){$+=y(),O="decimalExponentInteger";return}throw V(y())},decimalExponentSign(){if(ee.isDigit(H)){$+=y(),O="decimalExponentInteger";return}throw V(y())},decimalExponentInteger(){if(ee.isDigit(H)){$+=y();return}return q("numeric",Me*Number($))},hexadecimal(){if(ee.isHexDigit(H)){$+=y(),O="hexadecimalInteger";return}throw V(y())},hexadecimalInteger(){if(ee.isHexDigit(H)){$+=y();return}return q("numeric",Me*Number($))},string(){switch(H){case"\\":y(),$+=Bo();return;case'"':if(zt)return y(),q("string",$);$+=y();return;case"'":if(!zt)return y(),q("string",$);$+=y();return;case`
`:case"\r":throw V(y());case"\u2028":case"\u2029":_o(H);break;case void 0:throw V(y())}$+=y()},start(){switch(H){case"{":case"[":return q("punctuator",y())}O="value"},beforePropertyName(){switch(H){case"$":case"_":$=y(),O="identifierName";return;case"\\":y(),O="identifierNameStartEscape";return;case"}":return q("punctuator",y());case'"':case"'":zt=y()==='"',O="string";return}if(ee.isIdStartChar(H)){$+=y(),O="identifierName";return}throw V(y())},afterPropertyName(){if(H===":")return q("punctuator",y());throw V(y())},beforePropertyValue(){O="value"},afterPropertyValue(){switch(H){case",":case"}":return q("punctuator",y())}throw V(y())},beforeArrayValue(){if(H==="]")return q("punctuator",y());O="value"},afterArrayValue(){switch(H){case",":case"]":return q("punctuator",y())}throw V(y())},end(){throw V(y())}};function q(r,e){return{type:r,value:e,line:Xe,column:be}}function lt(r){for(const e of r){if(je()!==e)throw V(y());y()}}function Bo(){switch(je()){case"b":return y(),"\b";case"f":return y(),"\f";case"n":return y(),`
`;case"r":return y(),"\r";case"t":return y(),"	";case"v":return y(),"\v";case"0":if(y(),ee.isDigit(je()))throw V(y());return"\0";case"x":return y(),bo();case"u":return y(),Fu();case`
`:case"\u2028":case"\u2029":return y(),"";case"\r":return y(),je()===`
`&&y(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw V(y());case void 0:throw V(y())}return y()}function bo(){let r="",e=je();if(!ee.isHexDigit(e)||(r+=y(),e=je(),!ee.isHexDigit(e)))throw V(y());return r+=y(),String.fromCodePoint(parseInt(r,16))}function Fu(){let r="",e=4;for(;e-- >0;){const t=je();if(!ee.isHexDigit(t))throw V(y());r+=y()}return String.fromCodePoint(parseInt(r,16))}const xo={start(){if(ae.type==="eof")throw ct();mu()},beforePropertyName(){switch(ae.type){case"identifier":case"string":Au=ae.value,pe="afterPropertyName";return;case"punctuator":pr();return;case"eof":throw ct()}},afterPropertyName(){if(ae.type==="eof")throw ct();pe="beforePropertyValue"},beforePropertyValue(){if(ae.type==="eof")throw ct();mu()},beforeArrayValue(){if(ae.type==="eof")throw ct();if(ae.type==="punctuator"&&ae.value==="]"){pr();return}mu()},afterPropertyValue(){if(ae.type==="eof")throw ct();switch(ae.value){case",":pe="beforePropertyName";return;case"}":pr()}},afterArrayValue(){if(ae.type==="eof")throw ct();switch(ae.value){case",":pe="beforeArrayValue";return;case"]":pr()}},end(){}};function mu(){let r;switch(ae.type){case"punctuator":switch(ae.value){case"{":r={};break;case"[":r=[];break}break;case"null":case"boolean":case"numeric":case"string":r=ae.value;break}if(Ut===void 0)Ut=r;else{const e=He[He.length-1];Array.isArray(e)?e.push(r):e[Au]=r}if(r!==null&&typeof r=="object")He.push(r),Array.isArray(r)?pe="beforeArrayValue":pe="beforePropertyName";else{const e=He[He.length-1];e==null?pe="end":Array.isArray(e)?pe="afterArrayValue":pe="afterPropertyValue"}}function pr(){He.pop();const r=He[He.length-1];r==null?pe="end":Array.isArray(r)?pe="afterArrayValue":pe="afterPropertyValue"}function V(r){return Cr(r===void 0?`JSON5: invalid end of input at ${Xe}:${be}`:`JSON5: invalid character '${ti(r)}' at ${Xe}:${be}`)}function ct(){return Cr(`JSON5: invalid end of input at ${Xe}:${be}`)}function ei(){return be-=5,Cr(`JSON5: invalid identifier character at ${Xe}:${be}`)}function _o(r){console.warn(`JSON5: '${ti(r)}' in strings is not valid ECMAScript; consider escaping`)}function ti(r){const e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(e[r])return e[r];if(r<" "){const t=r.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return r}function Cr(r){const e=new SyntaxError(r);return e.lineNumber=Xe,e.columnNumber=be,e}var So=function(e,t,u){const n=[];let i="",s,a,o="",l;if(t!=null&&typeof t=="object"&&!Array.isArray(t)&&(u=t.space,l=t.quote,t=t.replacer),typeof t=="function")a=t;else if(Array.isArray(t)){s=[];for(const p of t){let d;typeof p=="string"?d=p:(typeof p=="number"||p instanceof String||p instanceof Number)&&(d=String(p)),d!==void 0&&s.indexOf(d)<0&&s.push(d)}}return u instanceof Number?u=Number(u):u instanceof String&&(u=String(u)),typeof u=="number"?u>0&&(u=Math.min(10,Math.floor(u)),o="          ".substr(0,u)):typeof u=="string"&&(o=u.substr(0,10)),h("",{"":e});function h(p,d){let D=d[p];switch(D!=null&&(typeof D.toJSON5=="function"?D=D.toJSON5(p):typeof D.toJSON=="function"&&(D=D.toJSON(p))),a&&(D=a.call(d,p,D)),D instanceof Number?D=Number(D):D instanceof String?D=String(D):D instanceof Boolean&&(D=D.valueOf()),D){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof D=="string")return c(D);if(typeof D=="number")return String(D);if(typeof D=="object")return Array.isArray(D)?A(D):f(D)}function c(p){const d={"'":.1,'"':.2},D={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let F="";for(let b=0;b<p.length;b++){const B=p[b];switch(B){case"'":case'"':d[B]++,F+=B;continue;case"\0":if(ee.isDigit(p[b+1])){F+="\\x00";continue}}if(D[B]){F+=D[B];continue}if(B<" "){let _=B.charCodeAt(0).toString(16);F+="\\x"+("00"+_).substring(_.length);continue}F+=B}const m=l||Object.keys(d).reduce((b,B)=>d[b]<d[B]?b:B);return F=F.replace(new RegExp(m,"g"),D[m]),m+F+m}function f(p){if(n.indexOf(p)>=0)throw TypeError("Converting circular structure to JSON5");n.push(p);let d=i;i=i+o;let D=s||Object.keys(p),F=[];for(const b of D){const B=h(b,p);if(B!==void 0){let _=C(b)+":";o!==""&&(_+=" "),_+=B,F.push(_)}}let m;if(F.length===0)m="{}";else{let b;if(o==="")b=F.join(","),m="{"+b+"}";else{let B=`,
`+i;b=F.join(B),m=`{
`+i+b+`,
`+d+"}"}}return n.pop(),i=d,m}function C(p){if(p.length===0)return c(p);const d=String.fromCodePoint(p.codePointAt(0));if(!ee.isIdStartChar(d))return c(p);for(let D=d.length;D<p.length;D++)if(!ee.isIdContinueChar(String.fromCodePoint(p.codePointAt(D))))return c(p);return p}function A(p){if(n.indexOf(p)>=0)throw TypeError("Converting circular structure to JSON5");n.push(p);let d=i;i=i+o;let D=[];for(let m=0;m<p.length;m++){const b=h(String(m),p);D.push(b!==void 0?b:"null")}let F;if(D.length===0)F="[]";else if(o===""){let m=D.join(",");F="["+m+"]"}else{let m=`,
`+i,b=D.join(m);F=`[
`+i+b+`,
`+d+"]"}return n.pop(),i=d,F}},yu={parse:wo,stringify:So};const ri={behaviorPack:"./BP",resourcePack:"./RP",skinPack:"./SP",worldTemplate:"./WT"};class ko{constructor(e){this.basePath=e,this.data={}}async refreshConfig(){this.data=await this.readConfig()}async setup(){await this.refreshConfig()}get(){return this.data}getRelativePackRoot(e){var t,u;return(u=(t=this.data.packs)==null?void 0:t[e])!=null?u:ri[e]}getAbsolutePackRoot(e){return this.resolvePackPath(e)}resolvePackPath(e,t){return!t&&!e?this.basePath:!e&&t?L.join(this.basePath,t):!t&&e?L.join(this.basePath,this.getRelativePackRoot(e)):L.join(this.basePath,`${this.getRelativePackRoot(e)}/${t}`)}getAvailablePackPaths(){var e;const t=[];for(const u of Object.keys((e=this.data.packs)!=null?e:{}))t.push(this.resolvePackPath(u));return t}getAvailablePacks(){var e;const t={};for(const u in(e=this.data.packs)!=null?e:{})t[u]=this.resolvePackPath(u);return t}async save(){await this.writeConfig(this.data)}}class Ro{constructor(e){this.projectConfig=e,this.packTypes=[],this.extensionPackTypes=new Set}setProjectConfig(e){this.projectConfig=e}get all(){return this.packTypes.concat(...Array.from(this.extensionPackTypes.values()))}getFromId(e){return this.all.find(t=>t.id===e)}get(e){var t,u;const n=(u=(t=this.projectConfig)==null?void 0:t.getAvailablePacks())!=null?u:ri;for(const i in n)if(e.startsWith(n[i]))return this.getFromId(i)}getId(e){var t,u;return(u=(t=this.get(e))==null?void 0:t.id)!=null?u:"unknown"}addExtensionPackType(e){return this.extensionPackTypes.add(e),{dispose:()=>this.extensionPackTypes.delete(e)}}}class $o{constructor(e,t){this.projectConfig=e,this.isMatch=t,this.pluginFileTypes=new Set,this.fileTypes=[]}get all(){return this.fileTypes.concat([...this.pluginFileTypes.values()])}setProjectConfig(e){this.projectConfig=e}addPluginFileType(e){return this.pluginFileTypes.add(e),{dispose:()=>this.pluginFileTypes.delete(e)}}getPluginFileTypes(){return[...this.pluginFileTypes.values()]}setPluginFileTypes(e=[]){this.pluginFileTypes.clear(),e.forEach(t=>this.pluginFileTypes.add(t))}get(e,t){var u,n,i,s,a,o,l,h,c,f,C,A,p;const d=e?L.extname(e):null;if(!!d)for(const D of this.all){if(t!==void 0&&t===D.id)return D;if(!e)continue;const F=((u=D.detect)==null?void 0:u.packType)===void 0?[]:Array.isArray((n=D.detect)==null?void 0:n.packType)?(i=D.detect)==null?void 0:i.packType:[(s=D.detect)==null?void 0:s.packType],m=(a=D.detect)==null?void 0:a.fileExtensions,b=!!((o=D.detect)!=null&&o.scope),B=Array.isArray((l=D.detect)==null?void 0:l.scope)?(h=D.detect)==null?void 0:h.scope:[(c=D.detect)==null?void 0:c.scope],_=!!((f=D.detect)!=null&&f.matcher),R=Array.isArray((C=D.detect)==null?void 0:C.matcher)?(A=D.detect)==null?void 0:A.matcher:[(p=D.detect)==null?void 0:p.matcher];if(!(m&&!m.includes(d)))if(b){if(this.prefixMatchers(F,B).some(S=>e.startsWith(S)))return D}else if(_){if(this.isMatch(e,this.prefixMatchers(F,R)))return D}else throw console.log(D),new Error('Invalid file definition, no "detect" properties')}}prefixMatchers(e,t){if(!this.projectConfig)return[];if(e.length===0)return t.map(n=>this.projectConfig.resolvePackPath(void 0,n));const u=[];for(const n of e)for(const i of t)u.push(this.projectConfig.resolvePackPath(n,i));return u}getIds(){const e=[];for(const t of this.all)e.push(t.id);return e}async guessFolder(e){var t,u;const n=(o,l)=>{var h,c;let f=Array.isArray(o)?o[0]:o;f.endsWith("/")||(f+="/");const C=(c=(h=this.projectConfig)==null?void 0:h.getAbsolutePackRoot(l))!=null?c:"./unknown";return L.join(C,f)},i=`.${e.name.split(".").pop()}`;for(const{detect:o={}}of this.all)if(!!o.scope&&(t=o.fileExtensions)!=null&&t.includes(i))return n(o.scope,Array.isArray(o.packType)?o.packType[0]:(u=o.packType)!=null?u:"behaviorPack");if(!e.name.endsWith(".json"))return null;const s=await e.getFile();let a;try{a=yu.parse(await s.text())}catch{return null}for(const{type:o,detect:l}of this.all){if(typeof o=="string"&&o!=="json")continue;const{scope:h,fileContent:c,packType:f="behaviorPack"}=l!=null?l:{};if(!(!h||!c)&&!!ho(a,c))return n(h,Array.isArray(f)?f[0]:f)}return null}getId(e){var t,u;return(u=(t=this.get(e))==null?void 0:t.id)!=null?u:"unknown"}isJsonFile(e){var t,u;const n=(u=(t=this.get(e))==null?void 0:t.meta)==null?void 0:u.language;return n?n==="json":e.endsWith(".json")}}class To extends $o{constructor(e){super(e,Dr),this.ready=new rt,this.lCacheFiles={},this.lCacheFilesLoaded=new rt,this.packSpiderFiles={},this.packSpiderFilesLoaded=new rt}setProjectConfig(e){this.projectConfig=e}async setup(e){this.fileTypes.length>0||(await e.fired,this.fileTypes=await e.readJSON("data/packages/minecraftBedrock/fileDefinitions.json"),this.loadLightningCache(e),this.loadPackSpider(e),this.ready.dispatch())}getMonacoSchemaEntries(){return this.fileTypes.map(({detect:e={},schema:t})=>{if(!e.matcher)return null;const u=(e==null?void 0:e.packType)===void 0?[]:Array.isArray(e==null?void 0:e.packType)?e==null?void 0:e.packType:[e==null?void 0:e.packType];return{fileMatch:this.prefixMatchers(u,Array.isArray(e.matcher)?[...e.matcher]:[e.matcher]).map(n=>encodeURI(n).replaceAll(/;|,|@|&|=|\+|\$|\.|!|'|\(|\)|#/g,"*")),uri:t}}).filter(e=>e!==null).flat()}async loadLightningCache(e){var n;const t=await e.readJSON("data/packages/minecraftBedrock/lightningCaches.json"),u=i=>Object.entries(t).find(([s])=>s.endsWith(i));for(const i of this.fileTypes){if(!i.lightningCache)continue;const[s,a]=(n=u(i.lightningCache))!=null?n:[];if(!s)throw new Error(`Lightning cache file "${i.lightningCache}" for file type "${i.id}" not found`);this.lCacheFiles[i.lightningCache]=a}this.lCacheFilesLoaded.dispatch()}async getLightningCache(e){var u,n;const{lightningCache:t}=(u=this.get(e))!=null?u:{};return t?(await this.lCacheFilesLoaded.fired,(n=this.lCacheFiles[t])!=null?n:[]):[]}async loadPackSpider(e){const t=await e.readJSON("data/packages/minecraftBedrock/packSpiders.json");this.packSpiderFiles=Object.fromEntries(this.fileTypes.map(({id:u,packSpider:n})=>{if(!!n)return[u,t[`file:///data/packages/minecraftBedrock/packSpider/${n}`]]}).filter(u=>u!==void 0)),this.packSpiderFilesLoaded.dispatch()}async getPackSpiderData(){return await this.packSpiderFilesLoaded.fired,this.packSpiderFiles}}const Oo="/";var ui={},Po=function(r,e,t,u,n){var i=ui[e]||(ui[e]=URL.createObjectURL(new Blob([r],{type:"text/javascript"}))),s=new Worker(i);return s.onerror=function(a){return n(a.error,null)},s.onmessage=function(a){return n(null,a.data)},s.postMessage(t,u),s},De=Uint8Array,Te=Uint16Array,Wt=Uint32Array,wu=new De([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vu=new De([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ni=new De([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ii=function(r,e){for(var t=new Te(31),u=0;u<31;++u)t[u]=e+=1<<r[u-1];for(var n=new Wt(t[30]),u=1;u<30;++u)for(var i=t[u];i<t[u+1];++i)n[i]=i-t[u]<<5|u;return[t,n]},si=ii(wu,2),Bu=si[0],No=si[1];Bu[28]=258,No[258]=28;for(var Io=ii(vu,0),ai=Io[0],Er=new Te(32768),J=0;J<32768;++J){var Qe=(J&43690)>>>1|(J&21845)<<1;Qe=(Qe&52428)>>>2|(Qe&13107)<<2,Qe=(Qe&61680)>>>4|(Qe&3855)<<4,Er[J]=((Qe&65280)>>>8|(Qe&255)<<8)>>>1}for(var $t=function(r,e,t){for(var u=r.length,n=0,i=new Te(e);n<u;++n)++i[r[n]-1];var s=new Te(e);for(n=0;n<e;++n)s[n]=s[n-1]+i[n-1]<<1;var a;if(t){a=new Te(1<<e);var o=15-e;for(n=0;n<u;++n)if(r[n])for(var l=n<<4|r[n],h=e-r[n],c=s[r[n]-1]++<<h,f=c|(1<<h)-1;c<=f;++c)a[Er[c]>>>o]=l}else for(a=new Te(u),n=0;n<u;++n)r[n]&&(a[n]=Er[s[r[n]-1]++]>>>15-r[n]);return a},Gt=new De(288),J=0;J<144;++J)Gt[J]=8;for(var J=144;J<256;++J)Gt[J]=9;for(var J=256;J<280;++J)Gt[J]=7;for(var J=280;J<288;++J)Gt[J]=8;for(var oi=new De(32),J=0;J<32;++J)oi[J]=5;var li=$t(Gt,9,1),ci=$t(oi,5,1),gr=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},ve=function(r,e,t){var u=e/8|0;return(r[u]|r[u+1]<<8)>>(e&7)&t},Ar=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},hi=function(r){return(r/8|0)+(r&7&&1)},Fr=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var u=new(r instanceof Te?Te:r instanceof Wt?Wt:De)(t-e);return u.set(r.subarray(e,t)),u},fi=function(r,e,t){var u=r.length;if(!u||t&&!t.l&&u<5)return e||new De(0);var n=!e||t,i=!t||t.i;t||(t={}),e||(e=new De(u*3));var s=function(N){var Et=e.length;if(N>Et){var Pr=new De(Math.max(Et*2,N));Pr.set(e),e=Pr}},a=t.f||0,o=t.p||0,l=t.b||0,h=t.l,c=t.d,f=t.m,C=t.n,A=u*8;do{if(!h){t.f=a=ve(r,o,1);var p=ve(r,o+1,3);if(o+=3,p)if(p==1)h=li,c=ci,f=9,C=5;else if(p==2){var m=ve(r,o,31)+257,b=ve(r,o+10,15)+4,B=m+ve(r,o+5,31)+1;o+=14;for(var _=new De(B),R=new De(19),S=0;S<b;++S)R[ni[S]]=ve(r,o+S*3,7);o+=b*3;for(var j=gr(R),ne=(1<<j)-1,v=$t(R,j,1),S=0;S<B;){var W=v[ve(r,o,ne)];o+=W&15;var d=W>>>4;if(d<16)_[S++]=d;else{var z=0,we=0;for(d==16?(we=3+ve(r,o,3),o+=2,z=_[S-1]):d==17?(we=3+ve(r,o,7),o+=3):d==18&&(we=11+ve(r,o,127),o+=7);we--;)_[S++]=z}}var g=_.subarray(0,m),E=_.subarray(m);f=gr(g),C=gr(E),h=$t(g,f,1),c=$t(E,C,1)}else throw"invalid block type";else{var d=hi(o)+4,D=r[d-4]|r[d-3]<<8,F=d+D;if(F>u){if(i)throw"unexpected EOF";break}n&&s(l+D),e.set(r.subarray(d,F),l),t.b=l+=D,t.p=o=F*8;continue}if(o>A){if(i)throw"unexpected EOF";break}}n&&s(l+131072);for(var he=(1<<f)-1,U=(1<<C)-1,ge=o;;ge=o){var z=h[Ar(r,o)&he],fe=z>>>4;if(o+=z&15,o>A){if(i)throw"unexpected EOF";break}if(!z)throw"invalid length/literal";if(fe<256)e[l++]=fe;else if(fe==256){ge=o,h=null;break}else{var de=fe-254;if(fe>264){var S=fe-257,Pe=wu[S];de=ve(r,o,(1<<Pe)-1)+Bu[S],o+=Pe}var nr=c[Ar(r,o)&U],et=nr>>>4;if(!nr)throw"invalid distance";o+=nr&15;var E=ai[et];if(et>3){var Pe=vu[et];E+=Ar(r,o)&(1<<Pe)-1,o+=Pe}if(o>A){if(i)throw"unexpected EOF";break}n&&s(l+131072);for(var Ne=l+de;l<Ne;l+=4)e[l]=e[l-E],e[l+1]=e[l+1-E],e[l+2]=e[l+2-E],e[l+3]=e[l+3-E];l=Ne}}t.l=h,t.p=ge,t.b=l,h&&(a=1,t.m=f,t.d=c,t.n=C)}while(!a);return l==e.length?e:Fr(e,0,l)},Lo=new De(0),Ho=function(r,e){var t={};for(var u in r)t[u]=r[u];for(var u in e)t[u]=e[u];return t},Di=function(r,e,t){for(var u=r(),n=r.toString(),i=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<u.length;++s){var a=u[s],o=i[s];if(typeof a=="function"){e+=";"+o+"=";var l=a.toString();if(a.prototype)if(l.indexOf("[native code]")!=-1){var h=l.indexOf(" ",8)+1;e+=l.slice(h,l.indexOf("(",h))}else{e+=l;for(var c in a.prototype)e+=";"+o+".prototype."+c+"="+a.prototype[c].toString()}else e+=l}else t[o]=a}return[e,t]},mr=[],Mo=function(r){var e=[];for(var t in r)(r[t]instanceof De||r[t]instanceof Te||r[t]instanceof Wt)&&e.push((r[t]=new r[t].constructor(r[t])).buffer);return e},jo=function(r,e,t,u){var n;if(!mr[t]){for(var i="",s={},a=r.length-1,o=0;o<a;++o)n=Di(r[o],i,s),i=n[0],s=n[1];mr[t]=Di(r[a],i,s)}var l=Ho({},mr[t][1]);return Po(mr[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,l,Mo(l),u)},Uo=function(){return[De,Te,Wt,wu,vu,ni,Bu,ai,li,ci,Er,$t,gr,ve,Ar,hi,Fr,fi,xu,di,pi]},di=function(r){return postMessage(r,[r.buffer])},pi=function(r){return r&&r.size&&new De(r.size)},zo=function(r,e,t,u,n,i){var s=jo(t,u,n,function(a,o){s.terminate(),i(a,o)});return s.postMessage([r,e],e.consume?[r.buffer]:[]),function(){s.terminate()}},Oe=function(r,e){return r[e]|r[e+1]<<8},xe=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},bu=function(r,e){return xe(r,e)+xe(r,e+4)*4294967296};function Wo(r,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return zo(r,e,[Uo],function(u){return di(xu(u.data[0],pi(u.data[1])))},1,t)}function xu(r,e){return fi(r,e)}var _u=typeof TextDecoder<"u"&&new TextDecoder,Go=0;try{_u.decode(Lo,{stream:!0}),Go=1}catch{}var qo=function(r){for(var e="",t=0;;){var u=r[t++],n=(u>127)+(u>223)+(u>239);if(t+n>r.length)return[e,Fr(r,t-1)];n?n==3?(u=((u&15)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,e+=String.fromCharCode(55296|u>>10,56320|u&1023)):n&1?e+=String.fromCharCode((u&31)<<6|r[t++]&63):e+=String.fromCharCode((u&15)<<12|(r[t++]&63)<<6|r[t++]&63):e+=String.fromCharCode(u)}};function Vo(r,e){if(e){for(var t="",u=0;u<r.length;u+=16384)t+=String.fromCharCode.apply(null,r.subarray(u,u+16384));return t}else{if(_u)return _u.decode(r);var n=qo(r),i=n[0],s=n[1];if(s.length)throw"invalid utf-8 data";return i}}var Jo=function(r,e){return e+30+Oe(r,e+26)+Oe(r,e+28)},Ko=function(r,e,t){var u=Oe(r,e+28),n=Vo(r.subarray(e+46,e+46+u),!(Oe(r,e+8)&2048)),i=e+46+u,s=xe(r,e+20),a=t&&s==4294967295?Xo(r,i):[s,xe(r,e+24),xe(r,e+42)],o=a[0],l=a[1],h=a[2];return[Oe(r,e+10),o,l,n,i+Oe(r,e+30)+Oe(r,e+32),h]},Xo=function(r,e){for(;Oe(r,e)!=1;e+=4+Oe(r,e+2));return[bu(r,e+12),bu(r,e+4),bu(r,e+20)]};function Qo(r,e){if(typeof e!="function")throw"no callback";for(var t=[],u=function(){for(var f=0;f<t.length;++f)t[f]()},n={},i=r.length-22;xe(r,i)!=101010256;--i)if(!i||r.length-i>65558){e("invalid zip file",null);return}var s=Oe(r,i+8);s||e(null,{});var a=s,o=xe(r,i+16),l=o==4294967295;if(l){if(i=xe(r,i-12),xe(r,i)!=101075792){e("invalid zip file",null);return}a=s=xe(r,i+32),o=xe(r,i+48)}for(var h=function(f){var C=Ko(r,o,l),A=C[0],p=C[1],d=C[2],D=C[3],F=C[4],m=C[5],b=Jo(r,m);o=F;var B=function(R,S){R?(u(),e(R,null)):(n[D]=S,--s||e(null,n))};if(!A)B(null,Fr(r,b,b+p));else if(A==8){var _=r.subarray(b,b+p);if(p<32e4)try{B(null,xu(_,new De(d)))}catch(R){B(R,null)}else t.push(Wo(_,{size:d},B))}else B("unknown compression type "+A,null)},c=0;c<a;++c)h();return u}const Su=L.dirname,Yo=L.join;L.extname;const Ci=L.basename;L.resolve,L.relative;async function ku(r,e,t=new Set,u=""){for await(const n of r.values()){const i=u.length===0?n.name:`${u}/${n.name}`;if(n.kind==="file"){if(n.name[0]===".")continue;await e(n,i,r)}else n.kind==="directory"&&!t.has(i)&&await ku(n,e,t,i)}}async function Zo(){return typeof(await(await navigator.storage.getDirectory()).getFileHandle("bridge-supports-writable-test",{create:!0})).createWritable=="function"}async function Ei(){var r;return typeof((r=navigator.storage)==null?void 0:r.getDirectory)!="function"||!await Zo()?new me(null,"bridgeFolder",void 0):await navigator.storage.getDirectory()}class yr extends rt{constructor(e){super(),e&&this.setup(e)}get baseDirectory(){return this._baseDirectory}setup(e){this._baseDirectory=e,this.hasFired||this.dispatch()}async getDirectoryHandle(e,{create:t,createOnce:u}={}){if(e===""||e===".")return this.baseDirectory;let n=this.baseDirectory;const i=e.split(/\\|\//g);i[0]==="."&&i.shift(),i[0]==="extensions"&&(i[0]="~local",i.splice(1,0,"extensions")),i[0]==="~local"&&(n=await Ei(),i.shift());for(const s of i){try{n=await n.getDirectoryHandle(s,{create:u||t})}catch{throw new Error(`Failed to access "${e}": Directory does not exist`)}u&&(u=!1,t=!1)}return n}async getFileHandle(e,t=!1){if(e.length===0)throw new Error("Error: filePath is empty");const u=await this.getDirectoryHandle(Su(e),{create:t});try{return await u.getFileHandle(Ci(e),{create:t})}catch{throw new Error(`File does not exist: "${e}"`)}}async pathTo(e){const t=await Ei();if(e instanceof ke&&!(t instanceof me))return;let u=await t.resolve(e).then(n=>n==null?void 0:n.join("/"));return u?u="~local/"+u:u=await this.baseDirectory.resolve(e).then(n=>n==null?void 0:n.join("/")),u}async mkdir(e,{recursive:t}={}){await this.getDirectoryHandle(e,{create:!0})}async readdir(e,{withFileTypes:t}={}){const u=await this.getDirectoryHandle(e),n=[];for await(const i of u.values())i.kind==="file"&&i.name===".DS_Store"||(t?n.push(i):n.push(i.name));return n}async readFilesFromDir(e,t=this.getDirectoryHandle(e)){t=await t;const u=[];for await(const n of t.values())n.kind==="file"&&n.name===".DS_Store"||(n.kind==="file"?u.push({name:n.name,kind:n.kind,path:`${e}/${n.name}`}):n.kind==="directory"&&u.push(...await this.readFilesFromDir(`${e}/${n.name}`,n)));return u}readFile(e){return this.getFileHandle(e).then(t=>t.getFile())}async unlink(e){if(e.length===0)throw new Error("Error: filePath is empty");const t=e.split(/\\|\//g),u=t.pop();let n;try{n=await this.getDirectoryHandle(t.join("/"))}catch{return}try{await n.removeEntry(u,{recursive:!0})}catch{}}async writeFile(e,t){const u=await this.getFileHandle(e,!0);return await this.write(u,t),u}async write(e,t){const u=await e.createWritable({keepExistingData:!1});await u.write(t),await u.close()}async readJSON(e){const t=await this.readFile(e);try{return await yu.parse(await t.text())}catch{throw new Error(`Invalid JSON: ${e}`)}}writeJSON(e,t,u=!1){return this.writeFile(e,JSON.stringify(t,null,u?"	":void 0))}async move(e,t){if(await this.fileExists(e))await this.copyFile(e,t);else if(await this.directoryExists(e))await this.copyFolder(e,t);else throw new Error(`File or folder does not exist: ${e}`);await this.unlink(e)}async copyFile(e,t){const u=await this.getFileHandle(e,!1),n=await this.getFileHandle(t,!0);return await this.copyFileHandle(u,n)}async copyFileHandle(e,t){return await this.write(t,await e.getFile()),t}async copyFolder(e,t){const u=await this.getDirectoryHandle(e,{create:!1});await ku(u,async(n,i)=>{await this.copyFileHandle(n,await this.getFileHandle(Yo(t,i),!0))})}async copyFolderByHandle(e,t){const u=new yr(t);await ku(e,async(n,i)=>{await this.copyFileHandle(n,await u.getFileHandle(i,!0))})}loadFileHandleAsDataUrl(e){return new Promise(async(t,u)=>{const n=new FileReader;try{const i=await e.getFile();n.addEventListener("load",()=>{t(n.result)}),n.addEventListener("error",u),n.readAsDataURL(i)}catch{u(`File does not exist: "${e.name}"`)}})}async fileExists(e){try{return await this.getFileHandle(e),!0}catch{return!1}}async directoryExists(e){try{return await this.getDirectoryHandle(e),!0}catch{return!1}}async getDirectoryHandlesFromGlob(e,t="."){const u=e.split(/\/|\\/g),n=new Set([await this.getDirectoryHandle(t)]);for(const i of u){if(i==="*")for(const s of[...n.values()]){n.delete(s);for await(const a of s.values())a.kind==="directory"&&n.add(a)}else{if(i==="**")return console.warn('"**" is not supported yet'),[];for(const s of[...n.values()]){n.delete(s);try{n.add(await s.getDirectoryHandle(i))}catch{}}}if(n.size===0)return[]}return[...n.values()]}}const gi=1093873;function el(r){return new Promise(async e=>{typeof requestIdleCallback=="function"?requestIdleCallback(async()=>{await r(),e()}):(await r(),e())})}class tl extends yr{constructor(e=!1){super(),this.isMainLoader=e}get virtualFileSystem(){if(!this._virtualFileSystem)throw new Error("DataLoader: virtualFileSystem is not initialized");return this._virtualFileSystem}async loadData(e=!1){if(this.hasFired){console.warn("This dataLoader instance already loaded data. You called loadData() twice.");return}let t=await Wr("savedAllDataInIdb");e&&(t=!1,await Gr("savedAllDataInIdb",!1)),this.isMainLoader&&console.log(t?"[APP] Data saved; restoring from cache...":"[APP] Data not saved; fetching now..."),console.time("[App] Data");const u=this.isMainLoader&&!t;if(this._virtualFileSystem=new me(new Pt("data-fs"),"bridgeFolder",t?void 0:new Map,u),await this._virtualFileSystem.setupDone.fired,t){this.setup(this._virtualFileSystem),console.timeEnd("[App] Data");return}const n=await fetch(Oo+"packages.zip").then(o=>o.arrayBuffer());if(n.byteLength!==gi)throw new Error(`Error: Data package was larger than the expected size of ${gi} bytes; got ${n.byteLength} bytes`);const i=await new Promise((o,l)=>Qo(new Uint8Array(n),async(h,c)=>{if(h)return l(h);o(c)})),a={".":await this._virtualFileSystem.getDirectoryHandle("data",{create:!0})};for(const o in i){const l=Ci(o),h=Su(o);if(o.endsWith("/")){const c=await a[h].getDirectoryHandle(l,{create:!0});a[o.slice(0,-1)]=c}else await a[h].getFileHandle(l,{create:!0,initialData:i[o]})}this.setup(this._virtualFileSystem),console.timeEnd("[App] Data"),this.isMainLoader&&!e&&el(async()=>{await this._virtualFileSystem.moveToIdb(),await Gr("savedAllDataInIdb",!0)})}}const rl={"!":"BANG","&":"AND","(":"LEFT_PARENT",")":"RIGHT_PARENT","*":"ASTERISK","+":"PLUS",",":"COMMA","-":"MINUS","/":"SLASH",":":"COLON",";":"SEMICOLON","<":"SMALLER","=":"EQUALS",">":"GREATER","?":"QUESTION","[":"ARRAY_LEFT","]":"ARRAY_RIGHT","{":"CURLY_LEFT","|":"OR","}":"CURLY_RIGHT"},Ai=new Set(["return","continue","break","for_each","loop","false","true"]);class qt{constructor(e,t,u,n){this.type=e,this.text=t,this.startColumn=u,this.startLine=n}getType(){return this.type}getText(){return this.text}getPosition(){return{startColumn:this.startColumn,startLineNumber:this.startLine,endColumn:this.startColumn+this.text.length,endLineNumber:this.startLine}}}class Fi{constructor(e){this.i=0,this.currentColumn=0,this.currentLine=0,this.lastColumns=0,this.keywordTokens=e?new Set([...Ai,...e]):Ai}init(e){this.currentLine=0,this.currentColumn=0,this.lastColumns=0,this.i=0,this.expression=e}next(){for(this.currentColumn=this.i-this.lastColumns;this.i<this.expression.length&&(this.expression[this.i]===" "||this.expression[this.i]==="	"||this.expression[this.i]===`
`);)this.expression[this.i]===`
`&&(this.currentLine++,this.currentColumn=0,this.lastColumns=this.i+1),this.i++;if(this.expression[this.i]==="#"){const t=this.expression.indexOf(`
`,this.i+1);return this.i=t===-1?this.expression.length:t,this.currentLine++,this.lastColumns=this.i+1,this.currentColumn=0,this.next()}let e=rl[this.expression[this.i]];if(e)return new qt(e,this.expression[this.i++],this.currentColumn,this.currentLine);if(this.isLetter(this.expression[this.i])||this.expression[this.i]==="_"){let t=this.i+1;for(;t<this.expression.length&&(this.isLetter(this.expression[t])||this.isNumber(this.expression[t])||this.expression[t]==="_"||this.expression[t]===".");)t++;const u=this.expression.substring(this.i,t).toLowerCase();return this.i=t,new qt(this.keywordTokens.has(u)?u.toUpperCase():"NAME",u,this.currentColumn,this.currentLine)}if(this.isNumber(this.expression[this.i])||this.expression[this.i]==="."){let t=this.i+1,u=this.expression[this.i]===".";for(;t<this.expression.length&&(this.isNumber(this.expression[t])||this.expression[t]==="."&&!u);)this.expression[t]==="."&&(u=!0),t++;const n=new qt("NUMBER",this.expression.substring(this.i,t),this.currentColumn,this.currentLine),i=u&&this.expression[t]==="f";return this.i=i?t+1:t,n}if(this.expression[this.i]==="'"){let t=this.i+1;for(;t<this.expression.length&&this.expression[t]!=="'";)t++;t++;const u=new qt("STRING",this.expression.substring(this.i,t),this.currentColumn,this.currentLine);return this.i=t,u}return this.hasNext()?(this.i++,this.next()):new qt("EOF","",this.currentColumn,this.currentLine)}hasNext(){return this.i<this.expression.length}isLetter(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumber(e){return e>="0"&&e<="9"}}const ul=(r,e,t)=>typeof r!="number"||Number.isNaN(r)?e:r>t?t:r<e?e:r,nl=(r,e,t)=>{let u=0;for(;0<r;)u+=mi(e,t);return u},il=(r,e,t)=>{let u=0;for(;0<r;)u+=yi(e,t);return u},sl=r=>3*r**2-2*r**3,al=(r,e,t)=>(t<0?t=0:t>1&&(t=1),r+(e-r)*t),ol=(r,e,t)=>{const u=n=>((n+180)%360+180)%360;if((r=u(r))>(e=u(e))){let n=r;r=e,e=n}return e-r>180?u(e+t*(360-(e-r))):r+t*(e-r)},ll=(r,e)=>r%e,mi=(r,e)=>r+Math.random()*(e-r),yi=(r,e)=>Math.round(r+Math.random()*(e-r)),cl=r=>((r=((r%=360)+360)%360)>179&&(r-=360),r),hl=r=>{const e=r?1:Math.PI/180;return{"math.abs":Math.abs,"math.acos":t=>Math.acos(t)/e,"math.asin":t=>Math.asin(t)/e,"math.atan":t=>Math.atan(t)/e,"math.atan2":(t,u)=>Math.atan2(t,u)/e,"math.ceil":Math.ceil,"math.clamp":ul,"math.cos":t=>Math.cos(t*e),"math.die_roll":nl,"math.die_roll_integer":il,"math.exp":Math.exp,"math.floor":Math.floor,"math.hermite_blend":sl,"math.lerp":al,"math.lerp_rotate":ol,"math.ln":Math.log,"math.max":Math.max,"math.min":Math.min,"math.min_angle":cl,"math.mod":ll,"math.pi":Math.PI,"math.pow":Math.pow,"math.random":mi,"math.random_integer":yi,"math.round":Math.round,"math.sin":t=>Math.sin(t*e),"math.sqrt":Math.sqrt,"math.trunc":Math.trunc}},fl={"query.in_range":(r,e,t)=>typeof r!="number"||typeof e!="number"||typeof t!="number"?(console.error('"query.in_range": value, min and max must be numbers'),!1):r>=e&&r<=t,"query.all":(r,...e)=>e.every(t=>t===r),"query.any":(r,...e)=>e.some(t=>t===r),"query.count":r=>Array.isArray(r)?r.length:1},wi=r=>({...hl(r),...fl});class Ru{constructor(e,t){var u;if(this.config=t,!e)throw new Error("Provided environment must be an object");this.env={...wi((u=t.useRadians)!=null?u:!1),"query.self":()=>this.env,...t.isFlat?e:this.flattenEnv(e)}}updateConfig({variableHandler:e,convertUndefined:t,useRadians:u}){t!==void 0&&(this.config.convertUndefined=t),typeof e=="function"&&(this.config.variableHandler=e),!!this.config.useRadians!=!!u&&(this.env=Object.assign(this.env,wi(!!u)))}get(){return this.env}flattenEnv(e,t="",u={}){for(let n in e){let i=n;if(n[1]===".")switch(n[0]){case"q":i="query"+n.substring(1,n.length);break;case"t":i="temp"+n.substring(1,n.length);break;case"v":i="variable"+n.substring(1,n.length);break;case"c":i="context"+n.substring(1,n.length);break;case"f":i="function"+n.substring(1,n.length)}e[n].__isContext?u[`${t}${i}`]=e[n].env:typeof e[n]!="object"||Array.isArray(e[n])?u[`${t}${i}`]=e[n]:this.flattenEnv(e[n],`${t}${n}.`,u)}return u}setAt(e,t){if(e[1]===".")switch(e[0]){case"q":e="query"+e.substring(1,e.length);break;case"t":e="temp"+e.substring(1,e.length);break;case"v":e="variable"+e.substring(1,e.length);break;case"c":e="context"+e.substring(1,e.length);break;case"f":e="function"+e.substring(1,e.length)}return this.env[e]=t}getFrom(e){var u,n,i;if(e[1]===".")switch(e[0]){case"q":e="query"+e.substring(1,e.length);break;case"t":e="temp"+e.substring(1,e.length);break;case"v":e="variable"+e.substring(1,e.length);break;case"c":e="context"+e.substring(1,e.length);break;case"f":e="function"+e.substring(1,e.length)}const t=(i=this.env[e])!=null?i:(n=(u=this.config).variableHandler)==null?void 0:n.call(u,e,this.env);return t===void 0&&this.config.convertUndefined?0:t}}class te{toString(){return""+this.eval()}walk(e,t=new Set){var n;let u=(n=e(this))!=null?n:this;return u.iterate(e,t),u}iterate(e,t){var u;for(let n=0;n<this.allExpressions.length;n++){const i=this.allExpressions[n];if(t.has(i))continue;t.add(i);const s=(u=e(i))!=null?u:i;s!==i&&t.has(s)||(t.add(s),this.setExpressionAt(n,s),s.iterate(e,t))}}some(e){return this.allExpressions.some(t=>e(t)||t.some(e))}}class Tt extends te{constructor(){super(...arguments),this.type="VoidExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!0}eval(){return 0}toString(){return""}}class ce extends te{constructor(e,t,u,n){super(),this.left=e,this.right=t,this.operator=u,this.evalHelper=n,this.type="GenericOperatorExpression"}get allExpressions(){return[this.left,this.right]}setExpressionAt(e,t){e===0?this.left=t:e===1&&(this.right=t)}isStatic(){return this.left.isStatic()&&this.right.isStatic()}eval(){return this.evalHelper(this.left,this.right)}toString(){return`${this.left.toString()}${this.operator}${this.right.toString()}`}}const Dl=(r,e)=>{const t=r.eval(),u=e.eval();if(typeof t!="number"&&typeof t!="boolean"||typeof u!="number"&&typeof u!="boolean")throw new Error(`Cannot use numeric operators for expression "${t} + ${u}"`);return t+u},dl=(r,e)=>{const t=r.eval(),u=e.eval();if(typeof t!="number"&&typeof t!="boolean"||typeof u!="number"&&typeof u!="boolean")throw new Error(`Cannot use numeric operators for expression "${t} - ${u}"`);return t-u},pl=(r,e)=>{const t=r.eval(),u=e.eval();if(typeof t!="number"&&typeof t!="boolean"||typeof u!="number"&&typeof u!="boolean")throw new Error(`Cannot use numeric operators for expression "${t} / ${u}"`);return t/u},Cl=(r,e)=>{const t=r.eval(),u=e.eval();if(typeof t!="number"&&typeof t!="boolean"||typeof u!="number"&&typeof u!="boolean")throw new Error(`Cannot use numeric operators for expression "${t} * ${u}"`);return t*u},El=(r,e)=>{if(r.setPointer)return r.setPointer(e.eval()),0;throw Error("Cannot assign to "+r.type)};class Vt{constructor(e=0){this.precedence=e}parse(e,t,u){const n=e.parseExpression(this.precedence),i=u.getText();switch(i){case"+":return new ce(t,n,i,Dl);case"-":return new ce(t,n,i,dl);case"*":return new ce(t,n,i,Cl);case"/":return new ce(t,n,i,pl);case"=":return new ce(t,n,"=",El);default:throw new Error("Operator not implemented")}}}var K;(function(r){r[r.SCOPE=1]="SCOPE",r[r.STATEMENT=2]="STATEMENT",r[r.ASSIGNMENT=3]="ASSIGNMENT",r[r.CONDITIONAL=4]="CONDITIONAL",r[r.ARRAY_ACCESS=5]="ARRAY_ACCESS",r[r.NULLISH_COALESCING=6]="NULLISH_COALESCING",r[r.AND=7]="AND",r[r.OR=8]="OR",r[r.EQUALS_COMPARE=9]="EQUALS_COMPARE",r[r.COMPARE=10]="COMPARE",r[r.SUM=11]="SUM",r[r.PRODUCT=12]="PRODUCT",r[r.EXPONENT=13]="EXPONENT",r[r.PREFIX=14]="PREFIX",r[r.POSTFIX=15]="POSTFIX",r[r.FUNCTION=16]="FUNCTION"})(K||(K={}));class vi extends te{constructor(e,t){super(),this.tokenType=e,this.expression=t,this.type="PrefixExpression"}get allExpressions(){return[this.expression]}setExpressionAt(e,t){this.expression=t}isStatic(){return this.expression.isStatic()}eval(){const e=this.expression.eval();if(typeof e!="number")throw new Error(`Cannot use "${this.tokenType}" operator in front of ${typeof e} "${e}"`);switch(this.tokenType){case"MINUS":return-e;case"BANG":return!e}}toString(){switch(this.tokenType){case"MINUS":return"-"+this.expression.toString();case"BANG":return"!"+this.expression.toString()}throw new Error(`Unknown prefix operator: "${this.tokenType}"`)}}class Bi{constructor(e=0){this.precedence=e}parse(e,t){return new vi(t.getType(),e.parseExpression(this.precedence))}}class $u extends te{constructor(e){super(),this.value=e,this.type="NumberExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!0}eval(){return this.value}toString(){const e=""+this.value;return e.startsWith("0.")?e.slice(1):e}}class gl{constructor(e=0){this.precedence=e}parse(e,t){return new $u(Number(t.getText()))}}class Jt extends te{constructor(e,t,u=!1){super(),this.executionEnv=e,this.name=t,this.isFunctionCall=u,this.type="NameExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!1}setPointer(e){this.executionEnv.setAt(this.name,e)}setFunctionCall(e=!0){this.isFunctionCall=e}setName(e){this.name=e}setExecutionEnv(e){this.executionEnv=e}eval(){const e=this.executionEnv.getFrom(this.name);return this.isFunctionCall||typeof e!="function"?e:e()}toString(){return this.name}}class Al extends te{constructor(e,t){super(),this.leftExpr=e,this.rightExpr=t,this.type="NameExpression"}get allExpressions(){return[this.leftExpr,this.rightExpr]}setExpressionAt(e,t){if(!(t instanceof Jt))throw new Error('Cannot use context switch operator "->" on '+t.type);e===0?this.leftExpr=t:e===1&&(this.rightExpr=t)}isStatic(){return!1}eval(){const e=this.leftExpr.eval();return typeof e!="object"?0:(this.rightExpr.setExecutionEnv(new Ru(e,this.rightExpr.executionEnv.config)),this.rightExpr.eval())}toString(){return`${this.leftExpr.toString()}->${this.rightExpr.toString()}`}}class Fl{constructor(e=0){this.precedence=e}parse(e,t){const u=new Jt(e.executionEnv,t.getText()),n=[e.lookAhead(0),e.lookAhead(1)];if(n[0].getType()==="MINUS"&&n[1].getType()==="GREATER"){e.consume("MINUS"),e.consume("GREATER");const i=e.parseExpression(K.FUNCTION-1);if(i.type!=="NameExpression"&&i.type!=="FunctionExpression")throw new Error('Cannot use context switch operator "->" on '+i.type);return new Al(u,i)}return u}}class Ue extends te{constructor(e,t){super(),this.expression=e,this.brackets=t,this.type="GroupExpression"}get allExpressions(){return[this.expression]}setExpressionAt(e,t){this.expression=t}isStatic(){return this.expression.isStatic()}get isReturn(){return this.expression.isReturn}get isBreak(){return this.expression.isBreak}get isContinue(){return this.expression.isContinue}eval(){return this.expression.eval()}toString(){return`${this.brackets[0]}${this.expression.toString()}${this.brackets[1]}`}}class ml{constructor(e=0){this.precedence=e}parse(e,t){const u=e.parseExpression(this.precedence);return e.consume("RIGHT_PARENT"),e.config.keepGroups?new Ue(u,"()"):u}}class ht extends te{constructor(e){super(),this.expression=e,this.type="ReturnExpression",this.isReturn=!0}get allExpressions(){return[this.expression]}setExpressionAt(e,t){this.expression=t}isStatic(){return!1}eval(){return this.expression.eval()}toString(){return"return "+this.expression.toString()}}class yl{constructor(e=0){this.precedence=e}parse(e,t){const u=e.parseExpression(K.STATEMENT+1);return new ht(e.match("SEMICOLON",!1)?u:new $u(0))}}class ft extends te{constructor(e,t=!1){super(),this.value=e,this.isReturn=t,this.type="StaticExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!0}eval(){return this.value}toString(){let e=this.value;return typeof e=="string"&&(e=`'${e}'`),this.isReturn?"return "+e:""+e}}class Be extends te{constructor(e){super(),this.expressions=e,this.type="StatementExpression",this.didReturn=void 0,this.wasLoopBroken=!1,this.wasLoopContinued=!1}get allExpressions(){return this.expressions}setExpressionAt(e,t){this.expressions[e]=t}get isReturn(){if(this.didReturn!==void 0)return this.didReturn;let e=0;for(;e<this.expressions.length;){const t=this.expressions[e];if(t.isBreak||t.isContinue)return!1;if(t.isReturn)return this.didReturn=!0,!0;e++}return this.didReturn=!1,!1}get isBreak(){return!!this.wasLoopBroken&&(this.wasLoopBroken=!1,!0)}get isContinue(){return!!this.wasLoopContinued&&(this.wasLoopContinued=!1,!0)}isStatic(){let e=0;for(;e<this.expressions.length;){if(!this.expressions[e].isStatic())return!1;e++}return!0}eval(){this.didReturn=!1,this.wasLoopBroken=!1,this.wasLoopContinued=!1;let e=0;for(;e<this.expressions.length;){let t=this.expressions[e].eval();if(this.expressions[e].isReturn)return this.didReturn=!0,t;if(this.expressions[e].isContinue)return void(this.wasLoopContinued=!0);if(this.expressions[e].isBreak)return void(this.wasLoopBroken=!0);e++}return 0}toString(){let e="";for(const t of this.expressions){if(t instanceof Tt||t instanceof ft&&!t.isReturn)continue;const u=t.toString();u&&(e+=u+";")}return e}}class wl{constructor(e=0){this.precedence=e}findReEntryPoint(e){let t=1,u=e.lookAhead(0).getType();for(;u!=="EOF"&&(u=="CURLY_RIGHT"?t--:u==="CURLY_LEFT"&&t++,t!==0);)e.consume(),u=e.lookAhead(0).getType()}parse(e,t,u){if(e.config.useOptimizer&&(t.isStatic()&&(t=new ft(t.eval(),t.isReturn)),e.config.earlyReturnsSkipParsing&&t.isReturn))return e.config.earlyReturnsSkipTokenization||this.findReEntryPoint(e),new Be([t]);const n=[t];if(!e.match("CURLY_RIGHT",!1))do{let i=e.parseExpression(this.precedence);if(e.config.useOptimizer){if(i.isStatic()){if(e.config.useAgressiveStaticOptimizer&&!i.isReturn)continue;i=new ft(i.eval(),i.isReturn)}if(e.config.earlyReturnsSkipParsing&&(i.isBreak||i.isContinue||i.isReturn))return n.push(i),e.config.earlyReturnsSkipTokenization||this.findReEntryPoint(e),new Be(n)}n.push(i)}while(e.match("SEMICOLON")&&!e.match("EOF")&&!e.match("CURLY_RIGHT",!1));return e.match("SEMICOLON"),new Be(n)}}class wr extends te{constructor(e){super(),this.name=e,this.type="StringExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!0}eval(){return this.name.substring(1,this.name.length-1)}toString(){return this.name}}class vl{constructor(e=0){this.precedence=e}parse(e,t){return new wr(t.getText())}}class bi extends te{constructor(e,t){super(),this.name=e,this.args=t,this.type="FunctionExpression"}get allExpressions(){return[this.name,...this.args]}setExpressionAt(e,t){e===0?this.name=t:e>0&&(this.args[e-1]=t)}setExecutionEnv(e){this.name.setExecutionEnv(e)}get executionEnv(){return this.name.executionEnv}isStatic(){return!1}eval(){const e=[];let t=0;for(;t<this.args.length;)e.push(this.args[t++].eval());const u=this.name.eval();if(typeof u!="function")throw new Error(this.name.toString()+" is not callable!");return u(...e)}toString(){let e=this.name.toString()+"(";for(let t=0;t<this.args.length;t++)e+=`${this.args[t].toString()}${t+1<this.args.length?",":""}`;return e+")"}}class Bl{constructor(e=0){this.precedence=e}parse(e,t,u){const n=[];if(!t.setFunctionCall)throw new Error(t.type+" is not callable!");if(t.setFunctionCall(!0),!e.match("RIGHT_PARENT")){do n.push(e.parseExpression());while(e.match("COMMA"));e.consume("RIGHT_PARENT")}return new bi(t,n)}}class xi extends te{constructor(e,t){super(),this.name=e,this.lookup=t,this.type="ArrayAccessExpression"}get allExpressions(){return[this.name,this.lookup]}setExpressionAt(e,t){e===0?this.name=t:e===1&&(this.lookup=t)}isStatic(){return!1}setPointer(e){this.name.eval()[this.lookup.eval()]=e}eval(){return this.name.eval()[this.lookup.eval()]}toString(){return`${this.name.toString()}[${this.lookup.toString()}]`}}class bl{constructor(e=0){this.precedence=e}parse(e,t,u){const n=e.parseExpression(this.precedence-1);if(!t.setPointer)throw new Error(`"${t.type}" is not an array`);if(!e.match("ARRAY_RIGHT"))throw new Error(`No closing bracket for opening bracket "[${n.eval()}"`);return new xi(t,n)}}class xl{constructor(e=0){this.precedence=e}parse(e,t){let u=e.parseExpression(this.precedence);return e.config.useOptimizer&&e.config.earlyReturnsSkipTokenization&&u.isReturn?e.match("CURLY_RIGHT"):e.consume("CURLY_RIGHT"),e.config.keepGroups?new Ue(u,"{}"):u}}class _i extends te{constructor(e,t){super(),this.count=e,this.expression=t,this.type="LoopExpression"}get allExpressions(){return[this.count,this.expression]}get isNoopLoop(){return this.count.isStatic()&&this.count.eval()===0}setExpressionAt(e,t){e===0?this.count=t:e===1&&(this.expression=t)}get isReturn(){return!this.isNoopLoop&&this.expression.isReturn}isStatic(){return this.count.isStatic()&&this.expression.isStatic()}eval(){const e=Number(this.count.eval());if(e===0)return 0;if(Number.isNaN(e))throw new Error(`First loop() argument must be of type number, received "${typeof this.count.eval()}"`);if(e>1024)throw new Error(`Cannot loop more than 1024x times, received "${e}"`);let t=0;for(;t<e;){t++;const u=this.expression.eval();if(this.expression.isBreak)break;if(!this.expression.isContinue&&this.expression.isReturn)return u}return 0}toString(){return this.isNoopLoop?"":`loop(${this.count.toString()},${this.expression.toString()})`}}class _l{constructor(e=0){this.precedence=e}parse(e,t){e.consume("LEFT_PARENT");const u=[];if(e.match("RIGHT_PARENT"))throw new Error("loop() called without arguments");do u.push(e.parseExpression());while(e.match("COMMA"));if(e.consume("RIGHT_PARENT"),u.length!==2)throw new Error("There must be exactly two loop() arguments; found "+u.length);return new _i(u[0],u[1])}}class Si extends te{constructor(e,t,u){if(super(),this.variable=e,this.arrayExpression=t,this.expression=u,this.type="ForEachExpression",!this.variable.setPointer)throw new Error(`First for_each() argument must be a variable, received "${typeof this.variable.eval()}"`)}get isReturn(){return this.expression.isReturn}get allExpressions(){return[this.variable,this.arrayExpression,this.expression]}setExpressionAt(e,t){e===0?this.variable=t:e===1?this.arrayExpression=t:e===2&&(this.expression=t)}isStatic(){return this.variable.isStatic()&&this.arrayExpression.isStatic()&&this.expression.isStatic()}eval(){var u,n;const e=this.arrayExpression.eval();if(!Array.isArray(e))throw new Error(`Second for_each() argument must be an array, received "${typeof e}"`);let t=0;for(;t<e.length;){(n=(u=this.variable).setPointer)==null||n.call(u,e[t++]);const i=this.expression.eval();if(this.expression.isBreak)break;if(!this.expression.isContinue&&this.expression.isReturn)return i}return 0}toString(){return`for_each(${this.variable.toString()},${this.arrayExpression.toString()},${this.expression.toString()})`}}class Sl{constructor(e=0){this.precedence=e}parse(e,t){e.consume("LEFT_PARENT");const u=[];if(e.match("RIGHT_PARENT"))throw new Error("for_each() called without arguments");do u.push(e.parseExpression());while(e.match("COMMA"));if(e.consume("RIGHT_PARENT"),u.length!==3)throw new Error("There must be exactly three for_each() arguments; found "+u.length);return new Si(u[0],u[1],u[2])}}class ki extends te{constructor(){super(),this.type="ContinueExpression",this.isContinue=!0}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!1}eval(){return 0}toString(){return"continue"}}class kl{constructor(e=0){this.precedence=e}parse(e,t){return new ki}}class Ri extends te{constructor(){super(),this.type="BreakExpression",this.isBreak=!0}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!1}eval(){return 0}isString(){return"break"}}class Rl{constructor(e=0){this.precedence=e}parse(e,t){return new Ri}}class $i extends te{constructor(e){super(),this.value=e,this.type="BooleanExpression"}get allExpressions(){return[]}setExpressionAt(){}isStatic(){return!0}eval(){return this.value}}class Ti{constructor(e=0){this.precedence=e}parse(e,t){return new $i(t.getText()==="true")}}class $l{constructor(e=0){this.precedence=e}parse(e,t,u){return new ce(t,e.parseExpression(this.precedence),"==",(n,i)=>n.eval()===i.eval())}}class Tl{constructor(e=0){this.precedence=e}parse(e,t,u){if(e.match("EQUALS"))return new ce(t,e.parseExpression(this.precedence),"!=",(n,i)=>n.eval()!==i.eval());throw new Error("! was used as a binary operator")}}class Ol{constructor(e=0){this.precedence=e}parse(e,t,u){if(e.match("AND"))return new ce(t,e.parseExpression(this.precedence),"&&",(n,i)=>n.eval()&&i.eval());throw new Error('"&" not followed by another "&"')}}class Pl{constructor(e=0){this.precedence=e}parse(e,t,u){if(e.match("OR"))return new ce(t,e.parseExpression(this.precedence),"||",(n,i)=>n.eval()||i.eval());throw new Error('"|" not followed by another "|"')}}class Nl{constructor(e=0){this.precedence=e}parse(e,t,u){return e.match("EQUALS")?new ce(t,e.parseExpression(this.precedence),"<=",(n,i)=>n.eval()<=i.eval()):new ce(t,e.parseExpression(this.precedence),"<",(n,i)=>n.eval()<i.eval())}}class Il{constructor(e=0){this.precedence=e}parse(e,t,u){return e.match("EQUALS")?new ce(t,e.parseExpression(this.precedence),">=",(n,i)=>n.eval()>=i.eval()):new ce(t,e.parseExpression(this.precedence),">",(n,i)=>n.eval()>i.eval())}}class Tu extends te{constructor(e,t,u){super(),this.leftExpression=e,this.thenExpression=t,this.elseExpression=u,this.type="TernaryExpression"}get allExpressions(){return this.leftExpression.isStatic()?[this.leftExpression,this.leftExpression.eval()?this.thenExpression:this.elseExpression]:[this.leftExpression,this.thenExpression,this.elseExpression]}setExpressionAt(e,t){e===0?this.leftExpression=t:e===1?this.thenExpression=t:e===2&&(this.elseExpression=t)}get isReturn(){return this.leftResult===void 0?this.thenExpression.isReturn&&this.elseExpression.isReturn:this.leftResult?this.thenExpression.isReturn:this.elseExpression.isReturn}get hasReturn(){return this.thenExpression.isReturn||this.elseExpression.isReturn}get isContinue(){return this.leftResult===void 0?this.thenExpression.isContinue&&this.elseExpression.isContinue:this.leftResult?this.thenExpression.isContinue:this.elseExpression.isContinue}get isBreak(){return this.leftResult===void 0?this.thenExpression.isBreak&&this.elseExpression.isBreak:this.leftResult?this.thenExpression.isBreak:this.elseExpression.isBreak}isStatic(){return this.leftExpression.isStatic()&&this.thenExpression.isStatic()&&this.elseExpression.isStatic()}eval(){return this.leftResult=this.leftExpression.eval(),this.leftResult?this.thenExpression.eval():this.elseExpression.eval()}toString(){return this.elseExpression instanceof Tt?`${this.leftExpression.toString()}?${this.thenExpression.toString()}`:`${this.leftExpression.toString()}?${this.thenExpression.toString()}:${this.elseExpression.toString()}`}}const Ll=new class{constructor(r=0){this.precedence=r,this.exprName="Ternary"}parse(r,e,t){let u,n=r.parseExpression(this.precedence-1);return u=r.match("COLON")?r.parseExpression(this.precedence-1):new Tt,r.config.useOptimizer&&e.isStatic()?e.eval()?n:u:new Tu(e,n,u)}}(K.CONDITIONAL);class Hl{constructor(e=0){this.precedence=e}parse(e,t,u){return e.match("QUESTION")?new ce(t,e.parseExpression(this.precedence),"??",(n,i)=>{var s;return(s=n.eval())!=null?s:i.eval()}):Ll.parse(e,t,u)}}class Oi extends class{constructor(e){this.config=e,this.prefixParselets=new Map,this.infixParselets=new Map,this.readTokens=[],this.tokenIterator=new Fi}updateConfig(e){this.config=e}init(e){this.tokenIterator.init(e),this.readTokens=[]}setTokenizer(e){this.tokenIterator=e}setExecutionEnvironment(e){this.executionEnv=e}parseExpression(e=0){let t=this.consume();if(t.getType()==="EOF")return new Tt;const u=this.prefixParselets.get(t.getType());if(!u)throw new Error(`Cannot parse ${t.getType()} expression "${t.getType()}"`);let n=u.parse(this,t);return this.parseInfixExpression(n,e)}parseInfixExpression(e,t=0){let u;for(;this.getPrecedence()>t;){u=this.consume();let n=u.getType();n!=="EQUALS"||this.match("EQUALS")||(n="ASSIGN");const i=this.infixParselets.get(n);if(!i)throw new Error(`Unknown infix parselet: "${n}"`);e=i.parse(this,e,u)}return e}getPrecedence(){var t;const e=this.infixParselets.get(this.lookAhead(0).getType());return(t=e==null?void 0:e.precedence)!=null?t:0}consume(e){const t=this.lookAhead(0);if(e&&t.getType()!==e)throw new Error(`Expected token "${e}" and found "${t.getType()}"`);return this.readTokens.shift(),t}match(e,t=!0){return this.lookAhead(0).getType()===e&&(t&&this.consume(),!0)}lookAhead(e){for(;e>=this.readTokens.length;)this.readTokens.push(this.tokenIterator.next());return this.readTokens[e]}registerInfix(e,t){this.infixParselets.set(e,t)}registerPrefix(e,t){this.prefixParselets.set(e,t)}getInfix(e){return this.infixParselets.get(e)}getPrefix(e){return this.prefixParselets.get(e)}}{constructor(e){super(e),this.registerPrefix("NAME",new Fl),this.registerPrefix("STRING",new vl),this.registerPrefix("NUMBER",new gl),this.registerPrefix("TRUE",new Ti(K.PREFIX)),this.registerPrefix("FALSE",new Ti(K.PREFIX)),this.registerPrefix("RETURN",new yl),this.registerPrefix("CONTINUE",new kl),this.registerPrefix("BREAK",new Rl),this.registerPrefix("LOOP",new _l),this.registerPrefix("FOR_EACH",new Sl),this.registerInfix("QUESTION",new Hl(K.CONDITIONAL)),this.registerPrefix("LEFT_PARENT",new ml),this.registerInfix("LEFT_PARENT",new Bl(K.FUNCTION)),this.registerInfix("ARRAY_LEFT",new bl(K.ARRAY_ACCESS)),this.registerPrefix("CURLY_LEFT",new xl(K.SCOPE)),this.registerInfix("SEMICOLON",new wl(K.STATEMENT)),this.registerPrefix("MINUS",new Bi(K.PREFIX)),this.registerPrefix("BANG",new Bi(K.PREFIX)),this.registerInfix("PLUS",new Vt(K.SUM)),this.registerInfix("MINUS",new Vt(K.SUM)),this.registerInfix("ASTERISK",new Vt(K.PRODUCT)),this.registerInfix("SLASH",new Vt(K.PRODUCT)),this.registerInfix("EQUALS",new $l(K.EQUALS_COMPARE)),this.registerInfix("BANG",new Tl(K.EQUALS_COMPARE)),this.registerInfix("GREATER",new Il(K.COMPARE)),this.registerInfix("SMALLER",new Nl(K.COMPARE)),this.registerInfix("AND",new Ol(K.AND)),this.registerInfix("OR",new Pl(K.OR)),this.registerInfix("ASSIGN",new Vt(K.ASSIGNMENT))}}class Ml{constructor(e=0){this.precedence=e}parse(e,t){if(e.consume("LEFT_PARENT"),e.match("RIGHT_PARENT"))throw new Error("function() called without arguments");let u,n,i=[];do{const s=e.parseExpression();if(s instanceof wr)n?i.push(s.eval()):n=s.eval();else{if(!(s instanceof Be||s instanceof Ue))throw new Error(`Unexpected expresion: found "${s.constructor.name}"`);u=s}}while(e.match("COMMA"));if(e.consume("RIGHT_PARENT"),!n)throw new Error(`Missing function() name (argument 1); found "${n}"`);if(!u)throw new Error(`Missing function() body (argument ${i.length+2})`);if(e.lookAhead(0).getType()!=="SEMICOLON")throw new Error("Missing semicolon after function expression");return new jl(e.functions,n,i,u)}}class jl extends te{constructor(e,t,u,n){super(),this.functionBody=n,this.type="CustomFunctionExpression",e.set(t.toLowerCase(),[u,n instanceof Ue?n.allExpressions[0].toString():n.toString()])}get allExpressions(){return[this.functionBody]}setExpressionAt(e,t){this.functionBody=t}get isReturn(){return!1}isStatic(){return!0}eval(){return 0}}class Ou{constructor(e={},t={}){this.config=t,this.expressionCache={},this.totalCacheEntries=0,t.useOptimizer===void 0&&(this.config.useOptimizer=!0),t.useCache===void 0&&(this.config.useCache=!0),t.earlyReturnsSkipParsing===void 0&&(this.config.earlyReturnsSkipParsing=!0),t.earlyReturnsSkipTokenization===void 0&&(this.config.earlyReturnsSkipTokenization=!0),t.convertUndefined===void 0&&(this.config.convertUndefined=!1),this.parser=new Oi({...this.config,tokenizer:void 0}),this.updateExecutionEnv(e,t.assumeFlatEnvironment)}updateConfig(e){(e=Object.assign(this.config,e)).tokenizer&&this.parser.setTokenizer(e.tokenizer),this.parser.updateConfig({...this.config,tokenizer:void 0}),this.executionEnvironment.updateConfig(e)}updateExecutionEnv(e,t=!1){this.executionEnvironment=new Ru(e,{useRadians:this.config.useRadians,convertUndefined:this.config.convertUndefined,isFlat:t,variableHandler:this.config.variableHandler}),this.parser.setExecutionEnvironment(this.executionEnvironment)}clearCache(){this.expressionCache={},this.totalCacheEntries=0}execute(e){this.parser.setExecutionEnvironment(this.executionEnvironment);const t=this.parse(e).eval();return t===void 0?0:typeof t=="boolean"?Number(t):t}executeAndCatch(e){try{return this.execute(e)}catch{return 0}}parse(e){var u,n,i;if((u=this.config.useCache)==null||u){const s=this.expressionCache[e];if(s)return s}this.parser.init(e);let t=this.parser.parseExpression();return((n=this.config.useOptimizer)!=null?n:1)&&t.isStatic()&&(t=new ft(t.eval())),((i=this.config.useCache)==null||i)&&(this.totalCacheEntries>(this.config.maxCacheSize||256)&&this.clearCache(),this.expressionCache[e]=t,this.totalCacheEntries++),t}resolveStatic(e){return e=(e=e.walk(t=>{if(!(t instanceof wr))return t.isStatic()?new ft(t.eval()):void 0})).walk(t=>{if(t instanceof ce)switch(t.operator){case"+":case"-":{const u=t.allExpressions.find(n=>n.isStatic()&&n.eval()===0);if(u)return t.allExpressions.find(n=>n!==u);break}case"*":if(t.allExpressions.find(u=>u.isStatic()&&u.eval()===0))return new ft(0);case"*":case"/":{const u=t.allExpressions.find(n=>n.isStatic()&&n.eval()===1);if(u)return t.allExpressions.find(n=>n!==u);break}}})}getParser(){return this.parser}}class Ul extends Oi{constructor(e){super(e),this.functions=new Map,this.classes=new Map,this.registerPrefix("FUNCTION",new Ml)}reset(){this.functions.clear()}}class zl{constructor(e){this.parser=new Ul({useCache:!1,useOptimizer:!0,useAgressiveStaticOptimizer:!0,keepGroups:!0,earlyReturnsSkipParsing:!1,earlyReturnsSkipTokenization:!1}),this.parser.setExecutionEnvironment(new Ru(this.parser,e)),this.parser.setTokenizer(new Fi(new Set(["function"])))}get functions(){return this.parser.functions}parse(e){return this.parser.init(e.replace(/\"/g,"'")),this.parser.parseExpression()}transform(e){const t=new Ou({},{useCache:!1,keepGroups:!0,useOptimizer:!0,useAgressiveStaticOptimizer:!0,earlyReturnsSkipParsing:!0,earlyReturnsSkipTokenization:!1});let u=0,n=t.parse(e),i=!1;n instanceof Be&&(i=!0);let s=!1;n=n.walk(o=>{var p;if(o.type!=="FunctionExpression")return;const l=o.name.name.replace(/(f|function)\./g,""),h=o.args;let[c,f]=(p=this.functions.get(l))!=null?p:[];if(!f||!c)return;f=f.replace(/(a|arg)\.(\w+)/g,(d,D,F)=>{var m,b;return((b=(m=h[c.indexOf(F)])==null?void 0:m.toString())!=null?b:"0").replace(/(t|temp)\./,"outer_temp.")});let C=function(d){if(d instanceof ht)return new Ue(d.allExpressions[0],"()");if(!(d instanceof Be)||d.allExpressions.length>1)return d;const D=d.allExpressions[0];return D instanceof ht?new Ue(D.allExpressions[0],"()"):d}(t.parse(f));if(C instanceof Be){const d=C.allExpressions.some(F=>F instanceof ht),D=d||C.some(F=>F instanceof ht);C=t.parse(`({${f}}+${D?d?"t.return_value":"(t.return_value??0)":"0"})`),s=!0}const A=new Map;return C=C.walk(d=>{if(d instanceof Jt){let D=d.toString().split(".");const F=D.shift(),[m,...b]=D,B=b.length>0?"."+b.join("."):"";if(F==="t"||F==="temp"){let _=A.get(m);_||(_="t.__scvar"+u++,A.set(m,_)),d.setName(`${_}${B}`)}else F==="outer_temp"&&d.setName(`t.${m}${B}`)}else{if(d instanceof ht){const D=new Jt(t.getParser().executionEnv,"t.return_value"),F=d.allExpressions[0];return new ce(D,F,"=",()=>{D.setPointer(F.eval())})}if(d instanceof Be){const D=[];for(let F=0;F<d.allExpressions.length;F++){const m=d.allExpressions[F];if(m instanceof Tu&&m.hasReturn){Wl(m,d.allExpressions.slice(F+1)),D.push(m);break}if(m.isReturn){D.push(m);break}D.push(m)}return new Be(D)}}}),C});const a=t.parse(n.toString());return t.resolveStatic(a),!i&&s?`return ${a.toString()};`:a.toString()}reset(){this.functions.clear()}}function Wl(r,e){if(r.isReturn)return;const t=r.allExpressions[2].isReturn?1:2,u=r.allExpressions[t];u instanceof Tt||(u instanceof Ue&&u.allExpressions[0]instanceof Be?e.unshift(...u.allExpressions):e.unshift(u)),e.length>0&&r.setExpressionAt(t,new Ue(new Be(e),"{}"))}var Pi=Object.freeze({__proto__:null,ArrayAccessExpression:xi,BooleanExpression:$i,BreakExpression:Ri,ContinueExpression:ki,ForEachExpression:Si,FunctionExpression:bi,GenericOperatorExpression:ce,GroupExpression:Ue,LoopExpression:_i,NameExpression:Jt,NumberExpression:$u,PostfixExpression:class extends te{constructor(r,e){super(),this.expression=r,this.tokenType=e,this.type="PostfixExpression"}get allExpressions(){return[this.expression]}setExpressionAt(r,e){this.expression=e}isStatic(){return this.expression.isStatic()}eval(){this.tokenType}},PrefixExpression:vi,ReturnExpression:ht,StatementExpression:Be,StaticExpression:ft,StringExpression:wr,TernaryExpression:Tu,VoidExpression:Tt});let G,Ni=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Ni.decode();let vr=null;function Br(){return(vr===null||vr.buffer!==G.memory.buffer)&&(vr=new Uint8Array(G.memory.buffer)),vr}function br(r,e){return Ni.decode(Br().subarray(r,r+e))}const ze=new Array(32).fill(void 0);ze.push(void 0,null,!0,!1);let Kt=ze.length;function Ye(r){Kt===ze.length&&ze.push(ze.length+1);const e=Kt;return Kt=ze[e],ze[e]=r,e}function Xt(r){return ze[r]}let Dt=0,xr=new TextEncoder("utf-8");const Gl=typeof xr.encodeInto=="function"?function(r,e){return xr.encodeInto(r,e)}:function(r,e){const t=xr.encode(r);return e.set(t),{read:r.length,written:t.length}};function Qt(r,e,t){if(t===void 0){const a=xr.encode(r),o=e(a.length);return Br().subarray(o,o+a.length).set(a),Dt=a.length,o}let u=r.length,n=e(u);const i=Br();let s=0;for(;s<u;s++){const a=r.charCodeAt(s);if(a>127)break;i[n+s]=a}if(s!==u){s!==0&&(r=r.slice(s)),n=t(n,u,u=s+r.length*3);const a=Br().subarray(n+s,n+u);s+=Gl(r,a).written}return Dt=s,n}let _r=null;function ye(){return(_r===null||_r.buffer!==G.memory.buffer)&&(_r=new Int32Array(G.memory.buffer)),_r}function ql(r){r<36||(ze[r]=Kt,Kt=r)}function dt(r){const e=Xt(r);return ql(r),e}function Vl(r,e){try{const a=G.__wbindgen_add_to_stack_pointer(-16);var t=Qt(r,G.__wbindgen_malloc,G.__wbindgen_realloc),u=Dt;G.minifySync(a,t,u,Ye(e));var n=ye()[a/4+0],i=ye()[a/4+1],s=ye()[a/4+2];if(s)throw dt(i);return dt(n)}finally{G.__wbindgen_add_to_stack_pointer(16)}}function Jl(r,e){try{const a=G.__wbindgen_add_to_stack_pointer(-16);var t=Qt(r,G.__wbindgen_malloc,G.__wbindgen_realloc),u=Dt;G.parseSync(a,t,u,Ye(e));var n=ye()[a/4+0],i=ye()[a/4+1],s=ye()[a/4+2];if(s)throw dt(i);return dt(n)}finally{G.__wbindgen_add_to_stack_pointer(16)}}function Ii(r,e,t){try{const o=G.__wbindgen_add_to_stack_pointer(-16);var u=Qt(r,G.__wbindgen_malloc,G.__wbindgen_realloc),n=Dt;G.transformSync(o,u,n,Ye(e),Ye(t));var i=ye()[o/4+0],s=ye()[o/4+1],a=ye()[o/4+2];if(a)throw dt(s);return dt(i)}finally{G.__wbindgen_add_to_stack_pointer(16)}}async function Kl(r,e){if(typeof Response=="function"&&r instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(r,e)}catch(u){if(r.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const t=await r.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(r,e);return t instanceof WebAssembly.Instance?{instance:t,module:r}:t}}async function Li(r){typeof r>"u"&&(r=new URL("/assets/wasm-web_bg.533586ee.wasm",self.location));const e={};e.wbg={},e.wbg.__wbindgen_json_parse=function(n,i){var s=JSON.parse(br(n,i));return Ye(s)},e.wbg.__wbindgen_json_serialize=function(n,i){const s=Xt(i);var a=JSON.stringify(s===void 0?null:s),o=Qt(a,G.__wbindgen_malloc,G.__wbindgen_realloc),l=Dt;ye()[n/4+1]=l,ye()[n/4+0]=o},e.wbg.__wbindgen_object_drop_ref=function(n){dt(n)},e.wbg.__wbindgen_string_new=function(n,i){var s=br(n,i);return Ye(s)},e.wbg.__wbg_new0_57a6a2c2aaed3fc5=function(){var n=new Date;return Ye(n)},e.wbg.__wbg_getTime_f8ce0ff902444efb=function(n){var i=Xt(n).getTime();return i},e.wbg.__wbg_getTimezoneOffset_41211a984662508b=function(n){var i=Xt(n).getTimezoneOffset();return i},e.wbg.__wbg_new_693216e109162396=function(){var n=new Error;return Ye(n)},e.wbg.__wbg_stack_0ddaca5d1abfb52f=function(n,i){var s=Xt(i).stack,a=Qt(s,G.__wbindgen_malloc,G.__wbindgen_realloc),o=Dt;ye()[n/4+1]=o,ye()[n/4+0]=a},e.wbg.__wbg_error_09919627ac0992f5=function(n,i){try{console.error(br(n,i))}finally{G.__wbindgen_free(n,i)}},e.wbg.__wbindgen_throw=function(n,i){throw new Error(br(n,i))},(typeof r=="string"||typeof Request=="function"&&r instanceof Request||typeof URL=="function"&&r instanceof URL)&&(r=fetch(r));const{instance:t,module:u}=await Kl(await r,e);return G=t.exports,Li.__wbindgen_wasm_module=u,G}var Xl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ql(r){for(var e=0,t=0,u=0,n=0,i="",s=0;s<r.length;s++){var a=r[s];if(s>0&&(i+=";"),a.length!==0){for(var o=0,l=[],h=0,c=a;h<c.length;h++){var f=c[h],C=Yt(f[0]-o);o=f[0],f.length>1&&(C+=Yt(f[1]-e)+Yt(f[2]-t)+Yt(f[3]-u),e=f[1],t=f[2],u=f[3]),f.length===5&&(C+=Yt(f[4]-n),n=f[4]),l.push(C)}i+=l.join(",")}}return i}function Yt(r){var e="";r=r<0?-r<<1|1:r<<1;do{var t=r&31;r>>>=5,r>0&&(t|=32),e+=Xl[t]}while(r>0);return e}class Sr{constructor(e){this.bits=e instanceof Sr?e.bits.slice():[]}add(e){this.bits[e>>5]|=1<<(e&31)}has(e){return!!(this.bits[e>>5]&1<<(e&31))}}class Zt{constructor(e,t,u){this.start=e,this.end=t,this.original=u,this.intro="",this.outro="",this.content=u,this.storeName=!1,this.edited=!1,Object.defineProperties(this,{previous:{writable:!0,value:null},next:{writable:!0,value:null}})}appendLeft(e){this.outro+=e}appendRight(e){this.intro=this.intro+e}clone(){const e=new Zt(this.start,this.end,this.original);return e.intro=this.intro,e.outro=this.outro,e.content=this.content,e.storeName=this.storeName,e.edited=this.edited,e}contains(e){return this.start<e&&e<this.end}eachNext(e){let t=this;for(;t;)e(t),t=t.next}eachPrevious(e){let t=this;for(;t;)e(t),t=t.previous}edit(e,t,u){return this.content=e,u||(this.intro="",this.outro=""),this.storeName=t,this.edited=!0,this}prependLeft(e){this.outro=e+this.outro}prependRight(e){this.intro=e+this.intro}split(e){const t=e-this.start,u=this.original.slice(0,t),n=this.original.slice(t);this.original=u;const i=new Zt(e,this.end,n);return i.outro=this.outro,this.outro="",this.end=e,this.edited?(i.edit("",!1),this.content=""):this.content=u,i.next=this.next,i.next&&(i.next.previous=i),i.previous=this,this.next=i,i}toString(){return this.intro+this.content+this.outro}trimEnd(e){if(this.outro=this.outro.replace(e,""),this.outro.length)return!0;const t=this.content.replace(e,"");if(t.length)return t!==this.content&&this.split(this.start+t.length).edit("",void 0,!0),!0;if(this.edit("",void 0,!0),this.intro=this.intro.replace(e,""),this.intro.length)return!0}trimStart(e){if(this.intro=this.intro.replace(e,""),this.intro.length)return!0;const t=this.content.replace(e,"");if(t.length)return t!==this.content&&(this.split(this.end-t.length),this.edit("",void 0,!0)),!0;if(this.edit("",void 0,!0),this.outro=this.outro.replace(e,""),this.outro.length)return!0}}let Pu=()=>{throw new Error("Unsupported environment: `window.btoa` or `Buffer` should be supported.")};typeof window<"u"&&typeof window.btoa=="function"?Pu=r=>window.btoa(unescape(encodeURIComponent(r))):typeof Buffer=="function"&&(Pu=r=>Buffer.from(r,"utf-8").toString("base64"));class Yl{constructor(e){this.version=3,this.file=e.file,this.sources=e.sources,this.sourcesContent=e.sourcesContent,this.names=e.names,this.mappings=Ql(e.mappings)}toString(){return JSON.stringify(this)}toUrl(){return"data:application/json;charset=utf-8;base64,"+Pu(this.toString())}}function Zl(r){const e=r.split(`
`),t=e.filter(i=>/^\t+/.test(i)),u=e.filter(i=>/^ {2,}/.test(i));if(t.length===0&&u.length===0)return null;if(t.length>=u.length)return"	";const n=u.reduce((i,s)=>{const a=/^ +/.exec(s)[0].length;return Math.min(a,i)},1/0);return new Array(n+1).join(" ")}function ec(r,e){const t=r.split(/[/\\]/),u=e.split(/[/\\]/);for(t.pop();t[0]===u[0];)t.shift(),u.shift();if(t.length){let n=t.length;for(;n--;)t[n]=".."}return t.concat(u).join("/")}const tc=Object.prototype.toString;function rc(r){return tc.call(r)==="[object Object]"}function Hi(r){const e=r.split(`
`),t=[];for(let u=0,n=0;u<e.length;u++)t.push(n),n+=e[u].length+1;return function(n){let i=0,s=t.length;for(;i<s;){const l=i+s>>1;n<t[l]?s=l:i=l+1}const a=i-1,o=n-t[a];return{line:a,column:o}}}class uc{constructor(e){this.hires=e,this.generatedCodeLine=0,this.generatedCodeColumn=0,this.raw=[],this.rawSegments=this.raw[this.generatedCodeLine]=[],this.pending=null}addEdit(e,t,u,n){if(t.length){const i=[this.generatedCodeColumn,e,u.line,u.column];n>=0&&i.push(n),this.rawSegments.push(i)}else this.pending&&this.rawSegments.push(this.pending);this.advance(t),this.pending=null}addUneditedChunk(e,t,u,n,i){let s=t.start,a=!0;for(;s<t.end;)(this.hires||a||i.has(s))&&this.rawSegments.push([this.generatedCodeColumn,e,n.line,n.column]),u[s]===`
`?(n.line+=1,n.column=0,this.generatedCodeLine+=1,this.raw[this.generatedCodeLine]=this.rawSegments=[],this.generatedCodeColumn=0,a=!0):(n.column+=1,this.generatedCodeColumn+=1,a=!1),s+=1;this.pending=null}advance(e){if(!e)return;const t=e.split(`
`);if(t.length>1){for(let u=0;u<t.length-1;u++)this.generatedCodeLine++,this.raw[this.generatedCodeLine]=this.rawSegments=[];this.generatedCodeColumn=0}this.generatedCodeColumn+=t[t.length-1].length}}const er=`
`,Ot={insertLeft:!1,insertRight:!1,storeName:!1};class Nu{constructor(e,t={}){const u=new Zt(0,e.length,e);Object.defineProperties(this,{original:{writable:!0,value:e},outro:{writable:!0,value:""},intro:{writable:!0,value:""},firstChunk:{writable:!0,value:u},lastChunk:{writable:!0,value:u},lastSearchedChunk:{writable:!0,value:u},byStart:{writable:!0,value:{}},byEnd:{writable:!0,value:{}},filename:{writable:!0,value:t.filename},indentExclusionRanges:{writable:!0,value:t.indentExclusionRanges},sourcemapLocations:{writable:!0,value:new Sr},storedNames:{writable:!0,value:{}},indentStr:{writable:!0,value:Zl(e)}}),this.byStart[0]=u,this.byEnd[e.length]=u}addSourcemapLocation(e){this.sourcemapLocations.add(e)}append(e){if(typeof e!="string")throw new TypeError("outro content must be a string");return this.outro+=e,this}appendLeft(e,t){if(typeof t!="string")throw new TypeError("inserted content must be a string");this._split(e);const u=this.byEnd[e];return u?u.appendLeft(t):this.intro+=t,this}appendRight(e,t){if(typeof t!="string")throw new TypeError("inserted content must be a string");this._split(e);const u=this.byStart[e];return u?u.appendRight(t):this.outro+=t,this}clone(){const e=new Nu(this.original,{filename:this.filename});let t=this.firstChunk,u=e.firstChunk=e.lastSearchedChunk=t.clone();for(;t;){e.byStart[u.start]=u,e.byEnd[u.end]=u;const n=t.next,i=n&&n.clone();i&&(u.next=i,i.previous=u,u=i),t=n}return e.lastChunk=u,this.indentExclusionRanges&&(e.indentExclusionRanges=this.indentExclusionRanges.slice()),e.sourcemapLocations=new Sr(this.sourcemapLocations),e.intro=this.intro,e.outro=this.outro,e}generateDecodedMap(e){e=e||{};const t=0,u=Object.keys(this.storedNames),n=new uc(e.hires),i=Hi(this.original);return this.intro&&n.advance(this.intro),this.firstChunk.eachNext(s=>{const a=i(s.start);s.intro.length&&n.advance(s.intro),s.edited?n.addEdit(t,s.content,a,s.storeName?u.indexOf(s.original):-1):n.addUneditedChunk(t,s,this.original,a,this.sourcemapLocations),s.outro.length&&n.advance(s.outro)}),{file:e.file?e.file.split(/[/\\]/).pop():null,sources:[e.source?ec(e.file||"",e.source):null],sourcesContent:e.includeContent?[this.original]:[null],names:u,mappings:n.raw}}generateMap(e){return new Yl(this.generateDecodedMap(e))}getIndentString(){return this.indentStr===null?"	":this.indentStr}indent(e,t){const u=/^[^\r\n]/gm;if(rc(e)&&(t=e,e=void 0),e=e!==void 0?e:this.indentStr||"	",e==="")return this;t=t||{};const n={};t.exclude&&(typeof t.exclude[0]=="number"?[t.exclude]:t.exclude).forEach(h=>{for(let c=h[0];c<h[1];c+=1)n[c]=!0});let i=t.indentStart!==!1;const s=l=>i?`${e}${l}`:(i=!0,l);this.intro=this.intro.replace(u,s);let a=0,o=this.firstChunk;for(;o;){const l=o.end;if(o.edited)n[a]||(o.content=o.content.replace(u,s),o.content.length&&(i=o.content[o.content.length-1]===`
`));else for(a=o.start;a<l;){if(!n[a]){const h=this.original[a];h===`
`?i=!0:h!=="\r"&&i&&(i=!1,a===o.start||(this._splitChunk(o,a),o=o.next),o.prependRight(e))}a+=1}a=o.end,o=o.next}return this.outro=this.outro.replace(u,s),this}insert(){throw new Error("magicString.insert(...) is deprecated. Use prependRight(...) or appendLeft(...)")}insertLeft(e,t){return Ot.insertLeft||(console.warn("magicString.insertLeft(...) is deprecated. Use magicString.appendLeft(...) instead"),Ot.insertLeft=!0),this.appendLeft(e,t)}insertRight(e,t){return Ot.insertRight||(console.warn("magicString.insertRight(...) is deprecated. Use magicString.prependRight(...) instead"),Ot.insertRight=!0),this.prependRight(e,t)}move(e,t,u){if(u>=e&&u<=t)throw new Error("Cannot move a selection inside itself");this._split(e),this._split(t),this._split(u);const n=this.byStart[e],i=this.byEnd[t],s=n.previous,a=i.next,o=this.byStart[u];if(!o&&i===this.lastChunk)return this;const l=o?o.previous:this.lastChunk;return s&&(s.next=a),a&&(a.previous=s),l&&(l.next=n),o&&(o.previous=i),n.previous||(this.firstChunk=i.next),i.next||(this.lastChunk=n.previous,this.lastChunk.next=null),n.previous=l,i.next=o||null,l||(this.firstChunk=n),o||(this.lastChunk=i),this}overwrite(e,t,u,n){if(typeof u!="string")throw new TypeError("replacement content must be a string");for(;e<0;)e+=this.original.length;for(;t<0;)t+=this.original.length;if(t>this.original.length)throw new Error("end is out of bounds");if(e===t)throw new Error("Cannot overwrite a zero-length range \u2013 use appendLeft or prependRight instead");this._split(e),this._split(t),n===!0&&(Ot.storeName||(console.warn("The final argument to magicString.overwrite(...) should be an options object. See https://github.com/rich-harris/magic-string"),Ot.storeName=!0),n={storeName:!0});const i=n!==void 0?n.storeName:!1,s=n!==void 0?n.contentOnly:!1;if(i){const l=this.original.slice(e,t);Object.defineProperty(this.storedNames,l,{writable:!0,value:!0,enumerable:!0})}const a=this.byStart[e],o=this.byEnd[t];if(a){let l=a;for(;l!==o;){if(l.next!==this.byStart[l.end])throw new Error("Cannot overwrite across a split point");l=l.next,l.edit("",!1)}a.edit(u,i,s)}else{const l=new Zt(e,t,"").edit(u,i);o.next=l,l.previous=o}return this}prepend(e){if(typeof e!="string")throw new TypeError("outro content must be a string");return this.intro=e+this.intro,this}prependLeft(e,t){if(typeof t!="string")throw new TypeError("inserted content must be a string");this._split(e);const u=this.byEnd[e];return u?u.prependLeft(t):this.intro=t+this.intro,this}prependRight(e,t){if(typeof t!="string")throw new TypeError("inserted content must be a string");this._split(e);const u=this.byStart[e];return u?u.prependRight(t):this.outro=t+this.outro,this}remove(e,t){for(;e<0;)e+=this.original.length;for(;t<0;)t+=this.original.length;if(e===t)return this;if(e<0||t>this.original.length)throw new Error("Character is out of bounds");if(e>t)throw new Error("end must be greater than start");this._split(e),this._split(t);let u=this.byStart[e];for(;u;)u.intro="",u.outro="",u.edit(""),u=t>u.end?this.byStart[u.end]:null;return this}lastChar(){if(this.outro.length)return this.outro[this.outro.length-1];let e=this.lastChunk;do{if(e.outro.length)return e.outro[e.outro.length-1];if(e.content.length)return e.content[e.content.length-1];if(e.intro.length)return e.intro[e.intro.length-1]}while(e=e.previous);return this.intro.length?this.intro[this.intro.length-1]:""}lastLine(){let e=this.outro.lastIndexOf(er);if(e!==-1)return this.outro.substr(e+1);let t=this.outro,u=this.lastChunk;do{if(u.outro.length>0){if(e=u.outro.lastIndexOf(er),e!==-1)return u.outro.substr(e+1)+t;t=u.outro+t}if(u.content.length>0){if(e=u.content.lastIndexOf(er),e!==-1)return u.content.substr(e+1)+t;t=u.content+t}if(u.intro.length>0){if(e=u.intro.lastIndexOf(er),e!==-1)return u.intro.substr(e+1)+t;t=u.intro+t}}while(u=u.previous);return e=this.intro.lastIndexOf(er),e!==-1?this.intro.substr(e+1)+t:this.intro+t}slice(e=0,t=this.original.length){for(;e<0;)e+=this.original.length;for(;t<0;)t+=this.original.length;let u="",n=this.firstChunk;for(;n&&(n.start>e||n.end<=e);){if(n.start<t&&n.end>=t)return u;n=n.next}if(n&&n.edited&&n.start!==e)throw new Error(`Cannot use replaced character ${e} as slice start anchor.`);const i=n;for(;n;){n.intro&&(i!==n||n.start===e)&&(u+=n.intro);const s=n.start<t&&n.end>=t;if(s&&n.edited&&n.end!==t)throw new Error(`Cannot use replaced character ${t} as slice end anchor.`);const a=i===n?e-n.start:0,o=s?n.content.length+t-n.end:n.content.length;if(u+=n.content.slice(a,o),n.outro&&(!s||n.end===t)&&(u+=n.outro),s)break;n=n.next}return u}snip(e,t){const u=this.clone();return u.remove(0,e),u.remove(t,u.original.length),u}_split(e){if(this.byStart[e]||this.byEnd[e])return;let t=this.lastSearchedChunk;const u=e>t.end;for(;t;){if(t.contains(e))return this._splitChunk(t,e);t=u?this.byStart[t.end]:this.byEnd[t.start]}}_splitChunk(e,t){if(e.edited&&e.content.length){const n=Hi(this.original)(t);throw new Error(`Cannot split a chunk that has already been edited (${n.line}:${n.column} \u2013 "${e.original}")`)}const u=e.split(t);return this.byEnd[t]=e,this.byStart[t]=u,this.byEnd[u.end]=u,e===this.lastChunk&&(this.lastChunk=u),this.lastSearchedChunk=e,!0}toString(){let e=this.intro,t=this.firstChunk;for(;t;)e+=t.toString(),t=t.next;return e+this.outro}isEmpty(){let e=this.firstChunk;do if(e.intro.length&&e.intro.trim()||e.content.length&&e.content.trim()||e.outro.length&&e.outro.trim())return!1;while(e=e.next);return!0}length(){let e=this.firstChunk,t=0;do t+=e.intro.length+e.content.length+e.outro.length;while(e=e.next);return t}trimLines(){return this.trim("[\\r\\n]")}trim(e){return this.trimStart(e).trimEnd(e)}trimEndAborted(e){const t=new RegExp((e||"\\s")+"+$");if(this.outro=this.outro.replace(t,""),this.outro.length)return!0;let u=this.lastChunk;do{const n=u.end,i=u.trimEnd(t);if(u.end!==n&&(this.lastChunk===u&&(this.lastChunk=u.next),this.byEnd[u.end]=u,this.byStart[u.next.start]=u.next,this.byEnd[u.next.end]=u.next),i)return!0;u=u.previous}while(u);return!1}trimEnd(e){return this.trimEndAborted(e),this}trimStartAborted(e){const t=new RegExp("^"+(e||"\\s")+"+");if(this.intro=this.intro.replace(t,""),this.intro.length)return!0;let u=this.firstChunk;do{const n=u.end,i=u.trimStart(t);if(u.end!==n&&(u===this.lastChunk&&(this.lastChunk=u.next),this.byEnd[u.end]=u,this.byStart[u.next.start]=u.next,this.byEnd[u.next.end]=u.next),i)return!0;u=u.next}while(u);return!1}trimStart(e){return this.trimStartAborted(e),this}hasChanged(){return this.original!==this.toString()}replace(e,t){function u(i,s){return typeof t=="string"?t.replace(/\$(\$|&|\d+)/g,(a,o)=>o==="$"?"$":o==="&"?i[0]:+o<i.length?i[+o]:`$${o}`):t(...i,i.index,s,i.groups)}function n(i,s){let a;const o=[];for(;a=i.exec(s);)o.push(a);return o}if(typeof e!="string"&&e.global)n(e,this.original).forEach(s=>{s.index!=null&&this.overwrite(s.index,s.index+s[0].length,u(s,this.original))});else{const i=this.original.match(e);i&&i.index!=null&&this.overwrite(i.index,i.index+i[0].length,u(i,this.original))}return this}}function nc(r,e,t=0){const u=new Nu(r),n=(a,o,l)=>u.overwrite(a-t,o-t,l),i=(a,o)=>u.slice(a-t,o-t);let s="";return e.forEach(a=>{if(a.type==="ExportDefaultDeclaration")n(a.span.start,a.span.end,`
___module.__default__ = ${i(a.decl.span.start,a.decl.span.end)};`);else if(a.type==="ExportDefaultExpression")n(a.span.start,a.span.end,`
___module.__default__ = ${i(a.expression.span.start,a.expression.span.end)};`);else if(a.type==="ExportDeclaration")n(a.span.start,a.span.end,i(a.declaration.span.start,a.declaration.span.end)),a.declaration.type==="ClassDeclaration"||a.declaration.type==="FunctionDeclaration"?s+=`
___module.${a.declaration.identifier.value} = ${a.declaration.identifier.value};`:a.declaration.type==="VariableDeclaration"&&a.declaration.declarations.forEach(o=>{s+=`
___module.${o.id.value} = ${o.id.value};`});else if(a.type==="ExportNamedDeclaration"){let o="";for(const{orig:l,exported:h}of a.specifiers)h.value==="default"?o+=`
___module.__default__ = ${l.value};`:o+=`
___module.${h.value} = ${l.value};`;n(a.span.start,a.span.end,o)}else if(a.type==="ImportDeclaration")if(a.specifiers.length===1&&a.specifiers[0].type==="ImportNamespaceSpecifier")n(a.span.start,a.span.end,`
const ${a.specifiers[0].local.value} = await ___require(${a.source.raw});`);else{const o=[];a.specifiers.forEach(h=>{h.type==="ImportDefaultSpecifier"?o.push(`__default__: ${h.local.value}`):h.type==="ImportSpecifier"&&(h.imported||(h.imported=h.local),o.push(`${h.imported.value}: ${h.local.value}`))});const l=o.length===0?`
await ___require(${a.source.raw});`:`
const {${o.join(", ")}} = await ___require(${a.source.raw});`;n(a.span.start,a.span.end,l)}}),u.toString()+s}class ic{constructor(e){if(this.evaluatedModules=new Map,this.baseModules=new Map,this.env={},e)for(const[t,u]of e)this.registerModule(t,u)}async run(e,t={},u){return this.env=t,await this.eval(e,u)}clearCache(){this.evaluatedModules.clear()}registerModule(e,t){this.baseModules.set(e,t)}async eval(e,t){const u=this.evaluatedModules.get(e);if(u)return u;const n=L.dirname(e),i=e.endsWith(".js")?"ecmascript":"typescript";if(t||(t=await this.readFile(e).catch(()=>{})),!t)throw new Error(`File "${e}" not found`);if(kr===null)throw new Error("You must call initRuntimes() before using the runtime");await kr;let s=Vl(Ii(t,{filename:L.basename(e),jsc:{parser:{syntax:i,preserveAllComments:!1,topLevelAwait:!0},target:"es2020"}}).code,{compress:!1,mangle:!1,format:{beautify:!0}}).code;const{type:a,body:o}=Jl(s,{syntax:i,target:"es2022"}),l=o[0].span.start,h=nc(s,o,l),c={};try{await this.runSrc(h,Object.assign({},this.env,{___module:c,___require:f=>this.require(f,n)}))}catch(f){throw new Error(`Error in ${e}: ${f}`)}return this.evaluatedModules.set(e,c),c}async require(e,t){const u=this.baseModules.get(e);if(u)return typeof u=="function"?await u():u;if(e.startsWith("https://")){const s=await(await fetch(e)).text();return await this.eval(e,s)}if(e.startsWith(".")&&(e=L.join(t,e)),e.endsWith(".json")){const i=await this.readFile(e).catch(()=>{});if(i){let s={};try{s=yu.parse(i)}catch{throw new Error(`File "${e}" contains invalid JSON`)}return{__default__:s,...s}}}const n=[".ts",".js"];for(const i of n){const s=`${e}${i}`;let a=await this.readFile(s).catch(()=>{});if(!!a)return await this.eval(s,a)}throw new Error(`Module "${e}" not found`)}async runSrc(e,t){return new Function(...Object.keys(t),`return (async () => {
${e}
})()`)(...Object.values(t))}}let kr=null;function sc(r){kr=Li(r).then(()=>null)}/*!
 * is-extglob <https://github.com/jonschlinkert/is-extglob>
 *
 * Copyright (c) 2014-2016, Jon Schlinkert.
 * Licensed under the MIT License.
 */var ac=function(e){if(typeof e!="string"||e==="")return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1};/*!
 * is-glob <https://github.com/jonschlinkert/is-glob>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var oc=ac,Mi={"{":"}","(":")","[":"]"},lc=function(r){if(r[0]==="!")return!0;for(var e=0,t=-2,u=-2,n=-2,i=-2,s=-2;e<r.length;){if(r[e]==="*"||r[e+1]==="?"&&/[\].+)]/.test(r[e])||u!==-1&&r[e]==="["&&r[e+1]!=="]"&&(u<e&&(u=r.indexOf("]",e)),u>e&&(s===-1||s>u||(s=r.indexOf("\\",e),s===-1||s>u)))||n!==-1&&r[e]==="{"&&r[e+1]!=="}"&&(n=r.indexOf("}",e),n>e&&(s=r.indexOf("\\",e),s===-1||s>n))||i!==-1&&r[e]==="("&&r[e+1]==="?"&&/[:!=]/.test(r[e+2])&&r[e+3]!==")"&&(i=r.indexOf(")",e),i>e&&(s=r.indexOf("\\",e),s===-1||s>i))||t!==-1&&r[e]==="("&&r[e+1]!=="|"&&(t<e&&(t=r.indexOf("|",e)),t!==-1&&r[t+1]!==")"&&(i=r.indexOf(")",t),i>t&&(s=r.indexOf("\\",t),s===-1||s>i))))return!0;if(r[e]==="\\"){var a=r[e+1];e+=2;var o=Mi[a];if(o){var l=r.indexOf(o,e);l!==-1&&(e=l+1)}if(r[e]==="!")return!0}else e++}return!1},cc=function(r){if(r[0]==="!")return!0;for(var e=0;e<r.length;){if(/[*?{}()[\]]/.test(r[e]))return!0;if(r[e]==="\\"){var t=r[e+1];e+=2;var u=Mi[t];if(u){var n=r.indexOf(u,e);n!==-1&&(e=n+1)}if(r[e]==="!")return!0}else e++}return!1},hc=function(e,t){if(typeof e!="string"||e==="")return!1;if(oc(e))return!0;var u=lc;return t&&t.strict===!1&&(u=cc),u(e)};class fc extends ko{constructor(e,t){super(L.dirname(t)),this.fileSystem=e,this.configPath=t}readConfig(){return this.fileSystem.readJson(this.configPath)}writeConfig(e){return this.fileSystem.writeJson(this.configPath,e)}}class ji{constructor(e,t,u){this.dash=e,this.pluginId=t,this.plugin=u}async runBuildStartHook(){var e,t;try{return await((t=(e=this.plugin).buildStart)==null?void 0:t.call(e))}catch(u){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "buildStart" hook:`,u)}}async runIncludeHook(){var e,t;try{return await((t=(e=this.plugin).include)==null?void 0:t.call(e))}catch(u){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "include" hook:`,u)}}async runTransformPathHook(e){var t,u;try{return await((u=(t=this.plugin).transformPath)==null?void 0:u.call(t,e))}catch(n){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "transformPath" hook for "${e}":`,n)}}async runReadHook(e,t){var u,n;try{return await((n=(u=this.plugin).read)==null?void 0:n.call(u,e,t))}catch(i){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "read" hook for "${e}":`,i)}}async runLoadHook(e,t){var u,n;try{return await((n=(u=this.plugin).load)==null?void 0:n.call(u,e,t))}catch(i){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "load" hook for "${e}":`,i)}}async runRegisterAliasesHook(e,t){var u,n;try{return await((n=(u=this.plugin).registerAliases)==null?void 0:n.call(u,e,t))}catch(i){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "registerAliases" hook for "${e}":`,i)}}async runRequireHook(e,t){var u,n;try{return await((n=(u=this.plugin).require)==null?void 0:n.call(u,e,t))}catch(i){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "require" hook for "${e}":`,i)}}async runTransformHook(e,t,u){var n,i;try{return await((i=(n=this.plugin).transform)==null?void 0:i.call(n,e,t,u))}catch(s){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "transform" hook for "${e}":`,s)}}async runFinalizeBuildHook(e,t){var u,n;try{return await((n=(u=this.plugin).finalizeBuild)==null?void 0:n.call(u,e,t))}catch(i){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "finalizeBuild" hook for "${e}":`,i)}}async runBuildEndHook(){var e,t;try{return await((t=(e=this.plugin).buildEnd)==null?void 0:t.call(e))}catch(u){this.dash.console.error(`The plugin "${this.pluginId}" threw an error while running the "buildEnd" hook:`,u)}}}const Dc=({options:r,outputFileSystem:e,hasComMojangDirectory:t,projectConfig:u,projectRoot:n,packType:i})=>{var s;r.buildName||(r.buildName=r.mode==="development"?"dev":"dist"),r.packName||(r.packName="Bridge"),(s=r.rewriteToComMojang)==null||s||(t=!1);const a={behaviorPack:"development_behavior_packs",resourcePack:"development_resource_packs",skinPack:"skin_packs",worldTemplate:"minecraftWorlds"},o=h=>t&&r.mode==="development"?`${a[h]}`:`${n}/builds/${r.buildName}`,l=(h,c)=>`${o(h)}/${r.packName} ${c}`;return{async buildStart(){if(r.mode==="production"||r.buildType==="fullBuild")if(t)for(const h in a){const c=i.getFromId(h);!c||await e.unlink(l(h,c.defaultPackPath)).catch(()=>{})}else await e.unlink(o("BP")).catch(()=>{})},transformPath(h){if(!h||h.includes("BP/scripts/gametests/")&&r.mode==="production")return;const c=i==null?void 0:i.get(h);if(!c)return;const f=u.getAbsolutePackRoot(c.id),C=L.relative(f,h);if(["behaviorPack","resourcePack","skinPack","worldTemplate"].includes(c.id))return L.join(l(c.id,c.defaultPackPath),C)}}};var dc=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,pc=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,Cc=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Iu={Space_Separator:dc,ID_Start:pc,ID_Continue:Cc},re={isSpaceSeparator(r){return typeof r=="string"&&Iu.Space_Separator.test(r)},isIdStartChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="$"||r==="_"||Iu.ID_Start.test(r))},isIdContinueChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r>="0"&&r<="9"||r==="$"||r==="_"||r==="\u200C"||r==="\u200D"||Iu.ID_Continue.test(r))},isDigit(r){return typeof r=="string"&&/[0-9]/.test(r)},isHexDigit(r){return typeof r=="string"&&/[0-9A-Fa-f]/.test(r)}};let Lu,Ce,We,Rr,Ze,_e,oe,Hu,tr;var Ec=function(e,t){Lu=String(e),Ce="start",We=[],Rr=0,Ze=1,_e=0,oe=void 0,Hu=void 0,tr=void 0;do oe=gc(),mc[Ce]();while(oe.type!=="eof");return typeof t=="function"?Ui({"":tr},"",t):tr};function Ui(r,e,t){const u=r[e];if(u!=null&&typeof u=="object")for(const n in u){const i=Ui(u,n,t);i===void 0?delete u[n]:u[n]=i}return t.call(r,e,u)}let P,T,rr,Ge,M;function gc(){for(P="default",T="",rr=!1,Ge=1;;){M=qe();const r=zi[P]();if(r)return r}}function qe(){if(Lu[Rr])return String.fromCodePoint(Lu.codePointAt(Rr))}function w(){const r=qe();return r===`
`?(Ze++,_e=0):r?_e+=r.length:_e++,r&&(Rr+=r.length),r}const zi={default(){switch(M){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":w();return;case"/":w(),P="comment";return;case void 0:return w(),X("eof")}if(re.isSpaceSeparator(M)){w();return}return zi[Ce]()},comment(){switch(M){case"*":w(),P="multiLineComment";return;case"/":w(),P="singleLineComment";return}throw Q(w())},multiLineComment(){switch(M){case"*":w(),P="multiLineCommentAsterisk";return;case void 0:throw Q(w())}w()},multiLineCommentAsterisk(){switch(M){case"*":w();return;case"/":w(),P="default";return;case void 0:throw Q(w())}w(),P="multiLineComment"},singleLineComment(){switch(M){case`
`:case"\r":case"\u2028":case"\u2029":w(),P="default";return;case void 0:return w(),X("eof")}w()},value(){switch(M){case"{":case"[":return X("punctuator",w());case"n":return w(),pt("ull"),X("null",null);case"t":return w(),pt("rue"),X("boolean",!0);case"f":return w(),pt("alse"),X("boolean",!1);case"-":case"+":w()==="-"&&(Ge=-1),P="sign";return;case".":T=w(),P="decimalPointLeading";return;case"0":T=w(),P="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":T=w(),P="decimalInteger";return;case"I":return w(),pt("nfinity"),X("numeric",1/0);case"N":return w(),pt("aN"),X("numeric",NaN);case'"':case"'":rr=w()==='"',T="",P="string";return}throw Q(w())},identifierNameStartEscape(){if(M!=="u")throw Q(w());w();const r=Mu();switch(r){case"$":case"_":break;default:if(!re.isIdStartChar(r))throw Wi();break}T+=r,P="identifierName"},identifierName(){switch(M){case"$":case"_":case"\u200C":case"\u200D":T+=w();return;case"\\":w(),P="identifierNameEscape";return}if(re.isIdContinueChar(M)){T+=w();return}return X("identifier",T)},identifierNameEscape(){if(M!=="u")throw Q(w());w();const r=Mu();switch(r){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!re.isIdContinueChar(r))throw Wi();break}T+=r,P="identifierName"},sign(){switch(M){case".":T=w(),P="decimalPointLeading";return;case"0":T=w(),P="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":T=w(),P="decimalInteger";return;case"I":return w(),pt("nfinity"),X("numeric",Ge*(1/0));case"N":return w(),pt("aN"),X("numeric",NaN)}throw Q(w())},zero(){switch(M){case".":T+=w(),P="decimalPoint";return;case"e":case"E":T+=w(),P="decimalExponent";return;case"x":case"X":T+=w(),P="hexadecimal";return}return X("numeric",Ge*0)},decimalInteger(){switch(M){case".":T+=w(),P="decimalPoint";return;case"e":case"E":T+=w(),P="decimalExponent";return}if(re.isDigit(M)){T+=w();return}return X("numeric",Ge*Number(T))},decimalPointLeading(){if(re.isDigit(M)){T+=w(),P="decimalFraction";return}throw Q(w())},decimalPoint(){switch(M){case"e":case"E":T+=w(),P="decimalExponent";return}if(re.isDigit(M)){T+=w(),P="decimalFraction";return}return X("numeric",Ge*Number(T))},decimalFraction(){switch(M){case"e":case"E":T+=w(),P="decimalExponent";return}if(re.isDigit(M)){T+=w();return}return X("numeric",Ge*Number(T))},decimalExponent(){switch(M){case"+":case"-":T+=w(),P="decimalExponentSign";return}if(re.isDigit(M)){T+=w(),P="decimalExponentInteger";return}throw Q(w())},decimalExponentSign(){if(re.isDigit(M)){T+=w(),P="decimalExponentInteger";return}throw Q(w())},decimalExponentInteger(){if(re.isDigit(M)){T+=w();return}return X("numeric",Ge*Number(T))},hexadecimal(){if(re.isHexDigit(M)){T+=w(),P="hexadecimalInteger";return}throw Q(w())},hexadecimalInteger(){if(re.isHexDigit(M)){T+=w();return}return X("numeric",Ge*Number(T))},string(){switch(M){case"\\":w(),T+=Ac();return;case'"':if(rr)return w(),X("string",T);T+=w();return;case"'":if(!rr)return w(),X("string",T);T+=w();return;case`
`:case"\r":throw Q(w());case"\u2028":case"\u2029":yc(M);break;case void 0:throw Q(w())}T+=w()},start(){switch(M){case"{":case"[":return X("punctuator",w())}P="value"},beforePropertyName(){switch(M){case"$":case"_":T=w(),P="identifierName";return;case"\\":w(),P="identifierNameStartEscape";return;case"}":return X("punctuator",w());case'"':case"'":rr=w()==='"',P="string";return}if(re.isIdStartChar(M)){T+=w(),P="identifierName";return}throw Q(w())},afterPropertyName(){if(M===":")return X("punctuator",w());throw Q(w())},beforePropertyValue(){P="value"},afterPropertyValue(){switch(M){case",":case"}":return X("punctuator",w())}throw Q(w())},beforeArrayValue(){if(M==="]")return X("punctuator",w());P="value"},afterArrayValue(){switch(M){case",":case"]":return X("punctuator",w())}throw Q(w())},end(){throw Q(w())}};function X(r,e){return{type:r,value:e,line:Ze,column:_e}}function pt(r){for(const e of r){if(qe()!==e)throw Q(w());w()}}function Ac(){switch(qe()){case"b":return w(),"\b";case"f":return w(),"\f";case"n":return w(),`
`;case"r":return w(),"\r";case"t":return w(),"	";case"v":return w(),"\v";case"0":if(w(),re.isDigit(qe()))throw Q(w());return"\0";case"x":return w(),Fc();case"u":return w(),Mu();case`
`:case"\u2028":case"\u2029":return w(),"";case"\r":return w(),qe()===`
`&&w(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw Q(w());case void 0:throw Q(w())}return w()}function Fc(){let r="",e=qe();if(!re.isHexDigit(e)||(r+=w(),e=qe(),!re.isHexDigit(e)))throw Q(w());return r+=w(),String.fromCodePoint(parseInt(r,16))}function Mu(){let r="",e=4;for(;e-- >0;){const t=qe();if(!re.isHexDigit(t))throw Q(w());r+=w()}return String.fromCodePoint(parseInt(r,16))}const mc={start(){if(oe.type==="eof")throw Ct();ju()},beforePropertyName(){switch(oe.type){case"identifier":case"string":Hu=oe.value,Ce="afterPropertyName";return;case"punctuator":$r();return;case"eof":throw Ct()}},afterPropertyName(){if(oe.type==="eof")throw Ct();Ce="beforePropertyValue"},beforePropertyValue(){if(oe.type==="eof")throw Ct();ju()},beforeArrayValue(){if(oe.type==="eof")throw Ct();if(oe.type==="punctuator"&&oe.value==="]"){$r();return}ju()},afterPropertyValue(){if(oe.type==="eof")throw Ct();switch(oe.value){case",":Ce="beforePropertyName";return;case"}":$r()}},afterArrayValue(){if(oe.type==="eof")throw Ct();switch(oe.value){case",":Ce="beforeArrayValue";return;case"]":$r()}},end(){}};function ju(){let r;switch(oe.type){case"punctuator":switch(oe.value){case"{":r={};break;case"[":r=[];break}break;case"null":case"boolean":case"numeric":case"string":r=oe.value;break}if(tr===void 0)tr=r;else{const e=We[We.length-1];Array.isArray(e)?e.push(r):e[Hu]=r}if(r!==null&&typeof r=="object")We.push(r),Array.isArray(r)?Ce="beforeArrayValue":Ce="beforePropertyName";else{const e=We[We.length-1];e==null?Ce="end":Array.isArray(e)?Ce="afterArrayValue":Ce="afterPropertyValue"}}function $r(){We.pop();const r=We[We.length-1];r==null?Ce="end":Array.isArray(r)?Ce="afterArrayValue":Ce="afterPropertyValue"}function Q(r){return Tr(r===void 0?`JSON5: invalid end of input at ${Ze}:${_e}`:`JSON5: invalid character '${Gi(r)}' at ${Ze}:${_e}`)}function Ct(){return Tr(`JSON5: invalid end of input at ${Ze}:${_e}`)}function Wi(){return _e-=5,Tr(`JSON5: invalid identifier character at ${Ze}:${_e}`)}function yc(r){console.warn(`JSON5: '${Gi(r)}' in strings is not valid ECMAScript; consider escaping`)}function Gi(r){const e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(e[r])return e[r];if(r<" "){const t=r.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return r}function Tr(r){const e=new SyntaxError(r);return e.lineNumber=Ze,e.columnNumber=_e,e}var wc=function(e,t,u){const n=[];let i="",s,a,o="",l;if(t!=null&&typeof t=="object"&&!Array.isArray(t)&&(u=t.space,l=t.quote,t=t.replacer),typeof t=="function")a=t;else if(Array.isArray(t)){s=[];for(const p of t){let d;typeof p=="string"?d=p:(typeof p=="number"||p instanceof String||p instanceof Number)&&(d=String(p)),d!==void 0&&s.indexOf(d)<0&&s.push(d)}}return u instanceof Number?u=Number(u):u instanceof String&&(u=String(u)),typeof u=="number"?u>0&&(u=Math.min(10,Math.floor(u)),o="          ".substr(0,u)):typeof u=="string"&&(o=u.substr(0,10)),h("",{"":e});function h(p,d){let D=d[p];switch(D!=null&&(typeof D.toJSON5=="function"?D=D.toJSON5(p):typeof D.toJSON=="function"&&(D=D.toJSON(p))),a&&(D=a.call(d,p,D)),D instanceof Number?D=Number(D):D instanceof String?D=String(D):D instanceof Boolean&&(D=D.valueOf()),D){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof D=="string")return c(D);if(typeof D=="number")return String(D);if(typeof D=="object")return Array.isArray(D)?A(D):f(D)}function c(p){const d={"'":.1,'"':.2},D={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let F="";for(let b=0;b<p.length;b++){const B=p[b];switch(B){case"'":case'"':d[B]++,F+=B;continue;case"\0":if(re.isDigit(p[b+1])){F+="\\x00";continue}}if(D[B]){F+=D[B];continue}if(B<" "){let _=B.charCodeAt(0).toString(16);F+="\\x"+("00"+_).substring(_.length);continue}F+=B}const m=l||Object.keys(d).reduce((b,B)=>d[b]<d[B]?b:B);return F=F.replace(new RegExp(m,"g"),D[m]),m+F+m}function f(p){if(n.indexOf(p)>=0)throw TypeError("Converting circular structure to JSON5");n.push(p);let d=i;i=i+o;let D=s||Object.keys(p),F=[];for(const b of D){const B=h(b,p);if(B!==void 0){let _=C(b)+":";o!==""&&(_+=" "),_+=B,F.push(_)}}let m;if(F.length===0)m="{}";else{let b;if(o==="")b=F.join(","),m="{"+b+"}";else{let B=`,
`+i;b=F.join(B),m=`{
`+i+b+`,
`+d+"}"}}return n.pop(),i=d,m}function C(p){if(p.length===0)return c(p);const d=String.fromCodePoint(p.codePointAt(0));if(!re.isIdStartChar(d))return c(p);for(let D=d.length;D<p.length;D++)if(!re.isIdContinueChar(String.fromCodePoint(p.codePointAt(D))))return c(p);return p}function A(p){if(n.indexOf(p)>=0)throw TypeError("Converting circular structure to JSON5");n.push(p);let d=i;i=i+o;let D=[];for(let m=0;m<p.length;m++){const b=h(String(m),p);D.push(b!==void 0?b:"null")}let F;if(D.length===0)F="[]";else if(o===""){let m=D.join(",");F="["+m+"]"}else{let m=`,
`+i,b=D.join(m);F=`[
`+i+b+`,
`+d+"]"}return n.pop(),i=d,F}},ur={parse:Ec,stringify:wc};const vc=({fileType:r,projectConfig:e,requestJsonData:t,options:u,console:n,jsRuntime:i})=>{const s=(f,C)=>e.resolvePackPath(f,C),a=new zl({}),o=f=>f==null?void 0:f.endsWith(".molang"),l=f=>f==null?void 0:f.startsWith(e.resolvePackPath("behaviorPack","scripts/molang/")),h=f=>{var C;return(C=Object.entries(u.include).find(([A])=>(r==null?void 0:r.getId(f))===A))==null?void 0:C[1]};let c=[];return{async buildStart(){u.include=Object.assign(await t("data/packages/minecraftBedrock/location/validMoLang.json"),u.include)},transformPath(f){if(o(f)||l(f))return null},async read(f,C){if((o(f)||l(f))&&C){const A=await C.getFile();return await(A==null?void 0:A.text())}else if(h(f)&&f.endsWith(".json")&&C){const A=await C.getFile();if(!A)return;try{return ur.parse(await A.text())}catch(p){return u.buildType!=="fileRequest"&&n.error(`Error within file "${f}": ${p}`),{__error__:`Failed to load original file: ${p}`}}}},async load(f,C){if(o(f)&&C)a.parse(C);else if(l(f)){const A=await i.run(f,{console:n},C).catch(p=>(n.error(`Failed to execute Molang AST script "${f}": ${p}`),null));if(!A)return null;typeof A.__default__=="function"&&c.push(A.__default__)}},async require(f){if(h(f))return[s("behaviorPack","scripts/molang/**/*.[jt]s"),s("behaviorPack","molang/**/*.molang"),s("resourcePack","molang/**/*.molang")]},async transform(f,C){const A=h(f);A&&A.length>0&&A.forEach(p=>Kn(p,C,d=>{if(typeof d!="string"||d[0]==="/"||d[0]==="@")return d;if(c.length>0){let D=null;try{D=a.parse(d)}catch(F){u.buildType!=="fileRequest"&&n.error(`Error within file "${f}"; script "${d}": ${F}`)}if(D){for(const F of c)D=D.walk(F);d=D.toString()}}try{return a.transform(d)}catch(D){return u.buildType!=="fileRequest"&&n.error(`Error within file "${f}"; script "${d}": ${D}`),d}}))},finalizeBuild(f,C){if(h(f)&&typeof C!="string")return JSON.stringify(C,null,"	")},buildEnd(){c=[]}}},Bc=({fileType:r})=>({registerAliases(e,t){var u,n,i,s;if((r==null?void 0:r.getId(e))==="entity"&&((n=(u=t==null?void 0:t["minecraft:entity"])==null?void 0:u.description)==null?void 0:n.identifier))return[(s=(i=t==null?void 0:t["minecraft:entity"])==null?void 0:i.description)==null?void 0:s.identifier]}});function bc(r,e){const t=qi(r),u=qi(e),n=t.pop(),i=u.pop(),s=Ki(t,u);return s!==0?s:n&&i?Ki(n.split("."),i.split(".")):n||i?n?-1:1:0}const xc=(r,e,t)=>{Rc(t);const u=bc(r,e);return Xi[t].includes(u)},_c=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,qi=r=>{if(typeof r!="string")throw new TypeError("Invalid argument expected string");const e=r.match(_c);if(!e)throw new Error(`Invalid argument not valid semver ('${r}' received)`);return e.shift(),e},Vi=r=>r==="*"||r==="x"||r==="X",Ji=r=>{const e=parseInt(r,10);return isNaN(e)?r:e},Sc=(r,e)=>typeof r!=typeof e?[String(r),String(e)]:[r,e],kc=(r,e)=>{if(Vi(r)||Vi(e))return 0;const[t,u]=Sc(Ji(r),Ji(e));return t>u?1:t<u?-1:0},Ki=(r,e)=>{for(let t=0;t<Math.max(r.length,e.length);t++){const u=kc(r[t]||0,e[t]||0);if(u!==0)return u}return 0},Xi={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Qi=Object.keys(Xi),Rc=r=>{if(typeof r!="string")throw new TypeError(`Invalid operator type, expected string but got ${typeof r}`);if(Qi.indexOf(r)===-1)throw new Error(`Invalid operator, expected one of ${Qi.join("|")}`)},$c=(r,e)=>({register:t=>{var u;((u=t.type)!=null?u:"entity")===e&&(r.component=({name:n,schema:i,template:s})=>{const a=new t;n(t.component_name),i(Uu(Object.values(a.onPropose())[0])),s((o,{create:l})=>{l(a.onApply(o,"components")[`minecraft:${e}`])})})}});function Uu(r){const e={},t=Object.keys(r);if(t.length===1&&t[0].startsWith("$dynamic.list."))return{type:"array",items:Uu(Object.values(r)[0])};for(const[u,n]of Object.entries(r))u.startsWith("$")||(typeof n=="string"?e[u]=Tc(n):Array.isArray(n)?e[u]={enum:n}:n==="object"&&(e[u]=Uu(n)));return{type:"object",properties:e}}function Tc(r){switch(r){case"$general.boolean":return{type:"boolean"};case"$general.number":return{type:"integer"};case"$general.decimal":return{type:"number"};default:return{type:["number","integer","string","boolean","object","array"]}}}class Oc{constructor(e,t,u,n,i,s){this.console=e,this.fileType=t,this.componentSrc=u,this.mode=n,this.v1Compat=i,this.targetVersion=s,this.animations=[],this.animationControllers=[],this.createOnPlayer=[],this.dialogueScenes={},this.serverFiles=[],this.clientFiles={},this.lifecycleHookCount={activated:0,deactivated:0}}setProjectConfig(e){this.projectConfig=e}get name(){return this._name}async load(e,t,u){let n={component:null};const i=await e.run(t,{defineComponent:l=>l,console:this.console,Bridge:this.v1Compat?$c(n,this.fileType):void 0}).catch(()=>(this.console.error(`Failed to execute component ${t}`),null));if(!i)return!1;if(typeof i.__default__!="function")if(n.component)i.__default__=n.component;else return this.console.error(`Component ${t} is not a valid component. Expected a function as the default export.`),!1;const s=l=>this._name=l;let a=l=>this.schema=l,o=()=>{};return(!u||u==="server")&&(a=()=>{},o=l=>{this.template=(h,c)=>{try{l(h,c)}catch(f){this.console.log(l.toString()),this.console.error(f)}}}),await i.__default__({name:s,schema:a,template:o}),!0}reset(){this.animations=[],this.animationControllers=[],this.clientFiles={},this.serverFiles=[]}getSchema(){return this.schema}toString(){return this.componentSrc}create(e,t,u=`minecraft:${this.fileType}`,n){var i;const s=u.split("/"),a=s.pop(),o=this.getObjAtLocation(e,[...s]);o[a]=(n?(l,h)=>n(jt,l,h):jt)((i=o[a])!=null?i:{},t!=null?t:{})}getObjAtLocation(e,t){let u=e;for(;t.length>0;){const n=t.shift();u[n]===void 0?u[Number(n)]!==void 0?u=u[Number(n)]:(u[n]={},u=u[n]):u=u[n]}return u}async processTemplates(e,t,u){var n,i,s,a,o,l;if(typeof this.template!="function")return;const h=(s=(i=(n=e[`minecraft:${this.fileType}`])==null?void 0:n.description)==null?void 0:i.identifier)!=null?s:"bridge:no_identifier",c=await Cu(`${this.name}/${h}`),f=(l=(o=(a=this.projectConfig)==null?void 0:a.get())==null?void 0:o.namespace)!=null?l:"bridge",C=(_,R)=>(this.animations.push([_,R]),this.getShortAnimName("a",c,this.animations.length-1)),A=(_,R)=>(this.animationControllers.push([_,R]),this.getShortAnimName("ac",c,this.animationControllers.length-1)),p=_=>{const R=`loot_tables/bridge/${this.getShortAnimName("lt",c,this.serverFiles.length)}.json`;return this.serverFiles.push([R,_]),R},d=_=>{const R=`trading/bridge/${this.getShortAnimName("tt",c,this.serverFiles.length)}.json`;return this.serverFiles.push([R,_]),R},D=_=>{this.serverFiles.push([`recipes/bridge/${this.getShortAnimName("recipe",c,this.serverFiles.length)}.json`,_])},F=_=>{this.serverFiles.push([`spawn_rules/bridge/${this.getShortAnimName("sr",c,this.serverFiles.length)}.json`,_])},m=(await Cu(`${this.name}/${u}`)).slice(0,16),b=_=>this.registerLifecycleHook(e,u,_,m,"activated"),B=_=>this.registerLifecycleHook(e,u,_,m,"deactivated");this.fileType==="entity"?this.template(t!=null?t:{},{mode:this.mode,compilerMode:this.mode,sourceEntity:()=>JSON.parse(JSON.stringify(e)),create:(_,R,S)=>this.create(e,_,R,S),location:u,identifier:h,projectNamespace:f,animationController:A,animation:C,lootTable:p,tradeTable:d,spawnRule:F,dialogueScene:!this.targetVersion||xc(this.targetVersion,"1.17.10",">=")?(_,R=!0)=>{this.dialogueScenes[c]||(this.dialogueScenes[c]=[]),this.dialogueScenes[c].push(_),_.scene_tag&&R&&b({run_command:{command:[`/dialogue open @s @p ${_.scene_tag}`]}})}:void 0,onActivated:b,onDeactivated:B,client:{create:(_,R="1.10.0")=>{this.clientFiles[`entity/bridge/${c}.json`]={format_version:R,"minecraft:client_entity":Object.assign({description:{identifier:h}},_)}}}}):this.fileType==="item"?this.template(t!=null?t:{},{mode:this.mode,compilerMode:this.mode,sourceItem:()=>JSON.parse(JSON.stringify(e)),create:(_,R,S)=>this.create(e,_,R,S),location:u,identifier:h,projectNamespace:f,lootTable:p,recipe:D,player:{animationController:A,animation:C,create:(_,R,S)=>this.createOnPlayer.push([R!=null?R:"minecraft:entity",_,S])}}):this.fileType==="block"&&this.template(t!=null?t:{},{mode:this.mode,compilerMode:this.mode,sourceBlock:()=>JSON.parse(JSON.stringify(e)),create:(_,R,S)=>this.create(e,_,R,S),lootTable:p,recipe:D,location:u,identifier:h,projectNamespace:f})}async processAdditionalFiles(e,t){var u,n,i,s,a,o;const l=(n=(u=this.projectConfig)==null?void 0:u.getRelativePackRoot("behaviorPack"))!=null?n:"BP",h=(i=this.projectConfig)==null?void 0:i.getRelativePackRoot("resourcePack"),c=(o=(a=(s=t[`minecraft:${this.fileType}`])==null?void 0:s.description)==null?void 0:a.identifier)!=null?o:"bridge:no_identifier",f=await Cu(`${this.name}/${c}`),C=`${l}/animations/bridge/${f}.json`,A=`${l}/animation_controllers/bridge/${f}.json`;return c==="minecraft:player"&&this.createOnPlayer.forEach(([p,d,D])=>{this.create(t,d,p,D)}),h||(this.clientFiles={},this.console.error(`[${this.name}] Dash was unable to load the root of your resource pack and therefore cannot generate client files for this component.`)),{[C]:{baseFile:e,fileContent:this.createAnimations(f,t)},[A]:{baseFile:e,fileContent:this.createAnimationControllers(f,t)},[L.join(l,`dialogue/bridge/${f}.json`)]:this.dialogueScenes[f]&&this.dialogueScenes[f].length>0?{baseFile:e,fileContent:JSON.stringify({format_version:this.targetVersion,"minecraft:npc_dialogue":{scenes:this.dialogueScenes[f]}},null,"	")}:void 0,...Object.fromEntries(this.serverFiles.map(([p,d])=>[L.join(l,p),{baseFile:e,fileContent:JSON.stringify(d,null,"	")}])),...Object.fromEntries(Object.entries(this.clientFiles).map(([p,d])=>[L.join(h,p),{baseFile:e,fileContent:JSON.stringify(d,null,"	")}]))}}createAnimations(e,t){if(this.animations.length===0)return;let u=0;const n={format_version:"1.10.0",animations:{}};for(const[i,s]of this.animations){if(!i){u++;continue}const a=this.getAnimName("animation",e,u),o=this.getShortAnimName("a",e,u);n.animations[a]=i,this.create(t,{animations:{[o]:a}},"minecraft:entity/description"),s!==!1&&this.create(t,{scripts:{animate:[s?{[o]:s}:o]}},"minecraft:entity/description"),u++}return JSON.stringify(n,null,"	")}createAnimationControllers(e,t){if(this.animationControllers.length===0)return;let u=0;const n={format_version:"1.10.0",animation_controllers:{}};for(const[i,s]of this.animationControllers){if(!i){u++;continue}const a=this.getAnimName("controller.animation",e,u),o=this.getShortAnimName("ac",e,u);n.animation_controllers[a]=i,this.create(t,{animations:{[o]:a}},"minecraft:entity/description"),s!==!1&&this.create(t,{scripts:{animate:[s?{[o]:s}:o]}},"minecraft:entity/description"),u++}return JSON.stringify(n,null,"	")}getAnimName(e,t,u){return`${e}.${t}_${u}`}getShortAnimName(e,t,u){var n;return`${(n=t.slice(0,16))!=null?n:"bridge_auto"}_${e}_${u}`}registerLifecycleHook(e,t,u,n,i){e[`minecraft:${this.fileType}`].events||(e[`minecraft:${this.fileType}`].events={});const s=e[`minecraft:${this.fileType}`].events;if(i==="activated"&&t===`minecraft:${this.fileType}/components`)s["minecraft:entity_spawned"]||(s["minecraft:entity_spawned"]={}),this.addEventReponse(s["minecraft:entity_spawned"],u);else if(this.fileType==="entity"&&t.startsWith(`minecraft:${this.fileType}/component_groups/`)){const a=t.split("/").pop();this.findComponentGroupReferences(s,i==="activated"?"add":"remove",a).forEach(l=>this.addEventReponse(l,u))}else if(t.startsWith(`minecraft:${this.fileType}/permutations/`)){const a=t.split("/");if(a.pop()!=="components")throw new Error("Invalid component location inside of permutation");const o=this.getObjAtLocation(e,[...a]),l=`bridge:${n}_${i}_${i==="activated"?this.lifecycleHookCount.activated++:this.lifecycleHookCount.deactivated++}`;o.condition&&this.animationControllers.push([{states:{default:{on_entry:[`@s ${l}`]}}},i==="activated"?o.condition:`!(${o.condition})`]),s[l]=u}}addEventReponse(e,t){if(Array.isArray(e.sequence))e.sequence.push(t);else if(Object.keys(e).length===0)Object.assign(e,t);else{let u=Object.assign({},e,{filters:void 0});for(const n in e)n!=="filters"&&(e[n]=void 0);e.sequence=[u,t]}}findComponentGroupReferences(e,t,u){var n,i;let s=[];for(const a in e){const o=e[a];Array.isArray(o.sequence)?s.push(...this.findComponentGroupReferences(o.sequence,t,u)):Array.isArray(o.randomize)?s.push(...this.findComponentGroupReferences(o.randomize,t,u)):((i=(n=o[t])==null?void 0:n.component_groups)!=null?i:[]).includes(u)&&s.push(o)}return s}}function Pc(r){const e=[];for(const[t,u]of r)e.push(...Nc(u,t));return e}function Nc(r,e){const t=[];for(const u in r)u.startsWith("minecraft:")||u.startsWith("tag:")||t.push([u,e]);return t}function zu({fileType:r,getComponentObjects:e}){const t=new Map;let u={};return({console:n,projectConfig:i,projectRoot:s,compileFiles:a,getAliases:o,options:l,jsRuntime:h,targetVersion:c,fileType:f})=>{const C=(d,D)=>d&&r==="item"&&(f==null?void 0:f.getId(d))==="entity"&&D(d).includes("minecraft:player"),A=d=>l.v1CompatMode?d==null?void 0:d.includes("/components/"):d&&(f==null?void 0:f.getId(d))==="customComponent"&&d.includes(`/${r}/`),p=d=>d&&(f==null?void 0:f.getId(d))===r;return{buildStart(){t.clear(),u={}},transformPath(d){if(A(d)&&l.buildType!=="fileRequest")return null},async read(d,D){if(!D)return u[d]?ur.parse(u[d].fileContent):void 0;if(A(d)&&d.endsWith(".js")){const F=await D.getFile();return await(F==null?void 0:F.text())}else if(p(d)||C(d,o)){const F=await D.getFile();if(!F)return;try{return ur.parse(await F.text())}catch(m){return l.buildType!=="fileRequest"&&n.error(`Error within file "${d}": ${m}`),{__error__:`Failed to load original file: ${m}`}}}},async load(d,D){if(A(d)&&typeof D=="string"){const F=new Oc(n,r,D,l.mode,!!l.v1CompatMode,c);return F.setProjectConfig(i),await F.load(h,d)?F:D}},async registerAliases(d,D){if(A(d))return[`${r}Component#${D.name}`]},async require(d,D){if(C(d,o))return[`.${i.getRelativePackRoot("behaviorPack")}/components/item/**/*.[jt]s`,`.${i.getRelativePackRoot("behaviorPack")}/items/**/*.json`];if(p(d)){const F=Pc(e(D));return t.set(d,F),F.map(m=>`${r}Component#${m[0]}`)}else if(u[d])return[u[d].baseFile]},async transform(d,D,F={}){var m;if(C(d,o)){const b=Object.entries(F).filter(([B])=>B.startsWith("itemComponent#")).map(([B,_])=>_);for(const B of b){if(!B)return;u=jt(u,await B.processAdditionalFiles(d,D))}}else if(p(d)){const b=new Set;for(const[B,_]of(m=t.get(d))!=null?m:[]){const R=F[`${r}Component#${B}`];if(!R)continue;const S=fo(D,_.split("/"),{}),j=S[B];delete S[B],await R.processTemplates(D,j,_),b.add(R)}for(const B of b)u=jt(u,await B.processAdditionalFiles(d,D));for(const B of b)B.reset()}},finalizeBuild(d,D){if(A(d)&&D)return D.toString();if(p(d)||u[d])return JSON.stringify(D,null,"	")},async buildEnd(){if(l.buildType==="fileRequest")return;u=Object.fromEntries(Object.entries(u).filter(([D,F])=>(F==null?void 0:F.fileContent)!==void 0).map(([D,F])=>[L.join(s,D),F]));const d=Object.keys(u);d.length>0&&await a(d),u={}}}}}const Ic=zu({fileType:"entity",getComponentObjects:r=>{var e,t,u,n,i,s;return[["minecraft:entity/components",(t=(e=r==null?void 0:r["minecraft:entity"])==null?void 0:e.components)!=null?t:{}],...Object.entries((n=(u=r==null?void 0:r["minecraft:entity"])==null?void 0:u.component_groups)!=null?n:{}).map(([a,o])=>[`minecraft:entity/component_groups/${a}`,o]),...((s=(i=r==null?void 0:r["minecraft:entity"])==null?void 0:i.permutations)!=null?s:[]).map((a,o)=>{var l;return[`minecraft:entity/permutations/${o}/components`,(l=a==null?void 0:a.components)!=null?l:{}]})]}}),Lc=zu({fileType:"item",getComponentObjects:r=>{var e,t;return[["minecraft:item/components",(t=(e=r==null?void 0:r["minecraft:item"])==null?void 0:e.components)!=null?t:{}]]}}),Hc=zu({fileType:"block",getComponentObjects:r=>{var e,t,u,n;return[["minecraft:block/components",(t=(e=r==null?void 0:r["minecraft:block"])==null?void 0:e.components)!=null?t:{}],...((n=(u=r==null?void 0:r["minecraft:block"])==null?void 0:u.permutations)!=null?n:[]).map((i,s)=>{var a;return[`minecraft:block/permutations/${s}/components`,(a=i.components)!=null?a:{}]})]}});function Wu(r,e,t,u=0){const n=[];for(const i of r){if(!i.startsWith("/")){n.push(i);continue}const[s,...a]=Xn(i.slice(1)).tokens.map(({word:l})=>l),o=e[`command#${s}`];if(s==="execute"){let l=4;if(a[l]==="detect"&&(l+=6),a[l]===void 0){n.push(i);continue}const[h,...c]=a.slice(l),f=e[`command#${h}`];if(!(f instanceof Gu)){n.push(i);continue}n.push(...f.process(`${h} ${c.join(" ")}`,e,u+1).map(C=>C.startsWith("/")?`/execute ${a.slice(0,l).join(" ")} ${C.slice(1)}`:C));continue}else if(!(o instanceof Gu)){n.push(i);continue}n.push(...o.process(i,e,u))}return n.filter(i=>t||!i.startsWith("#")).map(i=>i.trim())}const Mc=r=>({register:e=>{r.command=({name:t,schema:u,template:n})=>{t(e.command_name),u([]),n(i=>new e().onApply(i))}}});class Gu{constructor(e,t,u,n){this.console=e,this.commandSrc=t,this.mode=u,this.v1Compat=n}get name(){var e;return(e=this._name)!=null?e:"unknown"}async load(e,t,u){const n={command:null},i=await e.run(t,{console:this.console,defineCommand:l=>l,Bridge:this.v1Compat?Mc(n):void 0}).catch(l=>(this.console.error(`Failed to execute command ${this.name}: ${l}`),null));if(!i)return null;if(typeof i.__default__!="function")if(n.command)i.__default__=n.command;else return this.console.error(`Component ${t} is not a valid component. Expected a function as the default export.`),!1;const s=l=>this._name=l;let a=l=>this.schema=l,o=()=>{};(!u||u==="server")&&(a=()=>{},o=l=>{this.template=(h,c)=>{try{return l(h,c)}catch(f){return this.console.error(f),[]}}}),await i.__default__({name:s,schema:a,template:o})}process(e,t,u){var n;e.startsWith("/")&&(e=e.slice(1));const[i,...s]=Xn(e).tokens.map(({word:l})=>l),a=(n=this.template)==null?void 0:n.call(this,s.map(l=>Eo(l)),{compilerMode:this.mode,commandNestingDepth:u,compileCommands:l=>Wu(l.map(h=>h.startsWith("/")?h:`/${h}`),t,!1,u+1).map(h=>h.startsWith("/")?h.slice(1):h)});let o=[];if(typeof a=="string")o=a.split(`
`);else if(Array.isArray(a))o=a.filter(l=>typeof l=="string");else{const l=`Failed to process command ${this._name}; Invalid command template return type: Expected string[] or string, received ${typeof a}`;this.console.error(l),o.push(`# ${l}`)}return o.map(l=>l.startsWith("/")||l.startsWith("#")?l:`/${l}`)}getSchema(){if(this.schema){if(Array.isArray(this.schema))return this.schema.length===0?[{commandName:this.name}]:this.schema.map(e=>({commandName:this.name,...e}))}else return[{commandName:this.name}];return this.schema.commandName||(this.schema.commandName=this.name),[this.schema]}toString(){return this.commandSrc}}const jc=({projectConfig:r,jsRuntime:e,console:t,fileType:u,requestJsonData:n,options:i})=>{const s=(c,f)=>r.resolvePackPath(c,f),a=c=>c&&u.getId(c)==="customCommand",o=c=>c&&u.getId(c)==="function",l=c=>{var f;return(f=Object.entries(i.include).find(([C])=>u.getId(c)===C))==null?void 0:f[1]},h=c=>{var f,C,A;return(A=(C=(f=u.get(c))==null?void 0:f.meta)==null?void 0:C.commandsUseSlash)!=null?A:!1};return{async buildStart(){i.include=Object.assign(await n("data/packages/minecraftBedrock/location/validCommand.json"),i.include)},transformPath(c){if(a(c)&&i.buildType!=="fileRequest")return null},async read(c,f){if(!!f){if(a(c)&&c.endsWith(".js")){const C=await f.getFile();return await(C==null?void 0:C.text())}else if(o(c)){const C=await f.getFile();return await(C==null?void 0:C.text())}else if(l(c)&&f){const C=await f.getFile();if(!C)return;try{return ur.parse(await C.text())}catch(A){t.error(A)}}}},async load(c,f){var C;if(a(c)){const A=new Gu(t,f,i.mode,(C=i.v1CompatMode)!=null?C:!1);return await A.load(e,c),A}},async registerAliases(c,f){if(a(c))return[`command#${f.name}`]},async require(c){if(l(c)||o(c))return[s("behaviorPack","commands/**/*.[jt]s"),s("behaviorPack","commands/*.[jt]s")]},async transform(c,f,C={}){const A=l(c);if(A&&A.length>0){const p=h(c);A.forEach(d=>Kn(d,f,D=>{if(!D)return D;D=Array.isArray(D)?D:[D];const F=[];for(const m of D){if(typeof m=="string"){F.push(m);continue}t.error(`The file "${c}" contains invalid commands. Expected type "string" within array but got type "${typeof m}"`)}return Wu(F.map(m=>!p&&!m.startsWith("/")?`/${m}`:m),C,!1).map(m=>p?m:m.slice(1))}))}else if(o(c)){const p=f.split(`
`).map(d=>d.trim()).filter(d=>d!==""&&!d.startsWith("#")).map(d=>`/${d}`);return Wu(p,C,!0).map(d=>d.startsWith("/")?d.slice(1):d).join(`
`)}},finalizeBuild(c,f){if(a(c)&&f)return f.toString();if(l(c)&&typeof f!="string")return JSON.stringify(f,null,"	")}}},Uc=({options:r})=>({async transformPath(e){if(!!(e!=null&&e.endsWith(".ts")))return`${e.slice(0,-3)}.js`},async read(e,t){if(!e.endsWith(".ts")||!t)return;const u=await t.getFile();return await(u==null?void 0:u.text())},async load(e,t){if(!!e.endsWith(".ts"))return await kr,Ii(t,{filename:L.basename(e),sourceMaps:r!=null&&r.inlineSourceMap?"inline":void 0,jsc:{parser:{syntax:"typescript"},target:"es2020"}}).code},finalizeBuild(e,t){if(e.endsWith(".ts")&&typeof t=="string")return t}}),zc=({options:r,outputFileSystem:e,projectRoot:t,packType:u,fileType:n,console:i})=>{r.packName||(r.packName="bridge project");const s=h=>h.split(/\\|\//g).filter(c=>c!==".."&&c!==".").slice(1).join("/"),a=h=>{const c=u.getId(h),f=L.relative(t,h);if(c==="behaviorPack"||c==="resourcePack"||c==="skinPack")return L.join(t,"builds/dist",c,s(f))},o=h=>{const c=u.getId(h),f=L.relative(t,h);if(c==="worldTemplate")return L.join(t,"builds/dist",s(f));if(c==="behaviorPack"||c==="resourcePack")return L.join(t,"builds/dist",c==="behaviorPack"?"behavior_packs":"resource_packs",r.packName,s(f))},l=h=>n.getId(h)==="worldManifest"?null:o(h);return{async buildStart(){await e.unlink(`${t}/builds/dist`).catch(()=>{})},transformPath(h){if(!!h)switch(r.format){case"mcaddon":return a(h);case"mcworld":return l(h);case"mctemplate":return o(h);default:i.error(`Unknown packaging format: ${r.format}`)}}}},Wc=({projectConfig:r,packType:e,options:t})=>{const u=Object.keys(r.getAvailablePacks()),n=Object.fromEntries(u.map(s=>[s,[]])),i=s=>{const a=e.getId(s);if(a!=="unknown")return[a,r.resolvePackPath(a,"contents.json")]};return t.buildType!=="fullBuild"?{}:{include(){return u.map(s=>[r.resolvePackPath(s,"contents.json"),{isVirtual:!0}])},read(s){const a=i(s);if(!a)return;const[o,l]=a;if(s!==l)return n[o]},transformPath(s){if(!s)return;const a=e.getId(s);a!=="unknown"&&n[a].push(s)},finalizeBuild(s){const a=i(s);if(!a)return;const[o,l]=a;if(s!==l)return JSON.stringify(n[o])}}},Gc=({fileType:r})=>{const e=[];for(const u of r.all)u.formatVersionMap&&e.push(u.id);const t=u=>u&&e.includes(r.getId(u));return{async read(u,n){if(!!n&&t(u)){const i=await n.getFile();if(!i)return;try{return ur.parse(await i.text())}catch(s){console.error(s)}}},load(u,n){if(t(u))return n},transform(u,n){if(t(u)){const i=r.get(u),s=i==null?void 0:i.formatVersionMap;if(!s)return;const a=n==null?void 0:n.format_version;return a&&s[a]&&(n.format_version=s[a]),n}},finalizeBuild(u,n){if(t(u))return JSON.stringify(n)}}},qc=({fileType:r,console:e,jsRuntime:t})=>{const u=a=>r.getId(a),n=a=>{var o;const l=r.get(a);return l?(o=l.type)!=null?o:"json":"raw"},i=a=>u(a)!=="gameTest"&&(a.endsWith(".js")||a.endsWith(".ts")),s=a=>{var o,l,h,c;return n(a)==="json"?".json":(c=(h=(l=(o=r.get(a))==null?void 0:o.detect)==null?void 0:l.fileExtensions)==null?void 0:h[0])!=null?c:".txt"};return{transformPath(a){if(a&&i(a))return a.replace(/\.(js|ts)$/,`.${s(a)}`)},read(a,o){if(i(a))return o==null?void 0:o.getFile()},async load(a,o){if(i(a)){const l=await t.run(a,{console:e},o).catch(h=>(e.error(`Failed to execute generator script "${a}": ${h}`),null));return l?l.__default__?l.__default__:(e.error(`Expected generator script "${a}" to provide file content as default export!`),null):null}},finalizeBuild(a,o){if(i(a))return o===null?null:typeof o=="object"?JSON.stringify(o):o}}};class Yi extends ic{constructor(e,t){super(t),this.fs=e}readFile(e){return this.fs.readFile(e).then(t=>t.text())}}const Zi={simpleRewrite:Dc,rewriteForPackaging:zc,moLang:vc,entityIdentifierAlias:Bc,customEntityComponents:Ic,customItemComponents:Lc,customBlockComponents:Hc,customCommands:jc,typeScript:Uc,contentsFile:Wc,formatVersionCorrection:Gc,generatorScripts:qc};class Vc{constructor(e){this.dash=e,this.plugins=[],this.pluginRuntime=new Yi(this.dash.fileSystem)}async loadPlugins(e={}){var t,u;this.plugins=[],this.pluginRuntime.clearCache();const n=[...(await this.dash.fileSystem.readdir(L.join(this.dash.projectRoot,".bridge/extensions")).catch(()=>[])).map(a=>a.kind==="directory"?L.join(this.dash.projectRoot,".bridge/extensions",a.name):void 0),...(await this.dash.fileSystem.readdir("extensions").catch(()=>[])).map(a=>a.kind==="directory"?L.join("extensions",a.name):void 0)],i={};for(const a of n){if(!a)continue;let o;try{o=await this.dash.fileSystem.readJson(L.join(a,"manifest.json"))}catch{continue}if(!!((t=o==null?void 0:o.compiler)!=null&&t.plugins))for(const l in o.compiler.plugins)i[l]=L.join(a,o.compiler.plugins[l])}const s=(u=(await this.getCompilerOptions()).plugins)!=null?u:[];for(const a of s){const o=typeof a=="string"?a:a[0],l=typeof a=="string"?{}:a[1];if(i[o]){const h=await this.pluginRuntime.run(i[o],{console:this.dash.console,...e}).catch(c=>(this.dash.console.error(`Failed to execute plugin ${o}: ${c}`),null));if(!h)continue;typeof h.__default__=="function"?this.plugins.push(new ji(this.dash,o,h.__default__(await this.getPluginContext(o,l)))):this.dash.console.error(`Plugin ${o} is invalid: It does not provide a function as a default export.`)}else Zi[o]?this.plugins.push(new ji(this.dash,o,Zi[o](await this.getPluginContext(o,l)))):this.dash.console.error(`Unknown compiler plugin: ${o}`)}}async getCompilerOptions(){var e;const t=await this.dash.getCompilerConfigPath();return t?await this.dash.fileSystem.readJson(t):(e=this.dash.projectConfig.get().compiler)!=null?e:{}}async getPluginContext(e,t={}){const u=this.dash;return{options:{get mode(){return u.getMode()},get buildType(){return u.buildType},...t},jsRuntime:this.dash.jsRuntime,console:this.dash.console,fileSystem:this.dash.fileSystem,outputFileSystem:this.dash.outputFileSystem,projectConfig:this.dash.projectConfig,projectRoot:this.dash.projectRoot,packType:this.dash.packType,fileType:this.dash.fileType,targetVersion:this.dash.projectConfig.get().targetVersion,requestJsonData:this.dash.requestJsonData,getAliases:n=>{var i,s;return[...(s=(i=this.dash.includedFiles.get(n))==null?void 0:i.aliases)!=null?s:[]]},hasComMojangDirectory:this.dash.fileSystem!==this.dash.outputFileSystem,compileFiles:n=>this.dash.compileVirtualFiles(n)}}async runBuildStartHooks(){for(const e of this.plugins)await e.runBuildStartHook()}async runIncludeHooks(){let e=[];for(const t of this.plugins){const u=await t.runIncludeHook();Array.isArray(u)&&e.push(...u)}return e}async runTransformPathHooks(e){let t=e;for(const u of this.plugins){const n=await u.runTransformPathHook(t);if(n===null)return null;n!==void 0&&(t=n)}return t}async runReadHooks(e,t){for(const u of this.plugins){const n=await u.runReadHook(e,t);if(n!=null)return n}}async runLoadHooks(e,t){let u=t;for(const n of this.plugins){const i=await n.runLoadHook(e,u);i!==void 0&&(u=i)}return u}async runRegisterAliasesHooks(e,t){const u=new Set;for(const n of this.plugins){const i=await n.runRegisterAliasesHook(e,t);i!=null&&(Array.isArray(i)?i.forEach(s=>u.add(s)):u.add(i))}return u}async runRequireHooks(e,t){const u=new Set;for(const n of this.plugins){const i=await n.runRequireHook(e,t);i!=null&&(Array.isArray(i)?i.forEach(s=>u.add(s)):u.add(i))}return u}async runTransformHooks(e){const t=Object.fromEntries([...e.requiredFiles].map(n=>this.dash.includedFiles.query(n)).flat().map(n=>[[n.filePath,n.data],...[...n.aliases].map(i=>[i,n.data])]).flat());let u=e.data;for(const n of this.plugins){const i=await n.runTransformHook(e.filePath,u,t);i!==void 0&&(u=i)}return u}async runFinalizeBuildHooks(e){for(const t of this.plugins){const u=await t.runFinalizeBuildHook(e.filePath,e.data);if(u!==void 0)return u}}async runBuildEndHooks(){for(const e of this.plugins)await e.runBuildEndHook()}}class qu{constructor(e,t,u=!1){this.dash=e,this.filePath=t,this.isVirtual=u,this.isDone=!1,this.requiredFiles=new Set,this.aliases=new Set,this.updateFiles=new Set,this.outputPath=t,this.isVirtual||this.setDefaultFileHandle()}setFileHandle(e){this.fileHandle=e}setDefaultFileHandle(){this.setFileHandle({getFile:()=>this.dash.fileSystem.readFile(this.filePath).catch(()=>null)})}setOutputPath(e){this.outputPath=e}setReadData(e){this.data=e}setAliases(e){for(const t of e)this.dash.includedFiles.addAlias(t,this);this.aliases=e}setRequiredFiles(e){this.requiredFiles=e}setUpdateFiles(e){this.updateFiles=new Set(e.map(t=>this.dash.includedFiles.get(t)).filter(t=>t!==void 0))}addUpdateFile(e){this.updateFiles.add(e)}removeUpdateFile(e){this.updateFiles.delete(e)}getHotUpdateChain(){const e=new Set([this]);for(const t of this.updateFiles)t.getHotUpdateChain().forEach(u=>{e.add(u)});return e}filesToLoadForHotUpdate(e=new Set,t=!0){const u=new Set;if(e.has(this))return u;e.add(this);for(const n of this.requiredFiles){const i=this.dash.includedFiles.query(n);for(const s of i)s.filesToLoadForHotUpdate(e,!1).forEach(a=>{u.add(a)})}if(u.add(this),t)for(const n of this.updateFiles)n.filesToLoadForHotUpdate(e,!0).forEach(i=>{u.add(i)});return u}async processAfterLoad(e){if((this.data===null||this.data===void 0)&&(this.isDone=!0,this.filePath!==this.outputPath&&this.outputPath!==null&&!this.isVirtual&&e)){const t=await this.dash.fileSystem.readFile(this.filePath);await this.dash.outputFileSystem.writeFile(this.outputPath,new Uint8Array(await t.arrayBuffer()))}}serialize(){return{isVirtual:this.isVirtual,filePath:this.filePath,aliases:[...this.aliases],requiredFiles:[...this.requiredFiles],updateFiles:[...this.updateFiles].map(e=>e.filePath)}}reset(){this.isDone=!1,this.data=null,this.isVirtual||this.setDefaultFileHandle()}}class Jc{constructor(e){this.dash=e,this.files=new Map,this.aliases=new Map,this.queryCache=new Map}all(){return[...this.files.values()]}filtered(e){return this.all().filter(t=>e(t))}get(e){var t;return(t=this.aliases.get(e))!=null?t:this.files.get(e)}query(e){if(hc(e))return this.queryGlob(e);const t=this.aliases.get(e);if(t)return[t];const u=this.files.get(e);return u?[u]:[]}addAlias(e,t){this.aliases.set(e,t)}queryGlob(e){if(this.queryCache.has(e))return this.queryCache.get(e);const t=this.filtered(u=>Dr(u.filePath,e));return this.queryCache.set(e,t),t}async loadAll(){this.queryCache=new Map;const e=new Set,t=this.dash.projectConfig.getAvailablePackPaths();for(const n of t){const i=await this.dash.fileSystem.allFiles(n).catch(s=>(this.dash.console.warn(s),[]));for(const s of i)e.add(s)}const u=await this.dash.plugins.runIncludeHooks();for(const n of u)typeof n=="string"?e.add(n):this.addOne(n[0],n[1].isVirtual);this.add([...e])}addOne(e,t=!1){const u=new qu(this.dash,e,t);return this.files.set(e,u),u}add(e,t=!1){let u=[];for(const n of e){const i=this.files.get(n);if(i){u.push(i);continue}u.push(new qu(this.dash,n,t)),this.files.set(n,u[u.length-1])}return u}remove(e){const t=this.files.get(e);if(!!t){this.files.delete(e);for(const u of t.aliases)this.aliases.delete(u)}}async save(e){await this.dash.fileSystem.writeJson(e,this.all().map(t=>t.serialize()))}async load(e){this.removeAll();const t=await this.dash.fileSystem.readJson(e),u=[];for(const n of t){const i=new qu(this.dash,n.filePath,n.isVirtual);i.setAliases(new Set(n.aliases)),i.setRequiredFiles(new Set(n.requiredFiles)),u.push(i);for(const s of n.aliases)this.aliases.set(s,i)}this.files=new Map(u.map(n=>[n.filePath,n]));for(let n=0;n<u.length;n++)u[n].setUpdateFiles(t[n].updateFiles)}resetAll(){for(const e of this.all())e.reset()}removeAll(){this.files=new Map,this.aliases=new Map,this.queryCache=new Map}}class Kc{constructor(e){this.dash=e}async run(e,t=!0){for(const u of e)u.isDone||await this.loadFile(u,t);for(const u of e)u.isDone||await this.loadRequiredFiles(u)}async loadFile(e,t=!0){var u;const[n,i]=await Promise.all([this.dash.plugins.runTransformPathHooks(e.filePath),this.dash.plugins.runReadHooks(e.filePath,e.fileHandle)]);if(e.setOutputPath(n),e.setReadData(i),await e.processAfterLoad(t),e.isDone)return;e.setReadData((u=await this.dash.plugins.runLoadHooks(e.filePath,e.data))!=null?u:e.data);const s=await this.dash.plugins.runRegisterAliasesHooks(e.filePath,e.data);e.setAliases(s)}async loadRequiredFiles(e){const t=await this.dash.plugins.runRequireHooks(e.filePath,e.data);e.setRequiredFiles(t)}}class Xc{constructor(e){this.dash=e}run(e){const t=new Set;for(const u of e)u.isDone||t.has(u)||this.resolveSingle(u,t);return t}resolveSingle(e,t,u=new Set){const n=this.dash.includedFiles;u.add(e);for(const i of e.requiredFiles){const s=n.query(i);for(const a of s){if(!a){this.dash.console.error(`Undefined file dependency: "${e.filePath}" requires "${i}"`);continue}if(a.addUpdateFile(e),!t.has(a)){if(u.has(a)){this.dash.console.error(`Circular dependency detected: ${a.filePath} is required by ${e.filePath} but also depends on this file.`);continue}this.resolveSingle(a,t,u)}}}t.add(e),u.delete(e)}}function Qc(r){return typeof r=="string"||r instanceof Blob||r instanceof File||r instanceof ArrayBuffer||(r==null?void 0:r.buffer)instanceof ArrayBuffer}class Yc{constructor(e){this.dash=e}async run(e,t=!1){for(const u of e){if(u.isDone)continue;let n=await this.transformFile(u,!0,t);n!=null&&u.outputPath&&await this.dash.outputFileSystem.writeFile(u.outputPath,n)}}async transformFile(e,t=!1,u=!1){var n;if(u||(e.data=(n=await this.dash.plugins.runTransformHooks(e))!=null?n:e.data),!t)return e.data;let i=await this.dash.plugins.runFinalizeBuildHooks(e);return i===void 0&&(i=e.data),i!=null&&(Qc(i)||(this.dash.console.warn(`File "${e.filePath}" was not in a writable format: "${typeof i}". Trying to JSON.stringify(...) it...`,i),i=JSON.stringify(i))),e.isDone=!0,i}}class Zc{constructor(e=1){this.total=e,this.current=0,this.onChangeCbs=new Set}get percentage(){return this.current/this.total}onChange(e){return this.onChangeCbs.add(e),{dispose:()=>this.onChangeCbs.delete(e)}}setTotal(e){this.total=e,this.current=0,this.onChangeCbs.forEach(t=>t(this))}updateCurrent(e){this.current=e,this.onChangeCbs.forEach(t=>t(this))}advance(){this.current++,this.onChangeCbs.forEach(e=>e(this))}addToTotal(e){this.total+=e,this.onChangeCbs.forEach(t=>t(this))}}class es{constructor(){this._timers=new Map}time(e){if(this._timers.has(e)){this.warn(`Timer "${e}" already exists.`);return}else this._timers.set(e,Date.now())}timeEnd(e){const t=this._timers.get(e);if(t)this._timers.delete(e),this.log(`${e}: ${Date.now()-t}ms`);else{this.warn(`Timer "${e}" does not exist.`);return}}}class e0 extends es{log(...e){console.log(...e)}error(...e){console.error(...e)}warn(...e){console.warn(...e)}info(...e){console.info(...e)}}class t0{constructor(e,t,u){var n;this.fileSystem=e,this.options=u,this.progress=new Zc,this.plugins=new Vc(this),this.includedFiles=new Jc(this),this.loadFiles=new Kc(this),this.fileOrderResolver=new Xc(this),this.fileTransformer=new Yc(this),this.buildType="fullBuild",this.outputFileSystem=t!=null?t:e,this.projectRoot=L.dirname(u.config),this.projectConfig=new fc(e,u.config),this.console=(n=u.console)!=null?n:new e0,this.jsRuntime=new Yi(this.fileSystem,[["@molang/expressions",Pi],["@molang/core",{MoLang:Ou}],["molang",{MoLang:Ou,...Pi}],["@bridge/compiler",{mode:u.mode}]]),this.packType=u.packType,this.fileType=u.fileType}getMode(){var e;return(e=this.options.mode)!=null?e:"development"}getCompilerConfigPath(){return this.options.compilerConfig}get requestJsonData(){return this.options.requestJsonData}get dashFilePath(){return L.join(this.projectRoot,`.bridge/.dash.${this.getMode()}.json`)}async setup(e){var t,u,n,i;try{await this.projectConfig.setup()}catch(s){this.console.error("Failed to load project config: "+s)}(t=this.fileType)==null||t.setProjectConfig(this.projectConfig),(u=this.packType)==null||u.setProjectConfig(this.projectConfig),await((n=this.fileType)==null?void 0:n.setup(e)),await((i=this.packType)==null?void 0:i.setup(e)),await this.plugins.loadPlugins(this.options.pluginEnvironment)}async reload(){try{await this.projectConfig.refreshConfig()}catch{}await this.plugins.loadPlugins(this.options.pluginEnvironment)}get isCompilerActivated(){const e=this.projectConfig.get();return e.compiler!==void 0&&Array.isArray(e.compiler.plugins)}async build(){if(this.console.log("Starting compilation..."),!this.isCompilerActivated)return;this.jsRuntime.clearCache(),this.buildType="fullBuild",this.includedFiles.removeAll();const e=Date.now();this.progress.setTotal(7),await this.plugins.runBuildStartHooks(),this.progress.advance(),await this.includedFiles.loadAll(),this.progress.advance(),await this.compileIncludedFiles(),await this.plugins.runBuildEndHooks(),this.progress.advance(),this.getMode()==="development"&&await this.saveDashFile(),this.includedFiles.resetAll(),this.progress.advance(),this.console.log(`Dash compiled ${this.includedFiles.all().length} files in ${Date.now()-e}ms!`)}async updateFiles(e,t=!0){var u;if(!this.isCompilerActivated||e.length===0)return;this.buildType="hotUpdate",this.jsRuntime.clearCache(),this.progress.setTotal(8),this.console.log(`Dash is starting to update ${e.length} files...`),await this.includedFiles.load(this.dashFilePath),await this.plugins.runBuildStartHooks();const n=[];for(const o of e){let l=this.includedFiles.get(o);l||([l]=this.includedFiles.add([o])),n.push(l)}this.progress.advance();const i=[];for(const o of n)i.push(new Set([...o.requiredFiles]));this.progress.advance(),await this.loadFiles.run(n),this.progress.advance();for(let o=0;o<n.length;o++){const l=n[o];[...l.requiredFiles].filter(f=>!i[o].has(f)).forEach(f=>this.includedFiles.query(f).forEach(C=>C.addUpdateFile(l))),[...i[o]].filter(f=>!l.requiredFiles.has(f)).forEach(f=>this.includedFiles.query(f).forEach(C=>C.removeUpdateFile(l)))}this.progress.advance();const s=new Set(n.map(o=>[...o.filesToLoadForHotUpdate()]).flat());this.console.log(`Dash is loading ${s.size} files...`),await this.loadFiles.run([...s.values()].filter(o=>!n.includes(o))),this.progress.advance();const a=new Set(n.map(o=>[...o.getHotUpdateChain()]).flat());for(const o of s)o.isDone||(o.data=(u=await this.plugins.runTransformHooks(o))!=null?u:o.data,a.has(o)||(o.isDone=!0));this.progress.advance(),this.console.log(`Dash is compiling ${a.size} files...`),await this.fileTransformer.run(a,!0),this.progress.advance(),await this.plugins.runBuildEndHooks(),t&&await this.saveDashFile(),this.includedFiles.resetAll(),this.console.log(`Dash finished updating ${a.size} files!`),this.progress.advance()}async compileFile(e,t){var u;if(!this.isCompilerActivated)return[[],t];this.buildType="fileRequest",this.jsRuntime.clearCache(),this.progress.setTotal(7),await this.plugins.runBuildStartHooks(),await this.includedFiles.load(this.dashFilePath);let n=this.includedFiles.get(e);n||([n]=this.includedFiles.add([e])),n.setFileHandle({getFile:async()=>new File([t],L.basename(e))}),await this.loadFiles.loadFile(n,!1),await this.loadFiles.loadRequiredFiles(n),this.progress.advance();const i=n.filesToLoadForHotUpdate();await this.loadFiles.run([...i.values()].filter(a=>n!==a),!1),this.progress.advance();for(const a of i)a.isDone||(a.data=(u=await this.plugins.runTransformHooks(a))!=null?u:a.data);this.progress.advance();const s=await this.fileTransformer.transformFile(n,!0,!0);return this.progress.advance(),await this.includedFiles.load(this.dashFilePath),this.progress.advance(),await this.plugins.runBuildEndHooks(),[[...i].map(a=>a.filePath),s]}async unlinkMultiple(e){if(!(!this.isCompilerActivated||e.length===0)){for(const t of e)await this.unlink(t,!1);await this.saveDashFile()}}async unlink(e,t=!0){if(!this.isCompilerActivated)return;const u=await this.plugins.runTransformPathHooks(e);!u||u===e||(await this.outputFileSystem.unlink(u),this.includedFiles.remove(e),t&&await this.saveDashFile())}async rename(e,t){!this.isCompilerActivated||(await this.unlink(e,!1),await this.updateFiles([t],!1),await this.saveDashFile())}async getCompilerOutputPath(e){if(!this.isCompilerActivated)return;const t=await this.plugins.runTransformPathHooks(e);if(!!t)return t}async getFileDependencies(e){if(!this.isCompilerActivated)return[];await this.includedFiles.load(this.dashFilePath);const t=this.includedFiles.get(e);return t?[...t.filesToLoadForHotUpdate()].map(u=>u.isVirtual?u.outputPath:u.filePath).filter(u=>u!==null&&u!==e):[]}async saveDashFile(){await this.includedFiles.save(this.dashFilePath)}async compileIncludedFiles(e=this.includedFiles.all()){await this.loadFiles.run(e),this.progress.advance();const t=this.fileOrderResolver.run(e);this.progress.advance(),await this.fileTransformer.run(t),this.progress.advance()}async compileVirtualFiles(e){const t=this.includedFiles.add(e,!0);this.progress.addToTotal(3),t.forEach(u=>u.reset()),await this.compileIncludedFiles(t)}}class r0{async allFiles(e){const t=[],u=await this.readdir(e);for(const{name:n,kind:i}of u)i==="directory"?t.push(...await this.allFiles(L.join(e,n))):i==="file"&&t.push(L.join(e,n));return t}async writeJson(e,t,u=!0){await this.writeFile(e,JSON.stringify(t,null,u?"	":0))}async readJson(e){const t=await this.readFile(e);try{return await JSON.parse(await t.text())}catch{throw new Error(`Invalid JSON: ${e}`)}}watchDirectory(e,t){console.warn("Watching a directory for changes is not supported on this platform!")}}class u0 extends Ro{constructor(e){super(e),this.ready=new rt}async setup(e){this.packTypes.length>0||(await e.fired,this.packTypes=await e.readJSON("data/packages/minecraftBedrock/packDefinitions.json").catch(()=>[]),this.ready.dispatch())}}class ts extends r0{constructor(e){super(),this.internalFs=new yr(e)}get internal(){return this.internalFs}readJson(e){return this.internalFs.readJSON(e)}async writeJson(e,t,u){await this.internalFs.writeJSON(e,t,u)}readFile(e){return this.internalFs.readFile(e)}async writeFile(e,t){await this.internalFs.writeFile(e,t)}mkdir(e){return this.internalFs.mkdir(e)}unlink(e){return this.internalFs.unlink(e)}async allFiles(e){return(await this.internalFs.readFilesFromDir(e)).map(t=>t.path)}readdir(e){return this.internalFs.readdir(e,{withFileTypes:!0})}async lastModified(e){return 0}}class n0 extends es{constructor(){super(...arguments),this.logs=[],this.changeListeners=[]}getLogs(){return this.logs}basicLog(e,{type:t}={}){switch(t){case"warning":console.warn(e);break;case"error":console.error(e);break;case"info":console.info(e);break;default:console.log(e);break}e instanceof Error&&(e=e.message),this.logs.unshift([typeof e=="string"?e:JSON.stringify(e),{type:t}]),this.logsChanged()}addChangeListener(e){this.changeListeners.push(e)}removeChangeListeners(){this.changeListeners=[]}logsChanged(){this.changeListeners.forEach(e=>e())}clear(){this.logs=[],this.logsChanged()}log(...e){e.forEach(t=>this.basicLog(t))}info(...e){e.forEach(t=>this.basicLog(t,{type:"info"}))}warn(...e){e.forEach(t=>this.basicLog(t,{type:"warning"}))}error(...e){e.forEach(t=>this.basicLog(t,{type:"error"}))}}class i0{constructor(){this.listeners=[],this.isLocked=!1}lock(){return new Promise(async(e,t)=>{this.isLocked?this.listeners.push(()=>{this.isLocked=!0,e()}):(this.isLocked=!0,e())})}unlock(){if(!this.isLocked)throw new Error("Trying to unlock a mutex that is not locked");this.isLocked=!1,this.listeners.length>0&&this.listeners.shift()()}}var s0="/assets/wasm-web_bg.533586ee.wasm";globalThis.process={cwd:()=>"",env:{}},sc(s0);const Or=new tl,rs=new Map;class a0 extends Zu{constructor(e,t,u){super(),this.isDashFree=new i0,this.isSetup=!1,this.completedStartUp=new rt,this.fileSystem=new ts(e);const n=t&&u.mode==="development"?new ts(t):void 0;this.fileType=new To,this.fileType.setPluginFileTypes(u.pluginFileTypes);let i=rs.get(u.projectName);i||(i=new n0,rs.set(u.projectName,i)),this.console=i,this.dash=new t0(this.fileSystem,n,{config:u.config,compilerConfig:u.compilerConfig,console:i,mode:u.mode,fileType:this.fileType,packType:new u0,requestJsonData:s=>Or.readJSON(s)}),this.projectDir=Su(u.config)}getCompilerLogs(){return this.console.getLogs()}clearCompilerLogs(){this.console.clear()}onConsoleUpdate(e){this.console.addChangeListener(e)}removeConsoleListeners(){this.console.removeChangeListeners()}async compileFile(e,t){await this.isDashFree.lock();const[u,n]=await this.dash.compileFile(e,t);return this.isDashFree.unlock(),[u,n!=null?n:t]}async start(e,t){await this.isDashFree.lock();const u=this.fileSystem.internal;await u.fileExists(`${this.projectDir}/.bridge/.restartWatchMode`)||!await u.fileExists(`${this.projectDir}/.bridge/.dash.${this.dash.getMode()}.json`)?await Promise.all([this.build(!1).catch(n=>console.error(n)),u.unlink(`${this.projectDir}/.bridge/.restartWatchMode`).catch(n=>console.error(n))]):(t.length>0&&await this.unlinkMultiple(t,!1),e.length>0&&await this.updateFiles(e,!1)),this.completedStartUp.dispatch(),this.isDashFree.unlock()}async build(e=!0){e&&await this.isDashFree.lock(),this.dispatch(),await this.dash.build(),e&&this.isDashFree.unlock()}async updateFiles(e,t=!0){t&&await this.isDashFree.lock(),this.dispatch(),await this.dash.updateFiles(e),t&&this.isDashFree.unlock()}async unlink(e,t=!0){await this.isDashFree.lock(),await this.dash.unlink(e,t),this.isDashFree.unlock()}async unlinkMultiple(e,t=!0){t&&await this.isDashFree.lock(),await this.dash.unlinkMultiple(e),t&&this.isDashFree.unlock()}async rename(e,t){await this.isDashFree.lock(),this.dispatch(),await this.dash.rename(e,t),this.isDashFree.unlock()}getCompilerOutputPath(e){return this.dash.getCompilerOutputPath(e)}getFileDependencies(e){return this.dash.getFileDependencies(e)}async setup(){await this.isDashFree.lock(),Or.hasFired||await Or.loadData(),await this.dash.setup(Or),this.isDashFree.unlock(),this.isSetup=!0}async reloadPlugins(){await this.isDashFree.lock(),await this.dash.reload(),this.isDashFree.unlock()}onProgress(e){const t=this.dash.progress.onChange(u=>{u.percentage===1?(t.dispose(),e(1)):e(u.percentage)})}}Lr(a0,self)})();
