var ls=Object.defineProperty;var fs=(Be,Fe,Re)=>Fe in Be?ls(Be,Fe,{enumerable:!0,configurable:!0,writable:!0,value:Re}):Be[Fe]=Re;var b=(Be,Fe,Re)=>(fs(Be,typeof Fe!="symbol"?Fe+"":Fe,Re),Re);(function(){"use strict";const Be=Symbol("Comlink.proxy"),Fe=Symbol("Comlink.endpoint"),Re=Symbol("Comlink.releaseProxy"),Bt=Symbol("Comlink.thrown"),fr=r=>typeof r=="object"&&r!==null||typeof r=="function",mu={canHandle:r=>fr(r)&&r[Be],serialize(r){const{port1:t,port2:e}=new MessageChannel;return St(r,t),[e,[e]]},deserialize(r){return r.start(),Bu(r)}},vu={canHandle:r=>fr(r)&&Bt in r,serialize({value:r}){let t;return r instanceof Error?t={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:t={isError:!1,value:r},[t,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},je=new Map([["proxy",mu],["throw",vu]]);function St(r,t=self){t.addEventListener("message",function e(u){if(!u||!u.data)return;const{id:i,type:s,path:n}=Object.assign({path:[]},u.data),a=(u.data.argumentList||[]).map(Pe);let o;try{const c=n.slice(0,-1).reduce((D,E)=>D[E],r),f=n.reduce((D,E)=>D[E],r);switch(s){case 0:o=f;break;case 1:c[n.slice(-1)[0]]=Pe(u.data.value),o=!0;break;case 2:o=f.apply(c,a);break;case 3:{const D=new f(...a);o=xu(D)}break;case 4:{const{port1:D,port2:E}=new MessageChannel;St(r,E),o=bu(D,[D])}break;case 5:o=void 0;break}}catch(c){o={value:c,[Bt]:0}}Promise.resolve(o).catch(c=>({value:c,[Bt]:0})).then(c=>{const[f,D]=xt(c);t.postMessage(Object.assign(Object.assign({},f),{id:i}),D),s===5&&(t.removeEventListener("message",e),Dr(t))})}),t.start&&t.start()}function wu(r){return r.constructor.name==="MessagePort"}function Dr(r){wu(r)&&r.close()}function Bu(r,t){return bt(r,[],t)}function nt(r){if(r)throw new Error("Proxy has been released and is not useable")}function bt(r,t=[],e=function(){}){let u=!1;const i=new Proxy(e,{get(s,n){if(nt(u),n===Re)return()=>We(r,{type:5,path:t.map(a=>a.toString())}).then(()=>{Dr(r),u=!0});if(n==="then"){if(t.length===0)return{then:()=>i};const a=We(r,{type:0,path:t.map(o=>o.toString())}).then(Pe);return a.then.bind(a)}return bt(r,[...t,n])},set(s,n,a){nt(u);const[o,c]=xt(a);return We(r,{type:1,path:[...t,n].map(f=>f.toString()),value:o},c).then(Pe)},apply(s,n,a){nt(u);const o=t[t.length-1];if(o===Fe)return We(r,{type:4}).then(Pe);if(o==="bind")return bt(r,t.slice(0,-1));const[c,f]=hr(a);return We(r,{type:2,path:t.map(D=>D.toString()),argumentList:c},f).then(Pe)},construct(s,n){nt(u);const[a,o]=hr(n);return We(r,{type:3,path:t.map(c=>c.toString()),argumentList:a},o).then(Pe)}});return i}function Su(r){return Array.prototype.concat.apply([],r)}function hr(r){const t=r.map(xt);return[t.map(e=>e[0]),Su(t.map(e=>e[1]))]}const dr=new WeakMap;function bu(r,t){return dr.set(r,t),r}function xu(r){return Object.assign(r,{[Be]:!0})}function xt(r){for(const[t,e]of je)if(e.canHandle(r)){const[u,i]=e.serialize(r);return[{type:3,name:t,value:u},i]}return[{type:0,value:r},dr.get(r)||[]]}function Pe(r){switch(r.type){case 3:return je.get(r.name).deserialize(r.value);case 0:return r.value}}function We(r,t,e){return new Promise(u=>{const i=_u();r.addEventListener("message",function s(n){!n.data||!n.data.id||n.data.id!==i||(r.removeEventListener("message",s),u(n.data))}),r.start&&r.start(),r.postMessage(Object.assign({id:i},t),e)})}function _u(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var st,ku=new Uint8Array(16);function Tu(){if(!st&&(st=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!st))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return st(ku)}var Ru=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Pu(r){return typeof r=="string"&&Ru.test(r)}for(var Z=[],_t=0;_t<256;++_t)Z.push((_t+256).toString(16).substr(1));function $u(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Z[r[t+0]]+Z[r[t+1]]+Z[r[t+2]]+Z[r[t+3]]+"-"+Z[r[t+4]]+Z[r[t+5]]+"-"+Z[r[t+6]]+Z[r[t+7]]+"-"+Z[r[t+8]]+Z[r[t+9]]+"-"+Z[r[t+10]]+Z[r[t+11]]+Z[r[t+12]]+Z[r[t+13]]+Z[r[t+14]]+Z[r[t+15]]).toLowerCase();if(!Pu(e))throw TypeError("Stringified UUID is invalid");return e}function Ou(r,t,e){r=r||{};var u=r.random||(r.rng||Tu)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,t){e=e||0;for(var i=0;i<16;++i)t[e+i]=u[i];return t}return $u(u)}class pr{constructor(){b(this,"listeners",new Set)}get hasListeners(){return this.listeners.size>0}dispatch(t){this.listeners.forEach(e=>e(t))}on(t,e=!0){if(this.listeners.add(t),e)return{dispose:()=>{this.off(t)}}}off(t){this.listeners.delete(t)}once(t,e=!1){const u=i=>{t(i),this.off(u)};return this.on(u,e)}disposeListeners(){this.listeners=new Set}}class ze extends pr{constructor(e=1){super();b(this,"firedTimes",0);b(this,"data");this.needsToFireAmount=e}get fired(){return new Promise(e=>this.once(e,!1))}get hasFired(){return this.firedTimes>=this.needsToFireAmount}setFiredTimes(e){this.firedTimes=e}resetSignal(){this.data=void 0,this.firedTimes=0}dispatch(e){if(this.firedTimes<this.needsToFireAmount&&this.firedTimes++,this.data=e,this.hasFired)return super.dispatch(e)}on(e,u=!0){return this.hasFired&&e(this.data),super.on(e,u)}}function Hu(){if(!(!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent))||!indexedDB.databases)return Promise.resolve();let t;return new Promise(e=>{const u=()=>indexedDB.databases().finally(e);t=setInterval(u,100),u()}).finally(()=>clearInterval(t))}function Se(r){return new Promise((t,e)=>{r.oncomplete=r.onsuccess=()=>t(r.result),r.onabort=r.onerror=()=>e(r.error)})}function kt(r,t){const e=Hu().then(()=>{const u=indexedDB.open(r);return u.onupgradeneeded=()=>u.result.createObjectStore(t),Se(u)});return(u,i)=>e.then(s=>i(s.transaction(t,u).objectStore(t)))}let Tt;function $e(){return Tt||(Tt=kt("keyval-store","keyval")),Tt}function Rt(r,t=$e()){return t("readonly",e=>Se(e.get(r)))}function Pt(r,t,e=$e()){return e("readwrite",u=>(u.put(t,r),Se(u.transaction)))}function Lu(r,t=$e()){return t("readwrite",e=>(r.forEach(u=>e.put(u[1],u[0])),Se(e.transaction)))}function Iu(r,t=$e()){return t("readonly",e=>Promise.all(r.map(u=>Se(e.get(u)))))}function Nu(r,t=$e()){return t("readwrite",e=>(e.delete(r),Se(e.transaction)))}function Mu(r=$e()){return r("readwrite",t=>(t.clear(),Se(t.transaction)))}function ju(r,t){return r("readonly",e=>(e.openCursor().onsuccess=function(){!this.result||(t(this.result),this.result.continue())},Se(e.transaction)))}function Wu(r=$e()){const t=[];return ju(r,e=>t.push(e.key)).then(()=>t)}const zu=kt("virtual-fs","virtual-fs-store"),Gu=r=>Rt(r,zu);class Ze{constructor(t="virtual-fs"){b(this,"store");this.storeName=t,this.store=kt(t,`${t}-store`)}set(t,e){return Pt(t,e,this.store)}get(t){return Rt(t,this.store)}del(t){return Nu(t,this.store)}setMany(t){return Lu(t,this.store)}getMany(t){return Iu(t,this.store)}clear(){return Mu(this.store)}async has(t){return await Gu(t)!==void 0}keys(){return Wu(this.store)}}class Ar{constructor(t,e,u=[],i=Ou()){b(this,"_idbWrapper",null);b(this,"parent",null);b(this,"isVirtual",!0);b(this,"setupDone",new ze);this._name=e,this.basePath=u,this.uuid=i,t===null?this._idbWrapper=new Ze:t instanceof Ze?this._idbWrapper=t:this.parent=t}get path(){return this.parent?this.parent.path.concat(this.name):this.basePath}get hasParentContext(){return this.path.length>1}get idbKey(){return this.path.length===0?this._name:this.path.join("/")}get idbWrapper(){return this._idbWrapper===null?this.parent.idbWrapper:this._idbWrapper}get name(){return this._name}getParent(){return this.parent}async isSameEntry(t){return t.idbKey===this.idbKey}async queryPermission(t){return"granted"}async requestPermission(t){return"granted"}}const Uu=new TextEncoder,gr=Symbol("writeMethod");class Vu{constructor(t){b(this,"tmpData",new Uint8Array);b(this,"cursorOffset",0);b(this,"locked",!1);this.fileHandle=t}async write(t){let e;if(typeof t=="string")e=Uu.encode(t);else if(t instanceof Blob)e=await t.arrayBuffer().then(u=>new Uint8Array(u));else if("type"in t){if(t.type==="seek")return await this.seek(t.position);if(t.type==="truncate")return await this.truncate(t.size);if(t.type==="write")return t.position&&await this.seek(t.position),await this.write(t.data);throw new Error(`Unknown data type: ${t.type}`)}else ArrayBuffer.isView(t)?e=new Uint8Array(t.buffer):e=new Uint8Array(t);this.tmpData=new Uint8Array([...this.tmpData.slice(0,this.cursorOffset),...e]),this.cursorOffset=this.tmpData.length}async seek(t){this.cursorOffset=Math.floor(t)}async truncate(t){this.tmpData=this.tmpData.slice(0,t),this.cursorOffset>t&&(this.cursorOffset=t)}async close(){await this.fileHandle[gr](this.tmpData)}async abort(){throw new Error("WriteStream was aborted")}getWriter(){}}class De extends Ar{constructor(e,u,i,s=!1,n){super(e,u,n);b(this,"kind","file");b(this,"isFile",!0);b(this,"isDirectory",!1);b(this,"fileData");this.inMemory=s,i?this.setup(i):this.setupDone.dispatch()}get isFileStoredInMemory(){return this.fileData!==void 0}moveData(){if(!this.fileData)throw new Error(`No file data to move to IDB for file "${this.name}"`);const e=this.fileData;return this.fileData=void 0,this.inMemory=!1,e}async setup(e){this.fileData=e;const u=this.path.join("/").startsWith("data/packages");if(this.inMemory||u&&e.length<5e4)return this.inMemory=!0,this.setupDone.dispatch();(!u||globalThis.document)&&await this.updateIdb(e),this.setupDone.dispatch()}async updateIdb(e){await this.idbWrapper.set(this.idbKey,e),this.fileData=void 0}async loadFromIdb(){if(this.fileData)return this.fileData;let e=await this.idbWrapper.get(this.idbKey);if(e===void 0)throw console.log(this.parent),new Error(`File not found: "${this.path.join("/")}"`);return e}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"file",name:this.name,path:this.path,fileData:this.fileData}}static deserialize(e){return new De(e.idbWrapper?new Ze(e.idbWrapper):null,e.name,e.fileData,e.fileData!==void 0,e.path)}async isSameEntry(e){return this.parent===null?!1:super.isSameEntry(e)}async removeSelf(e=!0){await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name)}async getFile(){const e=await this.loadFromIdb();return new File([e],this.name)}async createWritable(){return new Vu(this)}async[gr](e){this.inMemory?this.fileData=e:await this.updateIdb(e)}}class Ku{constructor(){b(this,"listeners",[]);b(this,"isLocked",!1)}lock(){return new Promise(async(t,e)=>{this.isLocked?this.listeners.push(()=>{this.isLocked=!0,t()}):(this.isLocked=!0,t())})}unlock(){if(!this.isLocked)throw new Error("Trying to unlock a mutex that is not locked");this.isLocked=!1,this.listeners.length>0&&this.listeners.shift()()}}class Ju{constructor(){b(this,"mutexMap",new Map)}async lock(t){let e=this.mutexMap.get(t);e||(e=new Ku,this.mutexMap.set(t,e)),await e.lock()}unlock(t){const e=this.mutexMap.get(t);if(!e)throw new Error("Trying to unlock a mutex that does not exist");e.unlock()}}const Cr=new Ju;class se extends Ar{constructor(e,u,i,s=!1,n=[]){super(e,u,n);b(this,"kind","directory");b(this,"isDirectory",!0);b(this,"isFile",!1);this.children=i,this.updateIdb(s)}get isDirectoryInMemory(){return this.children!==void 0}async moveToIdb(){const e=this.allInMemoryChildren();this.idbWrapper.setMany(e.map(u=>[u.idbKey,u.moveData()]))}moveData(){if(!this.children)throw new Error(`No directory data to move to IDB for directory "${this.name}"`);const e=[...this.children.values()].map(u=>u.name);return this.children=void 0,e}allInMemoryChildren(){if(!this.children)return[];const e=[this];for(const u of this.children.values())u instanceof se?u.isDirectoryInMemory&&e.push(...u.allInMemoryChildren()):u.isFileStoredInMemory&&e.push(u);return e}async lockAccess(){await Cr.lock(this.idbKey)}unlockAccess(){Cr.unlock(this.idbKey)}async updateIdb(e=!1){await this.lockAccess(),e&&await this.idbWrapper.clear(),!this.children&&!await this.hasChildren()&&await this.idbWrapper.set(this.idbKey,[]),this.setupDone.dispatch(),this.unlockAccess()}async addChild(e){this.children?this.children.set(e.name,e):await this.idbWrapper.set(this.idbKey,[...new Set([...await this.fromIdb(),e.name])])}async fromIdb(){var e;return(e=await this.idbWrapper.get(this.idbKey))!=null?e:[]}async getChildren(){return this.children?[...this.children.values()]:(await Promise.all((await this.fromIdb()).map(e=>this.getChild(e)))).filter(e=>e!==void 0)}getChildPath(e){return this.path.concat(e).join("/")}async getChild(e){if(this.children)return this.children.get(e);if(await this.has(e)){const u=await this.idbWrapper.get(this.getChildPath(e));if(u instanceof Uint8Array)return new De(this,e);if(Array.isArray(u))return new se(this,e)}}async deleteChild(e,u=!0){u&&await this.lockAccess(),this.children?this.children.delete(e):await this.idbWrapper.set(this.idbKey,(await this.fromIdb()).filter(i=>i!==e)),u&&this.unlockAccess()}async hasChildren(){return this.children?this.children.size>0:(await this.fromIdb()).length>0}async has(e){return this.children?this.children.has(e):(await this.fromIdb()).includes(e)}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"directory",name:this.name,path:this.path,children:this.children?[...this.children.values()].map(e=>e.serialize()):void 0}}static deserialize(e,u=null){var s;const i=new se(u||new Ze(e.idbWrapper),e.name,void 0,!1,e.path);for(const n of(s=e.children)!=null?s:[])n.kind==="directory"?i.addChild(se.deserialize(n,i)):i.addChild(new De(i,n.name,n.fileData));return i}async getDirectoryHandle(e,{create:u}={}){await this.lockAccess();let i=await this.getChild(e);if(i&&i.kind==="file")throw this.unlockAccess(),new Error(`TypeMismatch: Expected directory with name "${e}", found file`);if(!i)if(u)i=new se(this,e,this.children?new Map:void 0),await i.setupDone.fired,await this.addChild(i);else throw this.unlockAccess(),new Error(`No file with the name ${e} exists in this folder`);return this.unlockAccess(),i}async getFileHandle(e,{create:u,initialData:i}={}){await this.lockAccess();let s=await this.getChild(e);if(s&&s.kind==="directory")throw this.unlockAccess(),new Error(`TypeMismatch: Expected file with name "${e}", found directory`);if(!s)if(u)s=new De(this,e,i!=null?i:new Uint8Array),await s.setupDone.fired,await this.addChild(s);else throw this.unlockAccess(),new Error(`No file with the name ${e} exists in this folder`);return this.unlockAccess(),s}async removeEntry(e,{recursive:u}={}){await this.lockAccess();const i=await this.getChild(e);if(i){if(i.kind==="directory"&&!u&&await i.hasChildren())throw this.unlockAccess(),new Error('Cannot remove directory with children without "recursive" option being set to true')}else throw this.unlockAccess(),new Error(`No entry with the name ${e} exists in this folder`);await i.removeSelf(!0,!1),await this.deleteChild(e,!1),this.unlockAccess()}async resolve(e){const u=[e.name];let i=e.getParent();for(;i!==null&&!await i.isSameEntry(this);)u.unshift(i.name),i=i.getParent();return i===null?null:u}async removeSelf(e=!0,u=!0){u&&await this.lockAccess();const i=await this.getChildren();for(const s of i)await s.removeSelf(!1);this.children||await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name),u&&this.unlockAccess()}[Symbol.asyncIterator](){return this.entries()}keys(){return this.children?this.children.keys():{childNamesPromise:this.fromIdb(),[Symbol.asyncIterator](){return{i:0,childNamesPromise:this.childNamesPromise,async next(){const e=await this.childNamesPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}entries(){return this.children?this.children.entries():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:[e[this.i].name,e[this.i++]]}:{done:!0}}}}}}values(){return this.children?this.children.values():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}getEntries(){return this.values()}getDirectory(e,u={}){return this.getDirectoryHandle(e,u)}getFile(e,u={}){return this.getFileHandle(e,u)}}je.set("VirtualFileHandle",{canHandle:r=>r instanceof De,serialize:r=>[r.serialize(),[]],deserialize:r=>new De(null,r.name,r.fileData)}),je.set("VirtualDirectoryHandle",{canHandle:r=>r instanceof se,serialize:r=>[r.serialize(),[]],deserialize:r=>se.deserialize(r)}),je.set("VirtualDirectoryHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({directory:t})=>t instanceof se),serialize:r=>[r.map(({directory:t,...e})=>({directory:t.serialize(),...e})),[]],deserialize:r=>r.map(({directory:t,...e})=>({directory:se.deserialize(t),...e}))}),je.set("VirtualFileHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({fileHandle:t})=>t instanceof De),serialize:r=>[r.map(({fileHandle:t,...e})=>({fileHandle:t.serialize(),...e})),[]],deserialize:r=>r.map(({fileHandle:t,...e})=>({fileHandle:De.deserialize(t),...e}))});var Xu=Object.defineProperty,qu=Object.defineProperties,Qu=Object.getOwnPropertyDescriptors,Fr=Object.getOwnPropertySymbols,Zu=Object.prototype.hasOwnProperty,Yu=Object.prototype.propertyIsEnumerable,Er=(r,t,e)=>t in r?Xu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ge=(r,t)=>{for(var e in t||(t={}))Zu.call(t,e)&&Er(r,e,t[e]);if(Fr)for(var e of Fr(t))Yu.call(t,e)&&Er(r,e,t[e]);return r},at=(r,t)=>qu(r,Qu(t));function yr(r,t){for(var e=0,u=r.length-1;u>=0;u--){var i=r[u];i==="."?r.splice(u,1):i===".."?(r.splice(u,1),e++):e&&(r.splice(u,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}var ei=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,$t=function(r){return ei.exec(r).slice(1)};function ot(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var u=e>=0?arguments[e]:"/";if(typeof u!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!u)continue;r=u+"/"+r,t=u.charAt(0)==="/"}return r=yr(Lt(r.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+r||"."}function Ot(r){var t=Ht(r),e=ri(r,-1)==="/";return r=yr(Lt(r.split("/"),function(u){return!!u}),!t).join("/"),!r&&!t&&(r="."),r&&e&&(r+="/"),(t?"/":"")+r}function Ht(r){return r.charAt(0)==="/"}function mr(){var r=Array.prototype.slice.call(arguments,0);return Ot(Lt(r,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function vr(r,t){r=ot(r).substr(1),t=ot(t).substr(1);function e(c){for(var f=0;f<c.length&&c[f]==="";f++);for(var D=c.length-1;D>=0&&c[D]==="";D--);return f>D?[]:c.slice(f,D-f+1)}for(var u=e(r.split("/")),i=e(t.split("/")),s=Math.min(u.length,i.length),n=s,a=0;a<s;a++)if(u[a]!==i[a]){n=a;break}for(var o=[],a=n;a<u.length;a++)o.push("..");return o=o.concat(i.slice(n)),o.join("/")}var wr="/",Br=":";function Sr(r){var t=$t(r),e=t[0],u=t[1];return!e&&!u?".":(u&&(u=u.substr(0,u.length-1)),e+u)}function br(r,t){var e=$t(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function xr(r){return $t(r)[3]}var ti={extname:xr,basename:br,dirname:Sr,sep:wr,delimiter:Br,relative:vr,join:mr,isAbsolute:Ht,normalize:Ot,resolve:ot};function Lt(r,t){if(r.filter)return r.filter(t);for(var e=[],u=0;u<r.length;u++)t(r[u],u,r)&&e.push(r[u]);return e}var ri="ab".substr(-1)==="b"?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)},It=Object.freeze({__proto__:null,resolve:ot,normalize:Ot,isAbsolute:Ht,join:mr,relative:vr,sep:wr,delimiter:Br,dirname:Sr,basename:br,extname:xr,default:ti});function _r(){throw new Error("setTimeout has not been defined")}function kr(){throw new Error("clearTimeout has not been defined")}var be=_r,xe=kr,Ue;typeof window<"u"?Ue=window:typeof self<"u"?Ue=self:Ue={},typeof Ue.setTimeout=="function"&&(be=setTimeout),typeof Ue.clearTimeout=="function"&&(xe=clearTimeout);function Tr(r){if(be===setTimeout)return setTimeout(r,0);if((be===_r||!be)&&setTimeout)return be=setTimeout,setTimeout(r,0);try{return be(r,0)}catch{try{return be.call(null,r,0)}catch{return be.call(this,r,0)}}}function ui(r){if(xe===clearTimeout)return clearTimeout(r);if((xe===kr||!xe)&&clearTimeout)return xe=clearTimeout,clearTimeout(r);try{return xe(r)}catch{try{return xe.call(null,r)}catch{return xe.call(this,r)}}}var Ee=[],Ve=!1,Oe,ct=-1;function ii(){!Ve||!Oe||(Ve=!1,Oe.length?Ee=Oe.concat(Ee):ct=-1,Ee.length&&Rr())}function Rr(){if(!Ve){var r=Tr(ii);Ve=!0;for(var t=Ee.length;t;){for(Oe=Ee,Ee=[];++ct<t;)Oe&&Oe[ct].run();ct=-1,t=Ee.length}Oe=null,Ve=!1,ui(r)}}function ni(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];Ee.push(new Pr(r,t)),Ee.length===1&&!Ve&&Tr(Rr)}function Pr(r,t){this.fun=r,this.array=t}Pr.prototype.run=function(){this.fun.apply(null,this.array)};var si="browser",ai="browser",oi=!0,ci=[],li="",fi={},Di={},hi={};function He(){}var di=He,pi=He,Ai=He,gi=He,Ci=He,Fi=He,Ei=He;function yi(r){throw new Error("process.binding is not supported")}function mi(){return"/"}function vi(r){throw new Error("process.chdir is not supported")}function wi(){return 0}var Ke=Ue.performance||{},Bi=Ke.now||Ke.mozNow||Ke.msNow||Ke.oNow||Ke.webkitNow||function(){return new Date().getTime()};function Si(r){var t=Bi.call(Ke)*.001,e=Math.floor(t),u=Math.floor(t%1*1e9);return r&&(e=e-r[0],u=u-r[1],u<0&&(e--,u+=1e9)),[e,u]}var bi=new Date;function xi(){var r=new Date,t=r-bi;return t/1e3}var _i={nextTick:ni,title:si,browser:oi,env:{NODE_ENV:"production"},argv:ci,version:li,versions:fi,on:di,addListener:pi,once:Ai,off:gi,removeListener:Ci,removeAllListeners:Fi,emit:Ei,binding:yi,cwd:mi,chdir:vi,umask:wi,hrtime:Si,platform:ai,release:Di,config:hi,uptime:xi};function ki(r,t,e){return e={path:t,exports:{},require:function(u,i){return Ti(u,i==null?e.path:i)}},r(e,e.exports),e.exports}function Ti(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}const he="\\\\/",$r=`[^${he}]`,ye="\\.",Ri="\\+",Pi="\\?",lt="\\/",$i="(?=.)",Or="[^/]",Nt=`(?:${lt}|$)`,Hr=`(?:^|${lt})`,Mt=`${ye}{1,2}${Nt}`,Oi=`(?!${ye})`,Hi=`(?!${Hr}${Mt})`,Li=`(?!${ye}{0,1}${Nt})`,Ii=`(?!${Mt})`,Ni=`[^.${lt}]`,Mi=`${Or}*?`,Lr={DOT_LITERAL:ye,PLUS_LITERAL:Ri,QMARK_LITERAL:Pi,SLASH_LITERAL:lt,ONE_CHAR:$i,QMARK:Or,END_ANCHOR:Nt,DOTS_SLASH:Mt,NO_DOT:Oi,NO_DOTS:Hi,NO_DOT_SLASH:Li,NO_DOTS_SLASH:Ii,QMARK_NO_DOT:Ni,STAR:Mi,START_ANCHOR:Hr},ji=at(Ge({},Lr),{SLASH_LITERAL:`[${he}]`,QMARK:$r,STAR:`${$r}*?`,DOTS_SLASH:`${ye}{1,2}(?:[${he}]|$)`,NO_DOT:`(?!${ye})`,NO_DOTS:`(?!(?:^|[${he}])${ye}{1,2}(?:[${he}]|$))`,NO_DOT_SLASH:`(?!${ye}{0,1}(?:[${he}]|$))`,NO_DOTS_SLASH:`(?!${ye}{1,2}(?:[${he}]|$))`,QMARK_NO_DOT:`[^.${he}]`,START_ANCHOR:`(?:^|[${he}])`,END_ANCHOR:`(?:[${he}]|$)`}),Wi={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var Le={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Wi,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:It.sep,extglobChars(r){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${r.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(r){return r===!0?ji:Lr}},q=ki(function(r,t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:u,REGEX_SPECIAL_CHARS:i,REGEX_SPECIAL_CHARS_GLOBAL:s}=Le;t.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),t.hasRegexChars=n=>i.test(n),t.isRegexChar=n=>n.length===1&&t.hasRegexChars(n),t.escapeRegex=n=>n.replace(s,"\\$1"),t.toPosixSlashes=n=>n.replace(e,"/"),t.removeBackslashes=n=>n.replace(u,a=>a==="\\"?"":a),t.supportsLookbehinds=()=>{const n=_i.version.slice(1).split(".").map(Number);return n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10},t.isWindows=n=>n&&typeof n.windows=="boolean"?n.windows:It.sep==="\\",t.escapeLast=(n,a,o)=>{const c=n.lastIndexOf(a,o);return c===-1?n:n[c-1]==="\\"?t.escapeLast(n,a,c-1):`${n.slice(0,c)}\\${n.slice(c)}`},t.removePrefix=(n,a={})=>{let o=n;return o.startsWith("./")&&(o=o.slice(2),a.prefix="./"),o},t.wrapOutput=(n,a={},o={})=>{const c=o.contains?"":"^",f=o.contains?"":"$";let D=`${c}(?:${n})${f}`;return a.negated===!0&&(D=`(?:^(?!${D}).*$)`),D}});const{CHAR_ASTERISK:jt,CHAR_AT:zi,CHAR_BACKWARD_SLASH:Ye,CHAR_COMMA:Gi,CHAR_DOT:Wt,CHAR_EXCLAMATION_MARK:zt,CHAR_FORWARD_SLASH:Ir,CHAR_LEFT_CURLY_BRACE:Gt,CHAR_LEFT_PARENTHESES:Ut,CHAR_LEFT_SQUARE_BRACKET:Ui,CHAR_PLUS:Vi,CHAR_QUESTION_MARK:Nr,CHAR_RIGHT_CURLY_BRACE:Ki,CHAR_RIGHT_PARENTHESES:Mr,CHAR_RIGHT_SQUARE_BRACKET:Ji}=Le,jr=r=>r===Ir||r===Ye,Wr=r=>{r.isPrefix!==!0&&(r.depth=r.isGlobstar?1/0:1)};var Xi=(r,t)=>{const e=t||{},u=r.length-1,i=e.parts===!0||e.scanToEnd===!0,s=[],n=[],a=[];let o=r,c=-1,f=0,D=0,E=!1,y=!1,v=!1,A=!1,m=!1,g=!1,w=!1,S=!1,k=!1,x=!1,N=0,M,B,O={value:"",depth:0,isGlob:!1};const K=()=>c>=u,d=()=>o.charCodeAt(c+1),I=()=>(M=B,o.charCodeAt(++c));for(;c<u;){B=I();let Y;if(B===Ye){w=O.backslashes=!0,B=I(),B===Gt&&(g=!0);continue}if(g===!0||B===Gt){for(N++;K()!==!0&&(B=I());){if(B===Ye){w=O.backslashes=!0,I();continue}if(B===Gt){N++;continue}if(g!==!0&&B===Wt&&(B=I())===Wt){if(E=O.isBrace=!0,v=O.isGlob=!0,x=!0,i===!0)continue;break}if(g!==!0&&B===Gi){if(E=O.isBrace=!0,v=O.isGlob=!0,x=!0,i===!0)continue;break}if(B===Ki&&(N--,N===0)){g=!1,E=O.isBrace=!0,x=!0;break}}if(i===!0)continue;break}if(B===Ir){if(s.push(c),n.push(O),O={value:"",depth:0,isGlob:!1},x===!0)continue;if(M===Wt&&c===f+1){f+=2;continue}D=c+1;continue}if(e.noext!==!0&&(B===Vi||B===zi||B===jt||B===Nr||B===zt)===!0&&d()===Ut){if(v=O.isGlob=!0,A=O.isExtglob=!0,x=!0,B===zt&&c===f&&(k=!0),i===!0){for(;K()!==!0&&(B=I());){if(B===Ye){w=O.backslashes=!0,B=I();continue}if(B===Mr){v=O.isGlob=!0,x=!0;break}}continue}break}if(B===jt){if(M===jt&&(m=O.isGlobstar=!0),v=O.isGlob=!0,x=!0,i===!0)continue;break}if(B===Nr){if(v=O.isGlob=!0,x=!0,i===!0)continue;break}if(B===Ui){for(;K()!==!0&&(Y=I());){if(Y===Ye){w=O.backslashes=!0,I();continue}if(Y===Ji){y=O.isBracket=!0,v=O.isGlob=!0,x=!0;break}}if(i===!0)continue;break}if(e.nonegate!==!0&&B===zt&&c===f){S=O.negated=!0,f++;continue}if(e.noparen!==!0&&B===Ut){if(v=O.isGlob=!0,i===!0){for(;K()!==!0&&(B=I());){if(B===Ut){w=O.backslashes=!0,B=I();continue}if(B===Mr){x=!0;break}}continue}break}if(v===!0){if(x=!0,i===!0)continue;break}}e.noext===!0&&(A=!1,v=!1);let L=o,ae="",h="";f>0&&(ae=o.slice(0,f),o=o.slice(f),D-=f),L&&v===!0&&D>0?(L=o.slice(0,D),h=o.slice(D)):v===!0?(L="",h=o):L=o,L&&L!==""&&L!=="/"&&L!==o&&jr(L.charCodeAt(L.length-1))&&(L=L.slice(0,-1)),e.unescape===!0&&(h&&(h=q.removeBackslashes(h)),L&&w===!0&&(L=q.removeBackslashes(L)));const l={prefix:ae,input:r,start:f,base:L,glob:h,isBrace:E,isBracket:y,isGlob:v,isExtglob:A,isGlobstar:m,negated:S,negatedExtglob:k};if(e.tokens===!0&&(l.maxDepth=0,jr(B)||n.push(O),l.tokens=n),e.parts===!0||e.tokens===!0){let Y;for(let H=0;H<s.length;H++){const ne=Y?Y+1:f,ee=s[H],re=r.slice(ne,ee);e.tokens&&(H===0&&f!==0?(n[H].isPrefix=!0,n[H].value=ae):n[H].value=re,Wr(n[H]),l.maxDepth+=n[H].depth),(H!==0||re!=="")&&a.push(re),Y=ee}if(Y&&Y+1<r.length){const H=r.slice(Y+1);a.push(H),e.tokens&&(n[n.length-1].value=H,Wr(n[n.length-1]),l.maxDepth+=n[n.length-1].depth)}l.slashes=s,l.parts=a}return l};const{MAX_LENGTH:ft,POSIX_REGEX_SOURCE:qi,REGEX_NON_SPECIAL_CHARS:Qi,REGEX_SPECIAL_CHARS_BACKREF:Zi,REPLACEMENTS:zr}=Le,Yi=(r,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...r,t);r.sort();const e=`[${r.join("-")}]`;try{new RegExp(e)}catch{return r.map(i=>q.escapeRegex(i)).join("..")}return e},Je=(r,t)=>`Missing ${r}: "${t}" - use "\\\\${t}" to match literal characters`,Gr=(r,t)=>{if(typeof r!="string")throw new TypeError("Expected a string");r=zr[r]||r;const e=Ge({},t),u=typeof e.maxLength=="number"?Math.min(ft,e.maxLength):ft;let i=r.length;if(i>u)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${u}`);const s={type:"bos",value:"",output:e.prepend||""},n=[s],a=e.capture?"":"?:",o=q.isWindows(t),c=Le.globChars(o),f=Le.extglobChars(c),{DOT_LITERAL:D,PLUS_LITERAL:E,SLASH_LITERAL:y,ONE_CHAR:v,DOTS_SLASH:A,NO_DOT:m,NO_DOT_SLASH:g,NO_DOTS_SLASH:w,QMARK:S,QMARK_NO_DOT:k,STAR:x,START_ANCHOR:N}=c,M=F=>`(${a}(?:(?!${N}${F.dot?A:D}).)*?)`,B=e.dot?"":m,O=e.dot?S:k;let K=e.bash===!0?M(e):x;e.capture&&(K=`(${K})`),typeof e.noext=="boolean"&&(e.noextglob=e.noext);const d={input:r,index:-1,start:0,dot:e.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:n};r=q.removePrefix(r,d),i=r.length;const I=[],L=[],ae=[];let h=s,l;const Y=()=>d.index===i-1,H=d.peek=(F=1)=>r[d.index+F],ne=d.advance=()=>r[++d.index]||"",ee=()=>r.slice(d.index+1),re=(F="",G=0)=>{d.consumed+=F,d.index+=G},ge=F=>{d.output+=F.output!=null?F.output:F.value,re(F.value)},it=()=>{let F=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)ne(),d.start++,F++;return F%2===0?!1:(d.negated=!0,d.start++,!0)},Te=F=>{d[F]++,ae.push(F)},Ce=F=>{d[F]--,ae.pop()},R=F=>{if(h.type==="globstar"){const G=d.braces>0&&(F.type==="comma"||F.type==="brace"),C=F.extglob===!0||I.length&&(F.type==="pipe"||F.type==="paren");F.type!=="slash"&&F.type!=="paren"&&!G&&!C&&(d.output=d.output.slice(0,-h.output.length),h.type="star",h.value="*",h.output=K,d.output+=h.output)}if(I.length&&F.type!=="paren"&&(I[I.length-1].inner+=F.value),(F.value||F.output)&&ge(F),h&&h.type==="text"&&F.type==="text"){h.value+=F.value,h.output=(h.output||"")+F.value;return}F.prev=h,n.push(F),h=F},Me=(F,G)=>{const C=at(Ge({},f[G]),{conditions:1,inner:""});C.prev=h,C.parens=d.parens,C.output=d.output;const P=(e.capture?"(":"")+C.open;Te("parens"),R({type:F,value:G,output:d.output?"":v}),R({type:"paren",extglob:!0,value:ne(),output:P}),I.push(C)},vt=F=>{let G=F.close+(e.capture?")":""),C;if(F.type==="negate"){let P=K;F.inner&&F.inner.length>1&&F.inner.includes("/")&&(P=M(e)),(P!==K||Y()||/^\)+$/.test(ee()))&&(G=F.close=`)$))${P}`),F.inner.includes("*")&&(C=ee())&&/^\.[^\\/.]+$/.test(C)&&(G=F.close=`)${C})${P})`),F.prev.type==="bos"&&(d.negatedExtglob=!0)}R({type:"paren",extglob:!0,value:l,output:G}),Ce("parens")};if(e.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(r)){let F=!1,G=r.replace(Zi,(C,P,J,ie,X,lr)=>ie==="\\"?(F=!0,C):ie==="?"?P?P+ie+(X?S.repeat(X.length):""):lr===0?O+(X?S.repeat(X.length):""):S.repeat(J.length):ie==="."?D.repeat(J.length):ie==="*"?P?P+ie+(X?K:""):K:P?C:`\\${C}`);return F===!0&&(e.unescape===!0?G=G.replace(/\\/g,""):G=G.replace(/\\+/g,C=>C.length%2===0?"\\\\":C?"\\":"")),G===r&&e.contains===!0?(d.output=r,d):(d.output=q.wrapOutput(G,d,t),d)}for(;!Y();){if(l=ne(),l==="\0")continue;if(l==="\\"){const C=H();if(C==="/"&&e.bash!==!0||C==="."||C===";")continue;if(!C){l+="\\",R({type:"text",value:l});continue}const P=/^\\+/.exec(ee());let J=0;if(P&&P[0].length>2&&(J=P[0].length,d.index+=J,J%2!==0&&(l+="\\")),e.unescape===!0?l=ne():l+=ne(),d.brackets===0){R({type:"text",value:l});continue}}if(d.brackets>0&&(l!=="]"||h.value==="["||h.value==="[^")){if(e.posix!==!1&&l===":"){const C=h.value.slice(1);if(C.includes("[")&&(h.posix=!0,C.includes(":"))){const P=h.value.lastIndexOf("["),J=h.value.slice(0,P),ie=h.value.slice(P+2),X=qi[ie];if(X){h.value=J+X,d.backtrack=!0,ne(),!s.output&&n.indexOf(h)===1&&(s.output=v);continue}}}(l==="["&&H()!==":"||l==="-"&&H()==="]")&&(l=`\\${l}`),l==="]"&&(h.value==="["||h.value==="[^")&&(l=`\\${l}`),e.posix===!0&&l==="!"&&h.value==="["&&(l="^"),h.value+=l,ge({value:l});continue}if(d.quotes===1&&l!=='"'){l=q.escapeRegex(l),h.value+=l,ge({value:l});continue}if(l==='"'){d.quotes=d.quotes===1?0:1,e.keepQuotes===!0&&R({type:"text",value:l});continue}if(l==="("){Te("parens"),R({type:"paren",value:l});continue}if(l===")"){if(d.parens===0&&e.strictBrackets===!0)throw new SyntaxError(Je("opening","("));const C=I[I.length-1];if(C&&d.parens===C.parens+1){vt(I.pop());continue}R({type:"paren",value:l,output:d.parens?")":"\\)"}),Ce("parens");continue}if(l==="["){if(e.nobracket===!0||!ee().includes("]")){if(e.nobracket!==!0&&e.strictBrackets===!0)throw new SyntaxError(Je("closing","]"));l=`\\${l}`}else Te("brackets");R({type:"bracket",value:l});continue}if(l==="]"){if(e.nobracket===!0||h&&h.type==="bracket"&&h.value.length===1){R({type:"text",value:l,output:`\\${l}`});continue}if(d.brackets===0){if(e.strictBrackets===!0)throw new SyntaxError(Je("opening","["));R({type:"text",value:l,output:`\\${l}`});continue}Ce("brackets");const C=h.value.slice(1);if(h.posix!==!0&&C[0]==="^"&&!C.includes("/")&&(l=`/${l}`),h.value+=l,ge({value:l}),e.literalBrackets===!1||q.hasRegexChars(C))continue;const P=q.escapeRegex(h.value);if(d.output=d.output.slice(0,-h.value.length),e.literalBrackets===!0){d.output+=P,h.value=P;continue}h.value=`(${a}${P}|${h.value})`,d.output+=h.value;continue}if(l==="{"&&e.nobrace!==!0){Te("braces");const C={type:"brace",value:l,output:"(",outputIndex:d.output.length,tokensIndex:d.tokens.length};L.push(C),R(C);continue}if(l==="}"){const C=L[L.length-1];if(e.nobrace===!0||!C){R({type:"text",value:l,output:l});continue}let P=")";if(C.dots===!0){const J=n.slice(),ie=[];for(let X=J.length-1;X>=0&&(n.pop(),J[X].type!=="brace");X--)J[X].type!=="dots"&&ie.unshift(J[X].value);P=Yi(ie,e),d.backtrack=!0}if(C.comma!==!0&&C.dots!==!0){const J=d.output.slice(0,C.outputIndex),ie=d.tokens.slice(C.tokensIndex);C.value=C.output="\\{",l=P="\\}",d.output=J;for(const X of ie)d.output+=X.output||X.value}R({type:"brace",value:l,output:P}),Ce("braces"),L.pop();continue}if(l==="|"){I.length>0&&I[I.length-1].conditions++,R({type:"text",value:l});continue}if(l===","){let C=l;const P=L[L.length-1];P&&ae[ae.length-1]==="braces"&&(P.comma=!0,C="|"),R({type:"comma",value:l,output:C});continue}if(l==="/"){if(h.type==="dot"&&d.index===d.start+1){d.start=d.index+1,d.consumed="",d.output="",n.pop(),h=s;continue}R({type:"slash",value:l,output:y});continue}if(l==="."){if(d.braces>0&&h.type==="dot"){h.value==="."&&(h.output=D);const C=L[L.length-1];h.type="dots",h.output+=l,h.value+=l,C.dots=!0;continue}if(d.braces+d.parens===0&&h.type!=="bos"&&h.type!=="slash"){R({type:"text",value:l,output:D});continue}R({type:"dot",value:l,output:D});continue}if(l==="?"){if(!(h&&h.value==="(")&&e.noextglob!==!0&&H()==="("&&H(2)!=="?"){Me("qmark",l);continue}if(h&&h.type==="paren"){const P=H();let J=l;if(P==="<"&&!q.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(h.value==="("&&!/[!=<:]/.test(P)||P==="<"&&!/<([!=]|\w+>)/.test(ee()))&&(J=`\\${l}`),R({type:"text",value:l,output:J});continue}if(e.dot!==!0&&(h.type==="slash"||h.type==="bos")){R({type:"qmark",value:l,output:k});continue}R({type:"qmark",value:l,output:S});continue}if(l==="!"){if(e.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){Me("negate",l);continue}if(e.nonegate!==!0&&d.index===0){it();continue}}if(l==="+"){if(e.noextglob!==!0&&H()==="("&&H(2)!=="?"){Me("plus",l);continue}if(h&&h.value==="("||e.regex===!1){R({type:"plus",value:l,output:E});continue}if(h&&(h.type==="bracket"||h.type==="paren"||h.type==="brace")||d.parens>0){R({type:"plus",value:l});continue}R({type:"plus",value:E});continue}if(l==="@"){if(e.noextglob!==!0&&H()==="("&&H(2)!=="?"){R({type:"at",extglob:!0,value:l,output:""});continue}R({type:"text",value:l});continue}if(l!=="*"){(l==="$"||l==="^")&&(l=`\\${l}`);const C=Qi.exec(ee());C&&(l+=C[0],d.index+=C[0].length),R({type:"text",value:l});continue}if(h&&(h.type==="globstar"||h.star===!0)){h.type="star",h.star=!0,h.value+=l,h.output=K,d.backtrack=!0,d.globstar=!0,re(l);continue}let F=ee();if(e.noextglob!==!0&&/^\([^?]/.test(F)){Me("star",l);continue}if(h.type==="star"){if(e.noglobstar===!0){re(l);continue}const C=h.prev,P=C.prev,J=C.type==="slash"||C.type==="bos",ie=P&&(P.type==="star"||P.type==="globstar");if(e.bash===!0&&(!J||F[0]&&F[0]!=="/")){R({type:"star",value:l,output:""});continue}const X=d.braces>0&&(C.type==="comma"||C.type==="brace"),lr=I.length&&(C.type==="pipe"||C.type==="paren");if(!J&&C.type!=="paren"&&!X&&!lr){R({type:"star",value:l,output:""});continue}for(;F.slice(0,3)==="/**";){const wt=r[d.index+4];if(wt&&wt!=="/")break;F=F.slice(3),re("/**",3)}if(C.type==="bos"&&Y()){h.type="globstar",h.value+=l,h.output=M(e),d.output=h.output,d.globstar=!0,re(l);continue}if(C.type==="slash"&&C.prev.type!=="bos"&&!ie&&Y()){d.output=d.output.slice(0,-(C.output+h.output).length),C.output=`(?:${C.output}`,h.type="globstar",h.output=M(e)+(e.strictSlashes?")":"|$)"),h.value+=l,d.globstar=!0,d.output+=C.output+h.output,re(l);continue}if(C.type==="slash"&&C.prev.type!=="bos"&&F[0]==="/"){const wt=F[1]!==void 0?"|$":"";d.output=d.output.slice(0,-(C.output+h.output).length),C.output=`(?:${C.output}`,h.type="globstar",h.output=`${M(e)}${y}|${y}${wt})`,h.value+=l,d.output+=C.output+h.output,d.globstar=!0,re(l+ne()),R({type:"slash",value:"/",output:""});continue}if(C.type==="bos"&&F[0]==="/"){h.type="globstar",h.value+=l,h.output=`(?:^|${y}|${M(e)}${y})`,d.output=h.output,d.globstar=!0,re(l+ne()),R({type:"slash",value:"/",output:""});continue}d.output=d.output.slice(0,-h.output.length),h.type="globstar",h.output=M(e),h.value+=l,d.output+=h.output,d.globstar=!0,re(l);continue}const G={type:"star",value:l,output:K};if(e.bash===!0){G.output=".*?",(h.type==="bos"||h.type==="slash")&&(G.output=B+G.output),R(G);continue}if(h&&(h.type==="bracket"||h.type==="paren")&&e.regex===!0){G.output=l,R(G);continue}(d.index===d.start||h.type==="slash"||h.type==="dot")&&(h.type==="dot"?(d.output+=g,h.output+=g):e.dot===!0?(d.output+=w,h.output+=w):(d.output+=B,h.output+=B),H()!=="*"&&(d.output+=v,h.output+=v)),R(G)}for(;d.brackets>0;){if(e.strictBrackets===!0)throw new SyntaxError(Je("closing","]"));d.output=q.escapeLast(d.output,"["),Ce("brackets")}for(;d.parens>0;){if(e.strictBrackets===!0)throw new SyntaxError(Je("closing",")"));d.output=q.escapeLast(d.output,"("),Ce("parens")}for(;d.braces>0;){if(e.strictBrackets===!0)throw new SyntaxError(Je("closing","}"));d.output=q.escapeLast(d.output,"{"),Ce("braces")}if(e.strictSlashes!==!0&&(h.type==="star"||h.type==="bracket")&&R({type:"maybe_slash",value:"",output:`${y}?`}),d.backtrack===!0){d.output="";for(const F of d.tokens)d.output+=F.output!=null?F.output:F.value,F.suffix&&(d.output+=F.suffix)}return d};Gr.fastpaths=(r,t)=>{const e=Ge({},t),u=typeof e.maxLength=="number"?Math.min(ft,e.maxLength):ft,i=r.length;if(i>u)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${u}`);r=zr[r]||r;const s=q.isWindows(t),{DOT_LITERAL:n,SLASH_LITERAL:a,ONE_CHAR:o,DOTS_SLASH:c,NO_DOT:f,NO_DOTS:D,NO_DOTS_SLASH:E,STAR:y,START_ANCHOR:v}=Le.globChars(s),A=e.dot?D:f,m=e.dot?E:f,g=e.capture?"":"?:",w={negated:!1,prefix:""};let S=e.bash===!0?".*?":y;e.capture&&(S=`(${S})`);const k=B=>B.noglobstar===!0?S:`(${g}(?:(?!${v}${B.dot?c:n}).)*?)`,x=B=>{switch(B){case"*":return`${A}${o}${S}`;case".*":return`${n}${o}${S}`;case"*.*":return`${A}${S}${n}${o}${S}`;case"*/*":return`${A}${S}${a}${o}${m}${S}`;case"**":return A+k(e);case"**/*":return`(?:${A}${k(e)}${a})?${m}${o}${S}`;case"**/*.*":return`(?:${A}${k(e)}${a})?${m}${S}${n}${o}${S}`;case"**/.*":return`(?:${A}${k(e)}${a})?${n}${o}${S}`;default:{const O=/^(.*?)\.(\w+)$/.exec(B);if(!O)return;const K=x(O[1]);return K?K+n+O[2]:void 0}}},N=q.removePrefix(r,w);let M=x(N);return M&&e.strictSlashes!==!0&&(M+=`${a}?`),M};var Vt=Gr;const en=r=>r&&typeof r=="object"&&!Array.isArray(r),U=(r,t,e=!1)=>{if(Array.isArray(r)){const f=r.map(E=>U(E,t,e));return E=>{for(const y of f){const v=y(E);if(v)return v}return!1}}const u=en(r)&&r.tokens&&r.input;if(r===""||typeof r!="string"&&!u)throw new TypeError("Expected pattern to be a non-empty string");const i=t||{},s=q.isWindows(t),n=u?U.compileRe(r,t):U.makeRe(r,t,!1,!0),a=n.state;delete n.state;let o=()=>!1;if(i.ignore){const f=at(Ge({},t),{ignore:null,onMatch:null,onResult:null});o=U(i.ignore,f,e)}const c=(f,D=!1)=>{const{isMatch:E,match:y,output:v}=U.test(f,n,t,{glob:r,posix:s}),A={glob:r,state:a,regex:n,posix:s,input:f,output:v,match:y,isMatch:E};return typeof i.onResult=="function"&&i.onResult(A),E===!1?(A.isMatch=!1,D?A:!1):o(f)?(typeof i.onIgnore=="function"&&i.onIgnore(A),A.isMatch=!1,D?A:!1):(typeof i.onMatch=="function"&&i.onMatch(A),D?A:!0)};return e&&(c.state=a),c};U.test=(r,t,e,{glob:u,posix:i}={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");if(r==="")return{isMatch:!1,output:""};const s=e||{},n=s.format||(i?q.toPosixSlashes:null);let a=r===u,o=a&&n?n(r):r;return a===!1&&(o=n?n(r):r,a=o===u),(a===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?a=U.matchBase(r,t,e,i):a=t.exec(o)),{isMatch:Boolean(a),match:a,output:o}},U.matchBase=(r,t,e,u=q.isWindows(e))=>(t instanceof RegExp?t:U.makeRe(t,e)).test(It.basename(r)),U.isMatch=(r,t,e)=>U(t,e)(r),U.parse=(r,t)=>Array.isArray(r)?r.map(e=>U.parse(e,t)):Vt(r,at(Ge({},t),{fastpaths:!1})),U.scan=(r,t)=>Xi(r,t),U.compileRe=(r,t,e=!1,u=!1)=>{if(e===!0)return r.output;const i=t||{},s=i.contains?"":"^",n=i.contains?"":"$";let a=`${s}(?:${r.output})${n}`;r&&r.negated===!0&&(a=`^(?!${a}).*$`);const o=U.toRegex(a,t);return u===!0&&(o.state=r),o},U.makeRe=(r,t={},e=!1,u=!1)=>{if(!r||typeof r!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(r[0]==="."||r[0]==="*")&&(i.output=Vt.fastpaths(r,t)),i.output||(i=Vt(r,t)),U.compileRe(i,t,e,u)},U.toRegex=(r,t)=>{try{const e=t||{};return new RegExp(r,e.flags||(e.nocase?"i":""))}catch(e){if(t&&t.debug===!0)throw e;return/$^/}},U.constants=Le;var tn=U,rn=tn;function Kt(r,t){return Array.isArray(t)?t.some(e=>Kt(r,e)):rn(t)(r)}function Dt(r,t,e){var u,i;if(t===void 0)return;if(r.length===0)return e(t);if(typeof t!="object"||t===null)return;const s=r.shift();if(s==="**"){for(;r.length>0&&r[0]==="*";)r.shift();const n=["**",...r].join("/"),a=new Set;Ur("",t,a);for(const o of a)Kt(o,n)&&Dt(o.split("/"),t,e)}else if(s.startsWith("*")){let n;s.length>=1&&(n=new RegExp((i=(u=s.match(/(\*{)(.+)(})/))==null?void 0:u[2])!=null?i:".*"));for(const a in t)n&&a.match(n)!==null&&Dt([...r],t[a],e)}else Dt(r,t[s],e)}function Ur(r,t,e){for(const u in t)e.add(`${r}${u}`),typeof t[u]=="object"&&Ur(`${r}${u}/`,t[u],e)}function Vr(r,t,e){const u=r.length===0||r==="/"?[]:r.split("/");return Dt(u,t,e)}function un(r,t){let e=!1;for(const u of t)if(Vr(u,r,()=>e=!0),e)return!0;return!1}new TextEncoder;function nn(r,t){const e=Kr(r),u=Kr(t),i=e.pop(),s=u.pop(),n=qr(e,u);return n!==0?n:i&&s?qr(i.split("."),s.split(".")):i||s?i?-1:1:0}const sn=(r,t,e)=>{ln(e);const u=nn(r,t);return Qr[e].includes(u)},an=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Kr=r=>{if(typeof r!="string")throw new TypeError("Invalid argument expected string");const t=r.match(an);if(!t)throw new Error(`Invalid argument not valid semver ('${r}' received)`);return t.shift(),t},Jr=r=>r==="*"||r==="x"||r==="X",Xr=r=>{const t=parseInt(r,10);return isNaN(t)?r:t},on=(r,t)=>typeof r!=typeof t?[String(r),String(t)]:[r,t],cn=(r,t)=>{if(Jr(r)||Jr(t))return 0;const[e,u]=on(Xr(r),Xr(t));return e>u?1:e<u?-1:0},qr=(r,t)=>{for(let e=0;e<Math.max(r.length,t.length);e++){const u=cn(r[e]||0,t[e]||0);if(u!==0)return u}return 0},Qr={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Zr=Object.keys(Qr),ln=r=>{if(typeof r!="string")throw new TypeError(`Invalid operator type, expected string but got ${typeof r}`);if(Zr.indexOf(r)===-1)throw new Error(`Invalid operator, expected one of ${Zr.join("|")}`)};function de(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function Yr(r,t){for(var e="",u=0,i=-1,s=0,n,a=0;a<=r.length;++a){if(a<r.length)n=r.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(e.length<2||u!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",u=0):(e=e.slice(0,o),u=e.length-1-e.lastIndexOf("/")),i=a,s=0;continue}}else if(e.length===2||e.length===1){e="",u=0,i=a,s=0;continue}}t&&(e.length>0?e+="/..":e="..",u=2)}else e.length>0?e+="/"+r.slice(i+1,a):e=r.slice(i+1,a),u=a-i-1;i=a,s=0}else n===46&&s!==-1?++s:s=-1}return e}function fn(r,t){var e=t.dir||t.root,u=t.base||(t.name||"")+(t.ext||"");return e?e===t.root?e+u:e+r+u:u}var Xe={resolve:function(){for(var t="",e=!1,u,i=arguments.length-1;i>=-1&&!e;i--){var s;i>=0?s=arguments[i]:(u===void 0&&(u=process.cwd()),s=u),de(s),s.length!==0&&(t=s+"/"+t,e=s.charCodeAt(0)===47)}return t=Yr(t,!e),e?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(de(t),t.length===0)return".";var e=t.charCodeAt(0)===47,u=t.charCodeAt(t.length-1)===47;return t=Yr(t,!e),t.length===0&&!e&&(t="."),t.length>0&&u&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return de(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,e=0;e<arguments.length;++e){var u=arguments[e];de(u),u.length>0&&(t===void 0?t=u:t+="/"+u)}return t===void 0?".":Xe.normalize(t)},relative:function(t,e){if(de(t),de(e),t===e||(t=Xe.resolve(t),e=Xe.resolve(e),t===e))return"";for(var u=1;u<t.length&&t.charCodeAt(u)===47;++u);for(var i=t.length,s=i-u,n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var a=e.length,o=a-n,c=s<o?s:o,f=-1,D=0;D<=c;++D){if(D===c){if(o>c){if(e.charCodeAt(n+D)===47)return e.slice(n+D+1);if(D===0)return e.slice(n+D)}else s>c&&(t.charCodeAt(u+D)===47?f=D:D===0&&(f=0));break}var E=t.charCodeAt(u+D),y=e.charCodeAt(n+D);if(E!==y)break;E===47&&(f=D)}var v="";for(D=u+f+1;D<=i;++D)(D===i||t.charCodeAt(D)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+e.slice(n+f):(n+=f,e.charCodeAt(n)===47&&++n,e.slice(n))},_makeLong:function(t){return t},dirname:function(t){if(de(t),t.length===0)return".";for(var e=t.charCodeAt(0),u=e===47,i=-1,s=!0,n=t.length-1;n>=1;--n)if(e=t.charCodeAt(n),e===47){if(!s){i=n;break}}else s=!1;return i===-1?u?"/":".":u&&i===1?"//":t.slice(0,i)},basename:function(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');de(t);var u=0,i=-1,s=!0,n;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,o=-1;for(n=t.length-1;n>=0;--n){var c=t.charCodeAt(n);if(c===47){if(!s){u=n+1;break}}else o===-1&&(s=!1,o=n+1),a>=0&&(c===e.charCodeAt(a)?--a===-1&&(i=n):(a=-1,i=o))}return u===i?i=o:i===-1&&(i=t.length),t.slice(u,i)}else{for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!s){u=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":t.slice(u,i)}},extname:function(t){de(t);for(var e=-1,u=0,i=-1,s=!0,n=0,a=t.length-1;a>=0;--a){var o=t.charCodeAt(a);if(o===47){if(!s){u=a+1;break}continue}i===-1&&(s=!1,i=a+1),o===46?e===-1?e=a:n!==1&&(n=1):e!==-1&&(n=-1)}return e===-1||i===-1||n===0||n===1&&e===i-1&&e===u+1?"":t.slice(e,i)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return fn("/",t)},parse:function(t){de(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var u=t.charCodeAt(0),i=u===47,s;i?(e.root="/",s=1):s=0;for(var n=-1,a=0,o=-1,c=!0,f=t.length-1,D=0;f>=s;--f){if(u=t.charCodeAt(f),u===47){if(!c){a=f+1;break}continue}o===-1&&(c=!1,o=f+1),u===46?n===-1?n=f:D!==1&&(D=1):n!==-1&&(D=-1)}return n===-1||o===-1||D===0||D===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&i?e.base=e.name=t.slice(1,o):e.base=e.name=t.slice(a,o)):(a===0&&i?(e.name=t.slice(1,n),e.base=t.slice(1,o)):(e.name=t.slice(a,n),e.base=t.slice(a,o)),e.ext=t.slice(n,o)),a>0?e.dir=t.slice(0,a-1):i&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Xe.posix=Xe;var ce=Xe,Dn=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,hn=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,dn=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Jt={Space_Separator:Dn,ID_Start:hn,ID_Continue:dn},V={isSpaceSeparator(r){return typeof r=="string"&&Jt.Space_Separator.test(r)},isIdStartChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="$"||r==="_"||Jt.ID_Start.test(r))},isIdContinueChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r>="0"&&r<="9"||r==="$"||r==="_"||r==="\u200C"||r==="\u200D"||Jt.ID_Continue.test(r))},isDigit(r){return typeof r=="string"&&/[0-9]/.test(r)},isHexDigit(r){return typeof r=="string"&&/[0-9A-Fa-f]/.test(r)}};let Xt,ue,me,ht,_e,le,Q,qt,et;var pn=function(t,e){Xt=String(t),ue="start",me=[],ht=0,_e=1,le=0,Q=void 0,qt=void 0,et=void 0;do Q=An(),Fn[ue]();while(Q.type!=="eof");return typeof e=="function"?eu({"":et},"",e):et};function eu(r,t,e){const u=r[t];if(u!=null&&typeof u=="object")for(const i in u){const s=eu(u,i,e);s===void 0?delete u[i]:u[i]=s}return e.call(r,t,u)}let T,_,tt,ve,$;function An(){for(T="default",_="",tt=!1,ve=1;;){$=we();const r=tu[T]();if(r)return r}}function we(){if(Xt[ht])return String.fromCodePoint(Xt.codePointAt(ht))}function p(){const r=we();return r===`
`?(_e++,le=0):r?le+=r.length:le++,r&&(ht+=r.length),r}const tu={default(){switch($){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":p();return;case"/":p(),T="comment";return;case void 0:return p(),j("eof")}if(V.isSpaceSeparator($)){p();return}return tu[ue]()},comment(){switch($){case"*":p(),T="multiLineComment";return;case"/":p(),T="singleLineComment";return}throw W(p())},multiLineComment(){switch($){case"*":p(),T="multiLineCommentAsterisk";return;case void 0:throw W(p())}p()},multiLineCommentAsterisk(){switch($){case"*":p();return;case"/":p(),T="default";return;case void 0:throw W(p())}p(),T="multiLineComment"},singleLineComment(){switch($){case`
`:case"\r":case"\u2028":case"\u2029":p(),T="default";return;case void 0:return p(),j("eof")}p()},value(){switch($){case"{":case"[":return j("punctuator",p());case"n":return p(),Ie("ull"),j("null",null);case"t":return p(),Ie("rue"),j("boolean",!0);case"f":return p(),Ie("alse"),j("boolean",!1);case"-":case"+":p()==="-"&&(ve=-1),T="sign";return;case".":_=p(),T="decimalPointLeading";return;case"0":_=p(),T="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":_=p(),T="decimalInteger";return;case"I":return p(),Ie("nfinity"),j("numeric",1/0);case"N":return p(),Ie("aN"),j("numeric",NaN);case'"':case"'":tt=p()==='"',_="",T="string";return}throw W(p())},identifierNameStartEscape(){if($!=="u")throw W(p());p();const r=Qt();switch(r){case"$":case"_":break;default:if(!V.isIdStartChar(r))throw ru();break}_+=r,T="identifierName"},identifierName(){switch($){case"$":case"_":case"\u200C":case"\u200D":_+=p();return;case"\\":p(),T="identifierNameEscape";return}if(V.isIdContinueChar($)){_+=p();return}return j("identifier",_)},identifierNameEscape(){if($!=="u")throw W(p());p();const r=Qt();switch(r){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!V.isIdContinueChar(r))throw ru();break}_+=r,T="identifierName"},sign(){switch($){case".":_=p(),T="decimalPointLeading";return;case"0":_=p(),T="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":_=p(),T="decimalInteger";return;case"I":return p(),Ie("nfinity"),j("numeric",ve*(1/0));case"N":return p(),Ie("aN"),j("numeric",NaN)}throw W(p())},zero(){switch($){case".":_+=p(),T="decimalPoint";return;case"e":case"E":_+=p(),T="decimalExponent";return;case"x":case"X":_+=p(),T="hexadecimal";return}return j("numeric",ve*0)},decimalInteger(){switch($){case".":_+=p(),T="decimalPoint";return;case"e":case"E":_+=p(),T="decimalExponent";return}if(V.isDigit($)){_+=p();return}return j("numeric",ve*Number(_))},decimalPointLeading(){if(V.isDigit($)){_+=p(),T="decimalFraction";return}throw W(p())},decimalPoint(){switch($){case"e":case"E":_+=p(),T="decimalExponent";return}if(V.isDigit($)){_+=p(),T="decimalFraction";return}return j("numeric",ve*Number(_))},decimalFraction(){switch($){case"e":case"E":_+=p(),T="decimalExponent";return}if(V.isDigit($)){_+=p();return}return j("numeric",ve*Number(_))},decimalExponent(){switch($){case"+":case"-":_+=p(),T="decimalExponentSign";return}if(V.isDigit($)){_+=p(),T="decimalExponentInteger";return}throw W(p())},decimalExponentSign(){if(V.isDigit($)){_+=p(),T="decimalExponentInteger";return}throw W(p())},decimalExponentInteger(){if(V.isDigit($)){_+=p();return}return j("numeric",ve*Number(_))},hexadecimal(){if(V.isHexDigit($)){_+=p(),T="hexadecimalInteger";return}throw W(p())},hexadecimalInteger(){if(V.isHexDigit($)){_+=p();return}return j("numeric",ve*Number(_))},string(){switch($){case"\\":p(),_+=gn();return;case'"':if(tt)return p(),j("string",_);_+=p();return;case"'":if(!tt)return p(),j("string",_);_+=p();return;case`
`:case"\r":throw W(p());case"\u2028":case"\u2029":En($);break;case void 0:throw W(p())}_+=p()},start(){switch($){case"{":case"[":return j("punctuator",p())}T="value"},beforePropertyName(){switch($){case"$":case"_":_=p(),T="identifierName";return;case"\\":p(),T="identifierNameStartEscape";return;case"}":return j("punctuator",p());case'"':case"'":tt=p()==='"',T="string";return}if(V.isIdStartChar($)){_+=p(),T="identifierName";return}throw W(p())},afterPropertyName(){if($===":")return j("punctuator",p());throw W(p())},beforePropertyValue(){T="value"},afterPropertyValue(){switch($){case",":case"}":return j("punctuator",p())}throw W(p())},beforeArrayValue(){if($==="]")return j("punctuator",p());T="value"},afterArrayValue(){switch($){case",":case"]":return j("punctuator",p())}throw W(p())},end(){throw W(p())}};function j(r,t){return{type:r,value:t,line:_e,column:le}}function Ie(r){for(const t of r){if(we()!==t)throw W(p());p()}}function gn(){switch(we()){case"b":return p(),"\b";case"f":return p(),"\f";case"n":return p(),`
`;case"r":return p(),"\r";case"t":return p(),"	";case"v":return p(),"\v";case"0":if(p(),V.isDigit(we()))throw W(p());return"\0";case"x":return p(),Cn();case"u":return p(),Qt();case`
`:case"\u2028":case"\u2029":return p(),"";case"\r":return p(),we()===`
`&&p(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw W(p());case void 0:throw W(p())}return p()}function Cn(){let r="",t=we();if(!V.isHexDigit(t)||(r+=p(),t=we(),!V.isHexDigit(t)))throw W(p());return r+=p(),String.fromCodePoint(parseInt(r,16))}function Qt(){let r="",t=4;for(;t-- >0;){const e=we();if(!V.isHexDigit(e))throw W(p());r+=p()}return String.fromCodePoint(parseInt(r,16))}const Fn={start(){if(Q.type==="eof")throw Ne();Zt()},beforePropertyName(){switch(Q.type){case"identifier":case"string":qt=Q.value,ue="afterPropertyName";return;case"punctuator":dt();return;case"eof":throw Ne()}},afterPropertyName(){if(Q.type==="eof")throw Ne();ue="beforePropertyValue"},beforePropertyValue(){if(Q.type==="eof")throw Ne();Zt()},beforeArrayValue(){if(Q.type==="eof")throw Ne();if(Q.type==="punctuator"&&Q.value==="]"){dt();return}Zt()},afterPropertyValue(){if(Q.type==="eof")throw Ne();switch(Q.value){case",":ue="beforePropertyName";return;case"}":dt()}},afterArrayValue(){if(Q.type==="eof")throw Ne();switch(Q.value){case",":ue="beforeArrayValue";return;case"]":dt()}},end(){}};function Zt(){let r;switch(Q.type){case"punctuator":switch(Q.value){case"{":r={};break;case"[":r=[];break}break;case"null":case"boolean":case"numeric":case"string":r=Q.value;break}if(et===void 0)et=r;else{const t=me[me.length-1];Array.isArray(t)?t.push(r):t[qt]=r}if(r!==null&&typeof r=="object")me.push(r),Array.isArray(r)?ue="beforeArrayValue":ue="beforePropertyName";else{const t=me[me.length-1];t==null?ue="end":Array.isArray(t)?ue="afterArrayValue":ue="afterPropertyValue"}}function dt(){me.pop();const r=me[me.length-1];r==null?ue="end":Array.isArray(r)?ue="afterArrayValue":ue="afterPropertyValue"}function W(r){return pt(r===void 0?`JSON5: invalid end of input at ${_e}:${le}`:`JSON5: invalid character '${uu(r)}' at ${_e}:${le}`)}function Ne(){return pt(`JSON5: invalid end of input at ${_e}:${le}`)}function ru(){return le-=5,pt(`JSON5: invalid identifier character at ${_e}:${le}`)}function En(r){console.warn(`JSON5: '${uu(r)}' in strings is not valid ECMAScript; consider escaping`)}function uu(r){const t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[r])return t[r];if(r<" "){const e=r.charCodeAt(0).toString(16);return"\\x"+("00"+e).substring(e.length)}return r}function pt(r){const t=new SyntaxError(r);return t.lineNumber=_e,t.columnNumber=le,t}var yn=function(t,e,u){const i=[];let s="",n,a,o="",c;if(e!=null&&typeof e=="object"&&!Array.isArray(e)&&(u=e.space,c=e.quote,e=e.replacer),typeof e=="function")a=e;else if(Array.isArray(e)){n=[];for(const A of e){let m;typeof A=="string"?m=A:(typeof A=="number"||A instanceof String||A instanceof Number)&&(m=String(A)),m!==void 0&&n.indexOf(m)<0&&n.push(m)}}return u instanceof Number?u=Number(u):u instanceof String&&(u=String(u)),typeof u=="number"?u>0&&(u=Math.min(10,Math.floor(u)),o="          ".substr(0,u)):typeof u=="string"&&(o=u.substr(0,10)),f("",{"":t});function f(A,m){let g=m[A];switch(g!=null&&(typeof g.toJSON5=="function"?g=g.toJSON5(A):typeof g.toJSON=="function"&&(g=g.toJSON(A))),a&&(g=a.call(m,A,g)),g instanceof Number?g=Number(g):g instanceof String?g=String(g):g instanceof Boolean&&(g=g.valueOf()),g){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof g=="string")return D(g);if(typeof g=="number")return String(g);if(typeof g=="object")return Array.isArray(g)?v(g):E(g)}function D(A){const m={"'":.1,'"':.2},g={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let w="";for(let k=0;k<A.length;k++){const x=A[k];switch(x){case"'":case'"':m[x]++,w+=x;continue;case"\0":if(V.isDigit(A[k+1])){w+="\\x00";continue}}if(g[x]){w+=g[x];continue}if(x<" "){let N=x.charCodeAt(0).toString(16);w+="\\x"+("00"+N).substring(N.length);continue}w+=x}const S=c||Object.keys(m).reduce((k,x)=>m[k]<m[x]?k:x);return w=w.replace(new RegExp(S,"g"),g[S]),S+w+S}function E(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let m=s;s=s+o;let g=n||Object.keys(A),w=[];for(const k of g){const x=f(k,A);if(x!==void 0){let N=y(k)+":";o!==""&&(N+=" "),N+=x,w.push(N)}}let S;if(w.length===0)S="{}";else{let k;if(o==="")k=w.join(","),S="{"+k+"}";else{let x=`,
`+s;k=w.join(x),S=`{
`+s+k+`,
`+m+"}"}}return i.pop(),s=m,S}function y(A){if(A.length===0)return D(A);const m=String.fromCodePoint(A.codePointAt(0));if(!V.isIdStartChar(m))return D(A);for(let g=m.length;g<A.length;g++)if(!V.isIdContinueChar(String.fromCodePoint(A.codePointAt(g))))return D(A);return A}function v(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let m=s;s=s+o;let g=[];for(let S=0;S<A.length;S++){const k=f(String(S),A);g.push(k!==void 0?k:"null")}let w;if(g.length===0)w="[]";else if(o===""){let S=g.join(",");w="["+S+"]"}else{let S=`,
`+s,k=g.join(S);w=`[
`+s+k+`,
`+m+"]"}return i.pop(),s=m,w}},At={parse:pn,stringify:yn};const Yt={behaviorPack:"./BP",resourcePack:"./RP",skinPack:"./SP",worldTemplate:"./WT"};class mn{constructor(t){this.basePath=t,this.data={}}async refreshConfig(){this.data=await this.readConfig()}async setup(){await this.refreshConfig()}get(){return this.data}getRelativePackRoot(t){var e,u;return(u=(e=this.data.packs)==null?void 0:e[t])!=null?u:Yt[t]}getAbsolutePackRoot(t){return this.resolvePackPath(t)}resolvePackPath(t,e){return!e&&!t?this.basePath:!t&&e?ce.join(this.basePath,e):!e&&t?ce.join(this.basePath,this.getRelativePackRoot(t)):ce.join(this.basePath,`${this.getRelativePackRoot(t)}/${e}`)}getAvailablePackPaths(){var t;const e=[];for(const u of Object.keys((t=this.data.packs)!=null?t:{}))e.push(this.resolvePackPath(u));return e}getAvailablePacks(){var t;const e={};for(const u in(t=this.data.packs)!=null?t:{})e[u]=this.resolvePackPath(u);return e}async save(){await this.writeConfig(this.data)}}class vn{constructor(t){this.projectConfig=t,this.packTypes=[],this.extensionPackTypes=new Set}setProjectConfig(t){this.projectConfig=t}get all(){return this.packTypes.concat(...Array.from(this.extensionPackTypes.values()))}getFromId(t){return this.all.find(e=>e.id===t)}get(t,e=!1){var u;let i=(u=this.projectConfig)==null?void 0:u.getAvailablePacks();(!i||e)&&(i=Object.fromEntries(Object.keys(Yt).map(s=>{var n;const a=(n=this.projectConfig)==null?void 0:n.resolvePackPath(s);return a?[s,a]:null}).filter(s=>s!==null)));for(const s in i)if(t.startsWith(i[s]))return this.getFromId(s)}getId(t){var e,u;return(u=(e=this.get(t))==null?void 0:e.id)!=null?u:"unknown"}addExtensionPackType(t){return this.extensionPackTypes.add(t),{dispose:()=>this.extensionPackTypes.delete(t)}}}class wn{constructor(t,e){this.projectConfig=t,this.isMatch=e,this.pluginFileTypes=new Set,this._fileTypes=[]}get fileTypes(){return this._fileTypes}set fileTypes(t){this._fileTypes=t.sort((e,u)=>e.add==="post"&&u.add!=="post"?1:e.add!=="post"&&u.add==="post"||e.add==="pre"&&u.add!=="pre"?-1:e.add!=="pre"&&u.add==="pre"?1:0)}get all(){return this.fileTypes.concat([...this.pluginFileTypes.values()])}setProjectConfig(t){this.projectConfig=t}addPluginFileType(t){return this.pluginFileTypes.add(t),{dispose:()=>this.pluginFileTypes.delete(t)}}getPluginFileTypes(){return[...this.pluginFileTypes.values()]}setPluginFileTypes(t=[]){this.pluginFileTypes.clear(),t.forEach(e=>this.pluginFileTypes.add(e))}get(t,e,u=!0){var i,s,n,a,o,c,f,D,E,y,v,A,m;const g=t?ce.extname(t):null;if(!!g)for(const w of this.all){if(e!==void 0&&e===w.id)return w;if(!t)continue;const S=((i=w.detect)==null?void 0:i.packType)===void 0?[]:Array.isArray((s=w.detect)==null?void 0:s.packType)?(n=w.detect)==null?void 0:n.packType:[(a=w.detect)==null?void 0:a.packType],k=(o=w.detect)==null?void 0:o.fileExtensions,x=!!((c=w.detect)!=null&&c.scope),N=Array.isArray((f=w.detect)==null?void 0:f.scope)?(D=w.detect)==null?void 0:D.scope:[(E=w.detect)==null?void 0:E.scope],M=!!((y=w.detect)!=null&&y.matcher),B=Array.isArray((v=w.detect)==null?void 0:v.matcher)?(A=w.detect)==null?void 0:A.matcher:[(m=w.detect)==null?void 0:m.matcher];if(!(u&&k&&!k.includes(g)))if(x){if(this.prefixMatchers(S,N).some(O=>t.startsWith(O)))return w}else if(M){const O=this.prefixMatchers(S,B.filter(d=>!d.startsWith("!"))),K=this.prefixMatchers(S,B.filter(d=>d.startsWith("!")).map(d=>d.slice(1)));if(this.isMatch(t,O)&&!this.isMatch(t,K))return w}else throw console.log(w),new Error('Invalid file definition, no "detect" properties')}}prefixMatchers(t,e){if(!this.projectConfig)return[];if(t.length===0)return e.map(i=>this.projectConfig.resolvePackPath(void 0,i));const u=[];for(const i of t)for(const s of e)u.push(this.projectConfig.resolvePackPath(i,s));return u}getIds(){const t=[];for(const e of this.all)t.push(e.id);return t}async guessFolder(t){var e;const u=(f,D)=>{var E,y;let v=Array.isArray(f)?f[0]:f;v.endsWith("/")||(v+="/");const A=(y=(E=this.projectConfig)==null?void 0:E.getAbsolutePackRoot(D))!=null?y:"./unknown";return ce.join(A,v)},i=`.${t.name.split(".").pop()}`,s=this.all.filter(({detect:f})=>{var D;return!f||!f.scope?!1:(D=f.fileExtensions)==null?void 0:D.includes(i)}),n=s.length===1,a=i!==".json"&&s.length>0;if(n||a){const{detect:f}=s[0];return u(f.scope,Array.isArray(f.packType)?f.packType[0]:(e=f.packType)!=null?e:"behaviorPack")}if(i!==".json")return null;const o=await t.getFile();let c;try{c=At.parse(await o.text())}catch{return null}for(const{type:f,detect:D}of s){if(typeof f=="string"&&f!=="json")continue;const{scope:E,fileContent:y,packType:v="behaviorPack"}=D!=null?D:{};if(!(!E||!y)&&!!un(c,y))return u(E,Array.isArray(v)?v[0]:v)}return null}getId(t){var e,u;return(u=(e=this.get(t))==null?void 0:e.id)!=null?u:"unknown"}isJsonFile(t){var e,u;const i=(u=(e=this.get(t))==null?void 0:e.meta)==null?void 0:u.language;return i?i==="json":t.endsWith(".json")}}class Bn extends wn{constructor(e){super(e,Kt);b(this,"ready",new ze);b(this,"lCacheFiles",{});b(this,"lCacheFilesLoaded",new ze);b(this,"packSpiderFiles",{});b(this,"packSpiderFilesLoaded",new ze)}setProjectConfig(e){this.projectConfig=e}async setup(e){this.fileTypes.length>0||(await e.fired,this.fileTypes=await e.readJSON("data/packages/minecraftBedrock/fileDefinitions.json"),this.loadLightningCache(e),this.loadPackSpider(e),this.ready.dispatch())}getMonacoSchemaEntries(){return this.fileTypes.map(({detect:e={},schema:u})=>{if(!e.matcher)return null;const i=(e==null?void 0:e.packType)===void 0?[]:Array.isArray(e==null?void 0:e.packType)?e==null?void 0:e.packType:[e==null?void 0:e.packType];return{fileMatch:this.prefixMatchers(i,Array.isArray(e.matcher)?[...e.matcher]:[e.matcher]).map(s=>encodeURI(s).replaceAll(/;|,|@|&|=|\+|\$|\.|!|'|\(|\)|#/g,"*")),uri:u}}).filter(e=>e!==null).flat()}async loadLightningCache(e){var s;const u=await e.readJSON("data/packages/minecraftBedrock/lightningCaches.json"),i=n=>Object.entries(u).find(([a])=>a.endsWith(n));for(const n of this.fileTypes){if(!n.lightningCache)continue;const[a,o]=(s=i(n.lightningCache))!=null?s:[];if(!a)throw new Error(`Lightning cache file "${n.lightningCache}" for file type "${n.id}" not found`);this.lCacheFiles[n.lightningCache]=o}this.lCacheFilesLoaded.dispatch()}async getLightningCache(e){var i,s;const{lightningCache:u}=(i=this.get(e))!=null?i:{};return u?(await this.lCacheFilesLoaded.fired,(s=this.lCacheFiles[u])!=null?s:[]):[]}async loadPackSpider(e){const u=await e.readJSON("data/packages/minecraftBedrock/packSpiders.json");this.packSpiderFiles=Object.fromEntries(this.fileTypes.map(({id:i,packSpider:s})=>{if(!!s)return[i,u[`file:///data/packages/minecraftBedrock/packSpider/${s}`]]}).filter(i=>i!==void 0)),this.packSpiderFilesLoaded.dispatch()}async getPackSpiderData(){return await this.packSpiderFilesLoaded.fired,this.packSpiderFiles}}class Sn{constructor(t,e,u){this.taskService=t,this.current=e,this.total=u}addToCurrent(t){this.current+=t!=null?t:1,this.taskService.dispatch([this.getCurrent(),this.getTotal()])}addToTotal(t){this.total+=t!=null?t:1,this.taskService.dispatch([this.getCurrent(),this.getTotal()])}getTotal(){return this.total}getCurrent(){return this.current}setTotal(t){this.total=t}}class bn extends pr{constructor(){super(...arguments);b(this,"lastDispatch",0);b(this,"progress")}async start(e){this.progress=new Sn(this,0,0);const u=await this.onStart(e);return this.dispatch([this.progress.getCurrent(),this.progress.getCurrent()]),u}dispatch(e){this.lastDispatch+200>Date.now()||(super.dispatch(e),this.lastDispatch=Date.now())}}const iu=ce.dirname,er=ce.join,xn=ce.extname,tr=ce.basename;ce.resolve,ce.relative;class _n{constructor(t,e,u){b(this,"store");b(this,"fs");b(this,"_visitedFiles",0);b(this,"_totalFiles",0);this.fileType=e,this.projectPath=u,this.fs=t}get visitedFiles(){return this._visitedFiles}get totalFiles(){return this._totalFiles}reset(){this.store={}}async setup(){var s,n;let t=[];try{t=(await this.fs.readFile(".bridge/.lightningCache").then(a=>a.text())).split(`
`)}catch{}if(this.store={},this._visitedFiles=0,this._totalFiles=0,t.length===0)return;let e=0;t[0].startsWith("$formatVersion: ")&&(e=Number((n=(s=t[0].match(/\d+/))==null?void 0:s[0])!=null?n:0),t.shift());const u=this.projectPath;let i="unknown";for(const a of t){if(a==="")continue;if(a[0]==="#"){i=a.slice(1),this.store[i]={};continue}let[o,c,f]=a.split("|");e===0&&(o=er(u,o)),this._totalFiles++,this.store[i][o]={lastModified:Number(c),data:f?JSON.parse(f):void 0}}}async saveStore(t=!0){let e=`$formatVersion: 1
`;const u=[];for(const i in this.store){e+=`#${i}
`;for(const s in this.store[i]){const n=this.store[i][s];if(!n.isForeignFile){if(t&&!n.visited){u.push(s),delete this.store[i][s];continue}e+=`${s}|${n.lastModified}`,n.data?e+=`|${JSON.stringify(n.data)}
`:e+=`
`}}}return await this.fs.writeFile(".bridge/.lightningCache",e),u}add(t,{lastModified:e,data:u,isForeignFile:i},s=this.fileType.getId(t)){var n,a;this.store[s]||(this.store[s]={}),this._visitedFiles++,this.store[s][t]||this._totalFiles++,this.store[s][t]={visited:!0,lastModified:e,isForeignFile:i,data:u!=null?u:(a=(n=this.store[s])==null?void 0:n[t])==null?void 0:a.data}}remove(t,e=this.fileType.getId(t)){!this.store[e]||delete this.store[e][t]}rename(t,e){const u=/\.\w+$/.test(t);for(const i in this.store)for(const s in this.store[i])if(u&&s===t||!u&&s.startsWith(t)){const n=s.replace(t,e),a=this.fileType.getId(n);this.store[a][n]=this.store[i][s],delete this.store[i][s]}}setVisited(t,e,u=this.fileType.getId(t)){var i,s;this._visitedFiles++,(s=(i=this.store)==null?void 0:i[u])!=null&&s[t]&&(this.store[u][t].visited=e)}getLastModified(t,e=this.fileType.getId(t)){var u,i;return(i=(u=this.store[e])==null?void 0:u[t])==null?void 0:i.lastModified}find(t,e,u,i=!1){var a,o;if(!u||u.length===0)return[];const s=this.store[t],n=[];for(const c in s)if(((o=(a=s[c].data)==null?void 0:a[e])!=null?o:[]).find(D=>u.includes(D)))if(i)n.push(c);else return[c];return n}findMultiple(t,e,u,i=!1){const s=[];for(const n of t){const a=this.find(n,e,u,i);if(a.length>0&&!i)return a;s.push(...a)}return s}async forEach(t,e){const u=this.store[t],i=[];for(const s in u)i.push(e(s,u[s]));await Promise.all(i)}get(t,e=this.fileType.getId(t)){var u,i;return(i=(u=this.store[e])==null?void 0:u[t])!=null?i:{}}has(t,e=this.fileType.getId(t)){var u;return!!((u=this.store[e])!=null&&u[t])}allFiles(t){const e=[];if(t&&this.store)for(const u in this.store[t])this.store[t][u].isForeignFile||e.push(u);else for(const u in this.store)for(const i in this.store[u])this.store[u][i].isForeignFile||e.push(i);return e}getAllFrom(t,e){var i,s,n;const u={};for(const a in(i=this.store[t])!=null?i:{}){if(e&&e!==a)continue;const o=(n=((s=this.store[t][a])!=null?s:{}).data)!=null?n:{};for(const c in o)u[c]?u[c].push(...o[c]):u[c]=[...o[c]]}for(const a in u)u[a]=[...new Set(u[a])];return u}async getSchemasFor(t,e){const u=await this.getAllFrom(t,e),i=`file:///data/packages/minecraftBedrock/schema/${t}/dynamic`,s=[];for(const n in u)s.push({uri:`${i}/${e?"currentContext/":""}${n}Enum.json`,schema:{type:"string",enum:u[n]}}),s.push({uri:`${i}/${e?"currentContext/":""}${n}Property.json`,schema:{properties:Object.fromEntries(u[n].map(a=>[a,{}]))}});return s}getCacheDataFor(t,e,u){const i=this.getAllFrom(t,e);return typeof u=="string"?i[u]:i}}class kn{constructor(t,e){b(this,"packSpiderFiles",new Map);this.packIndexer=t,this.lightningStore=e}get fileType(){return this.packIndexer.fileType}async setup(t){const e=await this.fileType.getPackSpiderData();for(const u in e){const i=e[u],s=this.lightningStore.allFiles(u);for(const n of s){const a=new Tn({lightningStore:this.lightningStore,filePath:n,fileType:u,instructions:i});this.packSpiderFiles.set(n,a)}}}getDiagnostics(t){const e=this.packSpiderFiles.get(t);return e?e.provideDiagnostics():[]}getConnectedFiles(t){const e=this.packSpiderFiles.get(t);return e?[...e.loadAllConnected()]:[]}async updateFile(t){}}class Tn{constructor({lightningStore:t,filePath:e,fileType:u,instructions:i}){b(this,"lightningStore");b(this,"filePath");b(this,"fileType");b(this,"instructions");b(this,"dependencies",new Map);this.lightningStore=t,this.filePath=e,this.fileType=u,this.instructions=i}get cacheData(){var t;return(t=this.lightningStore.get(this.filePath).data)!=null?t:{}}loadAllConnected(){return new Set([...this.loadConnected(),...this.loadDirectReferences()])}loadDirectReferences(){var t,e;return new Set((e=(t=this.instructions.includeFiles)==null?void 0:t.map(u=>{var i;if(u)return(i=this.cacheData[u])!=null?i:[]}).flat())!=null?e:[])}loadConnected(t=this.instructions.connect){var u;const e=new Set;for(let{find:i,where:s,matches:n,shouldFindMultiple:a}of t!=null?t:[]){Array.isArray(i)||(i=[i]);const o=(u=this.cacheData[n])!=null?u:[],c=this.lightningStore.findMultiple(i,s,o,a!=null?a:!0);for(const f of c)f!==this.filePath&&e.add(f)}return e}provideDiagnostics(){var e;const t=[];for(let{if:u,...i}of(e=this.instructions.provideDiagnostics)!=null?e:[]){const s=this.loadConnected([u]);if(u.not){if(s.size>0)continue;t.push(i)}else{if(s.size===0)continue;t.push(i)}}return t}addDependency(t,e){this.dependencies.has(t)?this.dependencies.get(t).add(e):this.dependencies.set(t,new Set(e))}}function rr(r){return Rn(r)(...Object.values(r.env))}function Rn({script:r,env:t,language:e,modules:u,async:i=!1}){if(e==="typeScript")throw new Error(`bridge.'s legacy script runner no longer supports TypeScript. Use "bridge-js-runner" instead.`);let s=Pn(r);if(u){const n=t.require;t.require=async a=>{if(u[a])return u[a];if(typeof n=="function")return await(n==null?void 0:n(a))}}try{return i?new Function(...Object.keys(t),`return (async () => {
${s}
})()`):new Function(...Object.keys(t),s)}catch(n){throw console.error(r),new Error(`Error within script: ${n}`)}}function Pn(r){return r.replace(/export default([ \(])/g,(t,e)=>`module.exports =${e}`).replace(/import\s+(\* as [a-z][a-z0-9]*|[a-z][a-z0-9]+|{[a-z\s][a-z0-9,\s]*})\s+from\s+["'](.+)["']/gi,(t,e,u)=>(e.startsWith("* as ")&&(e=e.replace("* as ","")),`const ${e} = await require('${u}')`))}function $n(r){const t={exports:void 0};return rr({script:r,env:{module:t}}),t.exports}async function On(r,t,e){for(const u of e){const i=`${t}${u}`;if(await r.fileExists(i))return i}}function Hn(r,t){return{Bridge:{value:r,withExtension:(e,u)=>On(t.fileSystem,e,u),resolvePackPath:(e,u)=>t.config.resolvePackPath(e,u)}}}const Ln=new Set([".js",".ts",".lang",".mcfunction",".txt",".molang",".html"]),nu=[".bridge","builds",".git","worlds"];class In{constructor(t,e){b(this,"folderIgnoreList",new Set);b(this,"totalTime",0);this.service=t,this.lightningStore=e}get fileType(){return this.service.fileType}async loadIgnoreFolders(){try{(await(await this.service.projectFileSystem.readFile(".bridge/.ignoreFolders")).text()).split(`
`).concat(nu).forEach(e=>this.folderIgnoreList.add(e))}catch{nu.forEach(t=>this.folderIgnoreList.add(t))}}async start(t){if(await this.lightningStore.setup(),this.folderIgnoreList.size===0&&await this.loadIgnoreFolders(),!t&&this.service.getOptions().noFullLightningCacheRefresh){const o=this.lightningStore.allFiles();if(o.length>0)return[o,[],[]]}let e=!1;const u=[],i=[],s=this.service.config.getAvailablePackPaths(),n=await Promise.all(s.map(async o=>[o,await this.service.fileSystem.getDirectoryHandle(o).catch(()=>{})]));for(const[o,c]of n){if(!c){console.warn(`Cannot index pack "${o}" because it does not exist`);continue}await this.iterateDir(c,async(f,D)=>{D=er(o,D),await this.processFile(D,f)&&(e||(e=!0),i.push(D)),u.push(D),this.service.progress.addToCurrent()})}let a=[];return(e||this.lightningStore.visitedFiles!==this.lightningStore.totalFiles)&&(a=await this.lightningStore.saveStore()),[u,i,a]}async unlinkFile(t,e=!0){this.lightningStore.remove(t),e&&await this.lightningStore.saveStore(!1)}async iterateDir(t,e,u=""){const i=[];for await(const[s,n]of t.entries()){const a=u.length===0?s:`${u}/${s}`;if(n.kind==="directory"){if(this.folderIgnoreList.has(a))continue;i.push(this.iterateDir(n,e,a))}else s[0]!=="."&&(this.service.progress.addToTotal(2),i.push(e(n,a)))}await Promise.allSettled(i)}async processFile(t,e,u=!1){const i=typeof e=="string",s=i?new File([e],tr(t)):await e.getFile(),n=this.fileType.getId(t);if(!s)throw new Error('Invalid call to "processFile": Either fileContent or fileHandle needs to be defined!');if(!i&&s.lastModified===this.lightningStore.getLastModified(t,n))return this.lightningStore.setVisited(t,!0,n),!1;const a=xn(t);return this.fileType.isJsonFile(t)?await this.processJSON(t,n,s,i?e:void 0,u):Ln.has(a)?await this.processText(t,n,s,u):this.lightningStore.add(t,{lastModified:s.lastModified,isForeignFile:u},n),!0}async processText(t,e,u,i){const s=await this.fileType.getLightningCache(t);if(typeof s=="string"){const n=$n(s);if(typeof n=="function"){const a=n(await u.text(),{resolvePackPath:(o,c)=>this.service.config.resolvePackPath(o,c)});this.lightningStore.add(t,{lastModified:u.lastModified,isForeignFile:i,data:Object.keys(a).length>0?a:void 0},e)}}this.lightningStore.add(t,{lastModified:u.lastModified,isForeignFile:i},e)}async processJSON(t,e,u,i,s){const n=await this.fileType.getLightningCache(t);if(n.length===0||typeof n=="string"){this.lightningStore.add(t,{lastModified:u.lastModified,isForeignFile:s},e);return}const a=i!==void 0;i===void 0&&(i=await u.text()),i===""&&(i="{}");let o;try{o=At.parse(i)}catch(y){a||(console.error(`[${t}] ${y.message}`),this.lightningStore.add(t,{lastModified:u.lastModified,isForeignFile:s},e));return}const c={},f=(y,v,A)=>async m=>{let g;if(Array.isArray(m)?g=m:typeof m=="object"?g=Object.keys(m!=null?m:{}):g=[m],v&&(g=g.filter(w=>!v.includes(w))),A){const w={config:this.service.config,fileSystem:this.service.fileSystem};g=(await Promise.all(g.map(S=>rr({async:!0,script:A,env:{...Hn(S,w)}})))).filter(S=>S!==void 0)}c[y]?c[y]=[...new Set(c[y].concat(g))]:c[y]=g},D=[],E=(y,v,A)=>m=>{D.push(f(y,v,A)(m))};for(const y of n){const v=y.cacheKey;if(!v)continue;let A=Array.isArray(y.path)?y.path:[y.path];const m=y.pathScript;if(m&&(A=rr({script:m,env:{Bridge:{paths:A}}}),!Array.isArray(A)||A.length===0))return;for(const g of A)Vr(g,o,E(v,y.filter,y.script))}await Promise.all(D),this.lightningStore.add(t,{lastModified:u.lastModified,isForeignFile:s,data:Object.keys(c).length>0?c:void 0},e)}}async function ur(r,t,e=new Set,u=""){const i=[];for await(const s of r.values()){const n=u.length===0?s.name:`${u}/${s.name}`;if(s.kind==="file"){if(s.name[0]===".")continue;i.push(t(s,n,r))}else s.kind==="directory"&&!e.has(n)&&i.push(ur(s,t,e,n))}await Promise.all(i)}async function Nn(){return typeof(await(await navigator.storage.getDirectory()).getFileHandle("bridge-supports-writable-test",{create:!0})).createWritable=="function"}async function su(){var r;return typeof((r=navigator.storage)==null?void 0:r.getDirectory)!="function"||!await Nn()?new se(null,"bridgeFolder",void 0):await navigator.storage.getDirectory()}class qe extends ze{constructor(e){super();b(this,"_baseDirectory");e&&this.setup(e)}get baseDirectory(){return this._baseDirectory}setup(e){this._baseDirectory=e,this.hasFired||this.dispatch()}async getDirectoryHandle(e,{create:u,createOnce:i}={}){if(e===""||e===".")return this.baseDirectory;let s=this.baseDirectory;const n=e.split(/\\|\//g);n[0]==="."&&n.shift(),n[0]==="extensions"&&(n[0]="~local",n.splice(1,0,"extensions")),n[0]==="~local"&&(s=await su(),n.shift());for(const a of n){try{s=await s.getDirectoryHandle(a,{create:i||u})}catch{throw new Error(`Failed to access "${e}": Directory does not exist`)}i&&(i=!1,u=!1)}return s}async getFileHandle(e,u=!1){if(e.length===0)throw new Error("Error: filePath is empty");const i=await this.getDirectoryHandle(iu(e),{create:u});try{return await i.getFileHandle(tr(e),{create:u})}catch{throw new Error(`File does not exist: "${e}"`)}}async pathTo(e){const u=await su();if(e instanceof De&&!(u instanceof se))return;let i=await u.resolve(e).then(s=>s==null?void 0:s.join("/"));return i?i="~local/"+i:i=await this.baseDirectory.resolve(e).then(s=>s==null?void 0:s.join("/")),i}async mkdir(e,{recursive:u}={}){await this.getDirectoryHandle(e,{create:!0})}async readdir(e,{withFileTypes:u}={}){const i=await this.getDirectoryHandle(e),s=[];for await(const n of i.values())n.kind==="file"&&n.name===".DS_Store"||(u?s.push(n):s.push(n.name));return s}async readFilesFromDir(e,u=this.getDirectoryHandle(e)){u=await u;const i=[],s=[];for await(const n of u.values())n.kind==="file"&&n.name===".DS_Store"||(n.kind==="file"?i.push({name:n.name,kind:n.kind,path:`${e}/${n.name}`}):n.kind==="directory"&&s.push(this.readFilesFromDir(`${e}/${n.name}`,n).then(a=>i.push(...a))));return await Promise.allSettled(s),i}readFile(e){return this.getFileHandle(e).then(u=>u.getFile())}async unlink(e){if(e.length===0)throw new Error("Error: filePath is empty");const u=e.split(/\\|\//g),i=u.pop();let s;try{s=await this.getDirectoryHandle(u.join("/"))}catch{return}try{await s.removeEntry(i,{recursive:!0})}catch{}}async writeFile(e,u){const i=await this.getFileHandle(e,!0);return await this.write(i,u),i}async write(e,u){const i=await e.createWritable({keepExistingData:!1});await i.write(u),await i.close()}async readJSON(e){const u=await this.readFile(e);try{return await At.parse(await u.text())}catch{throw new Error(`Invalid JSON: ${e}`)}}async readJsonHandle(e){const u=await e.getFile();try{return await At.parse(await u.text())}catch{throw new Error(`Invalid JSON: ${e.name}`)}}writeJSON(e,u,i=!1){return this.writeFile(e,JSON.stringify(u,null,i?"	":void 0))}async move(e,u){if(await this.fileExists(e))await this.copyFile(e,u);else if(await this.directoryExists(e))await this.copyFolder(e,u);else throw new Error(`File or folder does not exist: ${e}`);await this.unlink(e)}async copyFile(e,u){const i=await this.getFileHandle(e,!1),s=await this.getFileHandle(u,!0);return await this.copyFileHandle(i,s)}async copyFileHandle(e,u){return await this.write(u,await e.getFile()),u}async copyFolder(e,u){const i=await this.getDirectoryHandle(e,{create:!1});await ur(i,async(s,n)=>{await this.copyFileHandle(s,await this.getFileHandle(er(u,n),!0))})}async copyFolderByHandle(e,u){const i=new qe(u);await ur(e,async(s,n)=>{await this.copyFileHandle(s,await i.getFileHandle(n,!0))})}loadFileHandleAsDataUrl(e){return new Promise(async(u,i)=>{const s=new FileReader;try{const n=await e.getFile();s.addEventListener("load",()=>{u(s.result)}),s.addEventListener("error",i),s.readAsDataURL(n)}catch{i(`File does not exist: "${e.name}"`)}})}async fileExists(e){try{return await this.getFileHandle(e),!0}catch{return!1}}async directoryExists(e){try{return await this.getDirectoryHandle(e),!0}catch{return!1}}async getDirectoryHandlesFromGlob(e,u="."){const i=e.split(/\/|\\/g),s=new Set([await this.getDirectoryHandle(u)]);for(const n of i){if(n==="*")for(const a of[...s.values()]){s.delete(a);for await(const o of a.values())o.kind==="directory"&&s.add(o)}else{if(n==="**")return console.warn('"**" is not supported yet'),[];for(const a of[...s.values()]){s.delete(a);try{s.add(await a.getDirectoryHandle(n))}catch{}}}if(s.size===0)return[]}return[...s.values()]}}class Mn extends vn{constructor(e){super(e);b(this,"ready",new ze)}async setup(e){this.packTypes.length>0||(await e.fired,this.packTypes=await e.readJSON("data/packages/minecraftBedrock/packDefinitions.json").catch(()=>[]),this.ready.dispatch())}}const jn="/";var au={},Wn=function(r,t,e,u,i){var s=au[t]||(au[t]=URL.createObjectURL(new Blob([r],{type:"text/javascript"}))),n=new Worker(s);return n.onerror=function(a){return i(a.error,null)},n.onmessage=function(a){return i(null,a.data)},n.postMessage(e,u),n},te=Uint8Array,pe=Uint16Array,rt=Uint32Array,ir=new te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nr=new te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ou=new te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cu=function(r,t){for(var e=new pe(31),u=0;u<31;++u)e[u]=t+=1<<r[u-1];for(var i=new rt(e[30]),u=1;u<30;++u)for(var s=e[u];s<e[u+1];++s)i[s]=s-e[u]<<5|u;return[e,i]},lu=cu(ir,2),sr=lu[0],zn=lu[1];sr[28]=258,zn[258]=28;for(var Gn=cu(nr,0),fu=Gn[0],gt=new pe(32768),z=0;z<32768;++z){var ke=(z&43690)>>>1|(z&21845)<<1;ke=(ke&52428)>>>2|(ke&13107)<<2,ke=(ke&61680)>>>4|(ke&3855)<<4,gt[z]=((ke&65280)>>>8|(ke&255)<<8)>>>1}for(var Qe=function(r,t,e){for(var u=r.length,i=0,s=new pe(t);i<u;++i)++s[r[i]-1];var n=new pe(t);for(i=0;i<t;++i)n[i]=n[i-1]+s[i-1]<<1;var a;if(e){a=new pe(1<<t);var o=15-t;for(i=0;i<u;++i)if(r[i])for(var c=i<<4|r[i],f=t-r[i],D=n[r[i]-1]++<<f,E=D|(1<<f)-1;D<=E;++D)a[gt[D]>>>o]=c}else for(a=new pe(u),i=0;i<u;++i)r[i]&&(a[i]=gt[n[r[i]-1]++]>>>15-r[i]);return a},ut=new te(288),z=0;z<144;++z)ut[z]=8;for(var z=144;z<256;++z)ut[z]=9;for(var z=256;z<280;++z)ut[z]=7;for(var z=280;z<288;++z)ut[z]=8;for(var Du=new te(32),z=0;z<32;++z)Du[z]=5;var hu=Qe(ut,9,1),du=Qe(Du,5,1),Ct=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},oe=function(r,t,e){var u=t/8|0;return(r[u]|r[u+1]<<8)>>(t&7)&e},Ft=function(r,t){var e=t/8|0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>(t&7)},pu=function(r){return(r/8|0)+(r&7&&1)},Et=function(r,t,e){(t==null||t<0)&&(t=0),(e==null||e>r.length)&&(e=r.length);var u=new(r instanceof pe?pe:r instanceof rt?rt:te)(e-t);return u.set(r.subarray(t,e)),u},Au=function(r,t,e){var u=r.length;if(!u||e&&!e.l&&u<5)return t||new te(0);var i=!t||e,s=!e||e.i;e||(e={}),t||(t=new te(u*3));var n=function(R){var Me=t.length;if(R>Me){var vt=new te(Math.max(Me*2,R));vt.set(t),t=vt}},a=e.f||0,o=e.p||0,c=e.b||0,f=e.l,D=e.d,E=e.m,y=e.n,v=u*8;do{if(!f){e.f=a=oe(r,o,1);var A=oe(r,o+1,3);if(o+=3,A)if(A==1)f=hu,D=du,E=9,y=5;else if(A==2){var S=oe(r,o,31)+257,k=oe(r,o+10,15)+4,x=S+oe(r,o+5,31)+1;o+=14;for(var N=new te(x),M=new te(19),B=0;B<k;++B)M[ou[B]]=oe(r,o+B*3,7);o+=k*3;for(var O=Ct(M),K=(1<<O)-1,d=Qe(M,O,1),B=0;B<x;){var I=d[oe(r,o,K)];o+=I&15;var m=I>>>4;if(m<16)N[B++]=m;else{var L=0,ae=0;for(m==16?(ae=3+oe(r,o,3),o+=2,L=N[B-1]):m==17?(ae=3+oe(r,o,7),o+=3):m==18&&(ae=11+oe(r,o,127),o+=7);ae--;)N[B++]=L}}var h=N.subarray(0,S),l=N.subarray(S);E=Ct(h),y=Ct(l),f=Qe(h,E,1),D=Qe(l,y,1)}else throw"invalid block type";else{var m=pu(o)+4,g=r[m-4]|r[m-3]<<8,w=m+g;if(w>u){if(s)throw"unexpected EOF";break}i&&n(c+g),t.set(r.subarray(m,w),c),e.b=c+=g,e.p=o=w*8;continue}if(o>v){if(s)throw"unexpected EOF";break}}i&&n(c+131072);for(var Y=(1<<E)-1,H=(1<<y)-1,ne=o;;ne=o){var L=f[Ft(r,o)&Y],ee=L>>>4;if(o+=L&15,o>v){if(s)throw"unexpected EOF";break}if(!L)throw"invalid length/literal";if(ee<256)t[c++]=ee;else if(ee==256){ne=o,f=null;break}else{var re=ee-254;if(ee>264){var B=ee-257,ge=ir[B];re=oe(r,o,(1<<ge)-1)+sr[B],o+=ge}var it=D[Ft(r,o)&H],Te=it>>>4;if(!it)throw"invalid distance";o+=it&15;var l=fu[Te];if(Te>3){var ge=nr[Te];l+=Ft(r,o)&(1<<ge)-1,o+=ge}if(o>v){if(s)throw"unexpected EOF";break}i&&n(c+131072);for(var Ce=c+re;c<Ce;c+=4)t[c]=t[c-l],t[c+1]=t[c+1-l],t[c+2]=t[c+2-l],t[c+3]=t[c+3-l];c=Ce}}e.l=f,e.p=ne,e.b=c,f&&(a=1,e.m=E,e.d=D,e.n=y)}while(!a);return c==t.length?t:Et(t,0,c)},Un=new te(0),Vn=function(r,t){var e={};for(var u in r)e[u]=r[u];for(var u in t)e[u]=t[u];return e},gu=function(r,t,e){for(var u=r(),i=r.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),n=0;n<u.length;++n){var a=u[n],o=s[n];if(typeof a=="function"){t+=";"+o+"=";var c=a.toString();if(a.prototype)if(c.indexOf("[native code]")!=-1){var f=c.indexOf(" ",8)+1;t+=c.slice(f,c.indexOf("(",f))}else{t+=c;for(var D in a.prototype)t+=";"+o+".prototype."+D+"="+a.prototype[D].toString()}else t+=c}else e[o]=a}return[t,e]},yt=[],Kn=function(r){var t=[];for(var e in r)(r[e]instanceof te||r[e]instanceof pe||r[e]instanceof rt)&&t.push((r[e]=new r[e].constructor(r[e])).buffer);return t},Jn=function(r,t,e,u){var i;if(!yt[e]){for(var s="",n={},a=r.length-1,o=0;o<a;++o)i=gu(r[o],s,n),s=i[0],n=i[1];yt[e]=gu(r[a],s,n)}var c=Vn({},yt[e][1]);return Wn(yt[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,c,Kn(c),u)},Xn=function(){return[te,pe,rt,ir,nr,ou,sr,fu,hu,du,gt,Qe,Ct,oe,Ft,pu,Et,Au,or,Cu,Fu]},Cu=function(r){return postMessage(r,[r.buffer])},Fu=function(r){return r&&r.size&&new te(r.size)},qn=function(r,t,e,u,i,s){var n=Jn(e,u,i,function(a,o){n.terminate(),s(a,o)});return n.postMessage([r,t],t.consume?[r.buffer]:[]),function(){n.terminate()}},Ae=function(r,t){return r[t]|r[t+1]<<8},fe=function(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0},ar=function(r,t){return fe(r,t)+fe(r,t+4)*4294967296};function Qn(r,t,e){if(e||(e=t,t={}),typeof e!="function")throw"no callback";return qn(r,t,[Xn],function(u){return Cu(or(u.data[0],Fu(u.data[1])))},1,e)}function or(r,t){return Au(r,t)}var cr=typeof TextDecoder<"u"&&new TextDecoder,Zn=0;try{cr.decode(Un,{stream:!0}),Zn=1}catch{}var Yn=function(r){for(var t="",e=0;;){var u=r[e++],i=(u>127)+(u>223)+(u>239);if(e+i>r.length)return[t,Et(r,e-1)];i?i==3?(u=((u&15)<<18|(r[e++]&63)<<12|(r[e++]&63)<<6|r[e++]&63)-65536,t+=String.fromCharCode(55296|u>>10,56320|u&1023)):i&1?t+=String.fromCharCode((u&31)<<6|r[e++]&63):t+=String.fromCharCode((u&15)<<12|(r[e++]&63)<<6|r[e++]&63):t+=String.fromCharCode(u)}};function es(r,t){if(t){for(var e="",u=0;u<r.length;u+=16384)e+=String.fromCharCode.apply(null,r.subarray(u,u+16384));return e}else{if(cr)return cr.decode(r);var i=Yn(r),s=i[0],n=i[1];if(n.length)throw"invalid utf-8 data";return s}}var ts=function(r,t){return t+30+Ae(r,t+26)+Ae(r,t+28)},rs=function(r,t,e){var u=Ae(r,t+28),i=es(r.subarray(t+46,t+46+u),!(Ae(r,t+8)&2048)),s=t+46+u,n=fe(r,t+20),a=e&&n==4294967295?us(r,s):[n,fe(r,t+24),fe(r,t+42)],o=a[0],c=a[1],f=a[2];return[Ae(r,t+10),o,c,i,s+Ae(r,t+30)+Ae(r,t+32),f]},us=function(r,t){for(;Ae(r,t)!=1;t+=4+Ae(r,t+2));return[ar(r,t+12),ar(r,t+4),ar(r,t+20)]};function is(r,t){if(typeof t!="function")throw"no callback";for(var e=[],u=function(){for(var E=0;E<e.length;++E)e[E]()},i={},s=r.length-22;fe(r,s)!=101010256;--s)if(!s||r.length-s>65558){t("invalid zip file",null);return}var n=Ae(r,s+8);n||t(null,{});var a=n,o=fe(r,s+16),c=o==4294967295;if(c){if(s=fe(r,s-12),fe(r,s)!=101075792){t("invalid zip file",null);return}a=n=fe(r,s+32),o=fe(r,s+48)}for(var f=function(E){var y=rs(r,o,c),v=y[0],A=y[1],m=y[2],g=y[3],w=y[4],S=y[5],k=ts(r,S);o=w;var x=function(M,B){M?(u(),t(M,null)):(i[g]=B,--n||t(null,i))};if(!v)x(null,Et(r,k,k+A));else if(v==8){var N=r.subarray(k,k+A);if(A<32e4)try{x(null,or(N,new te(m)))}catch(M){x(M,null)}else e.push(Qn(N,{size:m},x))}else x("unknown compression type "+v,null)},D=0;D<a;++D)f();return u}const Eu=1276185;function ns(r){return new Promise(t=>{typeof requestIdleCallback=="function"?requestIdleCallback(async()=>{await r(),t()}):setTimeout(async()=>{await r(),t()},10)})}var ss=JSON.parse('{"name":"bridge","version":"2.3.6","private":true,"scripts":{"dev":"vite","dev:force":"vite --force","dev:host":"vite --host","serve":"vite preview","check":"tsc --project tsconfig.json --noEmit","build":"node ./scripts/build.mjs && node ./scripts/buildApp.mjs","build:nightly":"node ./scripts/build.mjs && node ./scripts/buildApp.mjs --nightly"},"dependencies":{"@mdi/font":"^6.9.96","@types/lz-string":"^1.3.34","bridge-common-utils":"^0.3.3","bridge-iframe-api":"^0.4.7","bridge-js-runtime":"^0.3.6","bridge-model-viewer":"^0.7.7","buffer":"^6.0.3","color-convert":"^2.0.1","comlink":"^4.3.0","compare-versions":"^3.6.0","core-js":"^3.6.5","dash-compiler":"^0.10.6","escape-string-regexp":"^5.0.0","fflate":"^0.6.7","idb-keyval":"^5.1.3","is-glob":"^4.0.1","json5":"^2.1.3","jsonc-parser":"^3.0.0","lodash-es":"^4.17.20","lz-string":"^1.4.4","mc-project-core":"^0.3.22","molang":"^1.13.11","monaco-editor":"^0.33.0","path-browserify":"^1.0.1","prismarine-nbt":"^1.6.0","quick-score":"^0.0.13","tga-js":"^1.1.1","three":"^0.139.2","uuid":"^8.3.1","vue":"^2.7.8","vue-template-compiler":"^2.7.8","vuedraggable":"^2.24.3","vuetify":"^2.6.10","wintersky":"^1.1.0"},"devDependencies":{"@types/color-convert":"^2.0.0","@types/is-glob":"^4.0.1","@types/json5":"0.0.30","@types/lodash-es":"^4.17.4","@types/lodash.debounce":"^4.0.6","@types/node":"^14.17.9","@types/three":"^0.127.1","@types/uuid":"^8.3.0","@types/wicg-file-system-access":"^2020.9.5","@vitejs/plugin-vue2":"^1.1.2","markdown-it":"^12.3.2","node-fetch":"^2.6.7","prettier":"^2.2.1","sass":"^1.19.0","typescript":"^4.4.3","vite":"^3.1.2","vite-plugin-ejs":"^1.4.3","vite-plugin-pwa":"^0.12.3","vite-plugin-vue2":"^2.0.2"}}');const yu=ss.version;class as extends qe{constructor(e=!1){super();b(this,"_virtualFileSystem");this.isMainLoader=e}get virtualFileSystem(){if(!this._virtualFileSystem)throw new Error("DataLoader: virtualFileSystem is not initialized");return this._virtualFileSystem}async loadData(e=!1){if(this.hasFired){console.warn("This dataLoader instance already loaded data. You called loadData() twice.");return}let u=await Rt("savedDataForVersion");e&&(u=void 0,await Pt("savedDataForVersion",void 0));const i=u?sn(yu,u,"="):!1;this.isMainLoader&&console.log(i?"[APP] Data saved; restoring from cache...":"[APP] Latest data not saved; fetching now..."),console.time("[App] Data");const s=this.isMainLoader&&!i;if(this._virtualFileSystem=new se(new Ze("data-fs"),"bridgeFolder",i?void 0:new Map,s),await this._virtualFileSystem.setupDone.fired,i){this.setup(this._virtualFileSystem),console.timeEnd("[App] Data");return}const n=await fetch(jn+"packages.zip").then(f=>f.arrayBuffer());if(n.byteLength!==Eu)throw new Error(`Error: Data package was larger than the expected size of ${Eu} bytes; got ${n.byteLength} bytes`);const a=await new Promise((f,D)=>is(new Uint8Array(n),async(E,y)=>{if(E)return D(E);f(y)})),c={".":await this._virtualFileSystem.getDirectoryHandle("data",{create:!0})};for(const f in a){const D=tr(f),E=iu(f);if(f.endsWith("/")){const y=await c[E].getDirectoryHandle(D,{create:!0});c[f.slice(0,-1)]=y}else await c[E].getFileHandle(D,{create:!0,initialData:a[f]})}this.setup(this._virtualFileSystem),console.timeEnd("[App] Data"),this.isMainLoader&&!e&&ns(async()=>{await this._virtualFileSystem.moveToIdb(),await Pt("savedDataForVersion",yu)})}}class os extends mn{constructor(t,e,u){super(e),this.fileSystem=t,this.project=u,u&&u.fileSave.on(this.resolvePackPath(void 0,"config.json"),()=>{this.refreshConfig(),this.project.app.windows.createPreset.onPresetsChanged(),this.project.compilerService.reloadPlugins()})}readConfig(){return this.fileSystem.readJSON("config.json").catch(()=>({}))}async writeConfig(t){await this.fileSystem.writeJSON("config.json",t,!0)}async setup(t=!0){var i,s,n,a,o,c,f;if(t&&await this.fileSystem.fileExists(".bridge/config.json")){const{darkTheme:D,lightTheme:E,gameTestAPI:y,scriptingAPI:v,prefix:A,...m}=await this.fileSystem.readJSON(".bridge/config.json");await this.fileSystem.unlink(".bridge/config.json");const g={};y&&(g.enableGameTestFramework=!0),v&&(g.additionalModdingCapabilities=!0);const w={type:"minecraftBedrock",name:this.fileSystem.baseDirectory.name,namespace:A,experimentalGameplay:g,...m,authors:m.author?[m.author]:["Unknown"],packs:Yt,bridge:{darkTheme:D,lightTheme:E}};await this.fileSystem.writeJSON("config.json",w,!0),this.data=w;return}await super.setup();const e=(s=(i=this.data.bridge)==null?void 0:i.formatVersion)!=null?s:0;this.data.bridge||(this.data.bridge={});let u=!1;if(t&&this.project&&this.data.capabilities){const D=await this.project.app.dataLoader.readJSON("data/packages/minecraftBedrock/experimentalGameplay.json"),E=(n=this.data.experimentalGameplay)!=null?n:{},y=(a=this.data.capabilities)!=null?a:[];E.enableGameTestFramework=y.includes("gameTestAPI"),E.additionalModdingCapabilities=y.includes("scriptingAPI");for(const v of D)(c=E[o=v.id])!=null||(E[o]=!0);this.data.experimentalGameplay=E,this.data.capabilities=void 0,u=!0}if(t&&this.data.author&&!this.data.authors&&(this.data.authors=typeof this.data.author=="string"?[this.data.author]:this.data.author,this.data.author=void 0,u=!0),t&&await this.fileSystem.fileExists(".bridge/compiler/default.json")){const D=await this.fileSystem.readJSON(".bridge/compiler/default.json");this.data.compiler={plugins:D.plugins},await this.fileSystem.unlink(".bridge/compiler/default.json"),u=!0}t&&e===0&&((f=this.data.compiler)==null?void 0:f.plugins)&&!this.data.compiler.plugins.includes("formatVersionCorrection")&&(this.data.bridge.formatVersion=1,this.data.compiler.plugins.push("formatVersionCorrection"),u=!0),u&&await this.writeConfig(this.data)}async getWorldHandles(){var u;if(!this.project)throw new Error("Cannot use getWorldHandles() within web workers yet");const t=this.project.app,e=((u=this.get().worlds)!=null?u:["./worlds/*"]).map(i=>this.resolvePackPath(void 0,i));return(await Promise.all(e.map(i=>t.fileSystem.getDirectoryHandlesFromGlob(i)))).flat()}getAuthorImage(){var e;const t=(e=this.get().authors)==null?void 0:e.find(u=>typeof u!="string"&&u.logo);if(!!t)return this.resolvePackPath(void 0,t.logo)}async toggleExperiment(t,e){var i,s;t.app.windows.loadingWindow.open();const u=(s=(i=this.get())==null?void 0:i.experimentalGameplay)!=null?s:{};u[e]=!u[e],await this.save(),t.isActiveProject&&await t.refresh(),this.project.app.windows.createPreset.onPresetsChanged(),t.app.windows.loadingWindow.close()}}globalThis.process={cwd:()=>"",env:{},release:{name:"browser"}};const mt=new as;class cs extends bn{constructor(e,u,i){super();b(this,"lightningStore");b(this,"packSpider");b(this,"lightningCache");b(this,"fileSystem");b(this,"projectFileSystem");b(this,"globalFileSystem");b(this,"config");b(this,"fileType");b(this,"packType");this.projectDirectory=e,this.options=i,this.fileSystem=new qe(u),this.projectFileSystem=new qe(e),this.config=new os(this.projectFileSystem,i.projectPath),this.fileType=new Bn(this.config),this.packType=new Mn(this.config),this.globalFileSystem=new qe(u),this.lightningStore=new _n(this.projectFileSystem,this.fileType,i.projectPath),this.packSpider=new kn(this,this.lightningStore),this.lightningCache=new In(this,this.lightningStore),this.fileType.setPluginFileTypes(i.pluginFileTypes)}getOptions(){return{projectDirectory:this.projectDirectory,baseDirectory:this.fileSystem.baseDirectory,...this.options}}async onStart(e){console.time("[WORKER] SETUP"),this.lightningStore.reset(),mt.hasFired||await mt.loadData(),await Promise.all([this.fileType.setup(mt),this.packType.setup(mt),this.config.setup(!1)]),console.timeEnd("[WORKER] SETUP"),console.time("[WORKER] LightningCache");const[u,i,s]=await this.lightningCache.start(e);return console.timeEnd("[WORKER] LightningCache"),console.time("[WORKER] PackSpider"),await this.packSpider.setup(u),console.timeEnd("[WORKER] PackSpider"),[i,s]}async updateFile(e,u,i=!1,s=!1){const n=await this.lightningCache.processFile(e,u!=null?u:await this.fileSystem.getFileHandle(e),i);return n&&(s||await this.lightningStore.saveStore(!1),await this.packSpider.updateFile(e)),n}async updateFiles(e,u=!1){let i=!1;for(let s=0;s<e.length;s++)await this.updateFile(e[s],void 0,!1,!1)&&(i=!0);return!u&&i&&await this.lightningStore.saveStore(!1),i}hasFile(e){return this.lightningStore.has(e)}async rename(e,u,i=!0){this.lightningStore.rename(e,u),i&&await this.lightningStore.saveStore(!1)}unlinkFile(e,u=!0){return this.lightningCache.unlinkFile(e,u)}saveCache(){return this.lightningStore.saveStore(!1)}updatePlugins(e){this.fileType.setPluginFileTypes(e)}find(e,u,i,s=!1){return this.lightningStore.find(e,u,i,s)}findMultiple(e,u,i,s=!1){return this.lightningStore.findMultiple(e,u,i,s)}getAllFiles(e,u=!1){return u?this.lightningStore.allFiles(e).sort((i,s)=>i.localeCompare(s)):this.lightningStore.allFiles(e)}getFileDiagnostics(e){return this.packSpider.getDiagnostics(e)}getConnectedFiles(e){return this.packSpider.getConnectedFiles(e)}getSchemasFor(e,u){return this.lightningStore.getSchemasFor(e,u)}getCacheDataFor(e,u,i){return this.lightningStore.getCacheDataFor(e,u,i)}}St(cs,self)})();
