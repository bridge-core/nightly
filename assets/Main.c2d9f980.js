(function(){"use strict";const ar=Symbol("Comlink.proxy"),gu=Symbol("Comlink.endpoint"),Fu=Symbol("Comlink.releaseProxy"),yt=Symbol("Comlink.thrown"),or=r=>typeof r=="object"&&r!==null||typeof r=="function",Eu={canHandle:r=>or(r)&&r[ar],serialize(r){const{port1:e,port2:t}=new MessageChannel;return mt(r,e),[t,[t]]},deserialize(r){return r.start(),vu(r)}},yu={canHandle:r=>or(r)&&yt in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},Le=new Map([["proxy",Eu],["throw",yu]]);function mt(r,e=self){e.addEventListener("message",function t(u){if(!u||!u.data)return;const{id:i,type:s,path:n}=Object.assign({path:[]},u.data),a=(u.data.argumentList||[]).map(xe);let o;try{const c=n.slice(0,-1).reduce((f,E)=>f[E],r),h=n.reduce((f,E)=>f[E],r);switch(s){case 0:o=h;break;case 1:c[n.slice(-1)[0]]=xe(u.data.value),o=!0;break;case 2:o=h.apply(c,a);break;case 3:{const f=new h(...a);o=Su(f)}break;case 4:{const{port1:f,port2:E}=new MessageChannel;mt(r,E),o=Bu(f,[f])}break;case 5:o=void 0;break}}catch(c){o={value:c,[yt]:0}}Promise.resolve(o).catch(c=>({value:c,[yt]:0})).then(c=>{const[h,f]=wt(c);e.postMessage(Object.assign(Object.assign({},h),{id:i}),f),s===5&&(e.removeEventListener("message",t),cr(e))})}),e.start&&e.start()}function mu(r){return r.constructor.name==="MessagePort"}function cr(r){mu(r)&&r.close()}function vu(r,e){return vt(r,[],e)}function tt(r){if(r)throw new Error("Proxy has been released and is not useable")}function vt(r,e=[],t=function(){}){let u=!1;const i=new Proxy(t,{get(s,n){if(tt(u),n===Fu)return()=>Ie(r,{type:5,path:e.map(a=>a.toString())}).then(()=>{cr(r),u=!0});if(n==="then"){if(e.length===0)return{then:()=>i};const a=Ie(r,{type:0,path:e.map(o=>o.toString())}).then(xe);return a.then.bind(a)}return vt(r,[...e,n])},set(s,n,a){tt(u);const[o,c]=wt(a);return Ie(r,{type:1,path:[...e,n].map(h=>h.toString()),value:o},c).then(xe)},apply(s,n,a){tt(u);const o=e[e.length-1];if(o===gu)return Ie(r,{type:4}).then(xe);if(o==="bind")return vt(r,e.slice(0,-1));const[c,h]=lr(a);return Ie(r,{type:2,path:e.map(f=>f.toString()),argumentList:c},h).then(xe)},construct(s,n){tt(u);const[a,o]=lr(n);return Ie(r,{type:3,path:e.map(c=>c.toString()),argumentList:a},o).then(xe)}});return i}function wu(r){return Array.prototype.concat.apply([],r)}function lr(r){const e=r.map(wt);return[e.map(t=>t[0]),wu(e.map(t=>t[1]))]}const fr=new WeakMap;function Bu(r,e){return fr.set(r,e),r}function Su(r){return Object.assign(r,{[ar]:!0})}function wt(r){for(const[e,t]of Le)if(t.canHandle(r)){const[u,i]=t.serialize(r);return[{type:3,name:e,value:u},i]}return[{type:0,value:r},fr.get(r)||[]]}function xe(r){switch(r.type){case 3:return Le.get(r.name).deserialize(r.value);case 0:return r.value}}function Ie(r,e,t){return new Promise(u=>{const i=bu();r.addEventListener("message",function s(n){!n.data||!n.data.id||n.data.id!==i||(r.removeEventListener("message",s),u(n.data))}),r.start&&r.start(),r.postMessage(Object.assign({id:i},e),t)})}function bu(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var rt,_u=new Uint8Array(16);function xu(){if(!rt&&(rt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!rt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rt(_u)}var ku=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Tu(r){return typeof r=="string"&&ku.test(r)}for(var Q=[],Bt=0;Bt<256;++Bt)Q.push((Bt+256).toString(16).substr(1));function Ru(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Q[r[e+0]]+Q[r[e+1]]+Q[r[e+2]]+Q[r[e+3]]+"-"+Q[r[e+4]]+Q[r[e+5]]+"-"+Q[r[e+6]]+Q[r[e+7]]+"-"+Q[r[e+8]]+Q[r[e+9]]+"-"+Q[r[e+10]]+Q[r[e+11]]+Q[r[e+12]]+Q[r[e+13]]+Q[r[e+14]]+Q[r[e+15]]).toLowerCase();if(!Tu(t))throw TypeError("Stringified UUID is invalid");return t}function Pu(r,e,t){r=r||{};var u=r.random||(r.rng||xu)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=u[i];return e}return Ru(u)}class Dr{constructor(){this.listeners=new Set}get hasListeners(){return this.listeners.size>0}dispatch(e){this.listeners.forEach(t=>t(e))}on(e,t=!0){if(this.listeners.add(e),t)return{dispose:()=>{this.off(e)}}}off(e){this.listeners.delete(e)}once(e,t=!1){const u=i=>{e(i),this.off(u)};return this.on(u,t)}disposeListeners(){this.listeners=new Set}}class Ne extends Dr{constructor(e=1){super(),this.needsToFireAmount=e,this.firedTimes=0}get fired(){return new Promise(e=>this.once(e,!1))}get hasFired(){return this.firedTimes>=this.needsToFireAmount}setFiredTimes(e){this.firedTimes=e}resetSignal(){this.data=void 0,this.firedTimes=0}dispatch(e){if(this.firedTimes<this.needsToFireAmount&&this.firedTimes++,this.data=e,this.hasFired)return super.dispatch(e)}on(e,t=!0){return this.hasFired&&e(this.data),super.on(e,t)}}function $u(){if(!(!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent))||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const u=()=>indexedDB.databases().finally(t);e=setInterval(u,100),u()}).finally(()=>clearInterval(e))}function ve(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function St(r,e){const t=$u().then(()=>{const u=indexedDB.open(r);return u.onupgradeneeded=()=>u.result.createObjectStore(e),ve(u)});return(u,i)=>t.then(s=>i(s.transaction(e,u).objectStore(e)))}let bt;function ke(){return bt||(bt=St("keyval-store","keyval")),bt}function _t(r,e=ke()){return e("readonly",t=>ve(t.get(r)))}function xt(r,e,t=ke()){return t("readwrite",u=>(u.put(e,r),ve(u.transaction)))}function Ou(r,e=ke()){return e("readwrite",t=>(r.forEach(u=>t.put(u[1],u[0])),ve(t.transaction)))}function Hu(r,e=ke()){return e("readonly",t=>Promise.all(r.map(u=>ve(t.get(u)))))}function Lu(r,e=ke()){return e("readwrite",t=>(t.delete(r),ve(t.transaction)))}function Iu(r=ke()){return r("readwrite",e=>(e.clear(),ve(e.transaction)))}function Nu(r,e){return r("readonly",t=>(t.openCursor().onsuccess=function(){!this.result||(e(this.result),this.result.continue())},ve(t.transaction)))}function Mu(r=ke()){const e=[];return Nu(r,t=>e.push(t.key)).then(()=>e)}const ju=St("virtual-fs","virtual-fs-store"),Wu=r=>_t(r,ju);class Je{constructor(e="virtual-fs"){this.storeName=e,this.store=St(e,`${e}-store`)}set(e,t){return xt(e,t,this.store)}get(e){return _t(e,this.store)}del(e){return Lu(e,this.store)}setMany(e){return Ou(e,this.store)}getMany(e){return Hu(e,this.store)}clear(){return Iu(this.store)}async has(e){return await Wu(e)!==void 0}keys(){return Mu(this.store)}}class hr{constructor(e,t,u=[],i=Pu()){this._name=t,this.basePath=u,this.uuid=i,this._idbWrapper=null,this.parent=null,this.isVirtual=!0,this.setupDone=new Ne,e===null?this._idbWrapper=new Je:e instanceof Je?this._idbWrapper=e:this.parent=e}get path(){return this.parent?this.parent.path.concat(this.name):this.basePath}get hasParentContext(){return this.path.length>1}get idbKey(){return this.path.length===0?this._name:this.path.join("/")}get idbWrapper(){return this._idbWrapper===null?this.parent.idbWrapper:this._idbWrapper}get name(){return this._name}getParent(){return this.parent}async isSameEntry(e){return e.idbKey===this.idbKey}async queryPermission(e){return"granted"}async requestPermission(e){return"granted"}}const zu=new TextEncoder,dr=Symbol("writeMethod");class Gu{constructor(e){this.fileHandle=e,this.tmpData=new Uint8Array,this.cursorOffset=0,this.locked=!1}async write(e){let t;if(typeof e=="string")t=zu.encode(e);else if(e instanceof Blob)t=await e.arrayBuffer().then(u=>new Uint8Array(u));else if("type"in e){if(e.type==="seek")return await this.seek(e.position);if(e.type==="truncate")return await this.truncate(e.size);if(e.type==="write")return e.position&&await this.seek(e.position),await this.write(e.data);throw new Error(`Unknown data type: ${e.type}`)}else ArrayBuffer.isView(e)?t=new Uint8Array(e.buffer):t=new Uint8Array(e);this.tmpData=new Uint8Array([...this.tmpData.slice(0,this.cursorOffset),...t]),this.cursorOffset=this.tmpData.length}async seek(e){this.cursorOffset=Math.floor(e)}async truncate(e){this.tmpData=this.tmpData.slice(0,e),this.cursorOffset>e&&(this.cursorOffset=e)}async close(){await this.fileHandle[dr](this.tmpData)}async abort(){throw new Error("WriteStream was aborted")}getWriter(){}}class fe extends hr{constructor(e,t,u,i=!1,s){super(e,t,s),this.inMemory=i,this.kind="file",this.isFile=!0,this.isDirectory=!1,u?this.setup(u):this.setupDone.dispatch()}get isFileStoredInMemory(){return this.fileData!==void 0}moveData(){if(!this.fileData)throw new Error(`No file data to move to IDB for file "${this.name}"`);const e=this.fileData;return this.fileData=void 0,this.inMemory=!1,e}async setup(e){this.fileData=e;const t=this.path.join("/").startsWith("data/packages");if(this.inMemory||t&&e.length<5e4)return this.inMemory=!0,this.setupDone.dispatch();(!t||globalThis.document)&&await this.updateIdb(e),this.setupDone.dispatch()}async updateIdb(e){await this.idbWrapper.set(this.idbKey,e),this.fileData=void 0}async loadFromIdb(){if(this.fileData)return this.fileData;let e=await this.idbWrapper.get(this.idbKey);if(e===void 0)throw console.log(this.parent),new Error(`File not found: "${this.path.join("/")}"`);return e}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"file",name:this.name,path:this.path,fileData:this.fileData}}static deserialize(e){return new fe(e.idbWrapper?new Je(e.idbWrapper):null,e.name,e.fileData,e.fileData!==void 0,e.path)}async isSameEntry(e){return this.parent===null?!1:super.isSameEntry(e)}async removeSelf(e=!0){await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name)}async getFile(){const e=await this.loadFromIdb();return new File([e],this.name)}async createWritable(){return new Gu(this)}async[dr](e){this.inMemory?this.fileData=e:await this.updateIdb(e)}}class ne extends hr{constructor(e,t,u,i=!1,s=[]){super(e,t,s),this.children=u,this.kind="directory",this.isDirectory=!0,this.isFile=!1,this.updateIdb(i)}get isDirectoryInMemory(){return this.children!==void 0}async moveToIdb(){const e=this.allInMemoryChildren();this.idbWrapper.setMany(e.map(t=>[t.idbKey,t.moveData()]))}moveData(){if(!this.children)throw new Error(`No directory data to move to IDB for directory "${this.name}"`);const e=[...this.children.values()].map(t=>t.name);return this.children=void 0,e}allInMemoryChildren(){if(!this.children)return[];const e=[this];for(const t of this.children.values())t instanceof ne?t.isDirectoryInMemory&&e.push(...t.allInMemoryChildren()):t.isFileStoredInMemory&&e.push(t);return e}async updateIdb(e=!1){e&&await this.idbWrapper.clear(),!this.children&&!await this.hasChildren()&&await this.idbWrapper.set(this.idbKey,[]),this.setupDone.dispatch()}async addChild(e){await this.has(e.name)||(this.children?this.children.set(e.name,e):await this.idbWrapper.set(this.idbKey,[...await this.fromIdb(),e.name]))}async fromIdb(){var e;return(e=await this.idbWrapper.get(this.idbKey))!=null?e:[]}async getChildren(){return this.children?[...this.children.values()]:await Promise.all((await this.fromIdb()).map(e=>this.getChild(e)).filter(e=>e!==void 0))}getChildPath(e){return this.path.concat(e).join("/")}async getChild(e){if(this.children)return this.children.get(e);if(await this.has(e)){const t=await this.idbWrapper.get(this.getChildPath(e));if(t instanceof Uint8Array)return new fe(this,e);if(Array.isArray(t))return new ne(this,e)}}async deleteChild(e){this.children?this.children.delete(e):await this.idbWrapper.set(this.idbKey,(await this.fromIdb()).filter(t=>t!==e))}async hasChildren(){return this.children?this.children.size>0:(await this.fromIdb()).length>0}async has(e){return this.children?this.children.has(e):(await this.fromIdb()).includes(e)}serialize(){return{idbWrapper:this.idbWrapper.storeName,kind:"directory",name:this.name,path:this.path,children:this.children?[...this.children.values()].map(e=>e.serialize()):void 0}}static deserialize(e,t=null){var i;const u=new ne(t||new Je(e.idbWrapper),e.name,void 0,!1,e.path);for(const s of(i=e.children)!=null?i:[])s.kind==="directory"?u.addChild(ne.deserialize(s,u)):u.addChild(new fe(u,s.name,s.fileData));return u}async getDirectoryHandle(e,{create:t}={}){let u=await this.getChild(e);if(u&&u.kind==="file")throw new Error(`TypeMismatch: Expected directory with name "${e}", found file`);if(!u)if(t)u=new ne(this,e,this.children?new Map:void 0),await u.setupDone.fired,await this.addChild(u);else throw new Error(`No file with the name ${e} exists in this folder`);return u}async getFileHandle(e,{create:t,initialData:u}={}){let i=await this.getChild(e);if(i&&i.kind==="directory")throw new Error(`TypeMismatch: Expected file with name "${e}", found directory`);if(!i)if(t)i=new fe(this,e,u!=null?u:new Uint8Array),await i.setupDone.fired,await this.addChild(i);else throw new Error(`No file with the name ${e} exists in this folder`);return i}async removeEntry(e,{recursive:t}={}){const u=await this.getChild(e);if(u){if(u.kind==="directory"&&!t&&await u.hasChildren())throw new Error('Cannot remove directory with children without "recursive" option being set to true')}else throw new Error(`No entry with the name ${e} exists in this folder`);await u.removeSelf(),await this.deleteChild(e)}async resolve(e){const t=[e.name];let u=e.getParent();for(;u!==null&&!await u.isSameEntry(this);)t.unshift(u.name),u=u.getParent();return u===null?null:t}async removeSelf(e=!0){const t=await this.getChildren();for(const u of t)await u.removeSelf(!1);this.children||await this.idbWrapper.del(this.idbKey),this.parent&&e&&this.parent.deleteChild(this.name)}[Symbol.asyncIterator](){return this.entries()}keys(){return this.children?this.children.keys():{childNamesPromise:this.fromIdb(),[Symbol.asyncIterator](){return{i:0,childNamesPromise:this.childNamesPromise,async next(){const e=await this.childNamesPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}entries(){return this.children?this.children.entries():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:[e[this.i].name,e[this.i++]]}:{done:!0}}}}}}values(){return this.children?this.children.values():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}getEntries(){return this.values()}getDirectory(e,t={}){return this.getDirectoryHandle(e,t)}getFile(e,t={}){return this.getFileHandle(e,t)}}Le.set("VirtualFileHandle",{canHandle:r=>r instanceof fe,serialize:r=>[r.serialize(),[]],deserialize:r=>new fe(null,r.name,r.fileData)}),Le.set("VirtualDirectoryHandle",{canHandle:r=>r instanceof ne,serialize:r=>[r.serialize(),[]],deserialize:r=>ne.deserialize(r)}),Le.set("VirtualDirectoryHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({directory:e})=>e instanceof ne),serialize:r=>[r.map(({directory:e,...t})=>({directory:e.serialize(),...t})),[]],deserialize:r=>r.map(({directory:e,...t})=>({directory:ne.deserialize(e),...t}))}),Le.set("VirtualFileHandleArray",{canHandle:r=>Array.isArray(r)&&r.every(({fileHandle:e})=>e instanceof fe),serialize:r=>[r.map(({fileHandle:e,...t})=>({fileHandle:e.serialize(),...t})),[]],deserialize:r=>r.map(({fileHandle:e,...t})=>({fileHandle:fe.deserialize(e),...t}))});var Uu=Object.defineProperty,Vu=Object.defineProperties,Ku=Object.getOwnPropertyDescriptors,pr=Object.getOwnPropertySymbols,Ju=Object.prototype.hasOwnProperty,Xu=Object.prototype.propertyIsEnumerable,Ar=(r,e,t)=>e in r?Uu(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Me=(r,e)=>{for(var t in e||(e={}))Ju.call(e,t)&&Ar(r,t,e[t]);if(pr)for(var t of pr(e))Xu.call(e,t)&&Ar(r,t,e[t]);return r},ut=(r,e)=>Vu(r,Ku(e));function Cr(r,e){for(var t=0,u=r.length-1;u>=0;u--){var i=r[u];i==="."?r.splice(u,1):i===".."?(r.splice(u,1),t++):t&&(r.splice(u,1),t--)}if(e)for(;t--;t)r.unshift("..");return r}var qu=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,kt=function(r){return qu.exec(r).slice(1)};function it(){for(var r="",e=!1,t=arguments.length-1;t>=-1&&!e;t--){var u=t>=0?arguments[t]:"/";if(typeof u!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!u)continue;r=u+"/"+r,e=u.charAt(0)==="/"}return r=Cr(Pt(r.split("/"),function(i){return!!i}),!e).join("/"),(e?"/":"")+r||"."}function Tt(r){var e=Rt(r),t=Zu(r,-1)==="/";return r=Cr(Pt(r.split("/"),function(u){return!!u}),!e).join("/"),!r&&!e&&(r="."),r&&t&&(r+="/"),(e?"/":"")+r}function Rt(r){return r.charAt(0)==="/"}function gr(){var r=Array.prototype.slice.call(arguments,0);return Tt(Pt(r,function(e,t){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Fr(r,e){r=it(r).substr(1),e=it(e).substr(1);function t(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var f=c.length-1;f>=0&&c[f]==="";f--);return h>f?[]:c.slice(h,f-h+1)}for(var u=t(r.split("/")),i=t(e.split("/")),s=Math.min(u.length,i.length),n=s,a=0;a<s;a++)if(u[a]!==i[a]){n=a;break}for(var o=[],a=n;a<u.length;a++)o.push("..");return o=o.concat(i.slice(n)),o.join("/")}var Er="/",yr=":";function mr(r){var e=kt(r),t=e[0],u=e[1];return!t&&!u?".":(u&&(u=u.substr(0,u.length-1)),t+u)}function vr(r,e){var t=kt(r)[2];return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t}function wr(r){return kt(r)[3]}var Qu={extname:wr,basename:vr,dirname:mr,sep:Er,delimiter:yr,relative:Fr,join:gr,isAbsolute:Rt,normalize:Tt,resolve:it};function Pt(r,e){if(r.filter)return r.filter(e);for(var t=[],u=0;u<r.length;u++)e(r[u],u,r)&&t.push(r[u]);return t}var Zu="ab".substr(-1)==="b"?function(r,e,t){return r.substr(e,t)}:function(r,e,t){return e<0&&(e=r.length+e),r.substr(e,t)},$t=Object.freeze({__proto__:null,resolve:it,normalize:Tt,isAbsolute:Rt,join:gr,relative:Fr,sep:Er,delimiter:yr,dirname:mr,basename:vr,extname:wr,default:Qu});function Br(){throw new Error("setTimeout has not been defined")}function Sr(){throw new Error("clearTimeout has not been defined")}var we=Br,Be=Sr,je;typeof window<"u"?je=window:typeof self<"u"?je=self:je={},typeof je.setTimeout=="function"&&(we=setTimeout),typeof je.clearTimeout=="function"&&(Be=clearTimeout);function br(r){if(we===setTimeout)return setTimeout(r,0);if((we===Br||!we)&&setTimeout)return we=setTimeout,setTimeout(r,0);try{return we(r,0)}catch{try{return we.call(null,r,0)}catch{return we.call(this,r,0)}}}function Yu(r){if(Be===clearTimeout)return clearTimeout(r);if((Be===Sr||!Be)&&clearTimeout)return Be=clearTimeout,clearTimeout(r);try{return Be(r)}catch{try{return Be.call(null,r)}catch{return Be.call(this,r)}}}var ge=[],We=!1,Te,nt=-1;function ei(){!We||!Te||(We=!1,Te.length?ge=Te.concat(ge):nt=-1,ge.length&&_r())}function _r(){if(!We){var r=br(ei);We=!0;for(var e=ge.length;e;){for(Te=ge,ge=[];++nt<e;)Te&&Te[nt].run();nt=-1,e=ge.length}Te=null,We=!1,Yu(r)}}function ti(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];ge.push(new xr(r,e)),ge.length===1&&!We&&br(_r)}function xr(r,e){this.fun=r,this.array=e}xr.prototype.run=function(){this.fun.apply(null,this.array)};var ri="browser",ui="browser",ii=!0,ni=[],si="",ai={},oi={},ci={};function Re(){}var li=Re,fi=Re,Di=Re,hi=Re,di=Re,pi=Re,Ai=Re;function Ci(r){throw new Error("process.binding is not supported")}function gi(){return"/"}function Fi(r){throw new Error("process.chdir is not supported")}function Ei(){return 0}var ze=je.performance||{},yi=ze.now||ze.mozNow||ze.msNow||ze.oNow||ze.webkitNow||function(){return new Date().getTime()};function mi(r){var e=yi.call(ze)*.001,t=Math.floor(e),u=Math.floor(e%1*1e9);return r&&(t=t-r[0],u=u-r[1],u<0&&(t--,u+=1e9)),[t,u]}var vi=new Date;function wi(){var r=new Date,e=r-vi;return e/1e3}var Bi={nextTick:ti,title:ri,browser:ii,env:{NODE_ENV:"production"},argv:ni,version:si,versions:ai,on:li,addListener:fi,once:Di,off:hi,removeListener:di,removeAllListeners:pi,emit:Ai,binding:Ci,cwd:gi,chdir:Fi,umask:Ei,hrtime:mi,platform:ui,release:oi,config:ci,uptime:wi};function Si(r,e,t){return t={path:e,exports:{},require:function(u,i){return bi(u,i==null?t.path:i)}},r(t,t.exports),t.exports}function bi(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}const De="\\\\/",kr=`[^${De}]`,Fe="\\.",_i="\\+",xi="\\?",st="\\/",ki="(?=.)",Tr="[^/]",Ot=`(?:${st}|$)`,Rr=`(?:^|${st})`,Ht=`${Fe}{1,2}${Ot}`,Ti=`(?!${Fe})`,Ri=`(?!${Rr}${Ht})`,Pi=`(?!${Fe}{0,1}${Ot})`,$i=`(?!${Ht})`,Oi=`[^.${st}]`,Hi=`${Tr}*?`,Pr={DOT_LITERAL:Fe,PLUS_LITERAL:_i,QMARK_LITERAL:xi,SLASH_LITERAL:st,ONE_CHAR:ki,QMARK:Tr,END_ANCHOR:Ot,DOTS_SLASH:Ht,NO_DOT:Ti,NO_DOTS:Ri,NO_DOT_SLASH:Pi,NO_DOTS_SLASH:$i,QMARK_NO_DOT:Oi,STAR:Hi,START_ANCHOR:Rr},Li=ut(Me({},Pr),{SLASH_LITERAL:`[${De}]`,QMARK:kr,STAR:`${kr}*?`,DOTS_SLASH:`${Fe}{1,2}(?:[${De}]|$)`,NO_DOT:`(?!${Fe})`,NO_DOTS:`(?!(?:^|[${De}])${Fe}{1,2}(?:[${De}]|$))`,NO_DOT_SLASH:`(?!${Fe}{0,1}(?:[${De}]|$))`,NO_DOTS_SLASH:`(?!${Fe}{1,2}(?:[${De}]|$))`,QMARK_NO_DOT:`[^.${De}]`,START_ANCHOR:`(?:^|[${De}])`,END_ANCHOR:`(?:[${De}]|$)`}),Ii={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var Pe={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ii,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:$t.sep,extglobChars(r){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${r.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(r){return r===!0?Li:Pr}},X=Si(function(r,e){const{REGEX_BACKSLASH:t,REGEX_REMOVE_BACKSLASH:u,REGEX_SPECIAL_CHARS:i,REGEX_SPECIAL_CHARS_GLOBAL:s}=Pe;e.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),e.hasRegexChars=n=>i.test(n),e.isRegexChar=n=>n.length===1&&e.hasRegexChars(n),e.escapeRegex=n=>n.replace(s,"\\$1"),e.toPosixSlashes=n=>n.replace(t,"/"),e.removeBackslashes=n=>n.replace(u,a=>a==="\\"?"":a),e.supportsLookbehinds=()=>{const n=Bi.version.slice(1).split(".").map(Number);return n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10},e.isWindows=n=>n&&typeof n.windows=="boolean"?n.windows:$t.sep==="\\",e.escapeLast=(n,a,o)=>{const c=n.lastIndexOf(a,o);return c===-1?n:n[c-1]==="\\"?e.escapeLast(n,a,c-1):`${n.slice(0,c)}\\${n.slice(c)}`},e.removePrefix=(n,a={})=>{let o=n;return o.startsWith("./")&&(o=o.slice(2),a.prefix="./"),o},e.wrapOutput=(n,a={},o={})=>{const c=o.contains?"":"^",h=o.contains?"":"$";let f=`${c}(?:${n})${h}`;return a.negated===!0&&(f=`(?:^(?!${f}).*$)`),f}});const{CHAR_ASTERISK:Lt,CHAR_AT:Ni,CHAR_BACKWARD_SLASH:Xe,CHAR_COMMA:Mi,CHAR_DOT:It,CHAR_EXCLAMATION_MARK:Nt,CHAR_FORWARD_SLASH:$r,CHAR_LEFT_CURLY_BRACE:Mt,CHAR_LEFT_PARENTHESES:jt,CHAR_LEFT_SQUARE_BRACKET:ji,CHAR_PLUS:Wi,CHAR_QUESTION_MARK:Or,CHAR_RIGHT_CURLY_BRACE:zi,CHAR_RIGHT_PARENTHESES:Hr,CHAR_RIGHT_SQUARE_BRACKET:Gi}=Pe,Lr=r=>r===$r||r===Xe,Ir=r=>{r.isPrefix!==!0&&(r.depth=r.isGlobstar?1/0:1)};var Ui=(r,e)=>{const t=e||{},u=r.length-1,i=t.parts===!0||t.scanToEnd===!0,s=[],n=[],a=[];let o=r,c=-1,h=0,f=0,E=!1,v=!1,m=!1,A=!1,y=!1,C=!1,w=!1,S=!1,x=!1,b=!1,I=0,N,B,$={value:"",depth:0,isGlob:!1};const V=()=>c>=u,d=()=>o.charCodeAt(c+1),L=()=>(N=B,o.charCodeAt(++c));for(;c<u;){B=L();let Z;if(B===Xe){w=$.backslashes=!0,B=L(),B===Mt&&(C=!0);continue}if(C===!0||B===Mt){for(I++;V()!==!0&&(B=L());){if(B===Xe){w=$.backslashes=!0,L();continue}if(B===Mt){I++;continue}if(C!==!0&&B===It&&(B=L())===It){if(E=$.isBrace=!0,m=$.isGlob=!0,b=!0,i===!0)continue;break}if(C!==!0&&B===Mi){if(E=$.isBrace=!0,m=$.isGlob=!0,b=!0,i===!0)continue;break}if(B===zi&&(I--,I===0)){C=!1,E=$.isBrace=!0,b=!0;break}}if(i===!0)continue;break}if(B===$r){if(s.push(c),n.push($),$={value:"",depth:0,isGlob:!1},b===!0)continue;if(N===It&&c===h+1){h+=2;continue}f=c+1;continue}if(t.noext!==!0&&(B===Wi||B===Ni||B===Lt||B===Or||B===Nt)===!0&&d()===jt){if(m=$.isGlob=!0,A=$.isExtglob=!0,b=!0,B===Nt&&c===h&&(x=!0),i===!0){for(;V()!==!0&&(B=L());){if(B===Xe){w=$.backslashes=!0,B=L();continue}if(B===Hr){m=$.isGlob=!0,b=!0;break}}continue}break}if(B===Lt){if(N===Lt&&(y=$.isGlobstar=!0),m=$.isGlob=!0,b=!0,i===!0)continue;break}if(B===Or){if(m=$.isGlob=!0,b=!0,i===!0)continue;break}if(B===ji){for(;V()!==!0&&(Z=L());){if(Z===Xe){w=$.backslashes=!0,L();continue}if(Z===Gi){v=$.isBracket=!0,m=$.isGlob=!0,b=!0;break}}if(i===!0)continue;break}if(t.nonegate!==!0&&B===Nt&&c===h){S=$.negated=!0,h++;continue}if(t.noparen!==!0&&B===jt){if(m=$.isGlob=!0,i===!0){for(;V()!==!0&&(B=L());){if(B===jt){w=$.backslashes=!0,B=L();continue}if(B===Hr){b=!0;break}}continue}break}if(m===!0){if(b=!0,i===!0)continue;break}}t.noext===!0&&(A=!1,m=!1);let H=o,se="",D="";h>0&&(se=o.slice(0,h),o=o.slice(h),f-=h),H&&m===!0&&f>0?(H=o.slice(0,f),D=o.slice(f)):m===!0?(H="",D=o):H=o,H&&H!==""&&H!=="/"&&H!==o&&Lr(H.charCodeAt(H.length-1))&&(H=H.slice(0,-1)),t.unescape===!0&&(D&&(D=X.removeBackslashes(D)),H&&w===!0&&(H=X.removeBackslashes(H)));const l={prefix:se,input:r,start:h,base:H,glob:D,isBrace:E,isBracket:v,isGlob:m,isExtglob:A,isGlobstar:y,negated:S,negatedExtglob:x};if(t.tokens===!0&&(l.maxDepth=0,Lr(B)||n.push($),l.tokens=n),t.parts===!0||t.tokens===!0){let Z;for(let O=0;O<s.length;O++){const ie=Z?Z+1:h,Y=s[O],te=r.slice(ie,Y);t.tokens&&(O===0&&h!==0?(n[O].isPrefix=!0,n[O].value=se):n[O].value=te,Ir(n[O]),l.maxDepth+=n[O].depth),(O!==0||te!=="")&&a.push(te),Z=Y}if(Z&&Z+1<r.length){const O=r.slice(Z+1);a.push(O),t.tokens&&(n[n.length-1].value=O,Ir(n[n.length-1]),l.maxDepth+=n[n.length-1].depth)}l.slashes=s,l.parts=a}return l};const{MAX_LENGTH:at,POSIX_REGEX_SOURCE:Vi,REGEX_NON_SPECIAL_CHARS:Ki,REGEX_SPECIAL_CHARS_BACKREF:Ji,REPLACEMENTS:Nr}=Pe,Xi=(r,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...r,e);r.sort();const t=`[${r.join("-")}]`;try{new RegExp(t)}catch{return r.map(i=>X.escapeRegex(i)).join("..")}return t},Ge=(r,e)=>`Missing ${r}: "${e}" - use "\\\\${e}" to match literal characters`,Mr=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a string");r=Nr[r]||r;const t=Me({},e),u=typeof t.maxLength=="number"?Math.min(at,t.maxLength):at;let i=r.length;if(i>u)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${u}`);const s={type:"bos",value:"",output:t.prepend||""},n=[s],a=t.capture?"":"?:",o=X.isWindows(e),c=Pe.globChars(o),h=Pe.extglobChars(c),{DOT_LITERAL:f,PLUS_LITERAL:E,SLASH_LITERAL:v,ONE_CHAR:m,DOTS_SLASH:A,NO_DOT:y,NO_DOT_SLASH:C,NO_DOTS_SLASH:w,QMARK:S,QMARK_NO_DOT:x,STAR:b,START_ANCHOR:I}=c,N=F=>`(${a}(?:(?!${I}${F.dot?A:f}).)*?)`,B=t.dot?"":y,$=t.dot?S:x;let V=t.bash===!0?N(t):b;t.capture&&(V=`(${V})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);const d={input:r,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:n};r=X.removePrefix(r,d),i=r.length;const L=[],H=[],se=[];let D=s,l;const Z=()=>d.index===i-1,O=d.peek=(F=1)=>r[d.index+F],ie=d.advance=()=>r[++d.index]||"",Y=()=>r.slice(d.index+1),te=(F="",z=0)=>{d.consumed+=F,d.index+=z},Ae=F=>{d.output+=F.output!=null?F.output:F.value,te(F.value)},et=()=>{let F=1;for(;O()==="!"&&(O(2)!=="("||O(3)==="?");)ie(),d.start++,F++;return F%2===0?!1:(d.negated=!0,d.start++,!0)},_e=F=>{d[F]++,se.push(F)},Ce=F=>{d[F]--,se.pop()},T=F=>{if(D.type==="globstar"){const z=d.braces>0&&(F.type==="comma"||F.type==="brace"),g=F.extglob===!0||L.length&&(F.type==="pipe"||F.type==="paren");F.type!=="slash"&&F.type!=="paren"&&!z&&!g&&(d.output=d.output.slice(0,-D.output.length),D.type="star",D.value="*",D.output=V,d.output+=D.output)}if(L.length&&F.type!=="paren"&&(L[L.length-1].inner+=F.value),(F.value||F.output)&&Ae(F),D&&D.type==="text"&&F.type==="text"){D.value+=F.value,D.output=(D.output||"")+F.value;return}F.prev=D,n.push(F),D=F},He=(F,z)=>{const g=ut(Me({},h[z]),{conditions:1,inner:""});g.prev=D,g.parens=d.parens,g.output=d.output;const R=(t.capture?"(":"")+g.open;_e("parens"),T({type:F,value:z,output:d.output?"":m}),T({type:"paren",extglob:!0,value:ie(),output:R}),L.push(g)},Ft=F=>{let z=F.close+(t.capture?")":""),g;if(F.type==="negate"){let R=V;F.inner&&F.inner.length>1&&F.inner.includes("/")&&(R=N(t)),(R!==V||Z()||/^\)+$/.test(Y()))&&(z=F.close=`)$))${R}`),F.inner.includes("*")&&(g=Y())&&/^\.[^\\/.]+$/.test(g)&&(z=F.close=`)${g})${R})`),F.prev.type==="bos"&&(d.negatedExtglob=!0)}T({type:"paren",extglob:!0,value:l,output:z}),Ce("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(r)){let F=!1,z=r.replace(Ji,(g,R,K,ue,J,sr)=>ue==="\\"?(F=!0,g):ue==="?"?R?R+ue+(J?S.repeat(J.length):""):sr===0?$+(J?S.repeat(J.length):""):S.repeat(K.length):ue==="."?f.repeat(K.length):ue==="*"?R?R+ue+(J?V:""):V:R?g:`\\${g}`);return F===!0&&(t.unescape===!0?z=z.replace(/\\/g,""):z=z.replace(/\\+/g,g=>g.length%2===0?"\\\\":g?"\\":"")),z===r&&t.contains===!0?(d.output=r,d):(d.output=X.wrapOutput(z,d,e),d)}for(;!Z();){if(l=ie(),l==="\0")continue;if(l==="\\"){const g=O();if(g==="/"&&t.bash!==!0||g==="."||g===";")continue;if(!g){l+="\\",T({type:"text",value:l});continue}const R=/^\\+/.exec(Y());let K=0;if(R&&R[0].length>2&&(K=R[0].length,d.index+=K,K%2!==0&&(l+="\\")),t.unescape===!0?l=ie():l+=ie(),d.brackets===0){T({type:"text",value:l});continue}}if(d.brackets>0&&(l!=="]"||D.value==="["||D.value==="[^")){if(t.posix!==!1&&l===":"){const g=D.value.slice(1);if(g.includes("[")&&(D.posix=!0,g.includes(":"))){const R=D.value.lastIndexOf("["),K=D.value.slice(0,R),ue=D.value.slice(R+2),J=Vi[ue];if(J){D.value=K+J,d.backtrack=!0,ie(),!s.output&&n.indexOf(D)===1&&(s.output=m);continue}}}(l==="["&&O()!==":"||l==="-"&&O()==="]")&&(l=`\\${l}`),l==="]"&&(D.value==="["||D.value==="[^")&&(l=`\\${l}`),t.posix===!0&&l==="!"&&D.value==="["&&(l="^"),D.value+=l,Ae({value:l});continue}if(d.quotes===1&&l!=='"'){l=X.escapeRegex(l),D.value+=l,Ae({value:l});continue}if(l==='"'){d.quotes=d.quotes===1?0:1,t.keepQuotes===!0&&T({type:"text",value:l});continue}if(l==="("){_e("parens"),T({type:"paren",value:l});continue}if(l===")"){if(d.parens===0&&t.strictBrackets===!0)throw new SyntaxError(Ge("opening","("));const g=L[L.length-1];if(g&&d.parens===g.parens+1){Ft(L.pop());continue}T({type:"paren",value:l,output:d.parens?")":"\\)"}),Ce("parens");continue}if(l==="["){if(t.nobracket===!0||!Y().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));l=`\\${l}`}else _e("brackets");T({type:"bracket",value:l});continue}if(l==="]"){if(t.nobracket===!0||D&&D.type==="bracket"&&D.value.length===1){T({type:"text",value:l,output:`\\${l}`});continue}if(d.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(Ge("opening","["));T({type:"text",value:l,output:`\\${l}`});continue}Ce("brackets");const g=D.value.slice(1);if(D.posix!==!0&&g[0]==="^"&&!g.includes("/")&&(l=`/${l}`),D.value+=l,Ae({value:l}),t.literalBrackets===!1||X.hasRegexChars(g))continue;const R=X.escapeRegex(D.value);if(d.output=d.output.slice(0,-D.value.length),t.literalBrackets===!0){d.output+=R,D.value=R;continue}D.value=`(${a}${R}|${D.value})`,d.output+=D.value;continue}if(l==="{"&&t.nobrace!==!0){_e("braces");const g={type:"brace",value:l,output:"(",outputIndex:d.output.length,tokensIndex:d.tokens.length};H.push(g),T(g);continue}if(l==="}"){const g=H[H.length-1];if(t.nobrace===!0||!g){T({type:"text",value:l,output:l});continue}let R=")";if(g.dots===!0){const K=n.slice(),ue=[];for(let J=K.length-1;J>=0&&(n.pop(),K[J].type!=="brace");J--)K[J].type!=="dots"&&ue.unshift(K[J].value);R=Xi(ue,t),d.backtrack=!0}if(g.comma!==!0&&g.dots!==!0){const K=d.output.slice(0,g.outputIndex),ue=d.tokens.slice(g.tokensIndex);g.value=g.output="\\{",l=R="\\}",d.output=K;for(const J of ue)d.output+=J.output||J.value}T({type:"brace",value:l,output:R}),Ce("braces"),H.pop();continue}if(l==="|"){L.length>0&&L[L.length-1].conditions++,T({type:"text",value:l});continue}if(l===","){let g=l;const R=H[H.length-1];R&&se[se.length-1]==="braces"&&(R.comma=!0,g="|"),T({type:"comma",value:l,output:g});continue}if(l==="/"){if(D.type==="dot"&&d.index===d.start+1){d.start=d.index+1,d.consumed="",d.output="",n.pop(),D=s;continue}T({type:"slash",value:l,output:v});continue}if(l==="."){if(d.braces>0&&D.type==="dot"){D.value==="."&&(D.output=f);const g=H[H.length-1];D.type="dots",D.output+=l,D.value+=l,g.dots=!0;continue}if(d.braces+d.parens===0&&D.type!=="bos"&&D.type!=="slash"){T({type:"text",value:l,output:f});continue}T({type:"dot",value:l,output:f});continue}if(l==="?"){if(!(D&&D.value==="(")&&t.noextglob!==!0&&O()==="("&&O(2)!=="?"){He("qmark",l);continue}if(D&&D.type==="paren"){const R=O();let K=l;if(R==="<"&&!X.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(D.value==="("&&!/[!=<:]/.test(R)||R==="<"&&!/<([!=]|\w+>)/.test(Y()))&&(K=`\\${l}`),T({type:"text",value:l,output:K});continue}if(t.dot!==!0&&(D.type==="slash"||D.type==="bos")){T({type:"qmark",value:l,output:x});continue}T({type:"qmark",value:l,output:S});continue}if(l==="!"){if(t.noextglob!==!0&&O()==="("&&(O(2)!=="?"||!/[!=<:]/.test(O(3)))){He("negate",l);continue}if(t.nonegate!==!0&&d.index===0){et();continue}}if(l==="+"){if(t.noextglob!==!0&&O()==="("&&O(2)!=="?"){He("plus",l);continue}if(D&&D.value==="("||t.regex===!1){T({type:"plus",value:l,output:E});continue}if(D&&(D.type==="bracket"||D.type==="paren"||D.type==="brace")||d.parens>0){T({type:"plus",value:l});continue}T({type:"plus",value:E});continue}if(l==="@"){if(t.noextglob!==!0&&O()==="("&&O(2)!=="?"){T({type:"at",extglob:!0,value:l,output:""});continue}T({type:"text",value:l});continue}if(l!=="*"){(l==="$"||l==="^")&&(l=`\\${l}`);const g=Ki.exec(Y());g&&(l+=g[0],d.index+=g[0].length),T({type:"text",value:l});continue}if(D&&(D.type==="globstar"||D.star===!0)){D.type="star",D.star=!0,D.value+=l,D.output=V,d.backtrack=!0,d.globstar=!0,te(l);continue}let F=Y();if(t.noextglob!==!0&&/^\([^?]/.test(F)){He("star",l);continue}if(D.type==="star"){if(t.noglobstar===!0){te(l);continue}const g=D.prev,R=g.prev,K=g.type==="slash"||g.type==="bos",ue=R&&(R.type==="star"||R.type==="globstar");if(t.bash===!0&&(!K||F[0]&&F[0]!=="/")){T({type:"star",value:l,output:""});continue}const J=d.braces>0&&(g.type==="comma"||g.type==="brace"),sr=L.length&&(g.type==="pipe"||g.type==="paren");if(!K&&g.type!=="paren"&&!J&&!sr){T({type:"star",value:l,output:""});continue}for(;F.slice(0,3)==="/**";){const Et=r[d.index+4];if(Et&&Et!=="/")break;F=F.slice(3),te("/**",3)}if(g.type==="bos"&&Z()){D.type="globstar",D.value+=l,D.output=N(t),d.output=D.output,d.globstar=!0,te(l);continue}if(g.type==="slash"&&g.prev.type!=="bos"&&!ue&&Z()){d.output=d.output.slice(0,-(g.output+D.output).length),g.output=`(?:${g.output}`,D.type="globstar",D.output=N(t)+(t.strictSlashes?")":"|$)"),D.value+=l,d.globstar=!0,d.output+=g.output+D.output,te(l);continue}if(g.type==="slash"&&g.prev.type!=="bos"&&F[0]==="/"){const Et=F[1]!==void 0?"|$":"";d.output=d.output.slice(0,-(g.output+D.output).length),g.output=`(?:${g.output}`,D.type="globstar",D.output=`${N(t)}${v}|${v}${Et})`,D.value+=l,d.output+=g.output+D.output,d.globstar=!0,te(l+ie()),T({type:"slash",value:"/",output:""});continue}if(g.type==="bos"&&F[0]==="/"){D.type="globstar",D.value+=l,D.output=`(?:^|${v}|${N(t)}${v})`,d.output=D.output,d.globstar=!0,te(l+ie()),T({type:"slash",value:"/",output:""});continue}d.output=d.output.slice(0,-D.output.length),D.type="globstar",D.output=N(t),D.value+=l,d.output+=D.output,d.globstar=!0,te(l);continue}const z={type:"star",value:l,output:V};if(t.bash===!0){z.output=".*?",(D.type==="bos"||D.type==="slash")&&(z.output=B+z.output),T(z);continue}if(D&&(D.type==="bracket"||D.type==="paren")&&t.regex===!0){z.output=l,T(z);continue}(d.index===d.start||D.type==="slash"||D.type==="dot")&&(D.type==="dot"?(d.output+=C,D.output+=C):t.dot===!0?(d.output+=w,D.output+=w):(d.output+=B,D.output+=B),O()!=="*"&&(d.output+=m,D.output+=m)),T(z)}for(;d.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));d.output=X.escapeLast(d.output,"["),Ce("brackets")}for(;d.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(Ge("closing",")"));d.output=X.escapeLast(d.output,"("),Ce("parens")}for(;d.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(Ge("closing","}"));d.output=X.escapeLast(d.output,"{"),Ce("braces")}if(t.strictSlashes!==!0&&(D.type==="star"||D.type==="bracket")&&T({type:"maybe_slash",value:"",output:`${v}?`}),d.backtrack===!0){d.output="";for(const F of d.tokens)d.output+=F.output!=null?F.output:F.value,F.suffix&&(d.output+=F.suffix)}return d};Mr.fastpaths=(r,e)=>{const t=Me({},e),u=typeof t.maxLength=="number"?Math.min(at,t.maxLength):at,i=r.length;if(i>u)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${u}`);r=Nr[r]||r;const s=X.isWindows(e),{DOT_LITERAL:n,SLASH_LITERAL:a,ONE_CHAR:o,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:f,NO_DOTS_SLASH:E,STAR:v,START_ANCHOR:m}=Pe.globChars(s),A=t.dot?f:h,y=t.dot?E:h,C=t.capture?"":"?:",w={negated:!1,prefix:""};let S=t.bash===!0?".*?":v;t.capture&&(S=`(${S})`);const x=B=>B.noglobstar===!0?S:`(${C}(?:(?!${m}${B.dot?c:n}).)*?)`,b=B=>{switch(B){case"*":return`${A}${o}${S}`;case".*":return`${n}${o}${S}`;case"*.*":return`${A}${S}${n}${o}${S}`;case"*/*":return`${A}${S}${a}${o}${y}${S}`;case"**":return A+x(t);case"**/*":return`(?:${A}${x(t)}${a})?${y}${o}${S}`;case"**/*.*":return`(?:${A}${x(t)}${a})?${y}${S}${n}${o}${S}`;case"**/.*":return`(?:${A}${x(t)}${a})?${n}${o}${S}`;default:{const $=/^(.*?)\.(\w+)$/.exec(B);if(!$)return;const V=b($[1]);return V?V+n+$[2]:void 0}}},I=X.removePrefix(r,w);let N=b(I);return N&&t.strictSlashes!==!0&&(N+=`${a}?`),N};var Wt=Mr;const qi=r=>r&&typeof r=="object"&&!Array.isArray(r),G=(r,e,t=!1)=>{if(Array.isArray(r)){const h=r.map(E=>G(E,e,t));return E=>{for(const v of h){const m=v(E);if(m)return m}return!1}}const u=qi(r)&&r.tokens&&r.input;if(r===""||typeof r!="string"&&!u)throw new TypeError("Expected pattern to be a non-empty string");const i=e||{},s=X.isWindows(e),n=u?G.compileRe(r,e):G.makeRe(r,e,!1,!0),a=n.state;delete n.state;let o=()=>!1;if(i.ignore){const h=ut(Me({},e),{ignore:null,onMatch:null,onResult:null});o=G(i.ignore,h,t)}const c=(h,f=!1)=>{const{isMatch:E,match:v,output:m}=G.test(h,n,e,{glob:r,posix:s}),A={glob:r,state:a,regex:n,posix:s,input:h,output:m,match:v,isMatch:E};return typeof i.onResult=="function"&&i.onResult(A),E===!1?(A.isMatch=!1,f?A:!1):o(h)?(typeof i.onIgnore=="function"&&i.onIgnore(A),A.isMatch=!1,f?A:!1):(typeof i.onMatch=="function"&&i.onMatch(A),f?A:!0)};return t&&(c.state=a),c};G.test=(r,e,t,{glob:u,posix:i}={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");if(r==="")return{isMatch:!1,output:""};const s=t||{},n=s.format||(i?X.toPosixSlashes:null);let a=r===u,o=a&&n?n(r):r;return a===!1&&(o=n?n(r):r,a=o===u),(a===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?a=G.matchBase(r,e,t,i):a=e.exec(o)),{isMatch:Boolean(a),match:a,output:o}},G.matchBase=(r,e,t,u=X.isWindows(t))=>(e instanceof RegExp?e:G.makeRe(e,t)).test($t.basename(r)),G.isMatch=(r,e,t)=>G(e,t)(r),G.parse=(r,e)=>Array.isArray(r)?r.map(t=>G.parse(t,e)):Wt(r,ut(Me({},e),{fastpaths:!1})),G.scan=(r,e)=>Ui(r,e),G.compileRe=(r,e,t=!1,u=!1)=>{if(t===!0)return r.output;const i=e||{},s=i.contains?"":"^",n=i.contains?"":"$";let a=`${s}(?:${r.output})${n}`;r&&r.negated===!0&&(a=`^(?!${a}).*$`);const o=G.toRegex(a,e);return u===!0&&(o.state=r),o},G.makeRe=(r,e={},t=!1,u=!1)=>{if(!r||typeof r!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(r[0]==="."||r[0]==="*")&&(i.output=Wt.fastpaths(r,e)),i.output||(i=Wt(r,e)),G.compileRe(i,e,t,u)},G.toRegex=(r,e)=>{try{const t=e||{};return new RegExp(r,t.flags||(t.nocase?"i":""))}catch(t){if(e&&e.debug===!0)throw t;return/$^/}},G.constants=Pe;var Qi=G,Zi=Qi;function zt(r,e){return Array.isArray(e)?e.some(t=>zt(r,t)):Zi(e)(r)}function ot(r,e,t){var u,i;if(e===void 0)return;if(r.length===0)return t(e);if(typeof e!="object"||e===null)return;const s=r.shift();if(s==="**"){for(;r.length>0&&r[0]==="*";)r.shift();const n=["**",...r].join("/"),a=new Set;jr("",e,a);for(const o of a)zt(o,n)&&ot(o.split("/"),e,t)}else if(s.startsWith("*")){let n;s.length>=1&&(n=new RegExp((i=(u=s.match(/(\*{)(.+)(})/))==null?void 0:u[2])!=null?i:".*"));for(const a in e)n&&a.match(n)!==null&&ot([...r],e[a],t)}else ot(r,e[s],t)}function jr(r,e,t){for(const u in e)t.add(`${r}${u}`),typeof e[u]=="object"&&jr(`${r}${u}/`,e[u],t)}function Wr(r,e,t){const u=r.length===0||r==="/"?[]:r.split("/");return ot(u,e,t)}function Yi(r,e){let t=!1;for(const u of e)if(Wr(u,r,()=>t=!0),t)return!0;return!1}new TextEncoder;function en(r,e){const t=zr(r),u=zr(e),i=t.pop(),s=u.pop(),n=Vr(t,u);return n!==0?n:i&&s?Vr(i.split("."),s.split(".")):i||s?i?-1:1:0}const tn=(r,e,t)=>{sn(t);const u=en(r,e);return Kr[t].includes(u)},rn=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,zr=r=>{if(typeof r!="string")throw new TypeError("Invalid argument expected string");const e=r.match(rn);if(!e)throw new Error(`Invalid argument not valid semver ('${r}' received)`);return e.shift(),e},Gr=r=>r==="*"||r==="x"||r==="X",Ur=r=>{const e=parseInt(r,10);return isNaN(e)?r:e},un=(r,e)=>typeof r!=typeof e?[String(r),String(e)]:[r,e],nn=(r,e)=>{if(Gr(r)||Gr(e))return 0;const[t,u]=un(Ur(r),Ur(e));return t>u?1:t<u?-1:0},Vr=(r,e)=>{for(let t=0;t<Math.max(r.length,e.length);t++){const u=nn(r[t]||0,e[t]||0);if(u!==0)return u}return 0},Kr={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Jr=Object.keys(Kr),sn=r=>{if(typeof r!="string")throw new TypeError(`Invalid operator type, expected string but got ${typeof r}`);if(Jr.indexOf(r)===-1)throw new Error(`Invalid operator, expected one of ${Jr.join("|")}`)};function he(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function Xr(r,e){for(var t="",u=0,i=-1,s=0,n,a=0;a<=r.length;++a){if(a<r.length)n=r.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||u!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var o=t.lastIndexOf("/");if(o!==t.length-1){o===-1?(t="",u=0):(t=t.slice(0,o),u=t.length-1-t.lastIndexOf("/")),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",u=0,i=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",u=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),u=a-i-1;i=a,s=0}else n===46&&s!==-1?++s:s=-1}return t}function an(r,e){var t=e.dir||e.root,u=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+u:t+r+u:u}var Ue={resolve:function(){for(var e="",t=!1,u,i=arguments.length-1;i>=-1&&!t;i--){var s;i>=0?s=arguments[i]:(u===void 0&&(u=process.cwd()),s=u),he(s),s.length!==0&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=Xr(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(he(e),e.length===0)return".";var t=e.charCodeAt(0)===47,u=e.charCodeAt(e.length-1)===47;return e=Xr(e,!t),e.length===0&&!t&&(e="."),e.length>0&&u&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return he(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var u=arguments[t];he(u),u.length>0&&(e===void 0?e=u:e+="/"+u)}return e===void 0?".":Ue.normalize(e)},relative:function(e,t){if(he(e),he(t),e===t||(e=Ue.resolve(e),t=Ue.resolve(t),e===t))return"";for(var u=1;u<e.length&&e.charCodeAt(u)===47;++u);for(var i=e.length,s=i-u,n=1;n<t.length&&t.charCodeAt(n)===47;++n);for(var a=t.length,o=a-n,c=s<o?s:o,h=-1,f=0;f<=c;++f){if(f===c){if(o>c){if(t.charCodeAt(n+f)===47)return t.slice(n+f+1);if(f===0)return t.slice(n+f)}else s>c&&(e.charCodeAt(u+f)===47?h=f:f===0&&(h=0));break}var E=e.charCodeAt(u+f),v=t.charCodeAt(n+f);if(E!==v)break;E===47&&(h=f)}var m="";for(f=u+h+1;f<=i;++f)(f===i||e.charCodeAt(f)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+t.slice(n+h):(n+=h,t.charCodeAt(n)===47&&++n,t.slice(n))},_makeLong:function(e){return e},dirname:function(e){if(he(e),e.length===0)return".";for(var t=e.charCodeAt(0),u=t===47,i=-1,s=!0,n=e.length-1;n>=1;--n)if(t=e.charCodeAt(n),t===47){if(!s){i=n;break}}else s=!1;return i===-1?u?"/":".":u&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');he(e);var u=0,i=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,o=-1;for(n=e.length-1;n>=0;--n){var c=e.charCodeAt(n);if(c===47){if(!s){u=n+1;break}}else o===-1&&(s=!1,o=n+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(i=n):(a=-1,i=o))}return u===i?i=o:i===-1&&(i=e.length),e.slice(u,i)}else{for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!s){u=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":e.slice(u,i)}},extname:function(e){he(e);for(var t=-1,u=0,i=-1,s=!0,n=0,a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(o===47){if(!s){u=a+1;break}continue}i===-1&&(s=!1,i=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===u+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return an("/",e)},parse:function(e){he(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var u=e.charCodeAt(0),i=u===47,s;i?(t.root="/",s=1):s=0;for(var n=-1,a=0,o=-1,c=!0,h=e.length-1,f=0;h>=s;--h){if(u=e.charCodeAt(h),u===47){if(!c){a=h+1;break}continue}o===-1&&(c=!1,o=h+1),u===46?n===-1?n=h:f!==1&&(f=1):n!==-1&&(f=-1)}return n===-1||o===-1||f===0||f===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&i?t.base=t.name=e.slice(1,o):t.base=t.name=e.slice(a,o)):(a===0&&i?(t.name=e.slice(1,n),t.base=e.slice(1,o)):(t.name=e.slice(a,n),t.base=e.slice(a,o)),t.ext=e.slice(n,o)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Ue.posix=Ue;var oe=Ue,on=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,cn=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ln=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Gt={Space_Separator:on,ID_Start:cn,ID_Continue:ln},U={isSpaceSeparator(r){return typeof r=="string"&&Gt.Space_Separator.test(r)},isIdStartChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="$"||r==="_"||Gt.ID_Start.test(r))},isIdContinueChar(r){return typeof r=="string"&&(r>="a"&&r<="z"||r>="A"&&r<="Z"||r>="0"&&r<="9"||r==="$"||r==="_"||r==="\u200C"||r==="\u200D"||Gt.ID_Continue.test(r))},isDigit(r){return typeof r=="string"&&/[0-9]/.test(r)},isHexDigit(r){return typeof r=="string"&&/[0-9A-Fa-f]/.test(r)}};let Ut,re,Ee,ct,Se,ce,q,Vt,qe;var fn=function(e,t){Ut=String(e),re="start",Ee=[],ct=0,Se=1,ce=0,q=void 0,Vt=void 0,qe=void 0;do q=Dn(),pn[re]();while(q.type!=="eof");return typeof t=="function"?qr({"":qe},"",t):qe};function qr(r,e,t){const u=r[e];if(u!=null&&typeof u=="object")for(const i in u){const s=qr(u,i,t);s===void 0?delete u[i]:u[i]=s}return t.call(r,e,u)}let k,_,Qe,ye,P;function Dn(){for(k="default",_="",Qe=!1,ye=1;;){P=me();const r=Qr[k]();if(r)return r}}function me(){if(Ut[ct])return String.fromCodePoint(Ut.codePointAt(ct))}function p(){const r=me();return r===`
`?(Se++,ce=0):r?ce+=r.length:ce++,r&&(ct+=r.length),r}const Qr={default(){switch(P){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":p();return;case"/":p(),k="comment";return;case void 0:return p(),M("eof")}if(U.isSpaceSeparator(P)){p();return}return Qr[re]()},comment(){switch(P){case"*":p(),k="multiLineComment";return;case"/":p(),k="singleLineComment";return}throw j(p())},multiLineComment(){switch(P){case"*":p(),k="multiLineCommentAsterisk";return;case void 0:throw j(p())}p()},multiLineCommentAsterisk(){switch(P){case"*":p();return;case"/":p(),k="default";return;case void 0:throw j(p())}p(),k="multiLineComment"},singleLineComment(){switch(P){case`
`:case"\r":case"\u2028":case"\u2029":p(),k="default";return;case void 0:return p(),M("eof")}p()},value(){switch(P){case"{":case"[":return M("punctuator",p());case"n":return p(),$e("ull"),M("null",null);case"t":return p(),$e("rue"),M("boolean",!0);case"f":return p(),$e("alse"),M("boolean",!1);case"-":case"+":p()==="-"&&(ye=-1),k="sign";return;case".":_=p(),k="decimalPointLeading";return;case"0":_=p(),k="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":_=p(),k="decimalInteger";return;case"I":return p(),$e("nfinity"),M("numeric",1/0);case"N":return p(),$e("aN"),M("numeric",NaN);case'"':case"'":Qe=p()==='"',_="",k="string";return}throw j(p())},identifierNameStartEscape(){if(P!=="u")throw j(p());p();const r=Kt();switch(r){case"$":case"_":break;default:if(!U.isIdStartChar(r))throw Zr();break}_+=r,k="identifierName"},identifierName(){switch(P){case"$":case"_":case"\u200C":case"\u200D":_+=p();return;case"\\":p(),k="identifierNameEscape";return}if(U.isIdContinueChar(P)){_+=p();return}return M("identifier",_)},identifierNameEscape(){if(P!=="u")throw j(p());p();const r=Kt();switch(r){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!U.isIdContinueChar(r))throw Zr();break}_+=r,k="identifierName"},sign(){switch(P){case".":_=p(),k="decimalPointLeading";return;case"0":_=p(),k="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":_=p(),k="decimalInteger";return;case"I":return p(),$e("nfinity"),M("numeric",ye*(1/0));case"N":return p(),$e("aN"),M("numeric",NaN)}throw j(p())},zero(){switch(P){case".":_+=p(),k="decimalPoint";return;case"e":case"E":_+=p(),k="decimalExponent";return;case"x":case"X":_+=p(),k="hexadecimal";return}return M("numeric",ye*0)},decimalInteger(){switch(P){case".":_+=p(),k="decimalPoint";return;case"e":case"E":_+=p(),k="decimalExponent";return}if(U.isDigit(P)){_+=p();return}return M("numeric",ye*Number(_))},decimalPointLeading(){if(U.isDigit(P)){_+=p(),k="decimalFraction";return}throw j(p())},decimalPoint(){switch(P){case"e":case"E":_+=p(),k="decimalExponent";return}if(U.isDigit(P)){_+=p(),k="decimalFraction";return}return M("numeric",ye*Number(_))},decimalFraction(){switch(P){case"e":case"E":_+=p(),k="decimalExponent";return}if(U.isDigit(P)){_+=p();return}return M("numeric",ye*Number(_))},decimalExponent(){switch(P){case"+":case"-":_+=p(),k="decimalExponentSign";return}if(U.isDigit(P)){_+=p(),k="decimalExponentInteger";return}throw j(p())},decimalExponentSign(){if(U.isDigit(P)){_+=p(),k="decimalExponentInteger";return}throw j(p())},decimalExponentInteger(){if(U.isDigit(P)){_+=p();return}return M("numeric",ye*Number(_))},hexadecimal(){if(U.isHexDigit(P)){_+=p(),k="hexadecimalInteger";return}throw j(p())},hexadecimalInteger(){if(U.isHexDigit(P)){_+=p();return}return M("numeric",ye*Number(_))},string(){switch(P){case"\\":p(),_+=hn();return;case'"':if(Qe)return p(),M("string",_);_+=p();return;case"'":if(!Qe)return p(),M("string",_);_+=p();return;case`
`:case"\r":throw j(p());case"\u2028":case"\u2029":An(P);break;case void 0:throw j(p())}_+=p()},start(){switch(P){case"{":case"[":return M("punctuator",p())}k="value"},beforePropertyName(){switch(P){case"$":case"_":_=p(),k="identifierName";return;case"\\":p(),k="identifierNameStartEscape";return;case"}":return M("punctuator",p());case'"':case"'":Qe=p()==='"',k="string";return}if(U.isIdStartChar(P)){_+=p(),k="identifierName";return}throw j(p())},afterPropertyName(){if(P===":")return M("punctuator",p());throw j(p())},beforePropertyValue(){k="value"},afterPropertyValue(){switch(P){case",":case"}":return M("punctuator",p())}throw j(p())},beforeArrayValue(){if(P==="]")return M("punctuator",p());k="value"},afterArrayValue(){switch(P){case",":case"]":return M("punctuator",p())}throw j(p())},end(){throw j(p())}};function M(r,e){return{type:r,value:e,line:Se,column:ce}}function $e(r){for(const e of r){if(me()!==e)throw j(p());p()}}function hn(){switch(me()){case"b":return p(),"\b";case"f":return p(),"\f";case"n":return p(),`
`;case"r":return p(),"\r";case"t":return p(),"	";case"v":return p(),"\v";case"0":if(p(),U.isDigit(me()))throw j(p());return"\0";case"x":return p(),dn();case"u":return p(),Kt();case`
`:case"\u2028":case"\u2029":return p(),"";case"\r":return p(),me()===`
`&&p(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw j(p());case void 0:throw j(p())}return p()}function dn(){let r="",e=me();if(!U.isHexDigit(e)||(r+=p(),e=me(),!U.isHexDigit(e)))throw j(p());return r+=p(),String.fromCodePoint(parseInt(r,16))}function Kt(){let r="",e=4;for(;e-- >0;){const t=me();if(!U.isHexDigit(t))throw j(p());r+=p()}return String.fromCodePoint(parseInt(r,16))}const pn={start(){if(q.type==="eof")throw Oe();Jt()},beforePropertyName(){switch(q.type){case"identifier":case"string":Vt=q.value,re="afterPropertyName";return;case"punctuator":lt();return;case"eof":throw Oe()}},afterPropertyName(){if(q.type==="eof")throw Oe();re="beforePropertyValue"},beforePropertyValue(){if(q.type==="eof")throw Oe();Jt()},beforeArrayValue(){if(q.type==="eof")throw Oe();if(q.type==="punctuator"&&q.value==="]"){lt();return}Jt()},afterPropertyValue(){if(q.type==="eof")throw Oe();switch(q.value){case",":re="beforePropertyName";return;case"}":lt()}},afterArrayValue(){if(q.type==="eof")throw Oe();switch(q.value){case",":re="beforeArrayValue";return;case"]":lt()}},end(){}};function Jt(){let r;switch(q.type){case"punctuator":switch(q.value){case"{":r={};break;case"[":r=[];break}break;case"null":case"boolean":case"numeric":case"string":r=q.value;break}if(qe===void 0)qe=r;else{const e=Ee[Ee.length-1];Array.isArray(e)?e.push(r):e[Vt]=r}if(r!==null&&typeof r=="object")Ee.push(r),Array.isArray(r)?re="beforeArrayValue":re="beforePropertyName";else{const e=Ee[Ee.length-1];e==null?re="end":Array.isArray(e)?re="afterArrayValue":re="afterPropertyValue"}}function lt(){Ee.pop();const r=Ee[Ee.length-1];r==null?re="end":Array.isArray(r)?re="afterArrayValue":re="afterPropertyValue"}function j(r){return ft(r===void 0?`JSON5: invalid end of input at ${Se}:${ce}`:`JSON5: invalid character '${Yr(r)}' at ${Se}:${ce}`)}function Oe(){return ft(`JSON5: invalid end of input at ${Se}:${ce}`)}function Zr(){return ce-=5,ft(`JSON5: invalid identifier character at ${Se}:${ce}`)}function An(r){console.warn(`JSON5: '${Yr(r)}' in strings is not valid ECMAScript; consider escaping`)}function Yr(r){const e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(e[r])return e[r];if(r<" "){const t=r.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return r}function ft(r){const e=new SyntaxError(r);return e.lineNumber=Se,e.columnNumber=ce,e}var Cn=function(e,t,u){const i=[];let s="",n,a,o="",c;if(t!=null&&typeof t=="object"&&!Array.isArray(t)&&(u=t.space,c=t.quote,t=t.replacer),typeof t=="function")a=t;else if(Array.isArray(t)){n=[];for(const A of t){let y;typeof A=="string"?y=A:(typeof A=="number"||A instanceof String||A instanceof Number)&&(y=String(A)),y!==void 0&&n.indexOf(y)<0&&n.push(y)}}return u instanceof Number?u=Number(u):u instanceof String&&(u=String(u)),typeof u=="number"?u>0&&(u=Math.min(10,Math.floor(u)),o="          ".substr(0,u)):typeof u=="string"&&(o=u.substr(0,10)),h("",{"":e});function h(A,y){let C=y[A];switch(C!=null&&(typeof C.toJSON5=="function"?C=C.toJSON5(A):typeof C.toJSON=="function"&&(C=C.toJSON(A))),a&&(C=a.call(y,A,C)),C instanceof Number?C=Number(C):C instanceof String?C=String(C):C instanceof Boolean&&(C=C.valueOf()),C){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof C=="string")return f(C);if(typeof C=="number")return String(C);if(typeof C=="object")return Array.isArray(C)?m(C):E(C)}function f(A){const y={"'":.1,'"':.2},C={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let w="";for(let x=0;x<A.length;x++){const b=A[x];switch(b){case"'":case'"':y[b]++,w+=b;continue;case"\0":if(U.isDigit(A[x+1])){w+="\\x00";continue}}if(C[b]){w+=C[b];continue}if(b<" "){let I=b.charCodeAt(0).toString(16);w+="\\x"+("00"+I).substring(I.length);continue}w+=b}const S=c||Object.keys(y).reduce((x,b)=>y[x]<y[b]?x:b);return w=w.replace(new RegExp(S,"g"),C[S]),S+w+S}function E(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let y=s;s=s+o;let C=n||Object.keys(A),w=[];for(const x of C){const b=h(x,A);if(b!==void 0){let I=v(x)+":";o!==""&&(I+=" "),I+=b,w.push(I)}}let S;if(w.length===0)S="{}";else{let x;if(o==="")x=w.join(","),S="{"+x+"}";else{let b=`,
`+s;x=w.join(b),S=`{
`+s+x+`,
`+y+"}"}}return i.pop(),s=y,S}function v(A){if(A.length===0)return f(A);const y=String.fromCodePoint(A.codePointAt(0));if(!U.isIdStartChar(y))return f(A);for(let C=y.length;C<A.length;C++)if(!U.isIdContinueChar(String.fromCodePoint(A.codePointAt(C))))return f(A);return A}function m(A){if(i.indexOf(A)>=0)throw TypeError("Converting circular structure to JSON5");i.push(A);let y=s;s=s+o;let C=[];for(let S=0;S<A.length;S++){const x=h(String(S),A);C.push(x!==void 0?x:"null")}let w;if(C.length===0)w="[]";else if(o===""){let S=C.join(",");w="["+S+"]"}else{let S=`,
`+s,x=C.join(S);w=`[
`+s+x+`,
`+y+"]"}return i.pop(),s=y,w}},Dt={parse:fn,stringify:Cn};const Xt={behaviorPack:"./BP",resourcePack:"./RP",skinPack:"./SP",worldTemplate:"./WT"};class gn{constructor(e){this.basePath=e,this.data={}}async refreshConfig(){this.data=await this.readConfig()}async setup(){await this.refreshConfig()}get(){return this.data}getRelativePackRoot(e){var t,u;return(u=(t=this.data.packs)==null?void 0:t[e])!=null?u:Xt[e]}getAbsolutePackRoot(e){return this.resolvePackPath(e)}resolvePackPath(e,t){return!t&&!e?this.basePath:!e&&t?oe.join(this.basePath,t):!t&&e?oe.join(this.basePath,this.getRelativePackRoot(e)):oe.join(this.basePath,`${this.getRelativePackRoot(e)}/${t}`)}getAvailablePackPaths(){var e;const t=[];for(const u of Object.keys((e=this.data.packs)!=null?e:{}))t.push(this.resolvePackPath(u));return t}getAvailablePacks(){var e;const t={};for(const u in(e=this.data.packs)!=null?e:{})t[u]=this.resolvePackPath(u);return t}async save(){await this.writeConfig(this.data)}}class Fn{constructor(e){this.projectConfig=e,this.packTypes=[],this.extensionPackTypes=new Set}setProjectConfig(e){this.projectConfig=e}get all(){return this.packTypes.concat(...Array.from(this.extensionPackTypes.values()))}getFromId(e){return this.all.find(t=>t.id===e)}get(e){var t,u;const i=(u=(t=this.projectConfig)==null?void 0:t.getAvailablePacks())!=null?u:Xt;for(const s in i)if(e.startsWith(i[s]))return this.getFromId(s)}getId(e){var t,u;return(u=(t=this.get(e))==null?void 0:t.id)!=null?u:"unknown"}addExtensionPackType(e){return this.extensionPackTypes.add(e),{dispose:()=>this.extensionPackTypes.delete(e)}}}class En{constructor(e,t){this.projectConfig=e,this.isMatch=t,this.pluginFileTypes=new Set,this._fileTypes=[]}get fileTypes(){return this._fileTypes}set fileTypes(e){this._fileTypes=e.sort((t,u)=>t.add==="post"&&u.add!=="post"?1:t.add!=="post"&&u.add==="post"||t.add==="pre"&&u.add!=="pre"?-1:t.add!=="pre"&&u.add==="pre"?1:0)}get all(){return this.fileTypes.concat([...this.pluginFileTypes.values()])}setProjectConfig(e){this.projectConfig=e}addPluginFileType(e){return this.pluginFileTypes.add(e),{dispose:()=>this.pluginFileTypes.delete(e)}}getPluginFileTypes(){return[...this.pluginFileTypes.values()]}setPluginFileTypes(e=[]){this.pluginFileTypes.clear(),e.forEach(t=>this.pluginFileTypes.add(t))}get(e,t,u=!0){var i,s,n,a,o,c,h,f,E,v,m,A,y;const C=e?oe.extname(e):null;if(!!C)for(const w of this.all){if(t!==void 0&&t===w.id)return w;if(!e)continue;const S=((i=w.detect)==null?void 0:i.packType)===void 0?[]:Array.isArray((s=w.detect)==null?void 0:s.packType)?(n=w.detect)==null?void 0:n.packType:[(a=w.detect)==null?void 0:a.packType],x=(o=w.detect)==null?void 0:o.fileExtensions,b=!!((c=w.detect)!=null&&c.scope),I=Array.isArray((h=w.detect)==null?void 0:h.scope)?(f=w.detect)==null?void 0:f.scope:[(E=w.detect)==null?void 0:E.scope],N=!!((v=w.detect)!=null&&v.matcher),B=Array.isArray((m=w.detect)==null?void 0:m.matcher)?(A=w.detect)==null?void 0:A.matcher:[(y=w.detect)==null?void 0:y.matcher];if(!(u&&x&&!x.includes(C)))if(b){if(this.prefixMatchers(S,I).some($=>e.startsWith($)))return w}else if(N){const $=this.prefixMatchers(S,B.filter(d=>!d.startsWith("!"))),V=this.prefixMatchers(S,B.filter(d=>d.startsWith("!")).map(d=>d.slice(1)));if(this.isMatch(e,$)&&!this.isMatch(e,V))return w}else throw console.log(w),new Error('Invalid file definition, no "detect" properties')}}prefixMatchers(e,t){if(!this.projectConfig)return[];if(e.length===0)return t.map(i=>this.projectConfig.resolvePackPath(void 0,i));const u=[];for(const i of e)for(const s of t)u.push(this.projectConfig.resolvePackPath(i,s));return u}getIds(){const e=[];for(const t of this.all)e.push(t.id);return e}async guessFolder(e){var t;const u=(h,f)=>{var E,v;let m=Array.isArray(h)?h[0]:h;m.endsWith("/")||(m+="/");const A=(v=(E=this.projectConfig)==null?void 0:E.getAbsolutePackRoot(f))!=null?v:"./unknown";return oe.join(A,m)},i=`.${e.name.split(".").pop()}`,s=this.all.filter(({detect:h})=>{var f;return!h||!h.scope?!1:(f=h.fileExtensions)==null?void 0:f.includes(i)}),n=s.length===1,a=i!==".json"&&s.length>0;if(n||a){const{detect:h}=s[0];return u(h.scope,Array.isArray(h.packType)?h.packType[0]:(t=h.packType)!=null?t:"behaviorPack")}if(i!==".json")return null;const o=await e.getFile();let c;try{c=Dt.parse(await o.text())}catch{return null}for(const{type:h,detect:f}of s){if(typeof h=="string"&&h!=="json")continue;const{scope:E,fileContent:v,packType:m="behaviorPack"}=f!=null?f:{};if(!(!E||!v)&&!!Yi(c,v))return u(E,Array.isArray(m)?m[0]:m)}return null}getId(e){var t,u;return(u=(t=this.get(e))==null?void 0:t.id)!=null?u:"unknown"}isJsonFile(e){var t,u;const i=(u=(t=this.get(e))==null?void 0:t.meta)==null?void 0:u.language;return i?i==="json":e.endsWith(".json")}}class yn extends En{constructor(e){super(e,zt),this.ready=new Ne,this.lCacheFiles={},this.lCacheFilesLoaded=new Ne,this.packSpiderFiles={},this.packSpiderFilesLoaded=new Ne}setProjectConfig(e){this.projectConfig=e}async setup(e){this.fileTypes.length>0||(await e.fired,this.fileTypes=await e.readJSON("data/packages/minecraftBedrock/fileDefinitions.json"),this.loadLightningCache(e),this.loadPackSpider(e),this.ready.dispatch())}getMonacoSchemaEntries(){return this.fileTypes.map(({detect:e={},schema:t})=>{if(!e.matcher)return null;const u=(e==null?void 0:e.packType)===void 0?[]:Array.isArray(e==null?void 0:e.packType)?e==null?void 0:e.packType:[e==null?void 0:e.packType];return{fileMatch:this.prefixMatchers(u,Array.isArray(e.matcher)?[...e.matcher]:[e.matcher]).map(i=>encodeURI(i).replaceAll(/;|,|@|&|=|\+|\$|\.|!|'|\(|\)|#/g,"*")),uri:t}}).filter(e=>e!==null).flat()}async loadLightningCache(e){var i;const t=await e.readJSON("data/packages/minecraftBedrock/lightningCaches.json"),u=s=>Object.entries(t).find(([n])=>n.endsWith(s));for(const s of this.fileTypes){if(!s.lightningCache)continue;const[n,a]=(i=u(s.lightningCache))!=null?i:[];if(!n)throw new Error(`Lightning cache file "${s.lightningCache}" for file type "${s.id}" not found`);this.lCacheFiles[s.lightningCache]=a}this.lCacheFilesLoaded.dispatch()}async getLightningCache(e){var u,i;const{lightningCache:t}=(u=this.get(e))!=null?u:{};return t?(await this.lCacheFilesLoaded.fired,(i=this.lCacheFiles[t])!=null?i:[]):[]}async loadPackSpider(e){const t=await e.readJSON("data/packages/minecraftBedrock/packSpiders.json");this.packSpiderFiles=Object.fromEntries(this.fileTypes.map(({id:u,packSpider:i})=>{if(!!i)return[u,t[`file:///data/packages/minecraftBedrock/packSpider/${i}`]]}).filter(u=>u!==void 0)),this.packSpiderFilesLoaded.dispatch()}async getPackSpiderData(){return await this.packSpiderFilesLoaded.fired,this.packSpiderFiles}}class mn{constructor(e,t,u){this.taskService=e,this.current=t,this.total=u}addToCurrent(e){this.current+=e!=null?e:1,this.taskService.dispatch([this.getCurrent(),this.getTotal()])}addToTotal(e){this.total+=e!=null?e:1,this.taskService.dispatch([this.getCurrent(),this.getTotal()])}getTotal(){return this.total}getCurrent(){return this.current}setTotal(e){this.total=e}}class vn extends Dr{constructor(){super(...arguments),this.lastDispatch=0}async start(e){this.progress=new mn(this,0,0);const t=await this.onStart(e);return this.dispatch([this.progress.getCurrent(),this.progress.getCurrent()]),t}dispatch(e){this.lastDispatch+200>Date.now()||(super.dispatch(e),this.lastDispatch=Date.now())}}const eu=oe.dirname,qt=oe.join,wn=oe.extname,Qt=oe.basename;oe.resolve,oe.relative;class Bn{constructor(e,t,u){this.fileType=t,this.projectPath=u,this._visitedFiles=0,this._totalFiles=0,this.fs=e}get visitedFiles(){return this._visitedFiles}get totalFiles(){return this._totalFiles}reset(){this.store={}}async setup(){var s,n;let e=[];try{e=(await this.fs.readFile(".bridge/.lightningCache").then(a=>a.text())).split(`
`)}catch{}if(this.store={},this._visitedFiles=0,this._totalFiles=0,e.length===0)return;let t=0;e[0].startsWith("$formatVersion: ")&&(t=Number((n=(s=e[0].match(/\d+/))==null?void 0:s[0])!=null?n:0),e.shift());const u=this.projectPath;let i="unknown";for(const a of e){if(a==="")continue;if(a[0]==="#"){i=a.slice(1),this.store[i]={};continue}let[o,c,h]=a.split("|");t===0&&(o=qt(u,o)),this._totalFiles++,this.store[i][o]={lastModified:Number(c),data:h?JSON.parse(h):void 0}}}async saveStore(e=!0){let t=`$formatVersion: 1
`;const u=[];for(const i in this.store){t+=`#${i}
`;for(const s in this.store[i]){const n=this.store[i][s];if(!n.isForeignFile){if(e&&!n.visited){u.push(s),delete this.store[i][s];continue}t+=`${s}|${n.lastModified}`,n.data?t+=`|${JSON.stringify(n.data)}
`:t+=`
`}}}return await this.fs.writeFile(".bridge/.lightningCache",t),u}add(e,{lastModified:t,data:u,isForeignFile:i},s=this.fileType.getId(e)){var n,a;this.store[s]||(this.store[s]={}),this._visitedFiles++,this.store[s][e]||this._totalFiles++,this.store[s][e]={visited:!0,lastModified:t,isForeignFile:i,data:u!=null?u:(a=(n=this.store[s])==null?void 0:n[e])==null?void 0:a.data}}remove(e,t=this.fileType.getId(e)){!this.store[t]||delete this.store[t][e]}rename(e,t){const u=/\.\w+$/.test(e);for(const i in this.store)for(const s in this.store[i])if(u&&s===e||!u&&s.startsWith(e)){const n=s.replace(e,t),a=this.fileType.getId(n);this.store[a][n]=this.store[i][s],delete this.store[i][s]}}setVisited(e,t,u=this.fileType.getId(e)){var i,s;this._visitedFiles++,(s=(i=this.store)==null?void 0:i[u])!=null&&s[e]&&(this.store[u][e].visited=t)}getLastModified(e,t=this.fileType.getId(e)){var u,i;return(i=(u=this.store[t])==null?void 0:u[e])==null?void 0:i.lastModified}find(e,t,u,i=!1){var a,o;if(!u||u.length===0)return[];const s=this.store[e],n=[];for(const c in s)if(((o=(a=s[c].data)==null?void 0:a[t])!=null?o:[]).find(f=>u.includes(f)))if(i)n.push(c);else return[c];return n}findMultiple(e,t,u,i=!1){const s=[];for(const n of e){const a=this.find(n,t,u,i);if(a.length>0&&!i)return a;s.push(...a)}return s}async forEach(e,t){const u=this.store[e],i=[];for(const s in u)i.push(t(s,u[s]));await Promise.all(i)}get(e,t=this.fileType.getId(e)){var u,i;return(i=(u=this.store[t])==null?void 0:u[e])!=null?i:{}}has(e,t=this.fileType.getId(e)){var u;return!!((u=this.store[t])!=null&&u[e])}allFiles(e){const t=[];if(e&&this.store)for(const u in this.store[e])this.store[e][u].isForeignFile||t.push(u);else for(const u in this.store)for(const i in this.store[u])this.store[u][i].isForeignFile||t.push(i);return t}getAllFrom(e,t){var i,s,n;const u={};for(const a in(i=this.store[e])!=null?i:{}){if(t&&t!==a)continue;const o=(n=((s=this.store[e][a])!=null?s:{}).data)!=null?n:{};for(const c in o)u[c]?u[c].push(...o[c]):u[c]=[...o[c]]}for(const a in u)u[a]=[...new Set(u[a])];return u}async getSchemasFor(e,t){const u=await this.getAllFrom(e,t),i=`file:///data/packages/minecraftBedrock/schema/${e}/dynamic`,s=[];for(const n in u)s.push({uri:`${i}/${t?"currentContext/":""}${n}Enum.json`,schema:{type:"string",enum:u[n]}}),s.push({uri:`${i}/${t?"currentContext/":""}${n}Property.json`,schema:{properties:Object.fromEntries(u[n].map(a=>[a,{}]))}});return s}getCacheDataFor(e,t,u){const i=this.getAllFrom(e,t);return typeof u=="string"?i[u]:i}}class Sn{constructor(e,t){this.packIndexer=e,this.lightningStore=t,this.packSpiderFiles=new Map}get fileType(){return this.packIndexer.fileType}async setup(e){const t=await this.fileType.getPackSpiderData();for(const u in t){const i=t[u],s=this.lightningStore.allFiles(u);for(const n of s){const a=new bn({lightningStore:this.lightningStore,filePath:n,fileType:u,instructions:i});this.packSpiderFiles.set(n,a)}}}getDiagnostics(e){const t=this.packSpiderFiles.get(e);return t?t.provideDiagnostics():[]}getConnectedFiles(e){const t=this.packSpiderFiles.get(e);return t?[...t.loadAllConnected()]:[]}async updateFile(e){}}class bn{constructor({lightningStore:e,filePath:t,fileType:u,instructions:i}){this.dependencies=new Map,this.lightningStore=e,this.filePath=t,this.fileType=u,this.instructions=i}get cacheData(){var e;return(e=this.lightningStore.get(this.filePath).data)!=null?e:{}}loadAllConnected(){return new Set([...this.loadConnected(),...this.loadDirectReferences()])}loadDirectReferences(){var e,t;return new Set((t=(e=this.instructions.includeFiles)==null?void 0:e.map(u=>{var i;if(u)return(i=this.cacheData[u])!=null?i:[]}).flat())!=null?t:[])}loadConnected(e=this.instructions.connect){var u;const t=new Set;for(let{find:i,where:s,matches:n,shouldFindMultiple:a}of e!=null?e:[]){Array.isArray(i)||(i=[i]);const o=(u=this.cacheData[n])!=null?u:[],c=this.lightningStore.findMultiple(i,s,o,a!=null?a:!0);for(const h of c)h!==this.filePath&&t.add(h)}return t}provideDiagnostics(){var t;const e=[];for(let{if:u,...i}of(t=this.instructions.provideDiagnostics)!=null?t:[]){const s=this.loadConnected([u]);if(u.not){if(s.size>0)continue;e.push(i)}else{if(s.size===0)continue;e.push(i)}}return e}addDependency(e,t){this.dependencies.has(e)?this.dependencies.get(e).add(t):this.dependencies.set(e,new Set(t))}}function Zt(r){return _n(r)(...Object.values(r.env))}function _n({script:r,env:e,language:t,modules:u,async:i=!1}){if(t==="typeScript")throw new Error(`bridge.'s legacy script runner no longer supports TypeScript. Use "bridge-js-runner" instead.`);let s=xn(r);if(u){const n=e.require;e.require=async a=>{if(u[a])return u[a];if(typeof n=="function")return await(n==null?void 0:n(a))}}try{return i?new Function(...Object.keys(e),`return (async () => {
${s}
})()`):new Function(...Object.keys(e),s)}catch(n){throw console.error(r),new Error(`Error within script: ${n}`)}}function xn(r){return r.replace(/export default([ \(])/g,(e,t)=>`module.exports =${t}`).replace(/import\s+(\* as [a-z][a-z0-9]*|[a-z][a-z0-9]+|{[a-z\s][a-z0-9,\s]*})\s+from\s+["'](.+)["']/gi,(e,t,u)=>(t.startsWith("* as ")&&(t=t.replace("* as ","")),`const ${t} = await require('${u}')`))}function kn(r){const e={exports:void 0};return Zt({script:r,env:{module:e}}),e.exports}async function Tn(r,e,t){for(const u of t){const i=`${e}${u}`;if(await r.fileExists(i))return i}}function Rn(r,e){return{Bridge:{value:r,withExtension:(t,u)=>Tn(e.fileSystem,t,u),resolvePackPath:(t,u)=>e.config.resolvePackPath(t,u)}}}const Pn=new Set([".js",".ts",".lang",".mcfunction",".txt",".molang",".html"]),tu=[".bridge","builds",".git","worlds"];class $n{constructor(e,t){this.service=e,this.lightningStore=t,this.folderIgnoreList=new Set,this.totalTime=0}get fileType(){return this.service.fileType}async loadIgnoreFolders(){try{(await(await this.service.projectFileSystem.readFile(".bridge/.ignoreFolders")).text()).split(`
`).concat(tu).forEach(t=>this.folderIgnoreList.add(t))}catch{tu.forEach(e=>this.folderIgnoreList.add(e))}}async start(e){if(await this.lightningStore.setup(),this.folderIgnoreList.size===0&&await this.loadIgnoreFolders(),!e&&this.service.getOptions().noFullLightningCacheRefresh){const o=this.lightningStore.allFiles();if(o.length>0)return[o,[],[]]}let t=!1;const u=[],i=[],s=this.service.config.getAvailablePackPaths(),n=await Promise.all(s.map(async o=>[o,await this.service.fileSystem.getDirectoryHandle(o).catch(()=>{})]));for(const[o,c]of n){if(!c){console.warn(`Cannot index pack "${o}" because it does not exist`);continue}await this.iterateDir(c,async(h,f)=>{f=qt(o,f),await this.processFile(f,h)&&(t||(t=!0),i.push(f)),u.push(f),this.service.progress.addToCurrent()})}let a=[];return(t||this.lightningStore.visitedFiles!==this.lightningStore.totalFiles)&&(a=await this.lightningStore.saveStore()),[u,i,a]}async unlinkFile(e,t=!0){this.lightningStore.remove(e),t&&await this.lightningStore.saveStore(!1)}async iterateDir(e,t,u=""){for await(const[i,s]of e.entries()){const n=u.length===0?i:`${u}/${i}`;if(s.kind==="directory"){if(this.folderIgnoreList.has(n))continue;await this.iterateDir(s,t,n)}else i[0]!=="."&&(this.service.progress.addToTotal(2),await t(s,n))}}async processFile(e,t,u=!1){const i=typeof t=="string",s=i?new File([t],Qt(e)):await t.getFile(),n=this.fileType.getId(e);if(!s)throw new Error('Invalid call to "processFile": Either fileContent or fileHandle needs to be defined!');if(!i&&s.lastModified===this.lightningStore.getLastModified(e,n))return this.lightningStore.setVisited(e,!0,n),!1;const a=wn(e);return this.fileType.isJsonFile(e)?await this.processJSON(e,n,s,i?t:void 0,u):Pn.has(a)?await this.processText(e,n,s,u):this.lightningStore.add(e,{lastModified:s.lastModified,isForeignFile:u},n),!0}async processText(e,t,u,i){const s=await this.fileType.getLightningCache(e);if(typeof s=="string"){const n=kn(s);if(typeof n=="function"){const a=n(await u.text(),{resolvePackPath:(o,c)=>this.service.config.resolvePackPath(o,c)});this.lightningStore.add(e,{lastModified:u.lastModified,isForeignFile:i,data:Object.keys(a).length>0?a:void 0},t)}}this.lightningStore.add(e,{lastModified:u.lastModified,isForeignFile:i},t)}async processJSON(e,t,u,i,s){const n=await this.fileType.getLightningCache(e);if(n.length===0||typeof n=="string"){this.lightningStore.add(e,{lastModified:u.lastModified,isForeignFile:s},t);return}const a=i!==void 0;i===void 0&&(i=await u.text()),i===""&&(i="{}");let o;try{o=Dt.parse(i)}catch(v){a||(console.error(`[${e}] ${v.message}`),this.lightningStore.add(e,{lastModified:u.lastModified,isForeignFile:s},t));return}const c={},h=(v,m,A)=>async y=>{let C;if(Array.isArray(y)?C=y:typeof y=="object"?C=Object.keys(y!=null?y:{}):C=[y],m&&(C=C.filter(w=>!m.includes(w))),A){const w={config:this.service.config,fileSystem:this.service.fileSystem};C=(await Promise.all(C.map(S=>Zt({async:!0,script:A,env:{...Rn(S,w)}})))).filter(S=>S!==void 0)}c[v]?c[v]=[...new Set(c[v].concat(C))]:c[v]=C},f=[],E=(v,m,A)=>y=>{f.push(h(v,m,A)(y))};for(const v of n){const m=v.cacheKey;if(!m)continue;let A=Array.isArray(v.path)?v.path:[v.path];const y=v.pathScript;if(y&&(A=Zt({script:y,env:{Bridge:{paths:A}}}),!Array.isArray(A)||A.length===0))return;for(const C of A)Wr(C,o,E(m,v.filter,v.script))}await Promise.all(f),this.lightningStore.add(e,{lastModified:u.lastModified,isForeignFile:s,data:Object.keys(c).length>0?c:void 0},t)}}async function Yt(r,e,t=new Set,u=""){for await(const i of r.values()){const s=u.length===0?i.name:`${u}/${i.name}`;if(i.kind==="file"){if(i.name[0]===".")continue;await e(i,s,r)}else i.kind==="directory"&&!t.has(s)&&await Yt(i,e,t,s)}}async function On(){return typeof(await(await navigator.storage.getDirectory()).getFileHandle("bridge-supports-writable-test",{create:!0})).createWritable=="function"}async function ru(){var r;return typeof((r=navigator.storage)==null?void 0:r.getDirectory)!="function"||!await On()?new ne(null,"bridgeFolder",void 0):await navigator.storage.getDirectory()}class Ve extends Ne{constructor(e){super(),e&&this.setup(e)}get baseDirectory(){return this._baseDirectory}setup(e){this._baseDirectory=e,this.hasFired||this.dispatch()}async getDirectoryHandle(e,{create:t,createOnce:u}={}){if(e===""||e===".")return this.baseDirectory;let i=this.baseDirectory;const s=e.split(/\\|\//g);s[0]==="."&&s.shift(),s[0]==="extensions"&&(s[0]="~local",s.splice(1,0,"extensions")),s[0]==="~local"&&(i=await ru(),s.shift());for(const n of s){try{i=await i.getDirectoryHandle(n,{create:u||t})}catch{throw new Error(`Failed to access "${e}": Directory does not exist`)}u&&(u=!1,t=!1)}return i}async getFileHandle(e,t=!1){if(e.length===0)throw new Error("Error: filePath is empty");const u=await this.getDirectoryHandle(eu(e),{create:t});try{return await u.getFileHandle(Qt(e),{create:t})}catch{throw new Error(`File does not exist: "${e}"`)}}async pathTo(e){const t=await ru();if(e instanceof fe&&!(t instanceof ne))return;let u=await t.resolve(e).then(i=>i==null?void 0:i.join("/"));return u?u="~local/"+u:u=await this.baseDirectory.resolve(e).then(i=>i==null?void 0:i.join("/")),u}async mkdir(e,{recursive:t}={}){await this.getDirectoryHandle(e,{create:!0})}async readdir(e,{withFileTypes:t}={}){const u=await this.getDirectoryHandle(e),i=[];for await(const s of u.values())s.kind==="file"&&s.name===".DS_Store"||(t?i.push(s):i.push(s.name));return i}async readFilesFromDir(e,t=this.getDirectoryHandle(e)){t=await t;const u=[];for await(const i of t.values())i.kind==="file"&&i.name===".DS_Store"||(i.kind==="file"?u.push({name:i.name,kind:i.kind,path:`${e}/${i.name}`}):i.kind==="directory"&&u.push(...await this.readFilesFromDir(`${e}/${i.name}`,i)));return u}readFile(e){return this.getFileHandle(e).then(t=>t.getFile())}async unlink(e){if(e.length===0)throw new Error("Error: filePath is empty");const t=e.split(/\\|\//g),u=t.pop();let i;try{i=await this.getDirectoryHandle(t.join("/"))}catch{return}try{await i.removeEntry(u,{recursive:!0})}catch{}}async writeFile(e,t){const u=await this.getFileHandle(e,!0);return await this.write(u,t),u}async write(e,t){const u=await e.createWritable({keepExistingData:!1});await u.write(t),await u.close()}async readJSON(e){const t=await this.readFile(e);try{return await Dt.parse(await t.text())}catch{throw new Error(`Invalid JSON: ${e}`)}}async readJsonHandle(e){const t=await e.getFile();try{return await Dt.parse(await t.text())}catch{throw new Error(`Invalid JSON: ${e.name}`)}}writeJSON(e,t,u=!1){return this.writeFile(e,JSON.stringify(t,null,u?"	":void 0))}async move(e,t){if(await this.fileExists(e))await this.copyFile(e,t);else if(await this.directoryExists(e))await this.copyFolder(e,t);else throw new Error(`File or folder does not exist: ${e}`);await this.unlink(e)}async copyFile(e,t){const u=await this.getFileHandle(e,!1),i=await this.getFileHandle(t,!0);return await this.copyFileHandle(u,i)}async copyFileHandle(e,t){return await this.write(t,await e.getFile()),t}async copyFolder(e,t){const u=await this.getDirectoryHandle(e,{create:!1});await Yt(u,async(i,s)=>{await this.copyFileHandle(i,await this.getFileHandle(qt(t,s),!0))})}async copyFolderByHandle(e,t){const u=new Ve(t);await Yt(e,async(i,s)=>{await this.copyFileHandle(i,await u.getFileHandle(s,!0))})}loadFileHandleAsDataUrl(e){return new Promise(async(t,u)=>{const i=new FileReader;try{const s=await e.getFile();i.addEventListener("load",()=>{t(i.result)}),i.addEventListener("error",u),i.readAsDataURL(s)}catch{u(`File does not exist: "${e.name}"`)}})}async fileExists(e){try{return await this.getFileHandle(e),!0}catch{return!1}}async directoryExists(e){try{return await this.getDirectoryHandle(e),!0}catch{return!1}}async getDirectoryHandlesFromGlob(e,t="."){const u=e.split(/\/|\\/g),i=new Set([await this.getDirectoryHandle(t)]);for(const s of u){if(s==="*")for(const n of[...i.values()]){i.delete(n);for await(const a of n.values())a.kind==="directory"&&i.add(a)}else{if(s==="**")return console.warn('"**" is not supported yet'),[];for(const n of[...i.values()]){i.delete(n);try{i.add(await n.getDirectoryHandle(s))}catch{}}}if(i.size===0)return[]}return[...i.values()]}}class Hn extends Fn{constructor(e){super(e),this.ready=new Ne}async setup(e){this.packTypes.length>0||(await e.fired,this.packTypes=await e.readJSON("data/packages/minecraftBedrock/packDefinitions.json").catch(()=>[]),this.ready.dispatch())}}const Ln="/";var uu={},In=function(r,e,t,u,i){var s=uu[e]||(uu[e]=URL.createObjectURL(new Blob([r],{type:"text/javascript"}))),n=new Worker(s);return n.onerror=function(a){return i(a.error,null)},n.onmessage=function(a){return i(null,a.data)},n.postMessage(t,u),n},ee=Uint8Array,de=Uint16Array,Ze=Uint32Array,er=new ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tr=new ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),iu=new ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nu=function(r,e){for(var t=new de(31),u=0;u<31;++u)t[u]=e+=1<<r[u-1];for(var i=new Ze(t[30]),u=1;u<30;++u)for(var s=t[u];s<t[u+1];++s)i[s]=s-t[u]<<5|u;return[t,i]},su=nu(er,2),rr=su[0],Nn=su[1];rr[28]=258,Nn[258]=28;for(var Mn=nu(tr,0),au=Mn[0],ht=new de(32768),W=0;W<32768;++W){var be=(W&43690)>>>1|(W&21845)<<1;be=(be&52428)>>>2|(be&13107)<<2,be=(be&61680)>>>4|(be&3855)<<4,ht[W]=((be&65280)>>>8|(be&255)<<8)>>>1}for(var Ke=function(r,e,t){for(var u=r.length,i=0,s=new de(e);i<u;++i)++s[r[i]-1];var n=new de(e);for(i=0;i<e;++i)n[i]=n[i-1]+s[i-1]<<1;var a;if(t){a=new de(1<<e);var o=15-e;for(i=0;i<u;++i)if(r[i])for(var c=i<<4|r[i],h=e-r[i],f=n[r[i]-1]++<<h,E=f|(1<<h)-1;f<=E;++f)a[ht[f]>>>o]=c}else for(a=new de(u),i=0;i<u;++i)r[i]&&(a[i]=ht[n[r[i]-1]++]>>>15-r[i]);return a},Ye=new ee(288),W=0;W<144;++W)Ye[W]=8;for(var W=144;W<256;++W)Ye[W]=9;for(var W=256;W<280;++W)Ye[W]=7;for(var W=280;W<288;++W)Ye[W]=8;for(var ou=new ee(32),W=0;W<32;++W)ou[W]=5;var cu=Ke(Ye,9,1),lu=Ke(ou,5,1),dt=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},ae=function(r,e,t){var u=e/8|0;return(r[u]|r[u+1]<<8)>>(e&7)&t},pt=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},fu=function(r){return(r/8|0)+(r&7&&1)},At=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var u=new(r instanceof de?de:r instanceof Ze?Ze:ee)(t-e);return u.set(r.subarray(e,t)),u},Du=function(r,e,t){var u=r.length;if(!u||t&&!t.l&&u<5)return e||new ee(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new ee(u*3));var n=function(T){var He=e.length;if(T>He){var Ft=new ee(Math.max(He*2,T));Ft.set(e),e=Ft}},a=t.f||0,o=t.p||0,c=t.b||0,h=t.l,f=t.d,E=t.m,v=t.n,m=u*8;do{if(!h){t.f=a=ae(r,o,1);var A=ae(r,o+1,3);if(o+=3,A)if(A==1)h=cu,f=lu,E=9,v=5;else if(A==2){var S=ae(r,o,31)+257,x=ae(r,o+10,15)+4,b=S+ae(r,o+5,31)+1;o+=14;for(var I=new ee(b),N=new ee(19),B=0;B<x;++B)N[iu[B]]=ae(r,o+B*3,7);o+=x*3;for(var $=dt(N),V=(1<<$)-1,d=Ke(N,$,1),B=0;B<b;){var L=d[ae(r,o,V)];o+=L&15;var y=L>>>4;if(y<16)I[B++]=y;else{var H=0,se=0;for(y==16?(se=3+ae(r,o,3),o+=2,H=I[B-1]):y==17?(se=3+ae(r,o,7),o+=3):y==18&&(se=11+ae(r,o,127),o+=7);se--;)I[B++]=H}}var D=I.subarray(0,S),l=I.subarray(S);E=dt(D),v=dt(l),h=Ke(D,E,1),f=Ke(l,v,1)}else throw"invalid block type";else{var y=fu(o)+4,C=r[y-4]|r[y-3]<<8,w=y+C;if(w>u){if(s)throw"unexpected EOF";break}i&&n(c+C),e.set(r.subarray(y,w),c),t.b=c+=C,t.p=o=w*8;continue}if(o>m){if(s)throw"unexpected EOF";break}}i&&n(c+131072);for(var Z=(1<<E)-1,O=(1<<v)-1,ie=o;;ie=o){var H=h[pt(r,o)&Z],Y=H>>>4;if(o+=H&15,o>m){if(s)throw"unexpected EOF";break}if(!H)throw"invalid length/literal";if(Y<256)e[c++]=Y;else if(Y==256){ie=o,h=null;break}else{var te=Y-254;if(Y>264){var B=Y-257,Ae=er[B];te=ae(r,o,(1<<Ae)-1)+rr[B],o+=Ae}var et=f[pt(r,o)&O],_e=et>>>4;if(!et)throw"invalid distance";o+=et&15;var l=au[_e];if(_e>3){var Ae=tr[_e];l+=pt(r,o)&(1<<Ae)-1,o+=Ae}if(o>m){if(s)throw"unexpected EOF";break}i&&n(c+131072);for(var Ce=c+te;c<Ce;c+=4)e[c]=e[c-l],e[c+1]=e[c+1-l],e[c+2]=e[c+2-l],e[c+3]=e[c+3-l];c=Ce}}t.l=h,t.p=ie,t.b=c,h&&(a=1,t.m=E,t.d=f,t.n=v)}while(!a);return c==e.length?e:At(e,0,c)},jn=new ee(0),Wn=function(r,e){var t={};for(var u in r)t[u]=r[u];for(var u in e)t[u]=e[u];return t},hu=function(r,e,t){for(var u=r(),i=r.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),n=0;n<u.length;++n){var a=u[n],o=s[n];if(typeof a=="function"){e+=";"+o+"=";var c=a.toString();if(a.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;e+=c.slice(h,c.indexOf("(",h))}else{e+=c;for(var f in a.prototype)e+=";"+o+".prototype."+f+"="+a.prototype[f].toString()}else e+=c}else t[o]=a}return[e,t]},Ct=[],zn=function(r){var e=[];for(var t in r)(r[t]instanceof ee||r[t]instanceof de||r[t]instanceof Ze)&&e.push((r[t]=new r[t].constructor(r[t])).buffer);return e},Gn=function(r,e,t,u){var i;if(!Ct[t]){for(var s="",n={},a=r.length-1,o=0;o<a;++o)i=hu(r[o],s,n),s=i[0],n=i[1];Ct[t]=hu(r[a],s,n)}var c=Wn({},Ct[t][1]);return In(Ct[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,c,zn(c),u)},Un=function(){return[ee,de,Ze,er,tr,iu,rr,au,cu,lu,ht,Ke,dt,ae,pt,fu,At,Du,ir,du,pu]},du=function(r){return postMessage(r,[r.buffer])},pu=function(r){return r&&r.size&&new ee(r.size)},Vn=function(r,e,t,u,i,s){var n=Gn(t,u,i,function(a,o){n.terminate(),s(a,o)});return n.postMessage([r,e],e.consume?[r.buffer]:[]),function(){n.terminate()}},pe=function(r,e){return r[e]|r[e+1]<<8},le=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},ur=function(r,e){return le(r,e)+le(r,e+4)*4294967296};function Kn(r,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return Vn(r,e,[Un],function(u){return du(ir(u.data[0],pu(u.data[1])))},1,t)}function ir(r,e){return Du(r,e)}var nr=typeof TextDecoder<"u"&&new TextDecoder,Jn=0;try{nr.decode(jn,{stream:!0}),Jn=1}catch{}var Xn=function(r){for(var e="",t=0;;){var u=r[t++],i=(u>127)+(u>223)+(u>239);if(t+i>r.length)return[e,At(r,t-1)];i?i==3?(u=((u&15)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,e+=String.fromCharCode(55296|u>>10,56320|u&1023)):i&1?e+=String.fromCharCode((u&31)<<6|r[t++]&63):e+=String.fromCharCode((u&15)<<12|(r[t++]&63)<<6|r[t++]&63):e+=String.fromCharCode(u)}};function qn(r,e){if(e){for(var t="",u=0;u<r.length;u+=16384)t+=String.fromCharCode.apply(null,r.subarray(u,u+16384));return t}else{if(nr)return nr.decode(r);var i=Xn(r),s=i[0],n=i[1];if(n.length)throw"invalid utf-8 data";return s}}var Qn=function(r,e){return e+30+pe(r,e+26)+pe(r,e+28)},Zn=function(r,e,t){var u=pe(r,e+28),i=qn(r.subarray(e+46,e+46+u),!(pe(r,e+8)&2048)),s=e+46+u,n=le(r,e+20),a=t&&n==4294967295?Yn(r,s):[n,le(r,e+24),le(r,e+42)],o=a[0],c=a[1],h=a[2];return[pe(r,e+10),o,c,i,s+pe(r,e+30)+pe(r,e+32),h]},Yn=function(r,e){for(;pe(r,e)!=1;e+=4+pe(r,e+2));return[ur(r,e+12),ur(r,e+4),ur(r,e+20)]};function es(r,e){if(typeof e!="function")throw"no callback";for(var t=[],u=function(){for(var E=0;E<t.length;++E)t[E]()},i={},s=r.length-22;le(r,s)!=101010256;--s)if(!s||r.length-s>65558){e("invalid zip file",null);return}var n=pe(r,s+8);n||e(null,{});var a=n,o=le(r,s+16),c=o==4294967295;if(c){if(s=le(r,s-12),le(r,s)!=101075792){e("invalid zip file",null);return}a=n=le(r,s+32),o=le(r,s+48)}for(var h=function(E){var v=Zn(r,o,c),m=v[0],A=v[1],y=v[2],C=v[3],w=v[4],S=v[5],x=Qn(r,S);o=w;var b=function(N,B){N?(u(),e(N,null)):(i[C]=B,--n||e(null,i))};if(!m)b(null,At(r,x,x+A));else if(m==8){var I=r.subarray(x,x+A);if(A<32e4)try{b(null,ir(I,new ee(y)))}catch(N){b(N,null)}else t.push(Kn(I,{size:y},b))}else b("unknown compression type "+m,null)},f=0;f<a;++f)h();return u}const Au=1185286;function ts(r){return new Promise(e=>{typeof requestIdleCallback=="function"?requestIdleCallback(async()=>{await r(),e()}):setTimeout(async()=>{await r(),e()},10)})}var rs=JSON.parse('{"name":"bridge","version":"2.3.3","private":true,"scripts":{"dev":"vite","dev:force":"vite --force","dev:host":"vite --host","serve":"vite preview","check":"tsc --project tsconfig.json --noEmit","build":"node ./scripts/build.mjs && node ./scripts/buildApp.mjs","build:nightly":"node ./scripts/build.mjs && node ./scripts/buildApp.mjs --nightly"},"dependencies":{"@mdi/font":"^6.9.96","@types/lz-string":"^1.3.34","bridge-common-utils":"^0.3.3","bridge-iframe-api":"^0.4.7","bridge-js-runtime":"^0.3.4","bridge-model-viewer":"^0.7.7","buffer":"^6.0.3","color-convert":"^2.0.1","comlink":"^4.3.0","compare-versions":"^3.6.0","core-js":"^3.6.5","dash-compiler":"^0.9.29","escape-string-regexp":"^5.0.0","fflate":"^0.6.7","idb-keyval":"^5.1.3","is-glob":"^4.0.1","json5":"^2.1.3","jsonc-parser":"^3.0.0","lodash-es":"^4.17.20","lz-string":"^1.4.4","mc-project-core":"^0.3.21","molang":"^1.13.11","monaco-editor":"^0.33.0","path-browserify":"^1.0.1","prismarine-nbt":"^1.6.0","quick-score":"^0.0.13","tga-js":"^1.1.1","three":"^0.139.2","uuid":"^8.3.1","vue":"^2.7.8","vue-template-compiler":"^2.7.8","vuedraggable":"^2.24.3","vuetify":"^2.6.7","wintersky":"^1.1.0"},"devDependencies":{"@types/color-convert":"^2.0.0","@types/is-glob":"^4.0.1","@types/json5":"0.0.30","@types/lodash-es":"^4.17.4","@types/lodash.debounce":"^4.0.6","@types/node":"^14.17.9","@types/three":"^0.127.1","@types/uuid":"^8.3.0","@types/wicg-file-system-access":"^2020.9.5","@vitejs/plugin-vue2":"^1.1.2","markdown-it":"^12.3.2","node-fetch":"^2.6.7","prettier":"^2.2.1","sass":"^1.19.0","typescript":"^4.4.3","vite":"^3.0.4","vite-plugin-ejs":"^1.4.3","vite-plugin-pwa":"^0.12.3","vite-plugin-vue2":"^2.0.2"}}');const Cu=rs.version;class us extends Ve{constructor(e=!1){super(),this.isMainLoader=e}get virtualFileSystem(){if(!this._virtualFileSystem)throw new Error("DataLoader: virtualFileSystem is not initialized");return this._virtualFileSystem}async loadData(e=!1){if(this.hasFired){console.warn("This dataLoader instance already loaded data. You called loadData() twice.");return}let t=await _t("savedDataForVersion");e&&(t=void 0,await xt("savedDataForVersion",void 0));const u=t?tn(Cu,t,"="):!1;this.isMainLoader&&console.log(u?"[APP] Data saved; restoring from cache...":"[APP] Latest data not saved; fetching now..."),console.time("[App] Data");const i=this.isMainLoader&&!u;if(this._virtualFileSystem=new ne(new Je("data-fs"),"bridgeFolder",u?void 0:new Map,i),await this._virtualFileSystem.setupDone.fired,u){this.setup(this._virtualFileSystem),console.timeEnd("[App] Data");return}const s=await fetch(Ln+"packages.zip").then(c=>c.arrayBuffer());if(s.byteLength!==Au)throw new Error(`Error: Data package was larger than the expected size of ${Au} bytes; got ${s.byteLength} bytes`);const n=await new Promise((c,h)=>es(new Uint8Array(s),async(f,E)=>{if(f)return h(f);c(E)})),o={".":await this._virtualFileSystem.getDirectoryHandle("data",{create:!0})};for(const c in n){const h=Qt(c),f=eu(c);if(c.endsWith("/")){const E=await o[f].getDirectoryHandle(h,{create:!0});o[c.slice(0,-1)]=E}else await o[f].getFileHandle(h,{create:!0,initialData:n[c]})}this.setup(this._virtualFileSystem),console.timeEnd("[App] Data"),this.isMainLoader&&!e&&ts(async()=>{await this._virtualFileSystem.moveToIdb(),await xt("savedDataForVersion",Cu)})}}class is extends gn{constructor(e,t,u){super(t),this.fileSystem=e,this.project=u,u&&u.fileSave.on(this.resolvePackPath(void 0,"config.json"),()=>{this.refreshConfig(),this.project.app.windows.createPreset.onPresetsChanged(),this.project.compilerService.reloadPlugins()})}readConfig(){return this.fileSystem.readJSON("config.json").catch(()=>({}))}async writeConfig(e){await this.fileSystem.writeJSON("config.json",e,!0)}async setup(e=!0){var i,s,n,a,o,c,h;if(e&&await this.fileSystem.fileExists(".bridge/config.json")){const{darkTheme:f,lightTheme:E,gameTestAPI:v,scriptingAPI:m,prefix:A,...y}=await this.fileSystem.readJSON(".bridge/config.json");await this.fileSystem.unlink(".bridge/config.json");const C={};v&&(C.enableGameTestFramework=!0),m&&(C.additionalModdingCapabilities=!0);const w={type:"minecraftBedrock",name:this.fileSystem.baseDirectory.name,namespace:A,experimentalGameplay:C,...y,authors:y.author?[y.author]:["Unknown"],packs:Xt,bridge:{darkTheme:f,lightTheme:E}};await this.fileSystem.writeJSON("config.json",w,!0),this.data=w;return}await super.setup();const t=(s=(i=this.data.bridge)==null?void 0:i.formatVersion)!=null?s:0;this.data.bridge||(this.data.bridge={});let u=!1;if(e&&this.project&&this.data.capabilities){const f=await this.project.app.dataLoader.readJSON("data/packages/minecraftBedrock/experimentalGameplay.json"),E=(n=this.data.experimentalGameplay)!=null?n:{},v=(a=this.data.capabilities)!=null?a:[];E.enableGameTestFramework=v.includes("gameTestAPI"),E.additionalModdingCapabilities=v.includes("scriptingAPI");for(const m of f)(c=E[o=m.id])!=null||(E[o]=!0);this.data.experimentalGameplay=E,this.data.capabilities=void 0,u=!0}if(e&&this.data.author&&!this.data.authors&&(this.data.authors=typeof this.data.author=="string"?[this.data.author]:this.data.author,this.data.author=void 0,u=!0),e&&await this.fileSystem.fileExists(".bridge/compiler/default.json")){const f=await this.fileSystem.readJSON(".bridge/compiler/default.json");this.data.compiler={plugins:f.plugins},await this.fileSystem.unlink(".bridge/compiler/default.json"),u=!0}e&&t===0&&((h=this.data.compiler)==null?void 0:h.plugins)&&!this.data.compiler.plugins.includes("formatVersionCorrection")&&(this.data.bridge.formatVersion=1,this.data.compiler.plugins.push("formatVersionCorrection"),u=!0),u&&await this.writeConfig(this.data)}async getWorldHandles(){var u;if(!this.project)throw new Error("Cannot use getWorldHandles() within web workers yet");const e=this.project.app,t=((u=this.get().worlds)!=null?u:["./worlds/*"]).map(i=>this.resolvePackPath(void 0,i));return(await Promise.all(t.map(i=>e.fileSystem.getDirectoryHandlesFromGlob(i)))).flat()}getAuthorImage(){var t;const e=(t=this.get().authors)==null?void 0:t.find(u=>typeof u!="string"&&u.logo);if(!!e)return this.resolvePackPath(void 0,e.logo)}async toggleExperiment(e,t){var i,s;e.app.windows.loadingWindow.open();const u=(s=(i=this.get())==null?void 0:i.experimentalGameplay)!=null?s:{};u[t]=!u[t],await this.save(),e.isActiveProject&&await e.refresh(),this.project.app.windows.createPreset.onPresetsChanged(),e.app.windows.loadingWindow.close()}}globalThis.process={cwd:()=>"",env:{}};const gt=new us;class ns extends vn{constructor(e,t,u){super(),this.projectDirectory=e,this.options=u,this.fileSystem=new Ve(t),this.projectFileSystem=new Ve(e),this.config=new is(this.projectFileSystem,u.projectPath),this.fileType=new yn(this.config),this.packType=new Hn(this.config),this.globalFileSystem=new Ve(t),this.lightningStore=new Bn(this.projectFileSystem,this.fileType,u.projectPath),this.packSpider=new Sn(this,this.lightningStore),this.lightningCache=new $n(this,this.lightningStore),this.fileType.setPluginFileTypes(u.pluginFileTypes)}getOptions(){return{projectDirectory:this.projectDirectory,baseDirectory:this.fileSystem.baseDirectory,...this.options}}async onStart(e){console.time("[WORKER] SETUP"),this.lightningStore.reset(),gt.hasFired||await gt.loadData(),await Promise.all([this.fileType.setup(gt),this.packType.setup(gt),this.config.setup(!1)]),console.timeEnd("[WORKER] SETUP"),console.time("[WORKER] LightningCache");const[t,u,i]=await this.lightningCache.start(e);return console.timeEnd("[WORKER] LightningCache"),console.time("[WORKER] PackSpider"),await this.packSpider.setup(t),console.timeEnd("[WORKER] PackSpider"),[u,i]}async updateFile(e,t,u=!1,i=!1){const s=await this.lightningCache.processFile(e,t!=null?t:await this.fileSystem.getFileHandle(e),u);return s&&(i||await this.lightningStore.saveStore(!1),await this.packSpider.updateFile(e)),s}async updateFiles(e,t=!1){let u=!1;for(let i=0;i<e.length;i++)await this.updateFile(e[i],void 0,!1,!1)&&(u=!0);return!t&&u&&await this.lightningStore.saveStore(!1),u}hasFile(e){return this.lightningStore.has(e)}async rename(e,t,u=!0){this.lightningStore.rename(e,t),u&&await this.lightningStore.saveStore(!1)}unlinkFile(e,t=!0){return this.lightningCache.unlinkFile(e,t)}saveCache(){return this.lightningStore.saveStore(!1)}updatePlugins(e){this.fileType.setPluginFileTypes(e)}find(e,t,u,i=!1){return this.lightningStore.find(e,t,u,i)}findMultiple(e,t,u,i=!1){return this.lightningStore.findMultiple(e,t,u,i)}getAllFiles(e,t=!1){return t?this.lightningStore.allFiles(e).sort((u,i)=>u.localeCompare(i)):this.lightningStore.allFiles(e)}getFileDiagnostics(e){return this.packSpider.getDiagnostics(e)}getConnectedFiles(e){return this.packSpider.getConnectedFiles(e)}getSchemasFor(e,t){return this.lightningStore.getSchemasFor(e,t)}getCacheDataFor(e,t,u){return this.lightningStore.getCacheDataFor(e,t,u)}}mt(ns,self)})();
