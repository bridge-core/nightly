var e,t=Object.defineProperty,i=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(e,i,n)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n,l=(e,t)=>{for(var i in t||(t={}))a.call(t,i)&&o(e,i,t[i]);if(s)for(var i of s(t))r.call(t,i)&&o(e,i,t[i]);return e},c=(e,t)=>i(e,n(t)),d=(e,t,i)=>(o(e,"symbol"!=typeof t?t+"":t,i),i);import{V as u,a as p,v as h,c as m,g,s as f,d as w,k as v,m as y,t as b,r as k,b as S,e as x,f as C,h as j,l as _,i as P,p as A,j as T,n as E,U as F,o as D,R as O,q as M,K as $,u as I,w as R,D as W,x as N,y as B,z as L,A as H,W as V,P as z,O as U,S as G,B as J,C as q,E as K,F as Q,G as X,H as Z,M as Y,I as ee,J as te,L as ie,N as ne,Q as se,T as ae,X as re,Y as oe,Z as le,_ as ce,$ as de,a0 as ue,a1 as pe,a2 as he,a3 as me,a4 as ge,a5 as fe,a6 as we,a7 as ve,a8 as ye,a9 as be,aa as ke,ab as Se}from"./vendor.52db306a.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}(),u.use(p);class xe{constructor(){d(this,"listeners",new Set)}get hasListeners(){return this.listeners.size>0}dispatch(e){this.listeners.forEach((t=>t(e)))}on(e,t=!0){if(this.listeners.add(e),t)return{dispose:()=>{this.off(e)}}}off(e){this.listeners.delete(e)}once(e){const t=i=>{e(i),this.off(t)};this.on(t)}disposeListeners(){this.listeners=new Set}}class Ce extends xe{constructor(e=1){super(),d(this,"firedTimes",0),d(this,"data"),this.needsToFireAmount=e}get fired(){return new Promise((e=>this.once(e)))}get hasFired(){return this.firedTimes>=this.needsToFireAmount}setFiredTimes(e){this.firedTimes=e}resetSignal(){this.data=void 0,this.firedTimes=0}dispatch(e){if(this.firedTimes<this.needsToFireAmount&&this.firedTimes++,this.data=e,this.hasFired)return super.dispatch(e)}on(e,t=!0){return this.hasFired&&e(this.data),super.on(e,t)}}class je{constructor(e,t,i=[],n=h()){d(this,"isVirtual",!0),d(this,"setupDone",new Ce),this.parent=e,this._name=t,this.basePath=i,this.uuid=n}get path(){return this.parent?this.parent.path.concat(this.name):this.basePath}get idbKey(){return 0===this.path.length?this._name:this.path.join("/")}get name(){return this._name}getParent(){return this.parent}async isSameEntry(e){return e.idbKey===this.idbKey}async queryPermission(e){return"granted"}async requestPermission(e){return"granted"}}const _e=new TextEncoder,Pe=Symbol("writeMethod");class Ae{constructor(e){d(this,"tmpData",new Uint8Array),d(this,"cursorOffset",0),d(this,"locked",!1),this.fileHandle=e}async write(e){let t;if("string"==typeof e)t=_e.encode(e);else if(e instanceof Blob)t=await e.arrayBuffer().then((e=>new Uint8Array(e)));else{if("type"in e){if("seek"===e.type)return await this.seek(e.position);if("truncate"===e.type)return await this.truncate(e.size);if("write"===e.type)return e.position&&await this.seek(e.position),await this.write(e.data);throw new Error(`Unknown data type: ${e.type}`)}t=ArrayBuffer.isView(e)?new Uint8Array(e.buffer):new Uint8Array(e)}this.tmpData=new Uint8Array([...this.tmpData.slice(0,this.cursorOffset),...t]),this.cursorOffset=this.tmpData.length}async seek(e){this.cursorOffset=Math.floor(e)}async truncate(e){this.tmpData=this.tmpData.slice(0,e),this.cursorOffset>e&&(this.cursorOffset=e)}async close(){await this.fileHandle[Pe](this.tmpData)}async abort(){throw new Error("WriteStream was aborted")}getWriter(){}}const Te=m("virtual-fs","virtual-fs-store"),Ee=(e,t)=>f(e,t,Te),Fe=e=>g(e,Te),De=e=>w(e,Te);class Oe extends je{constructor(e,t,i,n=!1){super(e,t),d(this,"kind","file"),d(this,"isFile",!0),d(this,"isDirectory",!1),d(this,"fileData"),this.inMemory=n,i?this.setup(i):this.setupDone.dispatch()}async setup(e){if(this.fileData=globalThis.document?y(e):e,this.inMemory||this.path.join("/").startsWith("data/packages")&&e.length<1e4)return this.setupDone.dispatch();await this.updateIdb(e),this.setupDone.dispatch()}async updateIdb(e){await Ee(this.idbKey,e),this.fileData=void 0}async loadFromIdb(){if(this.fileData)return this.fileData;let e=await Fe(this.idbKey);if(!e)throw console.log(this.parent),new Error(`File not found: "${this.path.join("/")}"`);return e}serialize(){return{kind:"file",name:this.name,fileData:this.fileData}}async removeSelf(){await De(this.idbKey)}async getFile(){const e=await this.loadFromIdb();return new File([e],this.name)}async createWritable(){return new Ae(this)}async[Pe](e){this.inMemory?this.fileData=e:await this.updateIdb(e)}}class Me extends je{constructor(e,t,i,n=!1,s=[]){super(e,t,s),d(this,"kind","directory"),d(this,"isDirectory",!0),d(this,"isFile",!1),this.children=i,this.updateIdb(n)}async updateIdb(e=!1){if(e){const e=await v(Te);for(const t of e)"string"==typeof t&&t.startsWith("data/packages/")&&await De(t)}this.children||await this.hasChildren()||await Ee(this.idbKey,[]),this.setupDone.dispatch()}async addChild(e){await this.has(e.name)||(this.children?this.children.set(e.name,e):await Ee(this.idbKey,[...await this.fromIdb(),e.name]))}async fromIdb(){var e;return null!=(e=await Fe(this.idbKey))?e:[]}async getChildren(){return this.children?[...this.children.values()]:await Promise.all((await this.fromIdb()).map((e=>this.getChild(e))).filter((e=>void 0!==e)))}getChildPath(e){return this.path.concat(e).join("/")}async getChild(e){if(this.children)return this.children.get(e);if(await this.has(e)){const t=await Fe(this.getChildPath(e));if(t instanceof Uint8Array)return new Oe(this,e);if(Array.isArray(t))return new Me(this,e)}}async deleteChild(e){this.children?this.children.delete(e):await Ee(this.idbKey,(await this.fromIdb()).filter((t=>t!==e)))}async hasChildren(){return this.children?this.children.size>0:(await this.fromIdb()).length>0}async has(e){return this.children?this.children.has(e):(await this.fromIdb()).includes(e)}serialize(){return{kind:"directory",name:this.name,path:this.path,children:this.children?[...this.children.values()].map((e=>e.serialize())):void 0}}static deserialize(e,t=null){var i;const n=new Me(t,e.name,void 0,!1,e.path);for(const s of null!=(i=e.children)?i:[])"directory"===s.kind?n.addChild(Me.deserialize(s,n)):n.addChild(new Oe(n,s.name,s.fileData));return n}async getDirectoryHandle(e,{create:t}={}){let i=await this.getChild(e);if(i&&"file"===i.kind)throw new Error(`TypeMismatch: Expected directory with name "${e}", found file`);if(!i){if(!t)throw new Error(`No file with the name ${e} exists in this folder`);i=new Me(this,e,this.children?new Map:void 0),await i.setupDone.fired,await this.addChild(i)}return i}async getFileHandle(e,{create:t,initialData:i}={}){let n=await this.getChild(e);if(n&&"directory"===n.kind)throw new Error(`TypeMismatch: Expected file with name "${e}", found directory`);if(!n){if(!t)throw new Error(`No file with the name ${e} exists in this folder`);n=new Oe(this,e,null!=i?i:new Uint8Array),await n.setupDone.fired,await this.addChild(n)}return n}async removeEntry(e,{recursive:t}={}){const i=await this.getChild(e);if(!i)throw new Error(`No entry with the name ${e} exists in this folder`);if("directory"===i.kind&&!t&&await i.hasChildren())throw new Error('Cannot remove directory with children without "recursive" option being set to true');await i.removeSelf(),await this.deleteChild(e)}async resolve(e){const t=[e.name];let i=e.getParent();for(;null!==i&&!(await i.isSameEntry(this));)t.unshift(i.name),i=i.getParent();return null===i?null:t}async removeSelf(){const e=await this.getChildren();for(const t of e)await t.removeSelf();this.children||await De(this.idbKey)}[Symbol.asyncIterator](){return this.entries()}keys(){return this.children?this.children.keys():{childNamesPromise:this.fromIdb(),[Symbol.asyncIterator](){return{i:0,childNamesPromise:this.childNamesPromise,async next(){const e=await this.childNamesPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}entries(){return this.children?this.children.entries():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:[e[this.i].name,e[this.i++]]}:{done:!0}}}}}}values(){return this.children?this.children.values():{childrenPromise:this.getChildren(),[Symbol.asyncIterator](){return{i:0,childrenPromise:this.childrenPromise,async next(){const e=await this.childrenPromise;return this.i<e.length?{done:!1,value:e[this.i++]}:{done:!0}}}}}}getEntries(){return this.values()}getDirectory(e,t={}){return this.getDirectoryHandle(e,t)}getFile(e,t={}){return this.getFileHandle(e,t)}}function $e(){const e=navigator.userAgentData;if(!e)return!1;const t=e.brands.find((({brand:e})=>"Google Chrome"===e));return!!t&&["93","94"].includes(t.version)}let Ie=!1;($e()||"function"!=typeof window.showDirectoryPicker)&&(Ie=!0,window.showDirectoryPicker=async()=>new Me(null,"bridgeFolder",void 0)),($e()||"function"!=typeof window.showOpenFilePicker)&&(window.showOpenFilePicker=async e=>{var t;const i=l({types:[]},e),n=document.createElement("input");n.type="file",n.multiple=null!=(t=i.multiple)&&t,n.accept=i.types.map((e=>Object.values(e.accept))).flat(2).join(","),n.style.display="none",document.body.appendChild(n);let s=!1;return new Promise(((e,t)=>{n.addEventListener("change",(async t=>{var i;s=!0;const a=[...null!=(i=n.files)?i:[]];document.body.removeChild(n),e(await Promise.all(a.map((async e=>new Oe(null,e.name,new Uint8Array(await e.arrayBuffer()),!0)))))}),{once:!0}),window.addEventListener("focus",(()=>{setTimeout((()=>{s||(t("User aborted selecting file"),document.body.removeChild(n))}),300)}),{once:!0}),n.click()}))}),($e()||"function"!=typeof window.showSaveFilePicker)&&(window.showSaveFilePicker=async(e={})=>{var t;return new Oe(null,null!=(t=e.suggestedName)?t:"newFile.txt",new Uint8Array,!0)}),($e()||globalThis.DataTransferItem&&!DataTransferItem.prototype.getAsFileSystemHandle)&&(DataTransferItem.prototype.getAsFileSystemHandle=async function(){if("file"===this.kind){const e=this.getAsFile();return e?new Oe(null,e.name,new Uint8Array(await e.arrayBuffer()),!0):null}return"directory"===this.kind?new Me(null,"unknown"):null}),b.set("VirtualFileHandle",{canHandle:e=>e instanceof Oe,serialize:e=>[e.serialize(),[]],deserialize:e=>new Oe(null,e.name,e.fileData)}),b.set("VirtualDirectoryHandle",{canHandle:e=>e instanceof Me,serialize:e=>[e.serialize(),[]],deserialize:e=>Me.deserialize(e)});let Re=k({});function We(e,t){const i=t;if((null==i?void 0:i.startsWith("["))&&i.endsWith("]"))return i.slice(1,-1);let n;(null==t?void 0:t.startsWith("$vuetify."))||(t=`$vuetify.${t}`);try{n=e.lang.t(t)}catch{return null!=i?i:"Unknown"}return n===t?null!=i?i:"Unknown":n}class Ne{constructor(e){this.vuetify=e}translate(e){return We(this.vuetify,e)}addLanguage(e,t,i=!1){const n=this.vuetify.lang;if(e in n.locales&&!i)throw new Error(`Language key "${e}" already exists!`);return u.set(n.locales,e,t),{dispose:()=>{n.current===e&&(n.current=n.defaultLocale),u.delete(n.locales,e)}}}selectLanguage(e){const t=this.vuetify.lang;if(!(e in t.locales))throw new Error(`Undefined language: "${e}"`);t.current=e}getLanguages(){const e=this.vuetify.lang.locales;return Object.entries(e).filter((([e,t])=>void 0!==t.languageName)).map((([e,t])=>[e,t.languageName]))}getCurrentLanguage(){return this.vuetify.lang.current}setDefaultLanguage(){var e,t;if("string"==typeof(null==(e=null==Re?void 0:Re.general)?void 0:e.locale))this.selectLanguage(null==(t=null==Re?void 0:Re.general)?void 0:t.locale);else for(const[i]of this.getLanguages())navigator.language.includes(i)&&this.selectLanguage(i)}}const Be={methods:{t(e){return We(this.$vuetify,e)}}};function Le(e,t,i,n,s,a,r,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=l):s&&(l=o?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}const He={name:"SidebarButton",mixins:[Be],props:{displayName:String,icon:String,iconColor:String,color:String,isLoading:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},alwaysAllowClick:{type:Boolean,default:!1},opacity:{type:Number,default:1}},data:()=>({settingsState:Re,hasClicked:!1}),computed:{isSidebarRight(){return this.settingsState&&this.settingsState.sidebar&&this.settingsState.sidebar.isSidebarRight},smallerSidebarElements(){return this.settingsState&&this.settingsState.sidebar&&this.settingsState.sidebar.smallerSidebarElements},computedColor(){return this.color?this.color.startsWith("#")?this.color:`var(--v-${this.color}-base)`:this.isLoading||this.isSelected?"var(--v-primary-base)":"var(--v-sidebarSelection-base)"}},methods:{onClick(){!this.alwaysAllowClick&&this.isLoading||(this.$emit("click"),this.hasClicked=!0,this.$nextTick((()=>this.hasClicked=!1)))},onMiddleClick(){!this.alwaysAllowClick&&this.isLoading||(this.$emit("middleClick"),this.hasClicked=!0,this.$nextTick((()=>this.hasClicked=!1)))}}},Ve={};var ze=Le(He,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-tooltip",{attrs:{color:e.color?e.color:"tooltip",disabled:e.hasClicked,right:!e.isSidebarRight,left:e.isSidebarRight},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("div",e._g({directives:[{name:"ripple",rawName:"v-ripple",value:e.alwaysAllowClick||!e.isLoading,expression:"alwaysAllowClick || !isLoading"}],staticClass:"rounded-lg ma-2 d-flex justify-center sidebar-button",class:{loading:e.isLoading,"pa-1":e.smallerSidebarElements,"pa-2":!e.smallerSidebarElements,"elevation-4":e.isSelected},style:{"background-color":e.computedColor,transform:e.isSelected?"scale(1.1)":void 0},on:{click:e.onClick,mouseup:function(t){return"button"in t&&1!==t.button?null:e.onMiddleClick(t)}}},n),[i("v-icon",{style:{position:e.isLoading?"absolute":"relative",marginTop:e.isLoading?"4px":0},attrs:{color:e.isLoading||e.isSelected?"white":e.iconColor,small:e.isLoading}},[e._v(" "+e._s(e.icon)+" ")]),e.isLoading?e._t("default",[i("v-progress-circular",{attrs:{size:"24",width:"2",color:"white",indeterminate:""}})]):e._e()],2)]}}],null,!0)},[i("span",[e._v(e._s(e.t(e.displayName)))])])}),[],!1,Ue,"4d3eb8e8",null,null);function Ue(e){for(let t in Ve)this[t]=Ve[t]}var Ge=function(){return ze.exports}();class Je extends Ce{constructor(e,t=!1,i=!1){super(),d(this,"windowUUID",h()),d(this,"isVisible",!1),d(this,"shouldRender",!1),d(this,"actions",[]),d(this,"component"),this.disposeOnClose=t,this.keepAlive=i,this.component=y(e)}defineWindow(){S(Yp.windowState.state,this.windowUUID,this)}addAction(e){this.actions.push(e)}close(e){this.isVisible=!1,null!==e&&this.dispatch(e),this.keepAlive||setTimeout((()=>{this.shouldRender=!1,this.disposeOnClose&&this.dispose()}),600)}open(){this.shouldRender=!0,this.isVisible=!0,this.resetSignal()}dispose(){x(Yp.windowState.state,this.windowUUID)}}function qe(){var e;if((null==(e=null==Re?void 0:Re.developers)?void 0:e.simulateOS)&&"auto"!==Re.developers.simulateOS)return Re.developers.simulateOS;const t=navigator.platform.toLowerCase();return t.includes("win")?"win32":t.includes("linux")?"linux":t.includes("mac")?"darwin":(console.error(`Unknown platform: ${t}`),"win32")}class Ke extends xe{constructor(e){var t;super(),d(this,"id"),this.config=e,this.id=null!=(t=e.id)?t:h()}get name(){return this.config.name}get icon(){return this.config.icon}get description(){return this.config.description}get color(){return this.config.color}get isDisabled(){var e,t,i,n;return"function"==typeof this.config.isDisabled?null!=(i=null==(t=(e=this.config).isDisabled)?void 0:t.call(e))&&i:null!=(n=this.config.isDisabled)&&n}async trigger(){if(!this.isDisabled)return this.dispatch(),await this.config.onTrigger()}}const Qe={};var Xe=Le({mixins:[Be],props:{action:Ke},data:()=>({platform:qe()}),computed:{minimalDisplay(){return!this.$vuetify.breakpoint.mdAndUp},isDarkMode(){return this.$vuetify.theme.dark}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn",{style:"darwin"===e.platform?"border-radius: 8px":void 0,attrs:{text:!e.minimalDisplay,small:"",icon:e.minimalDisplay},on:{click:function(t){return e.action.trigger()}}},[i("v-icon",{class:{"mr-1":!0,"ml-1":e.minimalDisplay},attrs:{color:e.action.accent||"accent",small:""}},[e._v(" "+e._s(e.action.icon)+" ")]),e.minimalDisplay?e._e():i("span",{style:{"text-transform":"none","font-weight":"unset",color:e.isDarkMode?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},[e._v(" "+e._s(e.t(e.action.name))+" ")])],1)}),[],!1,Ze,null,null,null);function Ze(e){for(let t in Qe)this[t]=Qe[t]}var Ye=function(){return Xe.exports}();const et={name:"WindowsToolbar",components:{DisplayAction:Ye},props:{windowTitle:String,actions:Array,sidebarWidth:{type:String,default:"25%"},hasCloseButton:{type:Boolean,default:!0},hasMaximizeButton:{type:Boolean,default:!0},hasSidebar:Boolean},computed:{isDarkMode(){return this.$vuetify.theme.dark}}},tt={};var it=Le(et,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-system-bar",{style:{"padding-right":"0px","padding-left":e.hasSidebar?"calc("+e.sidebarWidth+" + 12px)":void 0},attrs:{height:"30px",color:"toolbar"}},[i("span",[e._v(e._s(e.windowTitle))]),i("v-spacer"),i("v-toolbar-items",{staticClass:"px14-font"},[e._l(e.actions,(function(e){return i("DisplayAction",{key:e.id,attrs:{action:e}})})),e._t("default"),e.hasMaximizeButton?i("v-btn",{attrs:{small:"",icon:""},on:{click:function(t){return t.stopPropagation(),e.$emit("toggleFullscreen")}}},[i("v-icon",{attrs:{small:""}},[e._v("mdi-plus")])],1):e._e(),e.hasCloseButton?i("v-btn",{staticClass:"mr-1",attrs:{small:"",icon:"",color:"error"},on:{click:function(t){return t.stopPropagation(),e.$emit("closeWindow")}}},[i("v-icon",{attrs:{color:e.isDarkMode?"white":"grey darken-1",small:""}},[e._v(" mdi-close ")])],1):e._e()],2)],1)}),[],!1,nt,null,null,null);function nt(e){for(let t in tt)this[t]=tt[t]}var st=function(){return it.exports}();const at={props:{color:String,disabled:Boolean},data:()=>({windowHasFocus:!0}),mounted(){window.addEventListener("focus",this.enableButton),window.addEventListener("blur",this.disableButton)},destroyed(){window.removeEventListener("focus",this.enableButton),window.removeEventListener("blur",this.disableButton)},computed:{isDarkMode(){return this.$vuetify.theme.dark}},methods:{disableButton(){this.windowHasFocus=!1},enableButton(){this.windowHasFocus=!0}}},rt={};var ot=Le(at,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-icon",{directives:[{name:"ripple",rawName:"v-ripple",value:!e.disabled,expression:"!disabled"}],staticClass:"mr-1",staticStyle:{"font-size":"15px"},attrs:{color:e.disabled||!e.windowHasFocus?e.isDarkMode?"grey darken-2":"grey":e.color,small:""},nativeOn:{click:function(t){return t.stopPropagation(),e.$emit("click")}}},[e._v(" mdi-checkbox-blank-circle ")])}),[],!1,lt,null,null,null);function lt(e){for(let t in rt)this[t]=rt[t]}const ct={components:{MacButton:function(){return ot.exports}()},props:{hasCloseButton:{type:Boolean,default:!0},hasMinimizeButton:{type:Boolean,default:!1},hasMaximizeButton:{type:Boolean,default:!0}},computed:{isDarkMode(){return this.$vuetify.theme.dark}}},dt={};var ut=Le(ct,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{position:"fixed","z-index":"1"}},[e.hasCloseButton?i("MacButton",{attrs:{color:"error"},on:{click:function(t){return e.$emit("closeWindow")}}}):e._e(),e.hasCloseButton?i("MacButton",{attrs:{color:"warning",disabled:!e.hasMinimizeButton},on:{click:function(t){return e.$emit("minimizeWindow")}}}):e._e(),e.hasCloseButton?i("MacButton",{attrs:{color:"success",disabled:!e.hasMaximizeButton},on:{click:function(t){return e.$emit("toggleFullscreen")}}}):e._e()],1)}),[],!1,pt,null,null,null);function pt(e){for(let t in dt)this[t]=dt[t]}var ht=function(){return ut.exports}();const mt={name:"MacToolbar",components:{MacWindowControls:ht,DisplayAction:Ye},props:{windowTitle:String,hasSidebar:Boolean,actions:Array,sidebarWidth:{type:String,default:"25%"},hasCloseButton:{type:Boolean,default:!0},hasMinimizeButton:{type:Boolean,default:!1},hasMaximizeButton:{type:Boolean,default:!0}}},gt={};var ft=Le(mt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-system-bar",{attrs:{height:"30px",color:"toolbar"}},[i("span",{class:{"window-title":!e.hasSidebar},style:{"padding-left":e.hasSidebar?"calc("+e.sidebarWidth+" + 12px)":void 0}},[e._v(" "+e._s(e.windowTitle)+" ")]),i("div",{staticStyle:{position:"absolute",top:"3px"}},[e.hasSidebar?e._e():i("MacWindowControls",e._g({attrs:{hasCloseButton:e.hasCloseButton,hasMaximizeButton:e.hasMaximizeButton,hasMinimizeButton:e.hasMinimizeButton}},e.$listeners))],1),i("v-spacer"),e._l(e.actions,(function(e){return i("DisplayAction",{key:e.id,attrs:{action:e}})})),e._t("default")],2)}),[],!1,wt,"76a2b5b4",null,null);function wt(e){for(let t in gt)this[t]=gt[t]}const vt={name:"BaseWindow",mixins:[Be],components:{WindowsToolbar:st,MacToolbar:function(){return ft.exports}(),MacWindowControls:ht},props:{isFullscreen:Boolean,isVisible:Boolean,shouldRender:Boolean,isPersistent:Boolean,actions:Array,sidebarWidth:{type:String,default:"25%"},blurBackground:{type:Boolean,default:!0},hideToolbar:Boolean,windowTitle:String,hasCloseButton:{type:Boolean,default:!0},hasMaximizeButton:{type:Boolean,default:!1},width:{type:Number,default:1600},maxWidth:{type:Number,default:1600},height:{type:Number,default:800},maxHeight:{type:Number,default:800},heightUnset:Boolean,percentageHeight:Number,percentageWidth:Number,maxPercentageHeight:Number,maxPercentageWidth:Number,isSmallPopup:Boolean},data(){return{platform:qe(),globalWindowWidth:window.innerWidth,globalWindowHeight:window.innerHeight,updateWindowSize:C((function(){this.globalWindowWidth=window.innerWidth,this.globalWindowHeight=window.innerHeight}),200).bind(this)}},mounted(){window.addEventListener("resize",this.updateWindowSize)},destroyed(){window.removeEventListener("resize",this.updateWindowSize)},computed:{calcSidebarWidth(){return this.$vuetify.breakpoint.mobile?"76px":this.sidebarWidth},isFullScreenOrMobile(){return!this.isSmallPopup&&this.$vuetify.breakpoint.mobile||this.isFullscreen},isDarkMode(){return this.$vuetify.theme.dark},windowWidth(){return null==this.percentageWidth?this.width:this.globalWindowWidth/100*this.percentageWidth},windowHeight(){return null==this.percentageHeight?this.height:this.globalWindowHeight/100*this.percentageHeight-150},maxWindowWidth(){return null==this.maxPercentageWidth?this.maxWidth:this.globalWindowWidth/100*this.maxPercentageWidth},maxWindowHeight(){return!this.isSmallPopup&&this.$vuetify.breakpoint.mobile?this.globalWindowHeight-30*!this.hideToolbar-52*!!this.$slots.actions:null==this.maxPercentageHeight?this.maxHeight:this.globalWindowHeight/100*this.maxPercentageHeight-150}}},yt={};var bt=Le(vt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{value:e.isVisible,fullscreen:!e.isSmallPopup&&e.$vuetify.breakpoint.mobile,persistent:e.isPersistent,"hide-overlay":!e.blurBackground,"max-width":e.isFullScreenOrMobile?e.maxWindowWidth:e.windowWidth,"content-class":"no-overflow"},on:{input:function(t){return e.$emit("closeWindow")}}},[i("v-card",{ref:"card",attrs:{height:"100%",width:"100%",color:"background",rounded:"darwin"===e.platform?"lg":void 0}},[e.hideToolbar?e._e():i("darwin"===e.platform?"MacToolbar":"WindowsToolbar",{tag:"component",attrs:{windowTitle:e.t(e.windowTitle),actions:e.actions,hasMaximizeButton:e.hasMaximizeButton,hasCloseButton:e.hasCloseButton,hasSidebar:!!e.$slots.sidebar,sidebarWidth:e.calcSidebarWidth},on:{toggleFullscreen:function(t){return e.$emit("toggleFullscreen")},closeWindow:function(t){return e.$emit("closeWindow")}}},[e._t("toolbar")],2),e.$slots.sidebar?i("v-navigation-drawer",{staticStyle:{visibility:"visible",transform:"translateX(0)"},attrs:{absolute:"",width:e.calcSidebarWidth,permanent:"",clipped:"",stateless:"",color:"expandedSidebar"}},["darwin"===e.platform?i("MacWindowControls",{staticClass:"pl-3 pt-1",staticStyle:{width:"calc(100% - 1px)","background-color":"var(--v-expandedSidebar-base)"},attrs:{hasMaximizeButton:e.hasMaximizeButton,hasCloseButton:e.hasCloseButton},on:{toggleFullscreen:function(t){return e.$emit("toggleFullscreen")},closeWindow:function(t){return e.$emit("closeWindow")}}}):e._e(),i("v-container",{class:{"pt-8":"darwin"===e.platform}},[e._t("sidebar")],2)],1):e._e(),i("v-card-text",{staticStyle:{"overflow-y":"auto"},style:{height:e.heightUnset?void 0:(e.isFullScreenOrMobile?e.maxWindowHeight:e.windowHeight)+"px","max-height":e.maxWindowHeight+"px","padding-top":e.hideToolbar?"24px":"12px","padding-left":e.$slots.sidebar?"calc("+e.calcSidebarWidth+" + 12px)":void 0}},[e._t("default")],2),e.$slots.actions?i("v-card-actions",{style:{"padding-left":e.$slots.sidebar?"calc("+e.sidebarWidth+" + 12px)":void 0},attrs:{"background-color":"footer"}},[e._t("actions")],2):e._e()],1)],1)}),[],!1,kt,null,null,null);function kt(e){for(let t in yt)this[t]=yt[t]}var St=function(){return bt.exports}();const xt={};var Ct=Le({name:"Information",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{close(){this.currentWindow.close()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:e.$data.title,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,width:440,height:120,hasCloseButton:!1,isPersistent:e.$data.isPersistent,isSmallPopup:!0},scopedSlots:e._u([{key:"default",fn:function(){return[i("p",{staticClass:"mt-2"},[e._v(e._s(e.t(e.$data.description)))])]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary"},on:{click:e.close}},[i("v-icon",[e._v("mdi-check")]),i("span",[e._v(e._s(e.t("general.confirm")))])],1)]},proxy:!0}],null,!1,3734431350)}):e._e()}),[],!1,jt,null,null,null);function jt(e){for(let t in xt)this[t]=xt[t]}var _t=function(){return Ct.exports}();class Pt extends Je{constructor(e){super(_t,!0,!1),this.opts=e,this.defineWindow(),this.open()}get description(){return this.opts.description}get title(){var e;return null!=(e=this.opts.name)?e:"general.information"}get isPersistent(){var e;return null==(e=this.opts.isPersistent)||e}async close(){Yp.audioManager.playAudio("click5.ogg",1),super.close(null),"function"==typeof this.opts.onClose&&await this.opts.onClose(),this.dispatch()}}const At=j({});class Tt{constructor(e){var t,i;d(this,"id"),d(this,"_isVisible",!1),this.config=e,this.id=null!=(t=e.id)?t:h(),S(At,this.id,this),(null==(i=this.config.isVisible)||i)&&this.show()}get icon(){return this.config.icon}get message(){return this.config.message}get color(){return this.config.color}get textColor(){return this.config.textColor}get isVisible(){return this._isVisible}onClick(){"function"==typeof this.config.onClick&&this.config.onClick()}onMiddleClick(){var e,t;null==(t=(e=this.config).onMiddleClick)||t.call(e),this.config.disposeOnMiddleClick&&x(At,this.id)}addClickHandler(e){this.config.onClick=e}show(){this._isVisible||this.updateAppBadge(),this._isVisible=!0}dispose(){x(At,this.id),this.updateAppBadge()}updateAppBadge(){"function"==typeof navigator.setAppBadge&&navigator.setAppBadge(Object.values(At).filter((({isVisible:e})=>e)).length)}}function Et(e){return new Tt(e)}function Ft(e){var t;let i=(null!=(t=e.stack)?t:"at unknown").split("\n").map((e=>e.trim()));return i.splice(i[0].startsWith("Error")?1:0)}function Dt(e){var t;const i=null!=(t=e.message)?t:"";let n=i;i.includes(": ")&&(n=i.split(": ").shift()),n.length>24&&(n=i.length>24?`${i.substr(0,23)}...`:i);const s=Et({icon:"mdi-alert-circle-outline",message:`[${n}]`,color:"error",textColor:"white",disposeOnMiddleClick:!0,onClick:()=>{Yp.audioManager.playAudio("click5.ogg",1),new Pt({name:`[ERROR: ${n}]`,description:`[${e.message} (${Ft(e)})]`}),s.dispose()}});return s}window.addEventListener("error",(e=>{var t,i;Dt(null!=(t=e.error)?t:e),null==(i=null==Yp?void 0:Yp.ready)||i.once((e=>e.windows.loadingWindow.closeAll()))})),window.onunhandledrejection=e=>{var t;Dt(new Error(e.reason)),null==(t=null==Yp?void 0:Yp.ready)||t.once((e=>e.windows.loadingWindow.closeAll()))};const Ot=[[/§4/,"colorCode.darkRed"],[/§c/,"colorCode.red"],[/§6/,"colorCode.gold"],[/§e/,"colorCode.yellow"],[/§2/,"colorCode.darkGreen"],[/§a/,"colorCode.green"],[/§b/,"colorCode.aqua"],[/§3/,"colorCode.darkAqua"],[/§1/,"colorCode.darkBlue"],[/§9/,"colorCode.blue"],[/§d/,"colorCode.lightPurple"],[/§5/,"colorCode.darkPurple"],[/§[fr]/,"colorCode.white"],[/§7/,"colorCode.gray"],[/§8/,"colorCode.darkGray"],[/§0/,"colorCode.black"],[/§g/,"colorCode.minecoinGold"],[/§o/,"colorCode.italic"],[/§l/,"colorCode.bold"],[/§n/,"colorCode.underline"]];class Mt{constructor({id:e,extensions:t,config:i,tokenProvider:n,completionItemProvider:s}){d(this,"id"),d(this,"disposables",[]),d(this,"models",new Map),d(this,"highlighter"),this.id=e,_.register({id:e,extensions:t}),this.disposables=[_.setLanguageConfiguration(e,i),P.onDidCreateModel(this.onModelAdded.bind(this)),P.onWillDisposeModel(this.onModelRemoved.bind(this)),P.onDidChangeModelLanguage((e=>{this.onModelRemoved(e.model),this.onModelAdded(e.model)}))],this.highlighter=_.setMonarchTokensProvider(e,n),s&&this.disposables.push(_.registerCompletionItemProvider(e,s))}updateTokenProvider(e){this.highlighter.dispose(),this.highlighter=_.setMonarchTokensProvider(this.id,e)}onModelAdded(e){return e.getModeId()===this.id&&(this.validate(e),this.models.set(e.uri.toString(),e.onDidChangeContent(C((t=>this.validate(e,t)),500))),!0)}onModelRemoved(e){var t;P.setModelMarkers(e,this.id,[]);const i=e.uri.toString();null==(t=this.models.get(i))||t.dispose(),this.models.delete(i)}dispose(){this.highlighter.dispose(),this.disposables.forEach((e=>e.dispose())),this.disposables=[]}}const $t={comments:{lineComment:"##"}},It={tokenizer:{root:[[/##.*/,"comment"],[/=|\.|:/,"definition"],...Ot]}};class Rt extends Mt{constructor(){super({id:"lang",extensions:["lang"],config:$t,tokenProvider:It})}validate(){}}const Wt={props:{action:Object,hideTriggerButton:Boolean,dense:Boolean,selected:{type:Boolean,default:void 0}},mixins:[Be],methods:{onTrigger(){this.action.trigger()}}},Nt={};var Bt=Le(Wt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"text-normal pa-4 mb-2 rounded-lg control-bg",class:{selected:e.selected}},[i("div",{staticClass:"d-flex align-center"},[e.action.icon?i("v-icon",{staticClass:"mr-1",attrs:{color:e.action.color||"accent"}},[e._v(" "+e._s(e.action.icon)+" ")]):e._e(),i("h3",[e._v(e._s(e.t(e.action.name)))]),i("v-spacer"),e.action.keyBinding?i("span",[e._v(" "+e._s(e.action.keyBinding.toStrKeyCode())+" ")]):e._e(),e.hideTriggerButton?e._e():i("v-btn",{attrs:{color:"primary",small:"",icon:""}},[i("v-icon",{on:{click:e.onTrigger}},[e._v("mdi-play")])],1),void 0!==e.selected?i("v-icon",[e._v(" "+e._s(e.selected?"mdi-check-circle-outline":"mdi-checkbox-blank-circle-outline")+" ")]):e._e()],1),!e.dense&&e.action.description?i("span",[e._v(" "+e._s(e.t(e.action.description))+" ")]):e._e()])}),[],!1,Lt,"5fcc2265",null,null);function Lt(e){for(let t in Nt)this[t]=Nt[t]}var Ht=function(){return Bt.exports}();const Vt={data:()=>({isProjectMixinReady:!1}),async mounted(){const e=await Yp.getApp();await e.projectManager.fired,this.isProjectMixinReady=!0},computed:{project(){if(!this.isProjectMixinReady)return;const e=Yp.instance.projectManager;return e.state[e._selectedProject]}}},zt="https://nightly.bridge-core.app"===location.origin;const Ut={};var Gt=Le({setup:()=>({isNightly:zt})},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isNightly?i("img",{attrs:{draggable:"false",src:"/assets/logo.eca065f6.svg",alt:"Logo of bridge. v2"}}):i("img",{attrs:{draggable:"false",src:"/assets/logo.1f65ee53.svg",alt:"Logo of bridge. v2"}})}),[],!1,Jt,null,null,null);function Jt(e){for(let t in Ut)this[t]=Ut[t]}var qt=function(){return Gt.exports}();const Kt={};var Qt=Le({name:"welcome-screen",mixins:[Be,Vt],components:{ActionViewer:Ht,Logo:qt},async mounted(){const e=await Yp.getApp();this.actions=["bridge.action.newProject","bridge.action.newFile","bridge.action.searchFile","bridge.action.openSettings"].map((t=>e.actionManager.state[t])),await e.projectManager.fired,this.projectManager=e.projectManager},data:()=>({actions:[],projectManager:null,maySwitchProjects:!0}),computed:{files(){return this.project?this.project.recentFiles.elements:[]},projects(){return this.projectManager?this.projectManager.recentProjects.elements.filter((({path:e})=>e!==this.projectManager.selectedProject)):[]}},methods:{async openFile(e){const t=await Yp.getApp(),i=await t.fileSystem.getFileHandle(e);t.project.openFile(i)},selectProject(e){Yp.getApp().then((t=>t.projectManager.selectProject(e)))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d-flex flex-column justify-center align-center px-4",style:"padding-top: 14vh;"},[i("Logo",{staticClass:"mb-4",staticStyle:{height:"160px",width:"160px"},attrs:{alt:"Logo of bridge. v2"}}),i("h1",{staticClass:"text-h3 text-center"},[e._v(e._s(e.t("welcome.title")))]),i("h2",{staticClass:"text-h6 mb-12 text-center"},[e._v(e._s(e.t("welcome.subtitle")))]),i("v-row",{staticStyle:{"flex-wrap":"nowrap",width:"60vw"}},[e.actions.length>0?i("v-col",{attrs:{tag:"ul"}},[i("p",[e._v(e._s(e.t("welcome.quickActions")))]),i("v-divider",{staticClass:"mb-2"}),e._l(e.actions,(function(t){return i("li",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,staticClass:"rounded-lg pa-1 clickable",on:{click:function(){return t.trigger()}}},[i("v-icon",{attrs:{color:"accent",medium:""}},[e._v(e._s(t.icon))]),i("span",{attrs:{color:"text--primary"}},[e._v(e._s(e.t(t.name)))]),t.keyBinding?i("span",{staticClass:"text--secondary",staticStyle:{float:"right"}},[e._v(" "+e._s(t.keyBinding.toStrKeyCode())+" ")]):e._e()],1)}))],2):e._e(),e.$vuetify.breakpoint.smAndUp&&e.files.length>0?i("v-col",{attrs:{tag:"ul"}},[i("p",[e._v(e._s(e.t("welcome.recentFiles")))]),i("v-divider",{staticClass:"mb-2"}),e._l(e.files,(function(t){return i("li",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.path,staticClass:"d-flex rounded-lg pa-1 clickable",on:{click:function(i){return e.openFile(t.path)}}},[i("v-icon",{attrs:{color:t.color||"error",medium:""}},[e._v(" "+e._s(t.icon)+" ")]),i("span",{staticClass:"primary-text"},[e._v(e._s(t.name))])],1)}))],2):e._e(),e.$vuetify.breakpoint.mdAndUp&&e.projects.length>0?i("v-col",{class:{disabled:!e.maySwitchProjects},attrs:{tag:"ul"}},[i("p",[e._v(e._s(e.t("welcome.recentProjects")))]),e.maySwitchProjects?i("v-divider",{staticClass:"mb-2"}):i("v-progress-linear",{staticClass:"mb-1",attrs:{rounded:"",indeterminate:""}}),e._l(e.projects,(function(t){return i("li",{directives:[{name:"ripple",rawName:"v-ripple",value:e.maySwitchProjects,expression:"maySwitchProjects"}],key:t.name,class:{"d-flex rounded-lg pa-1":!0,clickable:e.maySwitchProjects},on:{click:function(i){e.maySwitchProjects&&e.selectProject(t.path)}}},[i("div",{staticClass:"d-flex align-center"},[t.imgSrc?i("img",{staticClass:"mr-1 pack-icon",attrs:{src:t.imgSrc,alt:t.name+" Logo",draggable:"false"}}):e._e(),i("span",{staticClass:"primary-text"},[e._v(e._s(t.path))])])])}))],2):e._e()],1)],1)}),[],!1,Xt,"69f03806",null,null);function Xt(e){for(let t in Kt)this[t]=Kt[t]}var Zt=function(){return Qt.exports}();function Yt(e,t){for(var i=0,n=e.length-1;n>=0;n--){var s=e[n];"."===s?e.splice(n,1):".."===s?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}var ei=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,ti=function(e){return ei.exec(e).slice(1)};function ii(){for(var e="",t=!1,i=arguments.length-1;i>=-1&&!t;i--){var n=i>=0?arguments[i]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return(t?"/":"")+(e=Yt(ui(e.split("/"),(function(e){return!!e})),!t).join("/"))||"."}function ni(e){var t=si(e),i="/"===pi(e,-1);return(e=Yt(ui(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e}function si(e){return"/"===e.charAt(0)}function ai(){var e=Array.prototype.slice.call(arguments,0);return ni(ui(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function ri(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=ii(e).substr(1),t=ii(t).substr(1);for(var n=i(e.split("/")),s=i(t.split("/")),a=Math.min(n.length,s.length),r=a,o=0;o<a;o++)if(n[o]!==s[o]){r=o;break}var l=[];for(o=r;o<n.length;o++)l.push("..");return(l=l.concat(s.slice(r))).join("/")}function oi(e){var t=ti(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."}function li(e,t){var i=ti(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i}function ci(e){return ti(e)[3]}var di={extname:ci,basename:li,dirname:oi,sep:"/",delimiter:":",relative:ri,join:ai,isAbsolute:si,normalize:ni,resolve:ii};function ui(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}var pi="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)},hi=Object.freeze({__proto__:null,resolve:ii,normalize:ni,isAbsolute:si,join:ai,relative:ri,sep:"/",delimiter:":",dirname:oi,basename:li,extname:ci,default:di});function mi(){throw new Error("setTimeout has not been defined")}function gi(){throw new Error("clearTimeout has not been defined")}var fi,wi=mi,vi=gi;function yi(e){if(wi===setTimeout)return setTimeout(e,0);if((wi===mi||!wi)&&setTimeout)return wi=setTimeout,setTimeout(e,0);try{return wi(e,0)}catch(t){try{return wi.call(null,e,0)}catch(i){return wi.call(this,e,0)}}}"function"==typeof(fi="undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).setTimeout&&(wi=setTimeout),"function"==typeof fi.clearTimeout&&(vi=clearTimeout);var bi,ki=[],Si=!1,xi=-1;function Ci(){Si&&bi&&(Si=!1,bi.length?ki=bi.concat(ki):xi=-1,ki.length&&ji())}function ji(){if(!Si){var e=yi(Ci);Si=!0;for(var t=ki.length;t;){for(bi=ki,ki=[];++xi<t;)bi&&bi[xi].run();xi=-1,t=ki.length}bi=null,Si=!1,function(e){if(vi===clearTimeout)return clearTimeout(e);if((vi===gi||!vi)&&clearTimeout)return vi=clearTimeout,clearTimeout(e);try{vi(e)}catch(t){try{return vi.call(null,e)}catch(i){return vi.call(this,e)}}}(e)}}function _i(e,t){this.fun=e,this.array=t}_i.prototype.run=function(){this.fun.apply(null,this.array)};function Pi(){}var Ai=Pi,Ti=Pi,Ei=Pi,Fi=Pi,Di=Pi,Oi=Pi,Mi=Pi;var $i=fi.performance||{},Ii=$i.now||$i.mozNow||$i.msNow||$i.oNow||$i.webkitNow||function(){return(new Date).getTime()};var Ri=new Date;var Wi={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];ki.push(new _i(e,t)),1!==ki.length||Si||yi(ji)},title:"browser",browser:!0,env:{NODE_ENV:"production"},argv:[],version:"",versions:{},on:Ai,addListener:Ti,once:Ei,off:Fi,removeListener:Di,removeAllListeners:Oi,emit:Mi,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*Ii.call($i),i=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(i-=e[0],(n-=e[1])<0&&(i--,n+=1e9)),[i,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ri)/1e3}};const Ni={DOT_LITERAL:"\\.",PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:"\\/",ONE_CHAR:"(?=.)",QMARK:"[^/]",END_ANCHOR:"(?:\\/|$)",DOTS_SLASH:"\\.{1,2}(?:\\/|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|\\/)\\.{1,2}(?:\\/|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:\\/|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:\\/|$))",QMARK_NO_DOT:"[^.\\/]",STAR:"[^/]*?",START_ANCHOR:"(?:^|\\/)"},Bi=c(l({},Ni),{SLASH_LITERAL:"[\\\\/]",QMARK:"[^\\\\/]",STAR:"[^\\\\/]*?",DOTS_SLASH:"\\.{1,2}(?:[\\\\/]|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|[\\\\/])\\.{1,2}(?:[\\\\/]|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:[\\\\/]|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:[\\\\/]|$))",QMARK_NO_DOT:"[^.\\\\/]",START_ANCHOR:"(?:^|[\\\\/])",END_ANCHOR:"(?:[\\\\/]|$)"});var Li,Hi,Vi={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:hi.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?Bi:Ni},zi=(function(e,t){const{REGEX_BACKSLASH:i,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_GLOBAL:a}=Vi;t.isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),t.hasRegexChars=e=>s.test(e),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=e=>e.replace(a,"\\$1"),t.toPosixSlashes=e=>e.replace(i,"/"),t.removeBackslashes=e=>e.replace(n,(e=>"\\"===e?"":e)),t.supportsLookbehinds=()=>{const e=Wi.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},t.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:"\\"===hi.sep,t.escapeLast=(e,i,n)=>{const s=e.lastIndexOf(i,n);return-1===s?e:"\\"===e[s-1]?t.escapeLast(e,i,s-1):`${e.slice(0,s)}\\${e.slice(s)}`},t.removePrefix=(e,t={})=>{let i=e;return i.startsWith("./")&&(i=i.slice(2),t.prefix="./"),i},t.wrapOutput=(e,t={},i={})=>{let n=`${i.contains?"":"^"}(?:${e})${i.contains?"":"$"}`;return!0===t.negated&&(n=`(?:^(?!${n}).*$)`),n}}(Hi={path:Li,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&Hi.path)}},Hi.exports),Hi.exports);const{CHAR_ASTERISK:Ui,CHAR_AT:Gi,CHAR_BACKWARD_SLASH:Ji,CHAR_COMMA:qi,CHAR_DOT:Ki,CHAR_EXCLAMATION_MARK:Qi,CHAR_FORWARD_SLASH:Xi,CHAR_LEFT_CURLY_BRACE:Zi,CHAR_LEFT_PARENTHESES:Yi,CHAR_LEFT_SQUARE_BRACKET:en,CHAR_PLUS:tn,CHAR_QUESTION_MARK:nn,CHAR_RIGHT_CURLY_BRACE:sn,CHAR_RIGHT_PARENTHESES:an,CHAR_RIGHT_SQUARE_BRACKET:rn}=Vi,on=e=>e===Xi||e===Ji,ln=e=>{!0!==e.isPrefix&&(e.depth=e.isGlobstar?1/0:1)};var cn=(e,t)=>{const i=t||{},n=e.length-1,s=!0===i.parts||!0===i.scanToEnd,a=[],r=[],o=[];let l,c,d=e,u=-1,p=0,h=0,m=!1,g=!1,f=!1,w=!1,v=!1,y=!1,b=!1,k=!1,S=!1,x=!1,C=0,j={value:"",depth:0,isGlob:!1};const _=()=>u>=n,P=()=>(l=c,d.charCodeAt(++u));for(;u<n;){let e;if(c=P(),c!==Ji){if(!0===y||c===Zi){for(C++;!0!==_()&&(c=P());)if(c!==Ji)if(c!==Zi){if(!0!==y&&c===Ki&&(c=P())===Ki){if(m=j.isBrace=!0,f=j.isGlob=!0,x=!0,!0===s)continue;break}if(!0!==y&&c===qi){if(m=j.isBrace=!0,f=j.isGlob=!0,x=!0,!0===s)continue;break}if(c===sn&&(C--,0===C)){y=!1,m=j.isBrace=!0,x=!0;break}}else C++;else b=j.backslashes=!0,P();if(!0===s)continue;break}if(c!==Xi){if(!0!==i.noext){if(!0===(c===tn||c===Gi||c===Ui||c===nn||c===Qi)&&d.charCodeAt(u+1)===Yi){if(f=j.isGlob=!0,w=j.isExtglob=!0,x=!0,c===Qi&&u===p&&(S=!0),!0===s){for(;!0!==_()&&(c=P());)if(c!==Ji){if(c===an){f=j.isGlob=!0,x=!0;break}}else b=j.backslashes=!0,c=P();continue}break}}if(c===Ui){if(l===Ui&&(v=j.isGlobstar=!0),f=j.isGlob=!0,x=!0,!0===s)continue;break}if(c===nn){if(f=j.isGlob=!0,x=!0,!0===s)continue;break}if(c===en){for(;!0!==_()&&(e=P());)if(e!==Ji){if(e===rn){g=j.isBracket=!0,f=j.isGlob=!0,x=!0;break}}else b=j.backslashes=!0,P();if(!0===s)continue;break}if(!0===i.nonegate||c!==Qi||u!==p){if(!0!==i.noparen&&c===Yi){if(f=j.isGlob=!0,!0===s){for(;!0!==_()&&(c=P());)if(c!==Yi){if(c===an){x=!0;break}}else b=j.backslashes=!0,c=P();continue}break}if(!0===f){if(x=!0,!0===s)continue;break}}else k=j.negated=!0,p++}else{if(a.push(u),r.push(j),j={value:"",depth:0,isGlob:!1},!0===x)continue;if(l===Ki&&u===p+1){p+=2;continue}h=u+1}}else b=j.backslashes=!0,c=P(),c===Zi&&(y=!0)}!0===i.noext&&(w=!1,f=!1);let A=d,T="",E="";p>0&&(T=d.slice(0,p),d=d.slice(p),h-=p),A&&!0===f&&h>0?(A=d.slice(0,h),E=d.slice(h)):!0===f?(A="",E=d):A=d,A&&""!==A&&"/"!==A&&A!==d&&on(A.charCodeAt(A.length-1))&&(A=A.slice(0,-1)),!0===i.unescape&&(E&&(E=zi.removeBackslashes(E)),A&&!0===b&&(A=zi.removeBackslashes(A)));const F={prefix:T,input:e,start:p,base:A,glob:E,isBrace:m,isBracket:g,isGlob:f,isExtglob:w,isGlobstar:v,negated:k,negatedExtglob:S};if(!0===i.tokens&&(F.maxDepth=0,on(c)||r.push(j),F.tokens=r),!0===i.parts||!0===i.tokens){let t;for(let n=0;n<a.length;n++){const s=t?t+1:p,l=a[n],c=e.slice(s,l);i.tokens&&(0===n&&0!==p?(r[n].isPrefix=!0,r[n].value=T):r[n].value=c,ln(r[n]),F.maxDepth+=r[n].depth),0===n&&""===c||o.push(c),t=l}if(t&&t+1<e.length){const n=e.slice(t+1);o.push(n),i.tokens&&(r[r.length-1].value=n,ln(r[r.length-1]),F.maxDepth+=r[r.length-1].depth)}F.slashes=a,F.parts=o}return F};const{MAX_LENGTH:dn,POSIX_REGEX_SOURCE:un,REGEX_NON_SPECIAL_CHARS:pn,REGEX_SPECIAL_CHARS_BACKREF:hn,REPLACEMENTS:mn}=Vi,gn=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const i=`[${e.join("-")}]`;try{new RegExp(i)}catch(n){return e.map((e=>zi.escapeRegex(e))).join("..")}return i},fn=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,wn=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=mn[e]||e;const i=l({},t),n="number"==typeof i.maxLength?Math.min(dn,i.maxLength):dn;let s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);const a={type:"bos",value:"",output:i.prepend||""},r=[a],o=i.capture?"":"?:",d=zi.isWindows(t),u=Vi.globChars(d),p=Vi.extglobChars(u),{DOT_LITERAL:h,PLUS_LITERAL:m,SLASH_LITERAL:g,ONE_CHAR:f,DOTS_SLASH:w,NO_DOT:v,NO_DOT_SLASH:y,NO_DOTS_SLASH:b,QMARK:k,QMARK_NO_DOT:S,STAR:x,START_ANCHOR:C}=u,j=e=>`(${o}(?:(?!${C}${e.dot?w:h}).)*?)`,_=i.dot?"":v,P=i.dot?k:S;let A=!0===i.bash?j(i):x;i.capture&&(A=`(${A})`),"boolean"==typeof i.noext&&(i.noextglob=i.noext);const T={input:e,index:-1,start:0,dot:!0===i.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:r};e=zi.removePrefix(e,T),s=e.length;const E=[],F=[],D=[];let O,M=a;const $=()=>T.index===s-1,I=T.peek=(t=1)=>e[T.index+t],R=T.advance=()=>e[++T.index]||"",W=()=>e.slice(T.index+1),N=(e="",t=0)=>{T.consumed+=e,T.index+=t},B=e=>{T.output+=null!=e.output?e.output:e.value,N(e.value)},L=()=>{let e=1;for(;"!"===I()&&("("!==I(2)||"?"===I(3));)R(),T.start++,e++;return e%2!=0&&(T.negated=!0,T.start++,!0)},H=e=>{T[e]++,D.push(e)},V=e=>{T[e]--,D.pop()},z=e=>{if("globstar"===M.type){const t=T.braces>0&&("comma"===e.type||"brace"===e.type),i=!0===e.extglob||E.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||i||(T.output=T.output.slice(0,-M.output.length),M.type="star",M.value="*",M.output=A,T.output+=M.output)}if(E.length&&"paren"!==e.type&&(E[E.length-1].inner+=e.value),(e.value||e.output)&&B(e),M&&"text"===M.type&&"text"===e.type)return M.value+=e.value,void(M.output=(M.output||"")+e.value);e.prev=M,r.push(e),M=e},U=(e,t)=>{const n=c(l({},p[t]),{conditions:1,inner:""});n.prev=M,n.parens=T.parens,n.output=T.output;const s=(i.capture?"(":"")+n.open;H("parens"),z({type:e,value:t,output:T.output?"":f}),z({type:"paren",extglob:!0,value:R(),output:s}),E.push(n)},G=e=>{let t,n=e.close+(i.capture?")":"");if("negate"===e.type){let s=A;e.inner&&e.inner.length>1&&e.inner.includes("/")&&(s=j(i)),(s!==A||$()||/^\)+$/.test(W()))&&(n=e.close=`)$))${s}`),e.inner.includes("*")&&(t=W())&&/^\.[^\\/.]+$/.test(t)&&(n=e.close=`)${t})${s})`),"bos"===e.prev.type&&(T.negatedExtglob=!0)}z({type:"paren",extglob:!0,value:O,output:n}),V("parens")};if(!1!==i.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let n=!1,s=e.replace(hn,((e,t,i,s,a,r)=>"\\"===s?(n=!0,e):"?"===s?t?t+s+(a?k.repeat(a.length):""):0===r?P+(a?k.repeat(a.length):""):k.repeat(i.length):"."===s?h.repeat(i.length):"*"===s?t?t+s+(a?A:""):A:t?e:`\\${e}`));return!0===n&&(s=!0===i.unescape?s.replace(/\\/g,""):s.replace(/\\+/g,(e=>e.length%2==0?"\\\\":e?"\\":""))),s===e&&!0===i.contains?(T.output=e,T):(T.output=zi.wrapOutput(s,T,t),T)}for(;!$();){if(O=R(),"\0"===O)continue;if("\\"===O){const e=I();if("/"===e&&!0!==i.bash)continue;if("."===e||";"===e)continue;if(!e){O+="\\",z({type:"text",value:O});continue}const t=/^\\+/.exec(W());let n=0;if(t&&t[0].length>2&&(n=t[0].length,T.index+=n,n%2!=0&&(O+="\\")),!0===i.unescape?O=R():O+=R(),0===T.brackets){z({type:"text",value:O});continue}}if(T.brackets>0&&("]"!==O||"["===M.value||"[^"===M.value)){if(!1!==i.posix&&":"===O){const e=M.value.slice(1);if(e.includes("[")&&(M.posix=!0,e.includes(":"))){const e=M.value.lastIndexOf("["),t=M.value.slice(0,e),i=M.value.slice(e+2),n=un[i];if(n){M.value=t+n,T.backtrack=!0,R(),a.output||1!==r.indexOf(M)||(a.output=f);continue}}}("["===O&&":"!==I()||"-"===O&&"]"===I())&&(O=`\\${O}`),"]"!==O||"["!==M.value&&"[^"!==M.value||(O=`\\${O}`),!0===i.posix&&"!"===O&&"["===M.value&&(O="^"),M.value+=O,B({value:O});continue}if(1===T.quotes&&'"'!==O){O=zi.escapeRegex(O),M.value+=O,B({value:O});continue}if('"'===O){T.quotes=1===T.quotes?0:1,!0===i.keepQuotes&&z({type:"text",value:O});continue}if("("===O){H("parens"),z({type:"paren",value:O});continue}if(")"===O){if(0===T.parens&&!0===i.strictBrackets)throw new SyntaxError(fn("opening","("));const e=E[E.length-1];if(e&&T.parens===e.parens+1){G(E.pop());continue}z({type:"paren",value:O,output:T.parens?")":"\\)"}),V("parens");continue}if("["===O){if(!0!==i.nobracket&&W().includes("]"))H("brackets");else{if(!0!==i.nobracket&&!0===i.strictBrackets)throw new SyntaxError(fn("closing","]"));O=`\\${O}`}z({type:"bracket",value:O});continue}if("]"===O){if(!0===i.nobracket||M&&"bracket"===M.type&&1===M.value.length){z({type:"text",value:O,output:`\\${O}`});continue}if(0===T.brackets){if(!0===i.strictBrackets)throw new SyntaxError(fn("opening","["));z({type:"text",value:O,output:`\\${O}`});continue}V("brackets");const e=M.value.slice(1);if(!0===M.posix||"^"!==e[0]||e.includes("/")||(O=`/${O}`),M.value+=O,B({value:O}),!1===i.literalBrackets||zi.hasRegexChars(e))continue;const t=zi.escapeRegex(M.value);if(T.output=T.output.slice(0,-M.value.length),!0===i.literalBrackets){T.output+=t,M.value=t;continue}M.value=`(${o}${t}|${M.value})`,T.output+=M.value;continue}if("{"===O&&!0!==i.nobrace){H("braces");const e={type:"brace",value:O,output:"(",outputIndex:T.output.length,tokensIndex:T.tokens.length};F.push(e),z(e);continue}if("}"===O){const e=F[F.length-1];if(!0===i.nobrace||!e){z({type:"text",value:O,output:O});continue}let t=")";if(!0===e.dots){const e=r.slice(),n=[];for(let t=e.length-1;t>=0&&(r.pop(),"brace"!==e[t].type);t--)"dots"!==e[t].type&&n.unshift(e[t].value);t=gn(n,i),T.backtrack=!0}if(!0!==e.comma&&!0!==e.dots){const i=T.output.slice(0,e.outputIndex),n=T.tokens.slice(e.tokensIndex);e.value=e.output="\\{",O=t="\\}",T.output=i;for(const e of n)T.output+=e.output||e.value}z({type:"brace",value:O,output:t}),V("braces"),F.pop();continue}if("|"===O){E.length>0&&E[E.length-1].conditions++,z({type:"text",value:O});continue}if(","===O){let e=O;const t=F[F.length-1];t&&"braces"===D[D.length-1]&&(t.comma=!0,e="|"),z({type:"comma",value:O,output:e});continue}if("/"===O){if("dot"===M.type&&T.index===T.start+1){T.start=T.index+1,T.consumed="",T.output="",r.pop(),M=a;continue}z({type:"slash",value:O,output:g});continue}if("."===O){if(T.braces>0&&"dot"===M.type){"."===M.value&&(M.output=h);const e=F[F.length-1];M.type="dots",M.output+=O,M.value+=O,e.dots=!0;continue}if(T.braces+T.parens===0&&"bos"!==M.type&&"slash"!==M.type){z({type:"text",value:O,output:h});continue}z({type:"dot",value:O,output:h});continue}if("?"===O){if(!(M&&"("===M.value)&&!0!==i.noextglob&&"("===I()&&"?"!==I(2)){U("qmark",O);continue}if(M&&"paren"===M.type){const e=I();let t=O;if("<"===e&&!zi.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===M.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(W()))&&(t=`\\${O}`),z({type:"text",value:O,output:t});continue}if(!0!==i.dot&&("slash"===M.type||"bos"===M.type)){z({type:"qmark",value:O,output:S});continue}z({type:"qmark",value:O,output:k});continue}if("!"===O){if(!0!==i.noextglob&&"("===I()&&("?"!==I(2)||!/[!=<:]/.test(I(3)))){U("negate",O);continue}if(!0!==i.nonegate&&0===T.index){L();continue}}if("+"===O){if(!0!==i.noextglob&&"("===I()&&"?"!==I(2)){U("plus",O);continue}if(M&&"("===M.value||!1===i.regex){z({type:"plus",value:O,output:m});continue}if(M&&("bracket"===M.type||"paren"===M.type||"brace"===M.type)||T.parens>0){z({type:"plus",value:O});continue}z({type:"plus",value:m});continue}if("@"===O){if(!0!==i.noextglob&&"("===I()&&"?"!==I(2)){z({type:"at",extglob:!0,value:O,output:""});continue}z({type:"text",value:O});continue}if("*"!==O){"$"!==O&&"^"!==O||(O=`\\${O}`);const e=pn.exec(W());e&&(O+=e[0],T.index+=e[0].length),z({type:"text",value:O});continue}if(M&&("globstar"===M.type||!0===M.star)){M.type="star",M.star=!0,M.value+=O,M.output=A,T.backtrack=!0,T.globstar=!0,N(O);continue}let t=W();if(!0!==i.noextglob&&/^\([^?]/.test(t)){U("star",O);continue}if("star"===M.type){if(!0===i.noglobstar){N(O);continue}const n=M.prev,s=n.prev,a="slash"===n.type||"bos"===n.type,r=s&&("star"===s.type||"globstar"===s.type);if(!0===i.bash&&(!a||t[0]&&"/"!==t[0])){z({type:"star",value:O,output:""});continue}const o=T.braces>0&&("comma"===n.type||"brace"===n.type),l=E.length&&("pipe"===n.type||"paren"===n.type);if(!a&&"paren"!==n.type&&!o&&!l){z({type:"star",value:O,output:""});continue}for(;"/**"===t.slice(0,3);){const i=e[T.index+4];if(i&&"/"!==i)break;t=t.slice(3),N("/**",3)}if("bos"===n.type&&$()){M.type="globstar",M.value+=O,M.output=j(i),T.output=M.output,T.globstar=!0,N(O);continue}if("slash"===n.type&&"bos"!==n.prev.type&&!r&&$()){T.output=T.output.slice(0,-(n.output+M.output).length),n.output=`(?:${n.output}`,M.type="globstar",M.output=j(i)+(i.strictSlashes?")":"|$)"),M.value+=O,T.globstar=!0,T.output+=n.output+M.output,N(O);continue}if("slash"===n.type&&"bos"!==n.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";T.output=T.output.slice(0,-(n.output+M.output).length),n.output=`(?:${n.output}`,M.type="globstar",M.output=`${j(i)}${g}|${g}${e})`,M.value+=O,T.output+=n.output+M.output,T.globstar=!0,N(O+R()),z({type:"slash",value:"/",output:""});continue}if("bos"===n.type&&"/"===t[0]){M.type="globstar",M.value+=O,M.output=`(?:^|${g}|${j(i)}${g})`,T.output=M.output,T.globstar=!0,N(O+R()),z({type:"slash",value:"/",output:""});continue}T.output=T.output.slice(0,-M.output.length),M.type="globstar",M.output=j(i),M.value+=O,T.output+=M.output,T.globstar=!0,N(O);continue}const n={type:"star",value:O,output:A};!0!==i.bash?!M||"bracket"!==M.type&&"paren"!==M.type||!0!==i.regex?(T.index!==T.start&&"slash"!==M.type&&"dot"!==M.type||("dot"===M.type?(T.output+=y,M.output+=y):!0===i.dot?(T.output+=b,M.output+=b):(T.output+=_,M.output+=_),"*"!==I()&&(T.output+=f,M.output+=f)),z(n)):(n.output=O,z(n)):(n.output=".*?","bos"!==M.type&&"slash"!==M.type||(n.output=_+n.output),z(n))}for(;T.brackets>0;){if(!0===i.strictBrackets)throw new SyntaxError(fn("closing","]"));T.output=zi.escapeLast(T.output,"["),V("brackets")}for(;T.parens>0;){if(!0===i.strictBrackets)throw new SyntaxError(fn("closing",")"));T.output=zi.escapeLast(T.output,"("),V("parens")}for(;T.braces>0;){if(!0===i.strictBrackets)throw new SyntaxError(fn("closing","}"));T.output=zi.escapeLast(T.output,"{"),V("braces")}if(!0===i.strictSlashes||"star"!==M.type&&"bracket"!==M.type||z({type:"maybe_slash",value:"",output:`${g}?`}),!0===T.backtrack){T.output="";for(const e of T.tokens)T.output+=null!=e.output?e.output:e.value,e.suffix&&(T.output+=e.suffix)}return T};wn.fastpaths=(e,t)=>{const i=l({},t),n="number"==typeof i.maxLength?Math.min(dn,i.maxLength):dn,s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);e=mn[e]||e;const a=zi.isWindows(t),{DOT_LITERAL:r,SLASH_LITERAL:o,ONE_CHAR:c,DOTS_SLASH:d,NO_DOT:u,NO_DOTS:p,NO_DOTS_SLASH:h,STAR:m,START_ANCHOR:g}=Vi.globChars(a),f=i.dot?p:u,w=i.dot?h:u,v=i.capture?"":"?:";let y=!0===i.bash?".*?":m;i.capture&&(y=`(${y})`);const b=e=>!0===e.noglobstar?y:`(${v}(?:(?!${g}${e.dot?d:r}).)*?)`,k=e=>{switch(e){case"*":return`${f}${c}${y}`;case".*":return`${r}${c}${y}`;case"*.*":return`${f}${y}${r}${c}${y}`;case"*/*":return`${f}${y}${o}${c}${w}${y}`;case"**":return f+b(i);case"**/*":return`(?:${f}${b(i)}${o})?${w}${c}${y}`;case"**/*.*":return`(?:${f}${b(i)}${o})?${w}${y}${r}${c}${y}`;case"**/.*":return`(?:${f}${b(i)}${o})?${r}${c}${y}`;default:{const t=/^(.*?)\.(\w+)$/.exec(e);if(!t)return;const i=k(t[1]);if(!i)return;return i+r+t[2]}}},S=zi.removePrefix(e,{negated:!1,prefix:""});let x=k(S);return x&&!0!==i.strictSlashes&&(x+=`${o}?`),x};var vn=wn;const yn=(e,t,i=!1)=>{if(Array.isArray(e)){const n=e.map((e=>yn(e,t,i)));return e=>{for(const t of n){const i=t(e);if(i)return i}return!1}}const n=(s=e)&&"object"==typeof s&&!Array.isArray(s)&&e.tokens&&e.input;var s;if(""===e||"string"!=typeof e&&!n)throw new TypeError("Expected pattern to be a non-empty string");const a=t||{},r=zi.isWindows(t),o=n?yn.compileRe(e,t):yn.makeRe(e,t,!1,!0),d=o.state;delete o.state;let u=()=>!1;if(a.ignore){const e=c(l({},t),{ignore:null,onMatch:null,onResult:null});u=yn(a.ignore,e,i)}const p=(i,n=!1)=>{const{isMatch:s,match:l,output:c}=yn.test(i,o,t,{glob:e,posix:r}),p={glob:e,state:d,regex:o,posix:r,input:i,output:c,match:l,isMatch:s};return"function"==typeof a.onResult&&a.onResult(p),!1===s?(p.isMatch=!1,!!n&&p):u(i)?("function"==typeof a.onIgnore&&a.onIgnore(p),p.isMatch=!1,!!n&&p):("function"==typeof a.onMatch&&a.onMatch(p),!n||p)};return i&&(p.state=d),p};yn.test=(e,t,i,{glob:n,posix:s}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const a=i||{},r=a.format||(s?zi.toPosixSlashes:null);let o=e===n,l=o&&r?r(e):e;return!1===o&&(l=r?r(e):e,o=l===n),!1!==o&&!0!==a.capture||(o=!0===a.matchBase||!0===a.basename?yn.matchBase(e,t,i,s):t.exec(l)),{isMatch:Boolean(o),match:o,output:l}},yn.matchBase=(e,t,i,n=zi.isWindows(i))=>(t instanceof RegExp?t:yn.makeRe(t,i)).test(hi.basename(e)),yn.isMatch=(e,t,i)=>yn(t,i)(e),yn.parse=(e,t)=>Array.isArray(e)?e.map((e=>yn.parse(e,t))):vn(e,c(l({},t),{fastpaths:!1})),yn.scan=(e,t)=>cn(e,t),yn.compileRe=(e,t,i=!1,n=!1)=>{if(!0===i)return e.output;const s=t||{},a=s.contains?"":"^",r=s.contains?"":"$";let o=`${a}(?:${e.output})${r}`;e&&!0===e.negated&&(o=`^(?!${o}).*$`);const l=yn.toRegex(o,t);return!0===n&&(l.state=e),l},yn.makeRe=(e,t={},i=!1,n=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return!1===t.fastpaths||"."!==e[0]&&"*"!==e[0]||(s.output=vn.fastpaths(e,t)),s.output||(s=vn(e,t)),yn.compileRe(s,t,i,n)},yn.toRegex=(e,t)=>{try{const i=t||{};return new RegExp(e,i.flags||(i.nocase?"i":""))}catch(i){if(t&&!0===t.debug)throw i;return/$^/}},yn.constants=Vi;var bn=yn;function kn(e,t){return Array.isArray(t)?t.some((t=>kn(e,t))):bn(t)(e)}function Sn(e,t,i){return xn(0===e.length||"/"===e?[]:e.split("/"),t,i)}function xn(e,t,i){var n,s;if(void 0===t)return;if(0===e.length)return i(t);if("object"!=typeof t||null===t)return;const a=e.shift();if("**"===a){for(;e.length>0&&"*"===e[0];)e.shift();const n=["**",...e].join("/"),s=new Set;Cn("",t,s);for(const e of s)kn(e,n)&&xn(e.split("/"),t,i)}else if(a.startsWith("*")){let r;a.length>=1&&(r=new RegExp(null!=(s=null==(n=a.match(/(\*{)(.+)(})/))?void 0:n[2])?s:".*"));for(const n in t)r&&null!==n.match(r)&&xn([...e],t[n],i)}else xn(e,t[a],i)}function Cn(e,t,i){for(const n in t)i.add(`${e}${n}`),"object"==typeof t[n]&&Cn(`${e}${n}/`,t[n],i)}function jn(e,t){let i=!1;for(const n of t)if(Sn(n,e,(()=>i=!0)),i)return!0;return!1}const _n=A.dirname,Pn=A.join,An=A.extname,Tn=A.basename,En=A.resolve;var Fn,Dn,On=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dirname:_n,join:Pn,extname:An,basename:Tn,resolve:En});function Mn({key:e,ctrlKey:t,altKey:i,shiftKey:n,metaKey:s}){const a=qe();let r=e.toUpperCase();return n&&(r="darwin"===a?"⇧ + "+r:"Shift + "+r),i&&(r="darwin"===a?"⌥ + "+r:"Alt + "+r),s&&(r="darwin"===a?"⌃ + "+r:"Meta + "+r),t&&(r="darwin"===a?"⌘ + "+r:"Ctrl + "+r),r}!function(e){const t=new Set;let i=[];function n(e,t){var n,s,a;const r=e?An(e):null;for(const o of i){if(void 0!==t&&t===o.id)return o;if(!e)continue;const i=null==(n=o.detect)?void 0:n.fileExtensions,l=null==(s=o.detect)?void 0:s.scope,c=null==(a=o.detect)?void 0:a.matcher;if(!i||!r||i.includes(r))if(l){if("string"==typeof l){if(e.startsWith(l))return o}else if(Array.isArray(l)&&l.some((t=>e.startsWith(t))))return o}else{if(!c)throw console.log(o),new Error('Invalid file definition, no "detect" properties');if(kn(e,c))return o}}}function s(e,t,i){if(0===t.length)return i.map((t=>e.getPackFilePath(void 0,t)));const n=[];for(const s of t)for(const t of i)n.push(e.getPackFilePath(s,t));return n}e.ready=new Ce,e.setup=async function(t){if(i.length>0)return;await t.fired;const n="data/packages/minecraftBedrock/fileDefinition",s=await t.getDirectoryHandle(n);for await(const e of s.values()){if("file"!==e.kind)return;let s=await t.readJSON(`${n}/${e.name}`).catch((()=>null));s&&i.push(s)}await async function(e){for(const t of i){if(!t.lightningCache)continue;const i=`data/packages/minecraftBedrock/lightningCache/${t.lightningCache}`;if(t.lightningCache.endsWith(".json"))a[t.lightningCache]=await e.readJSON(i);else{if(!t.lightningCache.endsWith(".js"))throw new Error(`Invalid lightningCache file format: ${t.lightningCache}`);a[t.lightningCache]=await e.readFile(i).then((e=>e.text()))}}}(t),await async function(e){r.push(...await Promise.all(i.map((({id:t,packSpider:i})=>{if(i)return e.readJSON(`data/packages/minecraftBedrock/packSpider/${i}`).then((e=>({id:t,packSpider:e})))})).filter((e=>void 0!==e))))}(t),e.ready.dispatch()},e.addPluginFileType=function(e){return t.add(e),{dispose:()=>t.delete(e)}},e.getPluginFileTypes=function(){return[...t.values()]},e.setPluginFileTypes=function(e=[]){t.clear(),e.forEach((e=>t.add(e)))},e.get=n,e.getGlobal=function(e,t,n){var a,r,o,l,c,d,u,p,h,m,g,f,w;const v=t?An(t):null;for(const y of i){if(void 0!==n&&n===y.id)return y;if(!t)continue;const i=void 0===(null==(a=y.detect)?void 0:a.packType)?[]:Array.isArray(null==(r=y.detect)?void 0:r.packType)?null==(o=y.detect)?void 0:o.packType:[null==(l=y.detect)?void 0:l.packType],b=null==(c=y.detect)?void 0:c.fileExtensions,k=!!(null==(d=y.detect)?void 0:d.scope),S=Array.isArray(null==(u=y.detect)?void 0:u.scope)?null==(p=y.detect)?void 0:p.scope:[null==(h=y.detect)?void 0:h.scope],x=!!(null==(m=y.detect)?void 0:m.matcher),C=Array.isArray(null==(g=y.detect)?void 0:g.matcher)?null==(f=y.detect)?void 0:f.matcher:[null==(w=y.detect)?void 0:w.matcher];if(!b||!v||b.includes(v))if(k){if(s(e,i,S).some((e=>t.startsWith(e))))return y}else{if(!x)throw console.log(y),new Error('Invalid file definition, no "detect" properties');if(kn(t,s(e,i,C)))return y}}},e.getIds=function(){const e=[];for(const t of i)e.push(t.id);return e},e.guessFolder=async function(e){var t;const n=e=>{let t=Array.isArray(e)?e[0]:e;return t.endsWith("/")||(t+="/"),t},s=`.${e.name.split(".").pop()}`;for(const{detect:o={}}of i)if(o.scope&&(null==(t=o.fileExtensions)?void 0:t.includes(s)))return n(o.scope);if(!e.name.endsWith(".json"))return null;const a=await e.getFile();let r;try{r=T.parse(await a.text())}catch{return null}for(const{type:o,detect:l}of i){if("string"==typeof o&&"json"!==o)continue;const{scope:e,fileContent:t}=null!=l?l:{};if(e&&t&&jn(r,t))return n(e)}return null},e.getId=function(e){var t,i;return null!=(i=null==(t=n(e))?void 0:t.id)?i:"unknown"},e.isJsonFile=function(t){var i,n;const s=null==(n=null==(i=e.get(t))?void 0:i.meta)?void 0:n.language;return s?"json"===s:t.endsWith(".json")},e.getMonacoSchemaArray=function(){return i.map((({detect:e={},schema:t})=>({fileMatch:Array.isArray(e.matcher)?[...e.matcher]:[e.matcher],uri:t}))).flat()};const a={};e.getLightningCache=async function(e){var t,i;const{lightningCache:s}=null!=(t=n(e))?t:{};return s&&null!=(i=a[s])?i:[]};const r=[];e.getPackSpiderData=async function(){return r}}(Fn||(Fn={})),function(e){let t=[],i=new Map;function n(){return t.concat([...i.values()])}function s(e){for(const t of n()){if("string"==typeof t.matcher&&kn(e,t.matcher))return t;for(const i of t.matcher)if(kn(e,i))return t}}e.ready=new Ce,e.all=n,e.setup=async function(i){t.length>0||(await i.fired,t=await i.readJSON("data/packages/minecraftBedrock/packDefinitions.json").catch((()=>[])),e.ready.dispatch())},e.get=s,e.getWithRelativePath=function(e){return s(`projects/bridge/${e}`)},e.getFromId=function(e){for(const t of n())if(t.id===e)return t},e.getId=function(e){var t,i;return null!=(i=null==(t=s(e))?void 0:t.id)?i:"unknown"},e.addExtensionPackType=function(e){const t=h();return i.set(t,e),{dispose:()=>i.delete(t)}}}(Dn||(Dn={}));class $n extends xe{constructor(e,t){super(),this.keyBindingManager=e,this.config=t}static fromStrKeyCode(e,t,i=!1,n){return e.create(c(l({},function(e,t=!1){const i=e.toLowerCase().split(" + "),n={key:""};return i.forEach((e=>{"⌘"===e||("darwin"!==qe()||t)&&"ctrl"===e?n.ctrlKey=!0:"⌥"===e||"alt"===e?n.altKey=!0:"⇧"===e||"shift"===e?n.shiftKey=!0:"⌃"===e||"meta"===e?n.metaKey=!0:n.key=e})),n}(t,i)),{prevent:n}))}toStrKeyCode(){return Mn(this.config)}async trigger(){this.dispatch()}prevent(e){return"function"==typeof this.config.prevent&&this.config.prevent(e)}dispose(){this.keyBindingManager.disposeKeyBinding(this.toStrKeyCode())}}class In extends Ke{constructor(e,t){var i;if(super(t),d(this,"type","action"),d(this,"id"),d(this,"_keyBinding"),this.actionManager=e,this.config=t,this.id=null!=(i=t.id)?i:h(),t.keyBinding){(Array.isArray(t.keyBinding)?t.keyBinding:[t.keyBinding]).forEach((i=>this.addKeyBinding($n.fromStrKeyCode(e.keyBindingManager,i,!0,t.prevent))))}}get keyBinding(){return this._keyBinding}addKeyBinding(e){return this._keyBinding=e,e.on((()=>this.trigger())),this}disposeKeyBinding(){this._keyBinding&&this._keyBinding.dispose()}dispose(){this.actionManager.disposeAction(this.id),this.disposeKeyBinding()}}class Rn{constructor(e){d(this,"state",j({})),this._keyBindingManager=e}get keyBindingManager(){if(!this._keyBindingManager)throw new Error("No keyBindingManager was defined for this actionManager");return this._keyBindingManager}create(e){const t=new In(this,e);return S(this.state,t.id,t),t}getAction(e){return this.state[e]}addDivider(){this.state[h()]={type:"divider"}}disposeAction(e){x(this.state,e)}dispose(){Object.values(this.state).forEach((e=>"action"===e.type?e.dispose():null))}async trigger(e){if(!this.state[e]||"action"!==this.state[e].type)throw new Error(`Failed to trigger "${e}": Action does not exist.`);await this.state[e].trigger()}}async function Wn(e,t,i=!0){let n=t.filter((e=>null!==e));if(e instanceof MouseEvent&&(e.preventDefault(),e.stopImmediatePropagation()),0===n.length)return;const s=await Yp.getApp(),a=new Rn;n.forEach((e=>"divider"===e.type?a.addDivider():a.create(e))),setTimeout((()=>s.contextMenu.show(e,a,i)),60)}class Nn extends Ce{constructor(e){super(),d(this,"uuid",h()),d(this,"hasRemoteChange",!1),d(this,"_isUnsaved",!1),d(this,"isForeignFile",!0),d(this,"connectedTabs",[]),d(this,"isTemporary",!0),d(this,"onClose",new xe),d(this,"path"),d(this,"folderName",null),d(this,"actions",[]),d(this,"isActive",!1),d(this,"isLoading",!0),this.parent=e,window.setTimeout((()=>this.setup()))}static is(e){return!1}async setup(){this.dispatch(this),this.isLoading=!1}setIsUnsaved(e){this._isUnsaved=e,this.isTemporary=!1}get isUnsaved(){return this._isUnsaved}updateParent(e){this.parent=e}get tabSystem(){return this.parent}get isSharingScreen(){return this.parent.isSharingScreen}setFolderName(e){this.folderName=e}getPath(){if(!this.path)throw new Error("Trying to access projectPath before tab finished loading");return this.path}getProjectPath(){if(!this.path)throw new Error("Trying to access projectPath before tab finished loading");return this.path.split("/").slice(2).join("/")}get icon(){var e,t;return null!=(t=null==(e=Fn.getGlobal(this.parent.project.config,this.getPath()))?void 0:e.icon)?t:"mdi-file-outline"}get iconColor(){var e;return null==(e=Dn.get(this.getPath()))?void 0:e.color}get isSelected(){return this.parent.selectedTab===this}select(){return this.parent.select(this),this}async close(){this.parent.setActive(!0);const e=await this.parent.close(this);return e&&(this.connectedTabs.forEach((e=>e.close())),this.onClose.dispatch()),e}async is(e){return!1}focus(){}async onActivate(){this.isActive=!0}onDeactivate(){this.isActive=!1}onDestroy(){}async toOtherTabSystem(e=!0){var t;const i=null==(t=(await Yp.getApp()).projectManager.currentProject)?void 0:t.tabSystems,n=this.isSelected,s=i[0]===this.parent?i[0]:i[1],a=i[0]===this.parent?i[1]:i[0];this.parent=a,e?(s.remove(this,!1),await a.add(this,!0)):(this.isForeignFile||(await a.openedFiles.add(this.getPath()),await s.openedFiles.remove(this.getPath())),n&&await s.select(s.tabs[0]),await a.select(this))}addAction(...e){this.actions.push(...e)}clearActions(){this.actions=[]}async onContextMenu(e){const t=[];this.isTemporary&&t.push({name:"actions.keepInTabSystem.name",description:"actions.keepInTabSystem.description",icon:"mdi-pin-outline",onTrigger:()=>{this.isTemporary=!1}}),this.parent.tabs.length>1&&t.push({name:"actions.moveToSplitScreen.name",description:"actions.moveToSplitScreen.description",icon:"mdi-arrow-split-vertical",onTrigger:async()=>{this.toOtherTabSystem()}}),t.length>0&&t.push({type:"divider"}),await Wn(e,[...t,{name:"actions.closeTab.name",description:"actions.closeTab.description",icon:"mdi-close",onTrigger:()=>{this.close()}},{name:"actions.closeAll.name",description:"actions.closeAll.description",icon:"mdi-table-row",onTrigger:()=>{this.parent.closeTabs((()=>!0))}},{name:"actions.closeTabsToRight.name",description:"actions.closeTabsToRight.description",icon:"mdi-chevron-right",onTrigger:()=>{let e=!0;this.parent.closeTabs((t=>(t===this&&(e=!1),e)))}},{name:"actions.closeAllSaved.name",description:"actions.closeAllSaved.description",icon:"mdi-content-save-outline",onTrigger:()=>{this.parent.closeTabs((e=>!e.isUnsaved))}},{name:"actions.closeOtherTabs.name",description:"actions.closeOtherTabs.description",icon:"mdi-unfold-more-vertical",onTrigger:()=>{this.parent.closeTabs((e=>e!==this))}}])}copy(){document.execCommand("copy")}cut(){document.execCommand("cut")}paste(){}}class Bn extends Nn{constructor(e,t,i=!1){super(e),d(this,"isForeignFile",!1),this.parent=e,this.fileHandle=t,this.isReadOnly=i}async setup(){var e;if(this.isForeignFile=!1,this.path=await this.parent.app.fileSystem.baseDirectory.resolve(this.fileHandle).then((e=>null==e?void 0:e.join("/"))),!this.path||!this.parent.project.isFileWithinProject(this.path)){this.isForeignFile=!0;let t=null!=(e=await Fn.guessFolder(this.fileHandle))?e:h();t.endsWith("/")||(t+="/"),this.path=`${t}${h()}/${this.fileHandle.name}`}this.parent.project.packIndexer.once((async()=>{const e=this.parent.project.packIndexer.service;await e.hasFile(this.path)||(await e.updateFile(this.path,await this.getFile().then((e=>e.text())),this.isForeignFile),Fn.isJsonFile(this.getProjectPath())&&this.parent.project.jsonDefaults.updateDynamicSchemas(this.getProjectPath()))})),await super.setup()}get name(){return this.fileHandle.name}getFileType(){return Fn.getId(this.getProjectPath())}async is(e){return e instanceof Bn&&await this.isForFileHandle(e.fileHandle)}async isForFileHandle(e){return e.isVirtual===this.fileHandle.isVirtual&&await e.isSameEntry(this.fileHandle)}getFile(){return this.fileHandle.getFile()}getFileHandle(){return this.fileHandle}async saveAs(){const e=await self.showSaveFilePicker({suggestedName:this.fileHandle.name,startIn:this.fileHandle}).catch((()=>null));e&&(this.isForeignFile||this.parent.openedFiles.remove(this.getPath()),this.fileHandle=e,this.resetSignal(),await this.setup(),await this.parent.save(this),this.isForeignFile||this.parent.openedFiles.add(this.getPath()))}}const Ln={};var Hn=Le({name:"TextTab",props:{tab:Object},computed:{tabSystem(){return this.tab.parent}},activated(){this.updateEditor()},mounted(){this.updateEditor()},methods:{updateEditor(){this.tabSystem.createMonacoEditor(this.$refs.monacoContainer)}}},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{ref:"monacoContainer",on:{click:function(t){return e.tab.parent.setActive(!0)},contextmenu:function(t){return e.tab.showContextMenu(t)}}})}),[],!1,Vn,null,null,null);function Vn(e){for(let t in Ln)this[t]=Ln[t]}var zn=function(){return Hn.exports}();const Un=E.exports.debounce((async e=>{var t,i;if(e.updateUnsavedStatus(),!e.editorModel||e.editorModel.isDisposed())return;const n=null==(t=e.editorModel)?void 0:t.getValue(),s=await Yp.getApp();await s.project.packIndexer.updateFile(e.getProjectPath(),n,e.isForeignFile),await s.project.jsonDefaults.updateDynamicSchemas(e.getProjectPath()),s.project.fileChange.dispatch(e.getProjectPath(),new File([null==(i=e.editorModel)?void 0:i.getValue()],e.name))}),600);class Gn extends Bn{constructor(e,t,i=!1){super(e,t,i),d(this,"component",zn),d(this,"editorModel"),d(this,"editorViewState"),d(this,"disposables",[]),d(this,"isActive",!1),d(this,"modelLoaded",new Ce),d(this,"initialVersionId",0),this.fired.then((async()=>{const e=await Yp.getApp();await e.projectManager.projectReady.fired,e.project.tabActionProvider.addTabActions(this)}))}get editorInstance(){return this.parent.monacoEditor}async getFile(){return!this.editorModel||this.editorModel.isDisposed()?await super.getFile():new File([this.editorModel.getValue()],this.name)}updateUnsavedStatus(){var e;this.editorModel&&!this.editorModel.isDisposed()&&this.setIsUnsaved(this.initialVersionId!==(null==(e=this.editorModel)?void 0:e.getAlternativeVersionId()))}async onActivate(){var e,t,i,n,s,a;if(!this.isActive){if(this.isActive=!0,await this.parent.fired,!this.editorModel||this.editorModel.isDisposed()){const n=await this.fileHandle.getFile(),s=await n.text(),a=F.file(this.getPath());this.editorModel=y(null!=(i=P.getModel(a))?i:P.createModel(s,null==(t=null==(e=Fn.get(this.getProjectPath()))?void 0:e.meta)?void 0:t.language,a)),this.initialVersionId=this.editorModel.getAlternativeVersionId(),this.modelLoaded.dispatch(),this.loadEditor()}else this.loadEditor();this.disposables.push(null==(n=this.editorModel)?void 0:n.onDidChangeContent((()=>{Un(this)}))),this.disposables.push(null==(s=this.editorInstance)?void 0:s.onDidFocusEditorText((()=>{this.parent.setActive(!0)}))),this.focus(),null==(a=this.editorInstance)||a.layout()}}onDeactivate(){if(this.tabSystem.hasFired){const e=this.editorInstance.saveViewState();e&&(this.editorViewState=y(e))}this.disposables.forEach((e=>null==e?void 0:e.dispose())),this.isActive=!1}onDestroy(){var e;this.disposables.forEach((e=>null==e?void 0:e.dispose())),null==(e=this.editorModel)||e.dispose(),this.editorModel=void 0,this.editorViewState=void 0,this.isActive=!1,this.modelLoaded.resetSignal()}updateParent(e){super.updateParent(e)}focus(){var e;null==(e=this.editorInstance)||e.focus()}loadEditor(){var e,t,i;this.editorModel&&!this.editorModel.isDisposed()&&(null==(e=this.editorInstance)||e.setModel(this.editorModel)),this.editorViewState&&(null==(t=this.editorInstance)||t.restoreViewState(this.editorViewState)),null==(i=this.editorInstance)||i.updateOptions({readOnly:this.isReadOnly}),this.focus()}async save(){var e,t,i,n,s;this.isTemporary=!1;const a=await Yp.getApp(),r=null==(e=this.editorInstance)?void 0:e.getAction("editor.action.formatDocument"),o=Fn.getGlobal(this.parent.project.config,this.getPath());if(!r||null!=(i=null==(t=null==Re?void 0:Re.general)?void 0:t.formatOnSave)&&!i||null!=(n=null==o?void 0:o.formatOnSaveCapable)&&!n)await this.saveFile(a);else{a.windows.loadingWindow.open(),null==(s=this.editorInstance)||s.executeEdits("automatic",[{forceMoveMarkers:!1,range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:0},text:"\t"}]);const e=new Promise((e=>{var t;if(!this.editorModel||this.editorModel.isDisposed())return e();const i=null==(t=this.editorModel)?void 0:t.onDidChangeContent((()=>{null==i||i.dispose(),e()}))})),t=r.run();await Promise.all([e,t]),await this.saveFile(a),a.windows.loadingWindow.close()}}async saveFile(e){this.editorModel&&!this.editorModel.isDisposed()?(this.setIsUnsaved(!1),this.initialVersionId=this.editorModel.getAlternativeVersionId(),await e.fileSystem.write(this.fileHandle,this.editorModel.getValue())):console.error("Cannot save file content without active editorModel")}setReadOnly(e){var t;this.isReadOnly=e,null==(t=this.editorInstance)||t.updateOptions({readOnly:e})}async paste(){var e;this.isReadOnly||(this.editorInstance.focus(),null==(e=this.editorInstance)||e.trigger("keyboard","paste",{text:await navigator.clipboard.readText()}))}cut(){this.isReadOnly||(this.focus(),document.execCommand("cut"))}async close(){const e=await super.close();if(e&&this.isUnsaved){const e=await Yp.getApp();if(this.isForeignFile)await e.fileSystem.unlink(this.getProjectPath());else{const t=await this.fileHandle.getFile(),i=await t.text();await e.project.packIndexer.updateFile(this.getProjectPath(),i)}}return e}showContextMenu(e){this.parent.showCustomMonacoContextMenu(e,this)}}const Jn={};var qn=Le({name:"Confirm",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onCancel(){this.currentWindow.cancel()},onNoSave(){this.currentWindow.noSave()},onSave(){this.currentWindow.save()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:"general.confirm",isVisible:e.isVisible,isPersistent:!1,hasMaximizeButton:!1,isFullscreen:!1,width:440,height:130,hasCloseButton:!1,isSmallPopup:!0},scopedSlots:e._u([{key:"default",fn:function(){return[i("p",{staticClass:"mt-2"},[e._v(e._s(e.t("windows.unsavedFile.description")))])]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"menu"},on:{click:e.onCancel}},[i("span",[e._v(e._s(e.t("general.cancel")))])]),i("v-btn",{attrs:{color:"error"},on:{click:e.onNoSave}},[i("span",[e._v(e._s(e.t("general.close")))])]),i("v-btn",{attrs:{color:"primary"},on:{click:e.onSave}},[i("span",[e._v(e._s(e.t("windows.unsavedFile.save")))])])]},proxy:!0}],null,!1,1792198457)}):e._e()}),[],!1,Kn,null,null,null);function Kn(e){for(let t in Jn)this[t]=Jn[t]}var Qn=function(){return qn.exports}();const Xn=new WeakMap;class Zn extends Je{constructor(e){super(Qn,!0,!1),Xn.set(this,e),this.defineWindow(),this.open()}get tab(){return Xn.get(this)}async noSave(){var e;this.close("close");const t=await Yp.getApp();await(null==(e=t.tabSystem)?void 0:e.close(this.tab,!1))}async save(){var e,t;Yp.audioManager.playAudio("confirmation_002.ogg",1),this.close("save");const i=await Yp.getApp();await(null==(e=i.tabSystem)?void 0:e.save(this.tab)),await(null==(t=i.tabSystem)?void 0:t.close(this.tab,!1))}async cancel(){this.close("cancel")}}class Yn{constructor(e=1/0,t){d(this,"array",[]),this.maxSize=e;for(const i of null!=t?t:[])this.add(i)}add(e,t=this.isEquals.bind(this)){const i=this.array.findIndex((i=>t(i,e)));return i>-1?(this.array.splice(i,1),this.array.unshift(e),this):(this.array.length>=this.maxSize&&this.array.pop(),this.array.unshift(e),this)}remove(e,t=this.isEquals.bind(this)){const i=this.array.findIndex((i=>t(i,e)));return i>-1&&this.array.splice(i,1),this}clear(){this.array=[]}isEquals(e,t){return e===t}toJSON(){return JSON.stringify(this.array)}fromArray(e){this.array=e}[Symbol.iterator](){return this.array.values()}get size(){return this.maxSize}get elementCount(){return this.array.length}get elements(){return[...this.array]}}class es extends Ce{constructor(e,t,i,n=!0){super(),d(this,"queue"),d(this,"app"),this.maxSize=t,this.savePath=i,S(this,"queue",new Yn(t)),this.app=y(e),n&&this.setup()}async setup(){await this.app.fileSystem.fired;let e=[];try{e=await this.app.fileSystem.readJSON(this.savePath)}catch{}this.queue.fromArray(e),this.dispatch(this.queue)}isEquals(e,t){return e===t}keep(e){const t=new Yn(this.maxSize);this.elements.filter((t=>e(t))).forEach((e=>t.add(e,this.isEquals.bind(this)))),this.queue=t}async add(e){await this.fired,this.queue.add(e,this.isEquals.bind(this)),await this.saveQueue()}async remove(e){await this.fired,this.queue.remove(e,this.isEquals.bind(this)),await this.saveQueue()}clear(){return this.queue.clear(),this.saveQueue()}async saveQueue(){await this.app.fileSystem.mkdir(_n(this.savePath),{recursive:!0}),await this.app.fileSystem.writeFile(this.savePath,this.queue.toJSON())}get elements(){return this.queue.elements}}class ts extends es{constructor(e,t,i){super(t,1/0,i),this.tabSystem=e}async restoreTabs(){var e,t;if(null==(t=null==(e=null==Re?void 0:Re.general)?void 0:e.restoreTabs)||t){await this.fired;for(let e=0;e<this.queue.elements.length;e++)try{await this.tabSystem.openPath(this.queue.elements[e],{selectTab:0===e,isTemporary:!1})}catch{}}}}function is(e,t){const i=D(e.getValue(),e.getOffsetAt(t)).path;return isNaN(Number(i[i.length-1]))||i.pop(),i.join("/")}function ns(e,t){const i=e.getLineContent(t.lineNumber),n=function(e,t){for(let i=t-2;i>0;i--)if('"'===e[i])return i+1;return 0}(i,t.column),s=function(e,t){for(let i=t-1;i<e.length;i++)if('"'===e[i])return i;return e.length}(i,t.column);return{word:i.substring(n,s),range:new O(t.lineNumber,n,t.lineNumber,s)}}function ss(e){return function({script:e,env:t,language:i,modules:n,async:s=!1}){"typeScript"===i&&(e=M.exports.transpile(e,{target:99,isolatedModules:!0}));let a=function(e){return e.replace(/export default([ \(])/g,((e,t)=>`module.exports =${t}`)).replace(/import\s+(\* as [a-z][a-z0-9]*|[a-z][a-z0-9]+|{[a-z\s][a-z0-9,\s]*})\s+from\s+["'](.+)["']/gi,((e,t,i)=>(t.startsWith("* as ")&&(t=t.replace("* as ","")),`const ${t} = await require('${i}')`)))}(e);if(n){const e=t.require;t.require=async t=>n[t]?n[t]:"function"==typeof e?await(null==e?void 0:e(t)):void 0}try{return s?new Function(...Object.keys(t),`return (async () => {\n${a}\n})()`):new Function(...Object.keys(t),a)}catch(r){throw console.error(e),new Error(`Error within script: ${r}`)}}(e)(...Object.values(e.env))}async function as(e,t,i){for(const n of i){const i=`${t}${n}`;if(await e.fileExists(i))return i}}async function rs(e,t){const i=await Promise.all(e.map(t));return e[i.findIndex((e=>e))]}async function os(e,t){var i,n;await Fn.ready.fired;const s=await Yp.getApp(),a=e=>s.locales.translate(e),{id:r,documentation:o}=null!=(i=Fn.get(e))?i:{};if(!o)return void new Pt({description:`[${a("actions.documentationLookup.noDocumentation")} ${r?a(`fileType.${r}`):'"'+e+'"'}.]`});let l=o.baseUrl;t&&(null==(n=o.supportsQuerying)||n)&&(l+=`#${t}`),Yp.openUrl(l)}function ls(e,t){let i;try{i=e.getLineContent(t.lineNumber)}catch{return!1}const n=function(e,t){for(let i=t-2;i>0;i--)if('"'===e[i])return!0;return!1}(i,t.column),s=function(e,t){for(let i=t-1;i<e.length;i++)if('"'===e[i])return!0;return!1}(i,t.column);return n&&s}_.typescript.javascriptDefaults.setCompilerOptions({target:_.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0,noLib:!0,alwaysStrict:!0}),_.registerDefinitionProvider("json",new class{async provideDefinition(e,t,i){var n,s,a;const r=await Yp.getApp(),{word:o,range:l}=ns(e,t),c=null==(s=null==(n=r.project.tabSystem)?void 0:n.selectedTab)?void 0:s.getProjectPath();if(!c)return;const{definitions:d}=null!=(a=Fn.get(c))?a:{},u=await Fn.getLightningCache(c);if(!d||"string"==typeof u||0===u.length)return;const p=is(e,t),{definitionId:h,transformedWord:m}=await this.getDefinition(o,p,u);if(!h||!m)return;let g=d[h];if(!g)return;Array.isArray(g)||(g=[g]);const f=r.project.name,w=await this.getFilePath(m,g);return(await Promise.all(w.map((async e=>{const t=`projects/${f}/${e}`,i=F.file(t);if(!P.getModel(i)){let e;try{e=await r.fileSystem.getFileHandle(t)}catch{return}const n=P.createModel(await e.getFile().then((e=>e.text())),void 0,i);setTimeout((()=>{r.project.getFileTab(e)||n.dispose()}),5e3)}return{uri:i,range:new O(0,0,1/0,1/0)}})))).filter((e=>void 0!==e))}async getDefinition(e,t,i){var n;const s=await Yp.getApp();let a=e;const r=i.map((e=>[e.cacheKey,e.path,{script:e.script,filter:e.filter}])).filter((e=>void 0!==e));return{definitionId:await(null==(n=rs(r,(async([i,n,{script:r,filter:o}])=>{if(""===n)return!1;return!!kn(t,n)&&(o&&o.includes(e)&&(a=void 0),a&&r&&(a=await ss({script:r,env:{Bridge:{value:a,withExtension:(e,t)=>as(s.project.fileSystem,e,t)}}})),!0)})))?void 0:n.then((e=>null==e?void 0:e[0]))),transformedWord:a}}async getFilePath(e,t){var i,n;const s=await Yp.getApp(),a=[];for(const r of t){if(r.directReference){a.push(e);continue}const t=null!=(n=await(null==(i=s.project.packIndexer.service)?void 0:i.find(r.from,r.match,[e],!0)))?n:[];a.push(...t)}return a}});class cs extends Ce{constructor(e){super(),d(this,"_monacoEditor"),d(this,"disposables",[]),this._app=e}get monacoEditor(){if(!this._monacoEditor)throw new Error("Accessed Monaco Editor before it was defined");return this._monacoEditor}getMobileOptions(e){return{lineNumbers:e?"off":"on",minimap:{enabled:!e},tabSize:e?2:4,scrollbar:{horizontalScrollbarSize:e?15:void 0,verticalScrollbarSize:e?20:void 0,horizontalSliderSize:e?15:void 0,verticalSliderSize:e?20:void 0}}}createMonacoEditor(e){var t,i,n,s,a,r,o,d,u,p,h;this.dispose(),this._monacoEditor=y(P.create(e,c(l({wordBasedSuggestions:!1,theme:"bridgeMonacoDefault",roundedSelection:!1,autoIndent:"full",fontSize:Number((null!=(i=null==(t=null==Re?void 0:Re.appearance)?void 0:t.editorFontSize)?i:"14px").replace("px","")),"bracketPairColorization.enabled":null!=(s=null==(n=null==Re?void 0:Re.editor)?void 0:n.bracketPairColorization)&&s,fontFamily:null!=(r=null==(a=null==Re?void 0:Re.appearance)?void 0:a.editorFont)?r:"darwin"===qe()?"Menlo":"Consolas"},this.getMobileOptions(this._app.mobile.isCurrentDevice())),{contextmenu:!1,wordWrap:(null==(o=null==Re?void 0:Re.editor)?void 0:o.wordWrap)?"bounded":"off",wordWrapColumn:Number(null!=(u=null==(d=null==Re?void 0:Re.editor)?void 0:d.wordWrapColumns)?u:"80")})));const m=this._monacoEditor._codeEditorService,g=m.openCodeEditor.bind(m);m.openCodeEditor=C((async(e,t,i)=>{var n,s;let a=await g(e,t,i);if(!a)try{const t=null==(n=this._app.tabSystem)?void 0:n.selectedTab;t&&(t.isTemporary=!1),await(null==(s=this._app.project.tabSystem)?void 0:s.openPath(e.resource.path.slice(1)))}catch{console.error(`Failed to open file "${e.resource.path.slice(1)}"`)}return a}),100);const f=this._monacoEditor.getAction("editor.action.commentLine");null==(p=this._monacoEditor)||p.addAction(c(l({},f),{keybindings:[$.CtrlCmd|I.US_BACKSLASH],run(...e){this._run(...e)}})),this._monacoEditor.onDidChangeModelContent((e=>{var t,i,n,s,a;const r=null==(i=null==(t=this._app.tabSystem)?void 0:t.selectedTab)?void 0:i.getProjectPath();if(!r)return;if(!Fn.isJsonFile(r))return;const o=null==(n=this._monacoEditor)?void 0:n.getModel(),l=null==(a=null==(s=this._monacoEditor)?void 0:s.getSelection())?void 0:a.getPosition();o&&l&&ls(o,l)&&e.changes.some((e=>" "===e.text))&&setTimeout((()=>{var e;null==(e=this._monacoEditor)||e.trigger("auto","editor.action.triggerSuggest",{})}),50)})),null==(h=this._monacoEditor)||h.layout(),this.disposables.push(this._app.windowResize.on((()=>setTimeout((()=>{var e;return null==(e=this._monacoEditor)?void 0:e.layout()}))))),this.disposables.push(this._app.mobile.change.on((e=>{var t;null==(t=this._monacoEditor)||t.updateOptions(this.getMobileOptions(e))}))),this.dispatch()}updateOptions(e){var t;null==(t=this._monacoEditor)||t.updateOptions(e)}dispose(){var e;null==(e=this._monacoEditor)||e.dispose(),this.disposables.forEach((e=>e.dispose())),this.disposables=[],this._monacoEditor=void 0}onReadonlyCustomMonacoContextMenu(){return[{name:"actions.documentationLookup.name",icon:"mdi-book-open-outline",onTrigger:()=>{var e,t,i,n,s;const a=null==(e=this._monacoEditor)?void 0:e.getModel(),r=null==(t=this._monacoEditor)?void 0:t.getSelection();if(!a||!r)return;const o=null==(n=null==(i=this._app.tabSystem)?void 0:i.selectedTab)?void 0:n.getProjectPath();if(!o)return;let l;l=Fn.isJsonFile(o)?ns(a,r.getPosition()).word:null==(s=a.getWordAtPosition(r.getPosition()))?void 0:s.word,os(o,l)}},{name:"actions.goToDefinition.name",icon:"mdi-magnify",onTrigger:()=>{var e;null==(e=this._monacoEditor)||e.trigger("contextmenu","editor.action.revealDefinition",null)}},{name:"actions.goToSymbol.name",icon:"mdi-at",onTrigger:()=>{setTimeout((()=>{var e,t;null==(e=this._monacoEditor)||e.focus(),null==(t=this._monacoEditor)||t.trigger("contextmenu","editor.action.quickOutline",null)}))}}]}showCustomMonacoContextMenu(e,t){if(t.isReadOnly)return Wn(e,this.onReadonlyCustomMonacoContextMenu());Wn(e,[...this.onReadonlyCustomMonacoContextMenu(),{type:"divider"},{name:"actions.changeAllOccurrences.name",icon:"mdi-pencil-outline",onTrigger:()=>{var e;null==(e=this._monacoEditor)||e.trigger("contextmenu","editor.action.rename",null)}},{name:"actions.formatDocument.name",icon:"mdi-text-box-check-outline",onTrigger:()=>{var e;null==(e=this._monacoEditor)||e.trigger("contextmenu","editor.action.formatDocument",null)}},{type:"divider"},{name:"actions.copy.name",icon:"mdi-content-copy",onTrigger:()=>{document.execCommand("copy")}},{name:"actions.cut.name",icon:"mdi-content-cut",onTrigger:()=>{t.cut()}},{name:"actions.paste.name",icon:"mdi-content-paste",onTrigger:()=>{t.paste()}}])}}async function ds(e,t){if(!t){const e=await Yp.getApp();t=e.fileSystem}return new Promise((async(i,n)=>{const s=new FileReader;try{const a=await t.getFileHandle(e),r=await a.getFile();s.addEventListener("load",(()=>{i(s.result)})),s.addEventListener("error",n),s.readAsDataURL(r)}catch{n(`File does not exist: "${e}"`)}}))}const us={};var ps=Le({name:"ImageTab",props:{tab:Object}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d-flex align-center justify-center",on:{click:function(t){return e.tab.parent.setActive(!0)}}},[i("img",{staticClass:"img-preview",attrs:{src:e.tab.dataUrl,alt:e.tab.path,draggable:"false"}})])}),[],!1,hs,"6a455043",null,null);function hs(e){for(let t in us)this[t]=us[t]}var ms=function(){return ps.exports}();class gs{}class fs extends gs{constructor(e){super(),this.entries=e}get unselectTrees(){return this.entries.map((e=>e.unselectTrees)).flat()}undo(){return new fs(this.entries.reverse().map((e=>e.undo())))}}class ws extends gs{constructor(e,t,i=""){super(),d(this,"unselectTrees",[]),this.tree=e,this.index=t,this.key=i,this.unselectTrees=[this.tree]}undo(){const e=this.tree.getParent();if(!e)throw new Error("Invalid state: Undo delete action on global tree node");return"array"===e.type?e.children.splice(this.index,0,this.tree):e.children.splice(this.index,0,[this.key,this.tree]),new vs(this.tree,this.index,this.key)}}class vs extends gs{constructor(e,t,i=""){super(),d(this,"unselectTrees",[]),this.tree=e,this.index=t,this.key=i,this.unselectTrees=[this.tree]}undo(){const e=this.tree.getParent();if(!e)throw new Error("Invalid state: Redo delete action on global tree node");return e.children.splice(this.index,1),new ws(this.tree,this.index,this.key)}}class ys extends gs{constructor(e,t,i){super(),d(this,"unselectTrees"),this.parent=e,this.oldValue=t,this.newValue=i,this.unselectTrees=[e]}undo(){return this.parent.updatePropertyName(this.newValue,this.oldValue),new ys(this.parent,this.newValue,this.oldValue)}}class bs extends gs{constructor(e,t){super(),d(this,"unselectTrees"),this.tree=e,this.value=t,this.unselectTrees=[e]}undo(){const e=`${this.tree.value}`;return this.tree.edit(this.value),new bs(this.tree,e)}}class ks extends gs{constructor(e,t){super(),d(this,"unselectTrees"),this.oldTree=e,this.newTree=t,this.unselectTrees=[t]}undo(){return this.newTree.replace(this.oldTree),new ks(this.newTree,this.oldTree)}}const Ss=R("mouse");window.addEventListener("pointerdown",(e=>{Ss.value=e.pointerType}),{passive:!0});const xs="mouse"===Ss.value?19:26;class Cs{constructor(e){d(this,"uuid",h()),d(this,"isSelected",!1),this.parent=e}get styles(){return{outline:"none",contentVisibility:"auto",containIntrinsicSize:`${this.height}px`}}get value(){return this._value}getParent(){return this.parent}setParent(e){this.parent=e}get path(){return this.parent?[...this.parent.path,this.key]:[]}findParentIndex(){if(!this.parent)throw new Error("Cannot findParentIndex for tree without parent");let e;if(e="array"===this.parent.type?this.parent.children.findIndex((e=>e===this)):this.parent.children.findIndex((([e,t])=>t===this)),-1===e)throw console.log(this),new Error("Invalid state: TreeChild with parent couldn't be found inside of parent's children");return e}get key(){if(!this.parent)throw new Error("Trees without parent do not have a key");const e=this.findParentIndex();return"array"===this.parent.type?e:this.parent.children[e][0]}setIsSelected(e){this.isSelected=e}replace(e){if(!this.parent)throw new Error("Cannot replace tree without parent");const t=this.findParentIndex();S(this.parent.children,t,"array"===this.parent.type?e:[this.key,e])}delete(){if(!this.parent)throw new Error("Cannot delete tree without parent");let e;if("array"===this.parent.type){if(e=this.parent.children.findIndex((e=>e===this)),-1===e)throw new Error("Invalid state: TreeChild with parent couldn't be found inside of parent's children")}else if(e=this.parent.children.findIndex((([e,t])=>t===this)),-1===e)throw new Error("Invalid state: TreeChild with parent couldn't be found inside of parent's children");const[t]=this.parent.children.splice(e,1);return[e,Array.isArray(t)?t[0]:""]}}const js=e=>`${e}Def`,_s=e=>({data:()=>Object.fromEntries(e.map((e=>[js(e),{}]))),mounted(){Yp.instance.themeManager.on(this.onThemeChanged),this.onThemeChanged()},destroyed(){Yp.instance.themeManager.off(this.onThemeChanged)},methods:{onThemeChanged(){e.forEach((e=>{this[js(e)]=Yp.instance.themeManager.getHighlighterInfo(e)}))}}});var Ps=function(){var e=this,t=e.$createElement,i=e._self._c||t;return void 0===e.value?i("span",{style:e.toStyle(e.def)},[e._t("default")],2):i("span",[e._v('"'),e._l(e.tokens,(function(t,n){var s=t.text,a=t.def;return[i("span",{key:s,style:e.toStyle(a)},[e._v(e._s(s))]),i("span",{key:s+".colon"},[e._v(e._s(e.tokens.length>n+1?":":""))])]})),e._v('"')],2)},As=[];const Ts={props:{def:Object,value:String},mixins:[_s(["string","number","variable","definition","keyword","type"])],data:()=>({keywords:[],typeIdentifiers:[],variables:[],definitions:[]}),async mounted(){const e=await Yp.getApp();e.configuredJsonLanguage.getHighlighter().on(this.updateKnownWords),this.updateKnownWords(e.configuredJsonLanguage.getHighlighter().knownWords)},async destroyed(){(await Yp.getApp()).configuredJsonLanguage.getHighlighter().on(this.updateKnownWords)},computed:{tokens(){return this.value.split(":").map((e=>({text:e,def:this.getDefinition(e)})))}},methods:{updateKnownWords({keywords:e,typeIdentifiers:t,variables:i,definitions:n}){this.keywords=e,this.typeIdentifiers=t,this.variables=i,this.definitions=n},getDefinition(e){return this.keywords.includes(e)?this.keywordDef:this.typeIdentifiers.includes(e)?this.typeDef:this.variables.includes(e)?this.variableDef:this.definitions.includes(e)?this.definitionDef:this.stringDef},getTextDecoration:e=>e?(e.textDecoration||(e.textDecoration=""),e.isItalic&&(e.textDecoration+=" italic"),e.textDecoration):null,toStyle(e){return{color:e?e.color:null,backgroundColor:e?e.background:null,textDecoration:this.getTextDecoration(e)}}}},Es={};var Fs=Le(Ts,Ps,As,!1,Ds,null,null,null);function Ds(e){for(let t in Es)this[t]=Es[t]}var Os=function(){return Fs.exports}();class Ms extends gs{constructor(e,t,i,n=""){super(),d(this,"unselectTrees",[]),this.oldParent=e,this.tree=t,this.index=i,this.key=n,this.unselectTrees=[this.tree]}undo(){const e=this.tree.getParent();if(!e)throw new Error("Invalid state: Undo delete action on global tree node");const t=this.tree.findParentIndex();return this.tree.delete(),"array"===this.oldParent.type?this.oldParent.children.splice(this.index,0,this.tree):this.oldParent.children.splice(this.index,0,[this.key,this.tree]),this.tree.setParent(this.oldParent),new Ms(e,this.tree,t,this.key)}}const $s={};var Is=Le({name:"TreeChildren",components:{Highlight:Os,Draggable:W},props:{tree:Object,treeEditor:Object},setup:()=>({pointerDevice:Ss}),methods:{wrapKey(e){return"object"===this.tree.type?`"${e}"`:`${e}`},onChange(e){if(e.removed||e.moved){const t=e.removed?e.removed.element[1]:e.moved.element[1],i=e.removed?e.removed.oldIndex:e.moved.oldIndex;this.treeEditor.history.push(new Ms(this.tree,t,i,t.key))}else e.added&&(e.added.element[1].parent=this.tree)}},computed:{dragAndDropEnabled(){var e,t;return null==(t=null==(e=Re.editor)?void 0:e.dragAndDropTreeNodes)||t},children:{get(){return this.tree instanceof ta?Object.entries(this.tree.children):this.tree.children},set(e){this.tree instanceof ta?this.tree._children=e.map((e=>e[1])):this.tree._children=e}}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pl-4"},[i("Draggable",{attrs:{group:{name:"treeEditorNode"},disabled:!e.dragAndDropEnabled||"touch"===e.pointerDevice},on:{change:e.onChange},model:{value:e.children,callback:function(t){e.children=t},expression:"children"}},e._l(e.children,(function(t){var n=t[0],s=t[1];return i(s.component,{key:s.uuid,tag:"component",attrs:{tree:s,treeEditor:e.treeEditor},on:{setActive:function(t){return e.$emit("setActive")}}},[i("Highlight",{attrs:{value:n}})],1)})),1)],1)}),[],!1,Rs,null,null,null);function Rs(e){for(let t in $s)this[t]=$s[t]}function Ws(e,t,i,n=500){let s=null;return{onTouchStart:(...t)=>{s=window.setTimeout((()=>{e(...t),s=null}),n)},onTouchEnd:()=>{s&&(window.clearTimeout(s),s=null,null==t||t()),null==i||i()}}}const Ns={computed:{isDevMode(){var e,t;return null!=(t=null==(e=null==Re?void 0:Re.developers)?void 0:e.isDevMode)&&t}}};const Bs={array:"[]",object:"{}"},Ls={};var Hs=Le({name:"ObjectTree",components:{TreeChildren:function(){return Is.exports}()},mixins:[Ns],props:{tree:Object,treeKey:String,treeEditor:Object},setup(e){const{onTouchStart:t,onTouchEnd:i}=Ws((t=>{"touch"===Ss.value&&e.treeEditor.onContextMenu(t,e.tree)}),null,(()=>{e.treeEditor.parent.app.contextMenu.setMayCloseOnClickOutside(!0)}));return{onTouchStart:t,onTouchEnd:i,pointerDevice:Ss}},computed:{openingBracket(){return this.tree.isOpen?Bs[this.tree.type][0]:Object.keys(this.tree.children).length>0?`${Bs[this.tree.type][0]}...${Bs[this.tree.type][1]}`:`${Bs[this.tree.type][0]}${Bs[this.tree.type][1]}`},closingBracket(){return this.tree.isOpen?Bs[this.tree.type][1]:void 0}},methods:{onClickKey(e){var t,i;this.$emit("setActive"),(null==(i=null==(t=Re.editor)?void 0:t.automaticallyOpenTreeNodes)||i)&&this.tree.toggleOpen(),e.altKey?this.treeEditor.toggleSelection(this.tree):this.treeEditor.setSelection(this.tree)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.$slots.default?i("details",{style:e.tree.styles,attrs:{open:e.tree.isOpen,tabindex:"-1"}},[i("summary",{class:{"common-tree-key":!0,open:e.tree.isOpen,"tree-editor-selection":e.tree.isSelected},style:{height:"touch"===e.pointerDevice?"26px":null},attrs:{tabindex:"-1"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onClickKey(t)},contextmenu:function(t){return t.preventDefault(),e.treeEditor.onContextMenu(t,e.tree)},pointerdown:function(t){return e.onTouchStart(t)},pointerup:e.onTouchEnd}},[i("v-icon",{staticClass:"mr-1",style:{position:"relative",opacity:e.tree.hasChildren?null:"60%",top:e.tree.hasChildren?"0px":"-1.5px"},attrs:{small:""},nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.tree.toggleOpen()}}},[e._v(" mdi-chevron-right ")]),"object"===e.tree.parent.type?i("span",[e.isDevMode?i("span",[e._v("s: "+e._s(e.tree.type)+" p: "+e._s(e.tree.parent.type)+" ")]):e._e(),i("span",{on:{dblclick:function(t){return e.tree.toggleOpen()}}},[e._t("default")],2),e._v(":")]):i("span",{class:{"mx-2":"touch"!==e.pointerDevice,"mx-6":"touch"===e.pointerDevice}}),i("span",{staticClass:"px-1",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.tree.toggleOpen()}}},[e._v(" "+e._s(e.openingBracket)+" ")])],1),e.tree.isOpen?i("TreeChildren",{attrs:{tree:e.tree,treeEditor:e.treeEditor},on:{setActive:function(t){return e.$emit("setActive")}}}):e._e(),e._v(" "+e._s(e.closingBracket)+" ")],1):i("TreeChildren",{attrs:{tree:e.tree,treeEditor:e.treeEditor},on:{setActive:function(t){return e.$emit("setActive")}}})}),[],!1,Vs,"733edf98",null,null);function Vs(e){for(let t in Ls)this[t]=Ls[t]}var zs=function(){return Hs.exports}();class Us extends Cs{constructor(e,t){super(e),d(this,"component",zs),d(this,"_isOpen",!1),d(this,"type","object"),d(this,"_children"),this._value=t,this._children=Object.entries(t).map((([e,t])=>[e,ea(this,t)]))}get height(){return this.isOpen?2*xs+this._children.reduce(((e,[t,i])=>e+i.height),0):xs}get children(){return this._children}get hasChildren(){return this._children.length>0}get isOpen(){return!!this.hasChildren&&this._isOpen}hasChild(e){return this.children.some((([t,i])=>i===e))}addChild(e,t){this._children.push([e,t])}setOpen(e,t=!1){(this.hasChildren||t)&&(this._isOpen=e)}toggleOpen(){this.setOpen(!this._isOpen)}toJSON(){return Object.fromEntries(this._children.map((([e,t])=>[e,t.toJSON()])))}updatePropertyName(e,t){const i=this.children.findIndex((t=>t[0]===e));let[n,s]=this.children[i];if(!s)return;let a=0,r=t,o=this.children.findIndex((e=>e[0]===t));if(o!==i)for(;-1!==o;)o=this.children.findIndex((e=>e[0]===t)),t=r+"_"+a++;S(this.children,i,[t,s])}}var Gs=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:Object.assign({},e.tree.styles,{height:"touch"===e.pointerDevice?"26px":null}),attrs:{tabindex:"-1"}},[i("div",{class:{"tree-editor-selection":"object"!==e.tree.type&&"array"!==e.tree.type&&e.tree.isSelected},staticStyle:{display:"inline-block"},on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.treeEditor.onContextMenu(t,e.tree)},pointerdown:function(t){return e.onKeyTouchStart(t)},pointerup:e.onKeyTouchEnd}},[i("v-icon",{staticClass:"mr-1",style:{opacity:"60%",position:"relative",top:"-1.5px"},attrs:{small:""}},[e._v(" mdi-chevron-right ")]),"object"===e.tree.parent.type?i("span",[i("span",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onClickKey(t)}}},[e._t("default")],2),e._v(":")]):e._e()],1),e.isDevMode?i("span",[e._v(" s: "+e._s(e.tree.type)+" p: "+e._s(e.tree.parent.type))]):e._e(),i("Highlight",{class:{"tree-editor-selection":e.tree.isValueSelected,"px-1":!0},style:{height:"20.5px",display:"inline-block"},attrs:{def:e.highlighterInfo,value:"string"===this.tree.type?e.treeValue:void 0},nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onClickKey(t,!0)},contextmenu:function(t){return t.preventDefault(),e.treeEditor.onContextMenu(t,e.tree,!1)},pointerdown:function(t){return e.onTouchStart(t)},pointerup:function(t){return e.onTouchEnd(t)}}},[e._v(" "+e._s(e.treeValue)+" ")])],1)},Js=[];const qs={components:{Highlight:Os},name:"PrimitiveTree",mixins:[_s(["atom","string","number"]),Ns],props:{tree:Object,treeEditor:Object},setup(e){const{onTouchStart:t,onTouchEnd:i}=Ws((t=>{"touch"===Ss.value&&e.treeEditor.onContextMenu(t,e.tree,!1)}),null,(()=>{e.treeEditor.parent.app.contextMenu.setMayCloseOnClickOutside(!0)})),{onTouchStart:n,onTouchEnd:s}=Ws((t=>{"touch"===Ss.value&&e.treeEditor.onContextMenu(t,e.tree)}),null,(()=>{e.treeEditor.parent.app.contextMenu.setMayCloseOnClickOutside(!0)}));return{onTouchStart:t,onTouchEnd:i,onKeyTouchStart:n,onKeyTouchEnd:s,pointerDevice:Ss}},computed:{treeValue(){return null===this.tree.value?"null":(this.tree.type,this.tree.value)},highlighterInfoDef(){switch(this.tree.type){case"number":return"numberDef";case"string":return;case"boolean":case"null":return"atomDef";default:throw new Error(`Unknown primitive type: "${this.tree.type}"`)}},highlighterInfo(){return this[this.highlighterInfoDef]},textDecoration(){return this.highlighterInfo.textDecoration||(this.highlighterInfo.textDecoration=""),this.highlighterInfo.isItalic&&(this.highlighterInfo.textDecoration+=" italic"),this.highlighterInfo.textDecoration}},methods:{onClickKey(e,t){this.$emit("setActive"),e.altKey?this.treeEditor.toggleSelection(this.tree,t):this.treeEditor.setSelection(this.tree,t)}}},Ks={};var Qs=Le(qs,Gs,Js,!1,Xs,null,null,null);function Xs(e){for(let t in Ks)this[t]=Ks[t]}var Zs=function(){return Qs.exports}();class Ys extends Cs{constructor(e,t){super(e),d(this,"component",Zs),d(this,"isValueSelected",!1),this._value=t}get type(){return null===this.value?"null":typeof this.value}get height(){return xs}setValue(e){this._value=e}toJSON(){return this.value}edit(e){"true"===e||"false"===e?this.setValue("true"===e):Number.isNaN(Number(e))?"null"===e?this.setValue(null):this.setValue(e):this.setValue(Number(e))}isEmpty(){return""===this.value}}function ea(e,t){if(null===t)return new Ys(e,null);if(Array.isArray(t))return new ta(e,t);if("object"==typeof t)return new Us(e,t);if(["string","number","boolean"].includes(typeof t))return new Ys(e,t);throw new Error(`Undefined type handler: "${typeof t}" -> ${t}`)}class ta extends Cs{constructor(e,t){super(e),d(this,"component",zs),d(this,"_isOpen",!1),d(this,"type","array"),d(this,"_children"),this._value=t,this._children=t.map((e=>ea(this,e)))}get height(){return this.isOpen?2*xs+this._children.reduce(((e,t)=>e+t.height),0):xs}get children(){return this._children}get hasChildren(){return this._children.length>0}get isOpen(){return!!this.hasChildren&&this._isOpen}hasChild(e){return this.children.includes(e)}addChild(e){this._children.push(e)}setOpen(e,t=!1){(this.hasChildren||t)&&(this._isOpen=e)}toggleOpen(){this.setOpen(!this._isOpen)}toJSON(){return this._children.map((e=>e.toJSON()))}updatePropertyName(e,t){let i=this.children[e],n=this.children[t];return this.children[t]=i,delete this.children[e],{undo:()=>{this.children[e]=i,this.children[t]=n}}}}class ia{constructor(e,t){this.parent=e,this.tree=t,t.setIsSelected(!0)}getTree(){return this.tree}getLocation(){return this.tree.path.join("/")}select(e){this.tree.setIsSelected(!1),this.tree=e,this.tree.setIsSelected(!0)}dispose(e=!0){this.tree.setIsSelected(!1),e&&this.parent.removeSelection(this)}edit(e){const t=this.tree.getParent();if(!t)throw new Error("Cannot edit property name without parent");if(t instanceof ta)throw new Error("Cannot edit array indices");const i=this.tree.key;return t.updatePropertyName(i,e),new ys(t,i,e)}addKey(e,t){if(this.tree instanceof Ys)return;const i=this.tree.children.length,n=[];if(this.tree.setOpen(!0,!0),"array"===t&&this.tree instanceof Us){this.dispose();const e=new ta(this.tree.getParent(),[]);this.tree.replace(e),e.setOpen(!0,!0),n.push(new ks(this.tree,e)),this.tree=e}const s=new Us(this.tree,{});if(this.tree instanceof ta){this.tree.children.push(s);const t=new Us(s,{});s.children.push([e,t]),this.parent.setSelection(t),s.setOpen(!0),this.tree.setOpen(!0)}else this.tree.children.push([e,s]),this.parent.setSelection(s);return n.push(new vs(s,i,e)),new fs(n)}addValue(e,t){const i=[];if(!(this.tree instanceof Ys)||this.tree.isEmpty()){if("valueArray"===t&&this.tree instanceof Us){this.dispose();const e=new ta(this.tree.getParent(),[]);e.setOpen(!0,!0),this.tree.replace(e),i.push(new ks(this.tree,e)),this.tree=e}if("array"===this.tree.type){const t=new Ys(this.tree,e);this.tree.children.push(t),this.parent.setSelection(this.tree),i.push(new vs(t,this.tree.children.length-1))}else if(this.tree instanceof Ys||0===this.tree.children.length){const t=new Ys(this.tree.getParent(),e);this.tree.replace(t),this.parent.setSelection(t.getParent()),this.dispose(),i.push(new ks(this.tree,t))}return new fs(i)}}}class na{constructor(e,t){this.parent=e,this.tree=t,t.isValueSelected=!0}getTree(){return this.tree}getLocation(){return this.tree.path.join("/")}dispose(e=!0){this.tree.isValueSelected=!1,e&&this.parent.removeSelection(this)}edit(e){const t=`${this.tree.value}`;return this.tree.edit(e),new bs(this.tree,t)}}const sa={};var aa=Le({name:"TreeTab",mixins:[Be],props:{tab:Object,height:Number},data:()=>({keyToAdd:"",valueToAdd:"",triggerCooldown:!1,isUserControlledTrigger:!1}),mounted(){this.treeEditor.receiveContainer(this.$refs.editorContainer),this.focusEditor()},activated(){this.treeEditor.receiveContainer(this.$refs.editorContainer),this.focusEditor()},computed:{fontSize:()=>Re&&Re.appearance&&Re.appearance.editorFontSize?`${Re.appearance.editorFontSize}`:"14px",codeFontFamily:()=>Re&&Re.appearance&&Re.appearance.editorFont?`${Re.appearance.editorFont} !important`:"Menlo !important",fontFamily(){return this.settingsState&&this.settingsState.appearance&&this.settingsState.appearance.font?`${this.settingsState.appearance.font} !important`:"Roboto !important"},treeEditor(){return this.tab.treeEditor},currentValue(){let e;return this.treeEditor.forEachSelection((t=>{if(!t.getTree().parent)return;let i;try{i=t instanceof na?t.getTree().value:t.getTree().key}catch{}void 0===e?e=i:e!==i&&(e="")})),e},isGlobal(){let e=!1;return this.treeEditor.forEachSelection((t=>{e||t.getTree().parent||(e=!0)})),e},propertySuggestions(){return this.treeEditor.propertySuggestions.map((e=>c(l({},e),{text:e.value})))},valueSuggestions(){return this.treeEditor.valueSuggestions.map((e=>c(l({},e),{text:e.value})))}},methods:{focusEditor(){this.$refs.editorContainer&&this.$refs.editorContainer.focus()},onEdit(e){this.treeEditor.edit(e)},onAddKey(e){if(this.triggerCooldown||!this.isUserControlledTrigger)return void(this.isUserControlledTrigger||this.$nextTick((()=>this.keyToAdd="")));if(!e)return this.onTriggerCooldown();const{type:t="object",value:i=e}=e;"snippet"===t?this.treeEditor.addFromJSON(i[1]):this.treeEditor.addKey(i,t),this.$nextTick((()=>this.keyToAdd="")),this.onTriggerCooldown()},onAddValue(e){if(this.triggerCooldown||!this.isUserControlledTrigger)return void(this.isUserControlledTrigger||this.$nextTick((()=>this.valueToAdd="")));if(!e)return this.onTriggerCooldown();const{type:t="value",value:i=e}=e;this.treeEditor.addValue(i,t),this.$nextTick((()=>this.valueToAdd="")),this.onTriggerCooldown()},onTriggerCooldown(){this.triggerCooldown||(setTimeout((()=>{this.triggerCooldown=!1}),100),this.triggerCooldown=!0)},mayTrigger(){this.isUserControlledTrigger||(setTimeout((()=>{this.isUserControlledTrigger=!1}),100),this.isUserControlledTrigger=!0)},onScroll(e){this.treeEditor.scrollTop=e.target.scrollTop},getIcon(e){switch(e.type){case"object":return"mdi-code-json";case"array":return"mdi-code-brackets";case"value":return"mdi-alphabetical";case"arrayValue":return"mdi-link-variant";case"snippet":return"mdi-attachment";default:return"mdi-text"}}},watch:{"tab.uuid"(){this.treeEditor.receiveContainer(this.$refs.editorContainer)},propertySuggestions(){this.$refs.addKeyInput&&this.$refs.addValueInput&&this.$refs.editValueInput&&(0===this.propertySuggestions.length&&this.valueSuggestions.length>0?(this.$refs.editValueInput.blur(),this.$refs.addKeyInput.blur(),this.$refs.addValueInput.focus()):this.propertySuggestions.length>0?(this.$refs.editValueInput.blur(),this.$refs.addValueInput.blur(),this.$refs.addKeyInput.focus()):this.treeEditor.selections.some((e=>e.tree instanceof Ys))&&(this.$refs.addKeyInput.blur(),this.$refs.addValueInput.blur(),this.$refs.editValueInput.focus()))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"editorContainer",staticClass:"editor-container",style:{fontSize:e.fontSize,fontFamily:e.codeFontFamily},attrs:{tabindex:"-1"},on:{click:function(t){return e.tab.parent.setActive(!0)}}},[i("div",{staticClass:"pr-4",style:"height: "+(e.height-194*!e.tab.isReadOnly)+"px; overflow: auto;",on:{blur:e.focusEditor,scroll:e.onScroll,contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.tab.treeEditor.onPasteMenu(t)}}},[i(e.tab.treeEditor.tree.component,{tag:"component",attrs:{tree:e.tab.treeEditor.tree,treeEditor:e.tab.treeEditor},on:{setActive:function(t){return e.tab.parent.setActive(!0)}}})],1),e.tab.isReadOnly?e._e():i("v-divider",{staticClass:"mb-4"}),e.tab.isReadOnly?e._e():i("div",{staticClass:"d-flex px-4",style:{fontFamily:e.fontFamily},on:{blur:e.focusEditor}},[i("v-combobox",{ref:"addKeyInput",attrs:{items:e.propertySuggestions,"item-value":function(e){return e},"menu-props":{maxHeight:124,top:!1,contentClass:"json-editor-suggestions-menu"},label:e.t("editors.treeEditor.addObject"),outlined:"",dense:"","hide-details":""},on:{change:e.onAddKey,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.mayTrigger(t)}},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return[i("div",{staticStyle:{width:"100%"},on:{click:e.mayTrigger}},[i("v-icon",{staticClass:"mr-1",attrs:{color:"primary",small:""}},[e._v(" "+e._s(e.getIcon(n))+" ")]),i("span",{staticStyle:{"font-size":"0.8125rem","font-weight":"500","line-height":"1rem"}},[e._v(" "+e._s(n.label)+" ")])],1)]}}],null,!1,1072492042),model:{value:e.keyToAdd,callback:function(t){e.keyToAdd=t},expression:"keyToAdd"}}),i("v-combobox",{ref:"addValueInput",staticClass:"mx-4",attrs:{disabled:e.isGlobal,items:e.valueSuggestions,"item-value":function(e){return e},"menu-props":{maxHeight:124,top:!1,contentClass:"json-editor-suggestions-menu"},label:e.t("editors.treeEditor.addValue"),outlined:"",dense:"","hide-details":""},on:{change:e.onAddValue,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.mayTrigger(t)}},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return[i("div",{staticStyle:{width:"100%"},on:{click:e.mayTrigger}},[i("v-icon",{staticClass:"mr-1",attrs:{color:"primary",small:""}},[e._v(" "+e._s(e.getIcon(n))+" ")]),i("span",{staticStyle:{"font-size":"0.8125rem","font-weight":"500","line-height":"1rem"}},[e._v(" "+e._s(n.label)+" ")])],1)]}}],null,!1,1072492042),model:{value:e.valueToAdd,callback:function(t){e.valueToAdd=t},expression:"valueToAdd"}}),i("v-text-field",{ref:"editValueInput",attrs:{value:e.currentValue,disabled:e.isGlobal,label:e.t("editors.treeEditor.edit"),outlined:"",dense:"","hide-details":""},on:{change:e.onEdit}})],1)],1)}),[],!1,ra,null,null,null);function ra(e){for(let t in sa)this[t]=sa[t]}var oa=function(){return aa.exports}();const la=["Control","Alt","Meta"];class ca{constructor(e=document){d(this,"state",j({})),d(this,"lastTimeStamp",0),d(this,"onKeydown",(e=>{const{key:t,ctrlKey:i,altKey:n,metaKey:s,shiftKey:a,code:r}=e;if(la.includes(t))return;const o=Mn({key:t,ctrlKey:"darwin"===qe()?s:i,altKey:n,metaKey:"darwin"===qe()?i:s,shiftKey:a}),l=this.state[o];if(l&&this.lastTimeStamp+100<Date.now()){if(l.prevent(e.target))return;this.lastTimeStamp=Date.now(),e.preventDefault(),e.stopImmediatePropagation(),l.trigger()}})),this.element=e,e.addEventListener("keydown",this.onKeydown)}create(e){const t=new $n(this,e),i=t.toStrKeyCode();if(this.state[i])throw new Error(`KeyBinding with keyCode "${i}" already exists!`);return S(this.state,i,t),t}disposeKeyBinding(e){x(this.state,e)}dispose(){this.element.removeEventListener("keydown",this.onKeydown)}}class da{constructor(e,t,i){d(this,"type"),this.location=e,this.key=t,this.value=i}validate(e){return[]}isValid(e){return 0===this.validate(e).length}}class ua extends da{constructor(e,t,i){super(e,t,i),d(this,"type","ifSchema"),d(this,"rootSchema"),"boolean"!=typeof i&&(this.rootSchema=new ma(this.location,"if",i))}getSchemasFor(){return[]}getCompletionItems(){return[]}validate(){return[]}isTrue(e){var t;return"boolean"==typeof this.value?this.value:null==(t=this.rootSchema)?void 0:t.isValid(e)}}class pa extends da{getCompletionItems(e){return this.children.map((t=>t.getCompletionItems(e))).flat()}getSchemasFor(e,t){return this.children.map((i=>i.getSchemasFor(e,[...t]))).flat()}getFlatChildren(){const e=[];for(const t of this.children)t instanceof pa?e.push(...t.getFlatChildren()):e.push(t);return e}}class ha extends da{constructor(e,t,i){super(e,t,i),d(this,"ifSchema"),d(this,"rootSchema"),this.rootSchema=new ma(this.location,"then",i)}receiveIfSchema(e){this.ifSchema=e}getSchemasFor(e,t){return this.ifSchema.isTrue(e)?this.rootSchema.getSchemasFor(e,[...t]):[]}getCompletionItems(e){return this.ifSchema.isTrue(e)?this.rootSchema.getCompletionItems(e):[]}validate(e){return this.ifSchema.isTrue(e)?this.rootSchema.validate(e):[]}}class ma extends pa{constructor(e,t,i){super(e,t,i),d(this,"children"),"$global"!==t&&"$ref"!==t||ba.addRootSchema(e,this),this.children=ba.createSchemas(this.location,i)}validate(e){return this.children.map((t=>t.validate(e))).flat()}getFreeIfSchema(){let e=!1;for(const t of this.getFlatChildren().reverse())if(t instanceof ha)e=!0;else if(t instanceof ua){if(!e)return t;e=!1}}}class ga extends da{getSchemasFor(){return[]}getCompletionItems(){return[{type:"value",label:`${this.value}`,value:this.value}]}validate(e){return this.value!==e?[{message:`Found ${e}; expected ${this.value}`}]:[]}}class fa extends da{constructor(e,t,i){var n,s;if(super(e,t,i),d(this,"type","refSchema"),d(this,"rootSchema"),"string"!=typeof i)throw new Error(`Invalid $ref type "${typeof i}": ${JSON.stringify(i)}`);if("#"===i)this.rootSchema=null!=(n=ba.requestRootSchema(this.location))?n:new ma(this.location,"$ref",ba.request(this.location));else{const e=this.location.includes("#/")?_n(this.location.split("#/")[0]):_n(this.location);let t,n;t=i.startsWith("/")?`file://${i}`:Pn(e,i).replace("file:/","file:///"),t.includes("#/")&&([t,n]=t.split("#/")),this.location=t,this.rootSchema=null!=(s=ba.requestRootSchema(n?`${t}#/${n}`:t))?s:new ma(n?`${t}#/${n}`:t,"$ref",ba.request(this.location,n))}}getCompletionItems(e){return this.rootSchema.getCompletionItems(e)}validate(e){return this.rootSchema.validate(e)}getSchemasFor(e,t){return this.rootSchema.getSchemasFor(e,[...t])}getFreeIfSchema(){return this.rootSchema.getFreeIfSchema()}}function wa(e){return Array.isArray(e)?"array":typeof e}const va=new Map([["$ref",fa],["additionalProperties",class extends da{constructor(e,t,i){super(e,t,i),d(this,"rootSchema"),"object"==typeof i&&(this.rootSchema=new ma(e,t,i))}validate(e){var t,i;return null!=(i=null==(t=this.rootSchema)?void 0:t.validate(e))?i:[]}getCompletionItems(e){return[]}getSchemasFor(e,t){var i,n;if(0===t.length)return[];if(1===t.length)return this.rootSchema?[this.rootSchema]:[];const s=t.shift();return null!=(n=null==(i=this.rootSchema)?void 0:i.getSchemasFor(e[s],t))?n:[]}}],["allOf",class extends pa{constructor(e,t,i){if(super(e,t,i),d(this,"children"),!Array.isArray(i))throw new Error(`"allOf" schema must be of type array, found "${typeof i}"`);this.children=i.map((e=>new ma(this.location,"allOf",e)))}validate(e){return this.children.map((t=>t.validate(e))).flat()}}],["anyOf",class extends pa{constructor(e,t,i){if(super(e,t,i),d(this,"children"),!Array.isArray(i))throw new Error(`"anyOf" schema must be of type array, found "${typeof i}"`);this.children=i.map((e=>new ma(this.location,"anyOf",e)))}validate(e){const t=[];for(const i of this.children){const n=i.validate(e);if(0===n.length)return[];t.push(...n)}return t}}],["const",ga],["enum",class extends da{constructor(e,t,i){if(super(e,t,i),!Array.isArray(i))throw new Error("Enum must be of type array; found "+typeof i)}getSchemasFor(){return[]}getCompletionItems(){return this.value.map((e=>({type:"value",label:`${e}`,value:e})))}validate(e){return this.value.includes(e)?[]:[{message:`Found ${e}; expected one of ${this.value.join(", ")}`}]}}],["if",ua],["items",class extends da{constructor(e,t,i){if(super(e,t,i),d(this,"children"),"object"!=typeof i&&void 0!==i)throw new Error(`Invalid usage of "properties" schema field. Expected type "object", received "${typeof i}"`);Array.isArray(i)?this.children=i.map((e=>new ma(this.location,"items",e))):this.children=new ma(this.location,"items",i)}get arrayChildren(){return Array.isArray(this.children)?this.children:[this.children]}getSchemasFor(e,t){var i,n;const s=t.shift();return"string"==typeof s?[]:void 0===s?this.arrayChildren:0===t.length?Array.isArray(this.children)?this.children[s]?[this.children[s]]:[]:[this.children]:Array.isArray(this.children)?null!=(n=null==(i=this.children[s])?void 0:i.getSchemasFor(e[s],[...t]))?n:[]:this.children.getSchemasFor(e[s],[...t])}getCompletionItems(e){return this.arrayChildren.map((t=>t.getCompletionItems(e).map((e=>({type:"object"===e.type?"array":"valueArray",label:`${e.value}`,value:e.value}))))).flat()}validate(e){return[]}}],["oneOf",class extends pa{constructor(e,t,i){if(super(e,t,i),d(this,"children"),!Array.isArray(i))throw new Error(`"oneOf" schema must be of type array, found "${typeof i}"`);this.children=i.map((e=>new ma(this.location,"oneOf",e)))}validate(e){const t=[];let i=!1,n=!1;for(const s of this.children){const a=s.validate(e);0===a.length&&(i&&(n=!0),i=!0),t.push(...a)}return n?[{message:"JSON matched more than one schema, expected exactly one match"}]:i?[]:t}}],["patternProperties",class extends da{constructor(e,t,i){if(super(e,t,i),d(this,"children",{}),"object"!=typeof i&&void 0!==i)throw new Error(`Invalid usage of "properties" schema field. Expected type "object", received "${typeof i}"`);this.children=Object.fromEntries(Object.entries(null!=i?i:{}).map((([e,t])=>[e,new ma(this.location,e,t)])))}getSchemasFor(e,t){const i=t.shift();let n=[];if("number"==typeof i||void 0===i)return n;for(const[s,a]of Object.entries(this.children))null!==i.match(new RegExp(s))&&n.push(a);return 0===t.length?n:n.map((n=>n.getSchemasFor(e[i],[...t]))).flat()}getCompletionItems(){return[]}validate(e){if("object"!=typeof e||Array.isArray(e))return[{message:`Invalid type: Expected "object", received "${Array.isArray(e)?"array":typeof e}"`}];const t=[];for(const i in e)for(const[n,s]of Object.entries(this.children))null===i.match(new RegExp(n))&&t.push(...s.validate(e[i]));return t}}],["properties",class extends da{constructor(e,t,i){if(super(e,t,i),d(this,"children",{}),"object"!=typeof i&&void 0!==i)throw new Error(`Invalid usage of "properties" schema field. Expected type "object", received "${typeof i}"`);this.children=Object.fromEntries(Object.entries(null!=i?i:{}).map((([e,t])=>[e,new ma(this.location,e,t)])))}getSchemasFor(e,t){var i,n;const s=t.shift();return void 0===s?Object.values(this.children):0===t.length?this.children[s]?[this.children[s]]:[]:null!=(n=null==(i=this.children[s])?void 0:i.getSchemasFor(e[s],[...t]))?n:[]}getCompletionItems(){return Object.keys(this.value).map((e=>({type:"object",label:`${e}`,value:e})))}validate(e){if("object"!=typeof e||Array.isArray(e))return[{message:`Invalid type: Expected "object", received "${Array.isArray(e)?"array":typeof e}"`}];const t=[];for(const i in e)this.children[i]&&t.push(...this.children[i].validate(e[i]));return t}}],["propertyNames",class extends da{constructor(e,t,i){super(e,t,i),d(this,"rootSchema"),this.rootSchema=new ma(this.location,"propertyNames",i)}getSchemasFor(){return[]}getCompletionItems(e){return this.rootSchema.getCompletionItems(e).filter((e=>"value"===e.type)).map((e=>({type:"object",label:`${e.value}`,value:e.value})))}validate(){return[]}isTrue(e){return this.rootSchema.isValid(e)}}],["required",class extends da{getSchemasFor(){return[]}getCompletionItems(){return[]}validate(e){const t=Array.isArray(this.value)?this.value:[this.value];if("object"!=typeof e||Array.isArray(e))return[{message:`Required properties missing: ${t.join(", ")}`}];for(const i of t)if(void 0===e[i]||null===e[i])return[{message:`Missing required property: ${i}`}];return[]}}],["then",ha],["type",class extends da{get values(){return Array.isArray(this.value)?this.value:[this.value]}getSchemasFor(){return[]}getCompletionItems(){const e=[];return this.values.includes("boolean")&&e.push(...[!0,!1].map((e=>({type:"value",label:`${e}`,value:e})))),this.values.includes("integer")&&e.push(...[0,1,2,3,4,5,6,7,8,9].map((e=>({type:"value",label:`${e}`,value:e})))),this.values.includes("number")&&e.push(...[0,.1,.2,.3,.4,.5,.6,.7,.8,.9].map((e=>({type:"value",label:`${e}`,value:e})))),this.values.includes("null")&&e.push({type:"value",label:"null",value:null}),e}validate(e){const t=Array.isArray(this.value)?this.value:[this.value];return t.includes(wa(e))?[]:[{message:`Invalid type: Found ${wa(e)}; expected ${t.join(", ")}`}]}}]]),ya=new Set(["$schema","$id","description","title","definitions","pattern","min","max","doNotSuggest","maxItems","minItems","deprecationMessage","examples","minimum","maximum","default"]);class ba{static setJSONDefaults(e){this.lib=e,this.rootSchemas.clear()}static request(e,t){const i=this.lib[e];if(!i)return console.warn(`Couldn't find schema for "${e}"`),{};if(t){let n;return Sn(t,i.schema,(e=>n=e)),void 0===n&&console.error(`Couldn't find hash ${t} @ ${e}`),null!=n?n:{}}return i.schema}static addRootSchema(e,t){return this.rootSchemas.set(e,t),t}static requestRootSchema(e){return this.rootSchemas.get(e)}static createSchemas(e,t){if("object"!=typeof t)return console.warn(`Unexpected schema type "${typeof t}" @ ${e}`),[new ga(e,"",t)];let i=[];for(const[n,s]of Object.entries(t)){if(void 0===s)continue;const t=va.get(n);if(void 0===t){if(ya.has(n))continue;console.warn(`Schema field not implemented: <${n}, ${s}> @ ${e}`);continue}const a=new t(e,n,s);if("then"===n){let t=i.reverse().map((e=>"ifSchema"===e.type?e:"refSchema"===e.type?e.getFreeIfSchema():void 0)).filter((e=>void 0!==e))[0];t||(console.warn(`"then" schema without "if" @ ${e}`),t=new(va.get("if"))(e,"if",!0)),a.receiveIfSchema(t)}i.push(a)}return i}}d(ba,"lib",{}),d(ba,"rootSchemas",new Map);class ka extends xe{constructor(e){super(),d(this,"changed",new xe),d(this,"undoStack",[]),d(this,"redoStack",[]),d(this,"lastUndoLength",0),this.parent=e}get length(){return this.undoStack.length}updateHasChanges(){this.dispatch(this.undoStack.length!==this.lastUndoLength)}saveState(){this.lastUndoLength=this.undoStack.length,this.updateHasChanges()}undo(){const e=this.undoStack.pop();e&&(e.unselectTrees.forEach((e=>this.parent.removeSelectionOf(e))),this.redoStack.push(e.undo()),this.updateHasChanges(),this.changed.dispatch())}redo(){const e=this.redoStack.pop();e&&(e.unselectTrees.forEach((e=>this.parent.removeSelectionOf(e))),this.undoStack.push(e.undo()),this.updateHasChanges(),this.changed.dispatch())}push(e){this.undoStack.push(e),this.redoStack=[],this.updateHasChanges(),this.changed.dispatch()}pushAll(e){0!==e.length&&(1===e.length?this.push(e[0]):this.push(new fs(e)))}}const Sa="darwin"===qe()?"Ctrl + Shift + Z":"Ctrl + Y";async function xa(e){const t=await Yp.getApp();return await t.dataLoader.fired,e||(e=t.projectConfig.get().targetVersion),Ca().then((t=>t.filter((t=>!e||N.exports.compare(t,e,"<=")))))}async function Ca(){const e=await Yp.getApp();await e.dataLoader.fired;return(await e.dataLoader.readJSON("data/packages/minecraftBedrock/formatVersions.json")).reverse()}function ja(){return Ca().then((e=>e[0]))}function _a(e){const t=new Set;return e.filter((e=>{const i=function(e){return`t-${e.type}:v-${e.value}`}(e),n=!t.has(i);return t.add(i),n}))}class Pa{constructor(e,t){d(this,"propertySuggestions",[]),d(this,"valueSuggestions",[]),d(this,"tree"),d(this,"selections",[]),d(this,"_keyBindings"),d(this,"_actions"),d(this,"history",new ka(this)),d(this,"schemaRoot"),d(this,"selectionChange",new xe),d(this,"containerElement"),d(this,"scrollTop",0),d(this,"updateSuggestions",C((async()=>{var e,t,i,n,s,a;this.propertySuggestions=[],this.valueSuggestions=[];const r=this.tree.toJSON().format_version||this.parent.project.config.get().targetVersion||await ja(),o=null==(e=this.selections[0])?void 0:e.getTree(),l=null==o?void 0:o.toJSON();let c=[];if(0===this.selections.length||o===this.tree)c=null!=(i=null==(t=this.schemaRoot)?void 0:t.getCompletionItems(l))?i:[];else if(o){const e=o.path,t=null!=(s=null==(n=this.schemaRoot)?void 0:n.getSchemasFor(this.tree.toJSON(),e))?s:[];t&&(c=t.filter((e=>void 0!==e)).map((e=>e.getCompletionItems(l))).flat())}this.propertySuggestions=_a(c.filter((e=>("object"===e.type||"array"===e.type)&&!(null!=o?o:this.tree).children.find((t=>"array"!==t.type&&t[0]===e.value)))).concat(this.parent.app.project.snippetLoader.getSnippetsFor(r,this.parent.getFileType(),this.selections.map((e=>e.getLocation()))).map((e=>({type:"snippet",label:e.displayData.name,value:e.insertData}))))),(o instanceof Us&&0===(null==(a=null==o?void 0:o.children)?void 0:a.length)||o instanceof ta||o instanceof Ys&&o.isEmpty())&&(this.valueSuggestions=_a(c.filter((e=>"value"===e.type||"valueArray"===e.type))))}),50)),this.parent=e,this.json=t,this.tree=ea(null,t),this.setSelection(this.tree),this.history.on((e=>{this.parent.setIsUnsaved(e)})),this.history.changed.on((()=>{this.propertySuggestions=[],this.valueSuggestions=[],this.parent.updateCache()})),Yp.getApp().then((async e=>{await e.projectManager.projectReady.fired,this.parent.once((()=>{e.project.jsonDefaults.isReady&&this.createSchemaRoot()})),e.project.jsonDefaults.on((()=>{this.parent.hasFired&&this.createSchemaRoot()}))})),this.selectionChange.on((()=>this.updateSuggestions()))}get keyBindings(){if(!this._keyBindings)throw new Error("Cannot access keyBindings before they were initialized.");return this._keyBindings}get actions(){if(!this._actions)throw new Error("Cannot access keyBindings before they were initialized.");return this._actions}createSchemaRoot(){var e;const t=null==(e=Fn.get(this.parent.getProjectPath()))?void 0:e.schema;t&&(this.schemaRoot=ba.addRootSchema(t,new ma(t,"$global",ba.request(t)))),this.updateSuggestions()}receiveContainer(e){var t,i;null==(t=this._keyBindings)||t.dispose(),null==(i=this._actions)||i.dispose(),this._keyBindings=new ca(e),this._actions=new Rn(this._keyBindings),this.containerElement=e,this.actions.create({keyBinding:["Ctrl + DELETE","Ctrl + BACKSPACE"],onTrigger:()=>{const e=[];this.forEachSelection((t=>{const i=t.getTree();if(i.getParent())if(t.dispose(),t instanceof na&&"object"===i.getParent().type){const t=new Us(i.getParent(),{});this.setSelection(t),i.replace(t),e.push(new ks(i,t))}else{this.toggleSelection(i.getParent());const[t,n]=i.delete();e.push(new ws(i,t,n))}})),this.history.pushAll(e)}}),this.actions.create({keyBinding:["ESCAPE"],onTrigger:()=>{this.setSelection(this.tree)}}),this.actions.create({keyBinding:["CTRL + Z"],onTrigger:()=>{this.undo()}}),this.actions.create({keyBinding:[Sa],onTrigger:()=>{this.redo()}})}deactivate(){var e,t;null==(e=this._keyBindings)||e.dispose(),null==(t=this._actions)||t.dispose()}activate(){this.containerElement&&(this.receiveContainer(this.containerElement),this.containerElement.children[0].scrollTop=this.scrollTop)}saveState(){this.history.saveState()}toJSON(){return this.tree.toJSON()}forEachSelection(e){this.selections.forEach(e)}removeSelection(e){this.selections=this.selections.filter((t=>e!==t)),this.selectionChange.dispatch()}removeSelectionOf(e){this.selections=this.selections.filter((t=>{const i=t.getTree();return i!==e&&(e instanceof Ys||!e.hasChild(i))||(t.dispose(!1),!1)})),this.selectionChange.dispatch()}setSelection(e,t=!1){this.selections.forEach((e=>e.dispose(!1))),this.selections=[t&&e instanceof Ys?new na(this,e):new ia(this,e)],this.selectionChange.dispatch()}toggleSelection(e,t=!1){let i=!1;this.selections=this.selections.filter((n=>n.getTree()!==e||n instanceof na!==t||(n.dispose(!1),i=!0,!1))),i||this.selections.push(t&&e instanceof Ys?new na(this,e):new ia(this,e)),this.selectionChange.dispatch()}addKey(e,t){const i=[];this.forEachSelection((n=>{if(n instanceof na)return;const s=n.addKey(e,t);s&&i.push(s)})),this.history.pushAll(i)}addValue(e,t){let i=e;"boolean"==typeof e||"true"===e||"false"===e?i="boolean"==typeof e?e:"true"===e:Number.isNaN(Number(e))?"null"!==e&&null!==e||(i=null):i=Number(e);const n=[];this.forEachSelection((e=>{if(e instanceof na)return;const s=e.addValue(i,t);s&&n.push(s)})),this.history.pushAll(n)}addFromJSON(e){if("object"!=typeof e)return;let t=[];this.forEachSelection((i=>{if(i instanceof na)return;const n=i.getTree();if(n instanceof Ys)return;const s=n.children.length;for(const a in e){const i=ea(n,e[a]);n instanceof Us?n.addChild(a,i):n.addChild(i),t.push(new vs(i,s,n instanceof Us?a:void 0))}})),this.history.pushAll(t)}edit(e){const t=[];this.forEachSelection((i=>{const n=i.edit(e);n&&t.push(n)})),this.history.pushAll(t)}delete(e){this.removeSelectionOf(e);const[t,i]=e.delete();this.history.push(new ws(e,t,i))}objectValueDeletion(e){this.removeSelectionOf(e);const t=new Us(e.getParent(),{});e.replace(t),this.history.push(new ks(e,t))}onPasteMenu(e,t=this.tree){const i=[{name:"actions.paste.name",icon:"mdi-content-paste",onTrigger:()=>{this.setSelection(t),this.parent.paste()}}];return e&&!this.parent.isReadOnly&&Wn(e,i,!1),i}onReadOnlyMenu(e,t=this.tree,i=!0){const n=[{name:"actions.documentationLookup.name",icon:"mdi-book-open-outline",onTrigger:()=>{const e=i?t.key:t.value;"string"==typeof e&&os(this.parent.getProjectPath(),e)}},{name:"actions.copy.name",icon:"mdi-content-copy",onTrigger:()=>{this.setSelection(t,!i),this.parent.copy()}}];return e&&Wn(e,n,!1),n}onContextMenu(e,t,i=!0){if(this.parent.isReadOnly)return this.onReadOnlyMenu(e,t,i);const[n,s]=this.onReadOnlyMenu(void 0,t,i),a=[n];t instanceof Ys?a.push({name:"general.delete",icon:"mdi-delete-outline",onTrigger:()=>{"object"!==t.getParent().type||i?this.delete(t):this.objectValueDeletion(t)}}):a.push({name:"general.delete",icon:"mdi-delete-outline",onTrigger:()=>{this.delete(t)}}),a.push(s,{name:"actions.cut.name",icon:"mdi-content-cut",onTrigger:()=>{this.setSelection(t,!i),this.parent.cut()}},...t instanceof Ys?[]:this.onPasteMenu(void 0,t)),t instanceof Ys||0!==t.children.length||a.push({name:t instanceof ta?"actions.toObject.name":"actions.toArray.name",icon:t instanceof ta?"mdi-code-braces-box":"mdi-code-array",onTrigger:()=>{if(this.removeSelectionOf(t),t instanceof ta){const e=new Us(t.getParent(),{});t.replace(e),this.history.push(new ks(t,e))}else{const e=new ta(t.getParent(),[]);t.replace(e),this.history.push(new ks(t,e))}}}),Wn(e,a,!1)}undo(){this.history.undo()}redo(){this.history.redo()}}const Aa=C((async e=>{const t=JSON.stringify(e.treeEditor.toJSON()),i=await Yp.getApp();await i.project.packIndexer.updateFile(e.getProjectPath(),t,e.isForeignFile),await i.project.jsonDefaults.updateDynamicSchemas(e.getProjectPath()),i.project.fileChange.dispatch(e.getProjectPath(),await e.getFile())}),600);class Ta extends Bn{constructor(e,t,i=!1){super(e,t,i),d(this,"component",oa),d(this,"_treeEditor"),this.fired.then((async()=>{const e=await Yp.getApp();await e.projectManager.projectReady.fired,e.project.tabActionProvider.addTabActions(this)}))}get app(){return this.parent.app}get project(){return this.parent.project}static is(e){var t;return"treeEditor"===(null==(t=null==Re?void 0:Re.editor)?void 0:t.jsonEditor)&&e.name.endsWith(".json")}get treeEditor(){if(!this._treeEditor)throw new Error("Trying to access TreeEditor before it was setup.");return this._treeEditor}async setup(){let e;try{e=T.parse(await this.fileHandle.getFile().then((e=>e.text())))}catch{return new Pt({name:"windows.invalidJson.title",description:"windows.invalidJson.description"}),void this.close()}this._treeEditor=new Pa(this,e),await super.setup()}async getFile(){return new File([JSON.stringify(this.treeEditor.toJSON())],this.name)}updateCache(){Aa(this)}async onActivate(){this.treeEditor.activate()}onDeactivate(){var e;null==(e=this._treeEditor)||e.deactivate()}loadEditor(){}setReadOnly(e){this.isReadOnly=e}async save(){this.isTemporary=!1;const e=await Yp.getApp(),t=JSON.stringify(this.treeEditor.toJSON(),null,"\t");await e.fileSystem.write(this.fileHandle,t),this.treeEditor.saveState()}async paste(){if(this.isReadOnly)return;const e=await navigator.clipboard.readText();let t;try{t=T.parse(e)}catch{try{t=T.parse(`{${e}}`)}catch{return}}void 0!==t&&this.treeEditor.addFromJSON(t)}async copy(){let e="";this.treeEditor.forEachSelection((t=>{const i=t.getTree();t instanceof na?i.isValueSelected?e+=i.toJSON():e+=i.key:e+=`"${i.key}": ${JSON.stringify(t.getTree().toJSON(),null,"\t")}`})),""!==e&&await navigator.clipboard.writeText(e)}async cut(){this.isReadOnly||(await this.copy(),this.treeEditor.forEachSelection((e=>this.treeEditor.delete(e.getTree()))))}async close(){const e=await super.close();if(!this.isForeignFile&&e&&this.isUnsaved){const e=await Yp.getApp();if(this.isForeignFile)await e.fileSystem.unlink(this.getProjectPath());else{const t=await this.fileHandle.getFile(),i=await t.text();await e.project.packIndexer.updateFile(this.getProjectPath(),i)}}return e}}class Ea{static get tabs(){return[...this._tabs].reverse()}static register(e){return this._tabs.add(e),{dispose:()=>this._tabs.delete(e)}}}d(Ea,"_tabs",new Set([Gn,Ta,class extends Bn{constructor(){super(...arguments),d(this,"component",ms),d(this,"dataUrl")}static is(e){const t=e.name;return t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")}setReadOnly(){this.isReadOnly=!0}async onActivate(){var e;this.dataUrl=await(e=this.fileHandle,new Promise((async(t,i)=>{const n=new FileReader;try{const s=await e.getFile();n.addEventListener("load",(()=>{t(n.result)})),n.addEventListener("error",i),n.readAsDataURL(s)}catch{i(`File does not exist: "${e.name}"`)}})))}get icon(){return"mdi-file-image-outline"}get iconColor(){return"primary"}save(){}}]));class Fa extends cs{constructor(e,t=0){super(e.app),d(this,"uuid",h()),d(this,"tabs",k([])),d(this,"_selectedTab"),d(this,"_isActive",!0),d(this,"openedFiles"),this._project=e,this.openedFiles=new ts(this,e.app,`projects/${e.name}/.bridge/openedFiles_${t}.json`)}get tabTypes(){return Ea.tabs}get isActive(){return this._isActive}get shouldRender(){return this.tabs.length>0}get app(){return this._app}get project(){return this._project}get isSharingScreen(){const e=this.project.tabSystems.find((e=>e!==this));return null==e?void 0:e.shouldRender}get hasUnsavedTabs(){return this.tabs.some((e=>e.isUnsaved))}get selectedTab(){return this._selectedTab}get currentComponent(){var e,t;return null!=(t=null==(e=this._selectedTab)?void 0:e.component)?t:Zt}get projectRoot(){return this.project.baseDirectory}get projectName(){return this.project.name}async open(e,{selectTab:t=!0,isReadOnly:i=!1,isTemporary:n=!0}={}){const s=await this.getTabFor(e,i);return n||(s.isTemporary=!1),await this.add(s,t),s}async openPath(e,t={}){const i=await this.project.app.fileSystem.getFileHandle(e);return await this.open(i,t)}async getTabFor(e,t=!1){let i;for(const n of this.tabTypes)if(await n.is(e)){i=new n(this,e,t);break}return i||(i=new Gn(this,e,t)),await i.fired}async hasTab(e){for(const t of this.tabs)if(await t.is(e))return!0;return!1}async add(e,t=!0,i=!1){if(this.closeAllTemporary(),!i)for(const n of this.tabs)if(await n.is(e))return e.onDeactivate(),t?n.select():n;return e.hasFired||await e.fired,this.tabs=[...this.tabs,e],e.isForeignFile||e instanceof Bn&&e.isReadOnly||await this.openedFiles.add(e.getPath()),t&&e.select(),this.project.updateTabFolders(),e}remove(e,t=!0,i=!0){e.onDeactivate();const n=this.tabs.findIndex((t=>t===e));if(-1!==n)return this.tabs.splice(n,1),t&&e.onDestroy(),i&&e===this._selectedTab&&this.select(this.tabs[0===n?0:n-1]),e.isForeignFile||this.openedFiles.remove(e.getPath()),this.project.updateTabFolders(),e}async close(e=this.selectedTab,t=!0){if(!e)return!1;if(t&&e.isUnsaved){const t=new Zn(e);return"cancel"!==await t.fired}return this.remove(e),!0}async closeTabWithHandle(e){const t=await this.getTab(e);t&&this.close(t)}async select(e){var t,i;this.isActive!==!!e&&this.setActive(!!e),this.app.mobile.isCurrentDevice()&&(eh.isNavigationVisible=!1,Yp.getApp().then((e=>e.windowResize.dispatch()))),(null==e?void 0:e.isSelected)||(null==(t=this._selectedTab)||t.onDeactivate(),e&&e!==this._selectedTab&&this.project.isActiveProject&&Yp.eventSystem.dispatch("currentTabSwitched",e),this._selectedTab=e,e&&(await(null==(i=this._selectedTab)?void 0:i.onActivate()),u.nextTick((async()=>{var e;null==(e=this._monacoEditor)||e.layout()}))))}async save(e=this.selectedTab){if(!e||e instanceof Bn&&e.isReadOnly)return;const t=await Yp.getApp();t.windows.loadingWindow.open();const i=this.selectedTab===e,n=this.selectedTab;n!==e&&await this.select(e),e instanceof Bn&&await e.save(),n!==e&&await this.select(n),!e.isForeignFile&&e instanceof Bn&&(await this.project.updateFile(e.getProjectPath()),await this.project.recentFiles.add({path:e.getPath(),name:e.name,color:e.iconColor,icon:e.icon}),this.project.fileSave.dispatch(e.getProjectPath(),await e.getFile()),i&&Yp.eventSystem.dispatch("refreshCurrentContext",e.getProjectPath())),t.windows.loadingWindow.close(),e.focus()}async saveAs(){this.selectedTab instanceof Bn&&await this.selectedTab.saveAs()}async saveAll(){const e=await Yp.getApp();e.windows.loadingWindow.open();for(const t of this.tabs)t.isUnsaved&&await this.save(t);e.windows.loadingWindow.close()}closeAllTemporary(){for(const e of[...this.tabs])e.isTemporary&&this.remove(e,!0,!1)}async activate(){var e;await this.openedFiles.restoreTabs(),this.tabs.length>0&&this.setActive(!0),!this.selectedTab&&this.tabs.length>0&&this.tabs[0].select(),await(null==(e=this.selectedTab)?void 0:e.onActivate())}deactivate(){var e;null==(e=this.selectedTab)||e.onDeactivate(),this.dispose()}setActive(e,t=!0){t&&this.project.setActiveTabSystem(this,!e),e!==this._isActive&&(this._isActive=e,e&&this._selectedTab&&this.project.isActiveProject&&Yp.eventSystem.dispatch("currentTabSwitched",this._selectedTab))}async getTab(e){for(const t of this.tabs)if(t instanceof Bn&&await t.isForFileHandle(e))return t}closeTabs(e){const t=[...this.tabs].reverse();for(const i of t)e(i)&&i.close()}has(e){for(const t of this.tabs)if(e(t))return!0;return!0}get(e){for(const t of this.tabs)if(e(t))return t}}const Da={behaviorPack:"./BP",resourcePack:"./RP",skinPack:"./SP",worldTemplate:"./WT"};class Oa{constructor(e,t){d(this,"data",{}),this.fileSystem=e,this.project=t,t&&t.fileSave.on("config.json",(()=>{this.refreshConfig(),this.project.app.windows.createPreset.onPresetsChanged()}))}async setup(){var e,t,i;if(await this.fileSystem.fileExists(".bridge/config.json")){const e=await this.fileSystem.readJSON(".bridge/config.json"),{darkTheme:t,lightTheme:i,gameTestAPI:n,scriptingAPI:o,prefix:d}=e,u=((e,t)=>{var i={};for(var n in e)a.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&s)for(var n of s(e))t.indexOf(n)<0&&r.call(e,n)&&(i[n]=e[n]);return i})(e,["darkTheme","lightTheme","gameTestAPI","scriptingAPI","prefix"]);await this.fileSystem.unlink(".bridge/config.json");const p={};n&&(p.enableGameTestFramework=!0),o&&(p.additionalModdingCapabilities=!0);const h=c(l({type:"minecraftBedrock",name:this.fileSystem.baseDirectory.name,namespace:d,experimentalGameplay:p},u),{authors:u.author?[u.author]:["Unknown"],packs:{behaviorPack:"./BP",resourcePack:"./RP",skinPack:"./SP",worldTemplate:"./WT"},bridge:{darkTheme:t,lightTheme:i}});return await this.fileSystem.writeJSON("config.json",h,!0),void(this.data=h)}try{this.data=await this.fileSystem.readJSON("config.json")}catch{this.data={}}let n=!1;if(this.project&&this.data.capabilities){const s=await this.project.app.dataLoader.readJSON("data/packages/minecraftBedrock/experimentalGameplay.json"),a=null!=(e=this.data.experimentalGameplay)?e:{},r=null!=(t=this.data.capabilities)?t:[];a.enableGameTestFramework=r.includes("gameTestAPI"),a.additionalModdingCapabilities=r.includes("scriptingAPI");for(const e of s)null!=a[i=e.id]||(a[i]=!0);this.data.experimentalGameplay=a,this.data.capabilities=void 0,n=!0}this.data.author&&!this.data.authors&&(this.data.authors="string"==typeof this.data.author?[this.data.author]:this.data.author,this.data.author=void 0,n=!0),n&&await this.fileSystem.writeJSON("config.json",this.data,!0)}async refreshConfig(){try{this.data=await this.fileSystem.readJSON("config.json")}catch{this.data={}}}get(){return this.data}getPackRoot(e){var t,i;return null!=(i=null==(t=this.data.packs)?void 0:t[e])?i:Da[e]}getPackFilePath(e,t){const i=this.fileSystem.baseDirectory.name;return t||e?e?En(`projects/${i}`,t?`${this.getPackRoot(e)}/${t}`:`${this.getPackRoot(e)}`):`projects/${i}/${t}`:`projects/${i}`}async save(){await this.fileSystem.writeJSON("config.json",this.data,!0)}}class Ma extends es{constructor(e,t){super(e,5,t)}isEquals(e,t){return e.path===t.path}removeFile(e){return this.remove({icon:"",name:"",path:e})}}async function $a(e,t){try{return await ds(e.getFilePath("behaviorPack","pack_icon.png"),t)}catch{}try{return await ds(e.getFilePath("resourcePack","pack_icon.png"),t)}catch{}try{return await ds(e.getFilePath("skinPack","pack_icon.png"),t)}catch{}}async function Ia(e,t){var i,n,s,a,r;const o=`${t}/manifest.json`;let d=await e.fileSystem.readJSON(o);const u=null==(n=null==(i=null==d?void 0:d.metadata)?void 0:i.generated_with)?void 0:n.bridge;let p=!1;return u?u.includes("2.1.5")||(u.push("2.1.5"),p=!0):(d=c(l({},null!=d?d:{}),{metadata:c(l({},null!=(s=null==d?void 0:d.metadata)?s:{}),{generated_with:c(l({},null!=(r=null==(a=null==d?void 0:d.metadata)?void 0:a.generated_with)?r:{}),{bridge:["2.1.5"]})})}),p=!0),p&&await e.fileSystem.writeJSON(o,d,!0),d}class Ra extends Ce{constructor(e,t){super(),d(this,"worker",null),d(this,"workerClass",null),d(this,"_service",null),d(this,"task",null),d(this,"disposeTimeout"),this.taskOptions=e,this.app=t}get service(){if(!this._service)throw new Error("Accessing service without service being defined");return this._service}async activate(e){var t;void 0!==this.disposeTimeout&&(window.clearTimeout(this.disposeTimeout),this.disposeTimeout=void 0);const i=null!=(t=this.app)?t:await Yp.getApp();if(this.task=i.taskManager.create(this.taskOptions),!this.worker){if(this.createWorker(),!this.worker)throw new Error("Method WorkerManager.createWorker() doesn't create worker");this.workerClass=B(this.worker)}this.resetSignal(),await this.start(e).then((e=>{var t;null==(t=this.task)||t.complete(),this.dispatch(e)}))}deactivate(){this.disposeTimeout=window.setTimeout((()=>this.dispose()),12e4)}dispose(){var e,t;this.disposeTimeout&&window.clearTimeout(this.disposeTimeout),this.resetSignal(),null==(e=this.worker)||e.terminate(),null==(t=this.task)||t.dispose(),this.worker=null,this._service=null,this.workerClass=null,this.disposeTimeout=void 0}}function Wa(){return new Worker("/assets/Main.62c6d573.js",{type:"module"})}class Na extends Ra{constructor(e,t){super({icon:"mdi-flash-outline",name:"taskManager.tasks.packIndexing.title",description:"taskManager.tasks.packIndexing.description"}),d(this,"ready",new Ce),this.project=e,this.baseDirectory=t}createWorker(){this.worker=new Wa}deactivate(){super.deactivate()}async start(e){var t,i,n;console.time("[TASK] Indexing Packs (Total)"),this._service=await new this.workerClass(this.baseDirectory,this.project.app.fileSystem.baseDirectory,{disablePackSpider:!(null!=(i=null==(t=null==Re?void 0:Re.general)?void 0:t.enablePackSpider)&&i),pluginFileTypes:Fn.getPluginFileTypes(),noFullLightningCacheRefresh:!e&&!(null==(n=null==Re?void 0:Re.general)?void 0:n.fullLightningCacheRefresh)}),await this.service.on(L((([e,t])=>{var i;null==(i=this.task)||i.update(e,t)})),!1);const[s,a]=await this.service.start(e);return await this.service.disposeListeners(),this.ready.dispatch(),console.timeEnd("[TASK] Indexing Packs (Total)"),[s,a]}async updateFile(e,t,i=!1){await this.ready.fired,this.ready.resetSignal(),await this.service.updatePlugins(Fn.getPluginFileTypes()),await this.service.updateFile(e,t,i),this.ready.dispatch()}async updateFiles(e){await this.ready.fired,this.ready.resetSignal(),await this.service.updatePlugins(Fn.getPluginFileTypes());for(const t of e)await this.service.updateFile(t);this.ready.dispatch()}async unlink(e){await this.ready.fired,this.ready.resetSignal(),await this.service.updatePlugins(Fn.getPluginFileTypes()),await this.service.unlink(e),this.ready.dispatch()}async readdir(e,...t){return await this.fired,await this.service.readdir(e)}}async function Ba(e,t,i=new Set,n=""){for await(const s of e.values()){const e=0===n.length?s.name:`${n}/${s.name}`;if("file"===s.kind){if("."===s.name[0])continue;await t(s,e)}else"directory"!==s.kind||i.has(e)||await Ba(s,t,i,e)}}class La extends Ce{constructor(e){super(),d(this,"_baseDirectory"),e&&this.setup(e)}get baseDirectory(){return this._baseDirectory}setup(e){this._baseDirectory=e,this.hasFired||this.dispatch()}async getDirectoryHandle(e,{create:t,createOnce:i}={}){if(""===e)return this.baseDirectory;let n=this.baseDirectory;const s=e.split(/\\|\//g);for(const a of s){try{n=await n.getDirectoryHandle(a,{create:i||t})}catch{throw new Error(`Failed to access "${e}": Directory does not exist`)}i&&(i=!1,t=!1)}return n}async getFileHandle(e,t=!1){if(0===e.length)throw new Error("Error: filePath is empty");const i=e.split(/\\|\//g),n=i.pop(),s=await this.getDirectoryHandle(i.join("/"),{create:t});try{return await s.getFileHandle(n,{create:t})}catch{throw new Error(`File does not exist: "${e}"`)}}async mkdir(e,{recursive:t}={}){await this.getDirectoryHandle(e,{create:!0})}async readdir(e,{withFileTypes:t}={}){const i=await this.getDirectoryHandle(e),n=[];for await(const s of i.values())"file"===s.kind&&".DS_Store"===s.name||(t?n.push(s):n.push(s.name));return n}async readFilesFromDir(e,t=this.getDirectoryHandle(e)){t=await t;const i=[];for await(const n of t.values())"file"===n.kind&&".DS_Store"===n.name||("file"===n.kind?i.push({name:n.name,kind:n.kind,path:`${e}/${n.name}`}):"directory"===n.kind&&i.push(...await this.readFilesFromDir(`${e}/${n.name}`,n)));return i}readFile(e){return this.getFileHandle(e).then((e=>e.getFile()))}async unlink(e){if(0===e.length)throw new Error("Error: filePath is empty");const t=e.split(/\\|\//g),i=t.pop();let n;try{n=await this.getDirectoryHandle(t.join("/"))}catch{return}try{await n.removeEntry(i,{recursive:!0})}catch{}}async writeFile(e,t){const i=await this.getFileHandle(e,!0);return await this.write(i,t),i}async write(e,t){const i=await e.createWritable();await i.write(t),await i.close()}async readJSON(e){const t=await this.readFile(e);try{return await T.parse(await t.text())}catch{throw new Error(`Invalid JSON: ${e}`)}}writeJSON(e,t,i=!1){return this.writeFile(e,JSON.stringify(t,null,i?"\t":void 0))}async move(e,t){if(await this.fileExists(e))await this.copyFile(e,t);else{if(!(await this.directoryExists(e)))throw new Error(`File or folder does not exist: ${e}`);await this.copyFolder(e,t)}await this.unlink(e)}async copyFile(e,t){const i=await this.getFileHandle(e,!1),n=await this.getFileHandle(t,!0);return await this.copyFileHandle(i,n)}async copyFileHandle(e,t){const i=await t.createWritable();return await i.write(await e.getFile()),await i.close(),t}async copyFolder(e,t){const i=await this.getDirectoryHandle(e,{create:!1});await Ba(i,(async(e,i)=>{await this.copyFileHandle(e,await this.getFileHandle(Pn(t,i),!0))}))}async copyFolderByHandle(e,t){const i=new La(t);await Ba(e,(async(e,t)=>{await this.copyFileHandle(e,await i.getFileHandle(t,!0))}))}loadFileHandleAsDataUrl(e){return new Promise((async(t,i)=>{const n=new FileReader;try{const s=await e.getFile();n.addEventListener("load",(()=>{t(n.result)})),n.addEventListener("error",i),n.readAsDataURL(s)}catch{i(`File does not exist: "${e.name}"`)}}))}async fileExists(e){try{return await this.getFileHandle(e),!0}catch{return!1}}async directoryExists(e){try{return await this.getDirectoryHandle(e),!0}catch{return!1}}}class Ha{constructor({type:e,text:t,isDismissible:i}){d(this,"type"),d(this,"text"),d(this,"isDismissible"),d(this,"isVisible",!0),this.type=e,this.text=t,this.isDismissible=null!=i&&i}}const Va={};var za=Le({mixins:[Be],props:{infoPanel:Ha}},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-alert",{attrs:{type:e.infoPanel.type,rounded:"lg",border:"bottom",dismissible:e.infoPanel.isDismissible},model:{value:e.infoPanel.isVisible,callback:function(t){e.$set(e.infoPanel,"isVisible",t)},expression:"infoPanel.isVisible"}},[e._v(" "+e._s(e.t(e.infoPanel.text))+" ")])}),[],!1,Ua,null,null,null);function Ua(e){for(let t in Va)this[t]=Va[t]}var Ga=function(){return za.exports}();const Ja={};var qa=Le({name:"InformedChoiceWindow",mixins:[Be],components:{BaseWindow:St,ActionViewer:Ht,InfoPanel:Ga},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()},onClick(e){e.trigger(),this.currentWindow.close()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseWindow",{attrs:{windowTitle:e.title,isVisible:e.isVisible,hasCloseButton:!e.opts.isPersistent,hasMaximizeButton:!1,percentageWidth:50,maxPercentageHeight:80,isPersistent:e.opts.isPersistent,heightUnset:""},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[e.currentWindow.topPanel?i("InfoPanel",{staticClass:"mb-2",attrs:{infoPanel:e.currentWindow.topPanel}}):e._e(),e._l(e.$data._actionManager.state,(function(t,n){return i("ActionViewer",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,staticStyle:{cursor:"pointer"},attrs:{action:t,hideTriggerButton:!0},nativeOn:{click:function(i){return e.onClick(t)}}})}))]},proxy:!0}])})}),[],!1,Ka,null,null,null);function Ka(e){for(let t in Ja)this[t]=Ja[t]}var Qa=function(){return qa.exports}();class Xa extends Je{constructor(e,t={}){super(Qa,!0),d(this,"_actionManager"),d(this,"_ready",new Ce),d(this,"topPanel"),this.title=e,this.opts=t,this.setup()}get actionManager(){return new Promise((e=>this._ready.once(e)))}async setup(){this._actionManager=new Rn,this._ready.dispatch(this._actionManager),this.defineWindow(),this.open()}async open(){Yp.audioManager.playAudio("click5.ogg",1),await this.actionManager,super.open()}dispose(){super.dispose(),this._actionManager.dispose()}}function Za(){return new Worker("/assets/Service.9ca1b207.js",{type:"module"})}class Ya extends Ra{constructor(e,t,i){super({icon:"mdi-cogs",name:"taskManager.tasks.compiler.title",description:"taskManager.tasks.compiler.description"}),d(this,"ready",new Ce),this.parent=e,this.project=t,this.config=i,this.ready.dispatch()}createWorker(){this.worker=new Za}async dispose(){await super.dispose(),this.parent.remove(this.config)}async start({mode:e,restartDevServer:t}){var i,n,s;await this.ready.fired,this.ready.resetSignal();const a=await Yp.getApp();await a.comMojang.fired,await a.project.packIndexer.fired,this._service?await this.updateService(e,!1,t):this._service=await new this.workerClass(this.project.baseDirectory,a.fileSystem.baseDirectory,a.comMojang.fileSystem.baseDirectory,{config:this.config,mode:e,isFileRequest:!1,isDevServerRestart:t,plugins:this.parent.getCompilerPlugins(),pluginFileTypes:Fn.getPluginFileTypes(),allFiles:await a.project.packIndexer.service.getAllFiles(!1)}),await this.service.on(L((([e,t])=>{var i;null==(i=this.task)||i.update(e,t)})),!1),console.time("[TASK] Compiling project (total)");let[r,o]=null!=(n=await(null==(i=a.project)?void 0:i.packIndexer.fired))?n:[];("build"===e||t)&&(r=null!=(s=await this.project.packIndexer.service.getAllFiles())?s:[]),await this._service.start([r,o]),this._service.disposeListeners(),this.ready.dispatch(),console.timeEnd("[TASK] Compiling project (total)")}async updateService(e,t,i){await this.service.updateMode(e,t,i),await this.service.updatePlugins(this.parent.getCompilerPlugins(),Fn.getPluginFileTypes())}async updateFiles(e){console.time("[Worker] Compiler: Update Files"),await this.ready.fired,this.ready.resetSignal(),await this.updateService("dev",!1,!1),await this.service.updateFiles(e),this.ready.dispatch(),console.timeEnd("[Worker] Compiler: Update Files")}async compileWithFile(e,t){await this.ready.fired,this.ready.resetSignal(),await this.updateService("dev",!0,!1);const i=new Uint8Array(await t.arrayBuffer()),[n,s]=await this.service.compileWithFile(e,i);return this.ready.dispatch(),[n,null!=s?s:i]}async unlink(e){await this.ready.fired,this.ready.resetSignal(),await this.updateService("dev",!1,!1),await this.service.unlink(e),this.ready.dispatch()}async getCompilerOutputPath(e){await this.ready.fired,this.ready.resetSignal(),await this.updateService("dev",!1,!1);const t=await this.service.getCompilerOutputPath(e);return this.ready.dispatch(),t}}function er(e,t){if(Array.isArray(e)&&Array.isArray(t))return e.concat(t);if(Array.isArray(e))return e.concat([t]);if(Array.isArray(t))return t.concat([e]);if("object"!=typeof t)return t;let i={};for(const n in e)void 0===t[n]?i[n]=e[n]:i[n]=er(e[n],t[n]);for(const n in t)void 0===e[n]&&(i[n]=t[n]);return i}class tr extends Ce{constructor(e){super(),d(this,"compilers",new Map),this.project=e}async start(e,t,i=!1){const n=await Yp.getApp();await n.extensionLoader.fired,await n.comMojang.fired,await this.project.fileSystem.fileExists(".bridge/.restartDevServer")&&(i=!0,await this.project.fileSystem.unlink(".bridge/.restartDevServer"));let s=this.compilers.get(e);if(s)return s.activate({mode:t,restartDevServer:i});s=new Ya(this,this.project,e),this.compilers.set(e,s),await s.activate({mode:t,restartDevServer:i}),this.dispatch()}get current(){let e=this.compilers.get("default");if(!e)throw new Error("Cannot get current compiler");return e}updateFiles(e,t){let i=this.compilers.get(e);if(!i)throw new Error(`Cannot update file because compiler for config ".bridge/compiler/${e}" doesn't exist`);return i.updateFiles(t)}unlink(e){let t=this.compilers.get("default");if(!t)throw new Error('Cannot update file because compiler for config ".bridge/compiler/default" doesn\'t exist');return t.unlink(e)}compileWithFile(e,t){let i=this.compilers.get("default");if(!i)throw new Error('Cannot update file because compiler for config ".bridge/compiler/default" doesn\'t exist');return i.compileWithFile(e,t)}remove(e){this.compilers.delete(e)}deactivate(){this.compilers.forEach((e=>e.deactivate()))}dispose(){this.compilers.forEach((e=>e.dispose()))}getCompilerPlugins(){return function(e){let t=e[0];for(let i=1;i<e.length;i++)t=er(t,e[i]);return t}(this.project.app.extensionLoader.mapActive((e=>e.compilerPlugins)))}async openWindow(){const e=this.project.app.comMojang,{hasComMojang:t,didDenyPermission:i}=e.status,n=await this.project.fileSystem.getDirectoryHandle(".bridge/compiler",{create:!0}),s=new class extends Xa{constructor(){let e;if(super("sidebar.compiler.name"),Ie)e={text:"comMojang.status.notAvailable",type:"error",isDismissible:!1};else if(!t&&i)e={text:"comMojang.status.deniedPermission",type:"warning",isDismissible:!1};else if(t&&!i)e={text:"comMojang.status.sucess",type:"success",isDismissible:!1};else{if(t)throw new Error("Invalid com.mojang status");e={text:"comMojang.status.notSetup",type:"error",isDismissible:!1}}this.topPanel=new Ha(e)}},a=await s.actionManager;a.create({icon:"mdi-cog",name:"sidebar.compiler.default.name",description:"sidebar.compiler.default.description",onTrigger:async()=>{this.project.packIndexer.deactivate(),await this.project.packIndexer.activate(!0),await this.start("default","build")}});for await(const r of n.values()){if("file"!==r.kind||".DS_Store"===r.name||"default.json"===r.name)continue;const e=await r.getFile();let t;try{t=T.parse(await e.text())}catch{continue}a.create({icon:t.icon,name:t.name,description:t.description,onTrigger:async()=>{this.project.packIndexer.deactivate(),await this.project.packIndexer.activate(!0),await this.start(r.name,"build")}})}}}const ir=(e,t)=>({register:i=>{var n;(null!=(n=i.type)?n:"entity")===t&&(e.exports=({name:e,schema:n,template:s})=>{const a=new i;e(i.component_name),n(nr(Object.values(a.onPropose())[0])),s(((e,{create:i})=>{i(a.onApply(e,"components")[`minecraft:${t}`])}))})}});function nr(e){const t={},i=Object.keys(e);if(1===i.length&&i[0].startsWith("$dynamic.list."))return{type:"array",items:nr(Object.values(e)[0])};for(const[n,s]of Object.entries(e))n.startsWith("$")||("string"==typeof s?t[n]=sr(s):Array.isArray(s)?t[n]={enum:s}:"object"===s&&(t[n]=nr(s)));return{type:"object",properties:t}}function sr(e){switch(e){case"$general.boolean":return{type:"boolean"};case"$general.number":return{type:"integer"};case"$general.decimal":return{type:"number"};default:return{type:["number","integer","string","boolean","object","array"]}}}const ar=(()=>{try{return"undefined"!=typeof process&&"node"===process.release.name}catch{return!1}})()?{encode:()=>{}}:new TextEncoder;async function rr(e){const t=ar.encode(e);if(!t)return"";const i=await async function(e){return new Uint8Array(await crypto.subtle.digest("sha-1",e))}(t);return n=i,Array.from(n).map((e=>("00"+e.toString(16)).slice(-2))).join("");var n}class or{constructor(e,t,i,n,s){d(this,"_name"),d(this,"schema"),d(this,"template"),d(this,"animations",[]),d(this,"animationControllers",[]),d(this,"createOnPlayer",[]),d(this,"dialogueScenes",[]),d(this,"clientFiles",{}),this.fileType=e,this.componentSrc=t,this.mode=i,this.v1Compat=n,this.targetVersion=s}get name(){return this._name}async load(e){const t={exports:{}};try{ss({script:this.componentSrc,env:{module:t,defineComponent:e=>e,Bridge:this.v1Compat?ir(t,this.fileType):void 0}})}catch(s){console.error(s)}if("function"!=typeof t.exports)return!1;let i=e=>this.schema=e,n=()=>{};return e&&"server"!==e||(i=()=>{},n=e=>{this.template=(t,i)=>{try{e(t,i)}catch(s){console.error(s)}}}),await t.exports({name:e=>this._name=e,schema:i,template:n}),!0}reset(){this.animations=[],this.animationControllers=[]}getSchema(){return this.schema}toString(){return this.componentSrc}create(e,t,i=`minecraft:${this.fileType}`,n){var s;const a=i.split("/"),r=a.pop(),o=this.getObjAtLocation(e,[...a]);o[r]=(n?(e,t)=>n(er,e,t):er)(null!=(s=o[r])?s:{},null!=t?t:{})}getObjAtLocation(e,t){let i=e;for(;t.length>0;){const e=t.shift();void 0===i[e]?void 0!==i[Number(e)]?i=i[Number(e)]:(i[e]={},i=i[e]):i=i[e]}return i}async processTemplates(e,t,i){var n,s,a;if("function"!=typeof this.template)return;const r=null!=(a=null==(s=null==(n=e[`minecraft:${this.fileType}`])?void 0:n.description)?void 0:s.identifier)?a:"bridge:no_identifier",o=await rr(`${this.name}/${r}`),l=(e,t)=>(this.animations.push([e,t]),this.getShortAnimName("a",o,this.animations.length-1)),c=(e,t)=>(this.animationControllers.push([e,t]),this.getShortAnimName("ac",o,this.animationControllers.length-1)),d=(await rr(`${this.name}/${i}`)).slice(0,16),u=t=>this.registerLifecycleHook(e,i,t,d,"activated"),p=t=>this.registerLifecycleHook(e,i,t,d,"deactivated");"entity"===this.fileType?this.template(null!=t?t:{},{mode:this.mode,compilerMode:this.mode,sourceEntity:()=>JSON.parse(JSON.stringify(e)),create:(t,i,n)=>this.create(e,t,i,n),location:i,identifier:r,animationController:c,animation:l,dialogueScene:!this.targetVersion||N.exports.compare(this.targetVersion,"1.17.10",">=")?(e,t=!0)=>{this.dialogueScenes.push(e),e.scene_tag&&t&&u({run_command:{command:[`/dialogue open @s @p ${e.scene_tag}`]}})}:void 0,onActivated:u,onDeactivated:p,client:{create:(e,t="1.10.0")=>{this.clientFiles[`RP/entity/bridge/${o}.json`]={format_version:t,"minecraft:client_entity":Object.assign({description:{identifier:r}},e)}}}}):"item"===this.fileType?this.template(null!=t?t:{},{mode:this.mode,compilerMode:this.mode,sourceItem:()=>JSON.parse(JSON.stringify(e)),create:(t,i,n)=>this.create(e,t,i,n),location:i,identifier:r,player:{animationController:c,animation:l,create:(e,t,i)=>this.createOnPlayer.push([null!=t?t:"minecraft:entity",e,i])}}):"block"===this.fileType&&this.template(null!=t?t:{},{mode:this.mode,sourceBlock:this.mode,fileContent:()=>JSON.parse(JSON.stringify(e)),create:(t,i,n)=>this.create(e,t,i,n),location:i,identifier:r})}async processAdditionalFiles(e){var t,i,n;const s=null!=(n=null==(i=null==(t=e[`minecraft:${this.fileType}`])?void 0:t.description)?void 0:i.identifier)?n:"bridge:no_identifier",a=await rr(`${this.name}/${s}`),r=`BP/animations/bridge/${a}.json`,o=`BP/animation_controllers/bridge/${a}.json`;return"minecraft:player"===s&&this.createOnPlayer.forEach((([t,i,n])=>{this.create(e,i,t,n)})),l({[r]:this.createAnimations(a,e),[o]:this.createAnimationControllers(a,e),[`BP/dialogue/bridge/${a}.json`]:this.dialogueScenes.length>0?JSON.stringify({format_version:this.targetVersion,"minecraft:npc_dialogue":{scenes:this.dialogueScenes}},null,"\t"):void 0},Object.fromEntries(Object.entries(this.clientFiles).map((([e,t])=>[e,JSON.stringify(t,null,"\t")]))))}createAnimations(e,t){if(0===this.animations.length)return;let i=0;const n={format_version:"1.10.0",animations:{}};for(const[s,a]of this.animations){if(!s){i++;continue}const r=this.getAnimName("animation",e,i),o=this.getShortAnimName("a",e,i);n.animations[r]=s,this.create(t,{animations:{[o]:r}},"minecraft:entity/description"),!1!==a&&this.create(t,{scripts:{animate:[a?{[o]:a}:o]}},"minecraft:entity/description"),i++}return JSON.stringify(n,null,"\t")}createAnimationControllers(e,t){if(0===this.animationControllers.length)return;let i=0;const n={format_version:"1.10.0",animation_controllers:{}};for(const[s,a]of this.animationControllers){if(!s){i++;continue}const r=this.getAnimName("controller.animation",e,i),o=this.getShortAnimName("ac",e,i);n.animation_controllers[r]=s,this.create(t,{animations:{[o]:r}},"minecraft:entity/description"),!1!==a&&this.create(t,{scripts:{animate:[a?{[o]:a}:o]}},"minecraft:entity/description"),i++}return JSON.stringify(n,null,"\t")}getAnimName(e,t,i){return`${e}.${t}_${i}`}getShortAnimName(e,t,i){var n;return`${null!=(n=t.slice(0,16))?n:"bridge_auto"}_${e}_${i}`}registerLifecycleHook(e,t,i,n,s){e[`minecraft:${this.fileType}`].events||(e[`minecraft:${this.fileType}`].events={});const a=e[`minecraft:${this.fileType}`].events;if("activated"===s&&t===`minecraft:${this.fileType}/components`)a["minecraft:entity_spawned"]||(a["minecraft:entity_spawned"]={}),this.addEventReponse(a["minecraft:entity_spawned"],i);else if("entity"===this.fileType&&t.startsWith(`minecraft:${this.fileType}/component_groups/`)){const e=t.split("/").pop();this.findComponentGroupReferences(a,"activated"===s?"add":"remove",e).forEach((e=>this.addEventReponse(e,i)))}else if(t.startsWith(`minecraft:${this.fileType}/permutations/`)){const r=t.split("/");if("components"!==r.pop())throw new Error("Invalid component location inside of permutation");const o=this.getObjAtLocation(e,[...r]),l=`bridge:${n}_${s}`;o.condition&&this.animationControllers.push([{states:{default:{on_entry:[`@s ${l}`]}}},"activated"===s?o.condition:`!(${o.condition})`]),a[l]=i}}addEventReponse(e,t){if(Array.isArray(e.sequence))e.sequence.push(t);else if(0===Object.keys(e).length)Object.assign(e,t);else{let i=Object.assign({},e,{filters:void 0});for(const t in e)"filters"!==t&&(e[t]=void 0);e.sequence=[i,t]}}findComponentGroupReferences(e,t,i){var n,s;let a=[];for(const r in e){const o=e[r];if(Array.isArray(o.sequence))a.push(...this.findComponentGroupReferences(o.sequence,t,i));else if(Array.isArray(o.randomize))a.push(...this.findComponentGroupReferences(o.randomize,t,i));else{(null!=(s=null==(n=o[t])?void 0:n.component_groups)?s:[]).includes(i)&&a.push(o)}}return a}}class lr{constructor(e,t){this.app=e,this.filePath=t}async runScript(e,t){const i=this.app.project.fileSystem;let n={},s=!0;if(this.filePath){const e=await this.app.project.getFileFromDiskOrTab(this.filePath);try{n=T.parse(await e.text()),s=!1}catch{}}try{return await ss({async:!0,script:t,env:{readdir:e=>i.readFilesFromDir(e).catch((()=>[])),uuid:h,getFormatVersions:xa,getCacheDataFor:async(e,t,i)=>this.app.project.packIndexer.service.getCacheDataFor(e,t,i),getProjectPrefix:()=>{var e;return null!=(e=this.app.projectConfig.get().namespace)?e:"bridge"},getProjectConfig:()=>this.app.projectConfig.get(),getFileName:()=>this.filePath?this.filePath.split(/\/|\\/g).pop():void 0,customComponents:e=>async function(e){var t,i;const n=await Yp.getApp(),s=null!=(i=null==(t=n.project.config.get().bridge)?void 0:t.v1CompatMode)&&i,a=s?"BP/components":`BP/components/${e}`;let r;try{r=await n.project.fileSystem.getDirectoryHandle(a)}catch{return}const o={};return await Ba(r,(async(t,i)=>{const[a,r]=await n.project.compilerManager.compileWithFile(i,await t.getFile()),l=new File([r],t.name),c=new or(e,await l.text(),"dev",s);await c.load("client")&&c.name&&(o[c.name]=c.getSchema())}),void 0,a),o}(e),get:e=>{const t=[];return Sn(e,n,(e=>t.push(e))),t},failedCurrentFileLoad:s}})}catch(a){console.error(`Error evaluating schemaScript "${e}": ${a.message}`)}}async runSchemaScripts(e){const t=await this.app.dataLoader.getDirectoryHandle("data/packages/minecraftBedrock/schemaScript");await Ba(t,(async(t,i)=>{const n=await t.getFile(),s=await n.text();let a;a=n.name.endsWith(".js")?{script:s}:T.parse(s);let r=await this.runScript(i,a.script);if(r){if(n.name.endsWith(".js")){if(r.keep)return;a=c(l({},a),{type:r.type,generateFile:r.generateFile}),r=r.data}"object"!==a.type||Array.isArray(r)||"object"!=typeof r?"custom"===a.type?e[`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`]={uri:`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`,schema:r}:e[`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`]={uri:`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`,schema:{type:"enum"===a.type?"string":"object",enum:"enum"===a.type?r:void 0,properties:"properties"===a.type?Object.fromEntries(r.map((e=>[e,{}]))):void 0}}:e[`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`]={uri:`file:///data/packages/minecraftBedrock/schema/${a.generateFile}`,schema:{type:"object",properties:r}}}}))}}let cr={},dr=!1;class ur extends xe{constructor(e){super(),d(this,"loadedSchemas",!1),d(this,"localSchemas",{}),d(this,"disposables",[]),this.project=e}get isReady(){return this.loadedSchemas&&dr}async activate(){console.time("[SETUP] JSONDefaults"),await this.project.app.project.packIndexer.fired,this.disposables=[Yp.eventSystem.on("currentTabSwitched",(e=>{e instanceof Bn&&Fn.isJsonFile(e.getProjectPath())&&this.updateDynamicSchemas(e.getProjectPath())})),Yp.eventSystem.on("refreshCurrentContext",(e=>this.updateDynamicSchemas(e))),Yp.eventSystem.on("disableValidation",(()=>{this.setJSONDefaults(!1)}))].filter((e=>void 0!==e)),this.loadedSchemas||await this.loadAllSchemas(),this.setJSONDefaults(),console.timeEnd("[SETUP] JSONDefaults")}deactivate(){this.disposables.forEach((e=>e.dispose())),this.disposables=[]}async loadAllSchemas(){var e;this.localSchemas={};const t=await Yp.getApp(),i=t.taskManager.create({icon:"mdi-book-open-outline",name:"taskManager.tasks.loadingSchemas.name",description:"taskManager.tasks.loadingSchemas.description",totalTaskSteps:10});await t.dataLoader.fired,i.update(1);const n=await t.dataLoader.readdir("data/packages");i.update(2);for(const r of n)try{await this.loadStaticSchemas(await t.dataLoader.getFileHandle(`data/packages/${r}/schemas.json`))}catch(a){console.error(a);continue}dr=!0,i.update(3),this.addSchemas(await this.getDynamicSchemas()),i.update(4),await this.runSchemaScripts(t),i.update(5);const s=null==(e=this.project.tabSystem)?void 0:e.selectedTab;if(s&&s instanceof Bn){const e=Fn.getId(s.getProjectPath());this.addSchemas(await this.requestSchemaFor(e,s.getProjectPath())),await this.runSchemaScripts(t,s.isForeignFile?void 0:s.getProjectPath())}this.loadedSchemas=!0,i.update(6),i.complete()}setJSONDefaults(e=!0){_.json.jsonDefaults.setDiagnosticsOptions({enableSchemaRequest:!1,allowComments:!0,validate:e,schemas:Object.values(Object.assign({},cr,this.localSchemas))}),ba.setJSONDefaults(Object.assign({},cr,this.localSchemas)),this.dispatch()}async reload(){const e=await Yp.getApp();e.windows.loadingWindow.open(),this.loadedSchemas=!1,this.localSchemas={},dr=!1,cr={},await this.deactivate(),await this.activate(),e.windows.loadingWindow.close()}async updateDynamicSchemas(e){const t=await Yp.getApp(),i=Fn.getId(e);this.addSchemas(await this.requestSchemaFor(i,e)),this.addSchemas(await this.requestSchemaFor(i)),await this.runSchemaScripts(t,e),this.setJSONDefaults()}async updateMultipleDynamicSchemas(e){const t=await Yp.getApp(),i=new Set;for(const n of e){const e=Fn.getId(n);i.has(e)||(this.addSchemas(await this.requestSchemaFor(e)),await this.runSchemaScripts(t,n),i.add(e))}this.setJSONDefaults()}addSchemas(e){e.forEach((e=>{this.localSchemas[e.uri]?(e.schema&&(this.localSchemas[e.uri].schema=e.schema),e.fileMatch&&(this.localSchemas[e.uri].fileMatch=e.fileMatch)):this.localSchemas[e.uri]=e}))}async requestSchemaFor(e,t){const i=this.project.packIndexer;return await i.fired,await i.service.getSchemasFor(e,t)}async getDynamicSchemas(){return(await Promise.all(Fn.getIds().map((e=>this.requestSchemaFor(e))))).flat()}async loadStaticSchemas(e){if(dr)return;const t=await e.getFile(),i=T.parse(await t.text());for(const n in i)cr[n]={uri:n,schema:i[n]};Fn.getMonacoSchemaArray().forEach((e=>{e.uri&&(cr[e.uri]?(e.schema&&(cr[e.uri].schema=e.schema),e.fileMatch&&(cr[e.uri].fileMatch?cr[e.uri].fileMatch.push(...e.fileMatch):cr[e.uri].fileMatch=e.fileMatch)):cr[e.uri]=e)}))}async runSchemaScripts(e,t){const i=new lr(e,t);await i.runSchemaScripts(this.localSchemas)}}const pr=new Map;class hr{constructor(e){d(this,"disposables",[]),d(this,"typeDisposables",[]),d(this,"currentTypeEnv",null),this.dataLoader=e}async activate(e){this.disposables=[Yp.eventSystem.on("currentTabSwitched",(e=>{!e.isForeignFile&&e instanceof Bn&&this.setTypeEnv(e.getProjectPath())}))],e&&await this.setTypeEnv(e)}deactivate(){this.typeDisposables.forEach((e=>e.dispose())),this.disposables.forEach((e=>e.dispose())),this.typeDisposables=[],this.disposables=[]}async load(e){let t=pr.get(e);if(t)return t;await this.dataLoader.fired;const i=await this.dataLoader.readFile(`data/packages/minecraftBedrock/${e}`);return t=await i.text(),pr.set(e,t),t}async setTypeEnv(e){var t;if(e===this.currentTypeEnv)return;this.currentTypeEnv=e,this.typeDisposables.forEach((e=>e.dispose())),this.typeDisposables=[],await Fn.ready.fired;const{types:i=[]}=null!=(t=Fn.get(e))?t:{},n=(await Promise.all(i.map((async e=>{var t;if("string"==typeof e)return[e,await this.load(e)];const i=await Yp.getApp(),[n,{targetVersion:[s,a]}]=e,r=null!=(t=i.projectConfig.get().targetVersion)?t:await ja();return N.exports.compare(r,a,s)?[n,await this.load(n)]:void 0})))).filter((e=>void 0!==e));for(const[s,a]of n){const e=F.file(s);this.typeDisposables.push(_.typescript.javascriptDefaults.addExtraLib(a,e.toString()),_.typescript.typescriptDefaults.addExtraLib(a,e.toString()))}}}class mr{constructor(e){this.config=e}trigger(e){var t,i;null==(i=(t=this.config).onTrigger)||i.call(t,e)}}class gr extends mr{constructor(e,t){super(t),d(this,"_isSelected",!1),this.parent=e,this.parent.selectedAction||this.select()}get isSelected(){return this._isSelected}select(){this.parent.unselectAllActions(),this._isSelected=!0,this.parent.selectedAction=this}unselect(){this._isSelected&&(this.parent.selectedAction=void 0),this._isSelected=!1}}class fr{constructor(){d(this,"headerSlot"),d(this,"headerHeight"),d(this,"topPanel"),d(this,"actions",[]),d(this,"selectedAction")}unselectAllActions(){var e;null==(e=this.actions)||e.forEach((e=>e instanceof gr?e.unselect():void 0))}getSelectedAction(){var e;return null==(e=this.actions)?void 0:e.find((e=>e instanceof gr&&e.isSelected))}}function wr(e){return new vr(e)}class vr{constructor(e){var t;if(d(this,"sidebarUUID"),d(this,"isLoading",!1),d(this,"isVisible",!0),d(this,"isSelected",!1),d(this,"stopHandle"),this.config=e,this.sidebarUUID=null!=(t=e.id)?t:h(),S(eh.sidebarElements,this.sidebarUUID,this),e.isVisible&&(this.isVisible=e.isVisible),this.config.component){const e=this.config.component;this.config.sidebarContent=new class extends fr{constructor(){super(...arguments),d(this,"component",e),d(this,"actions"),d(this,"topPanel")}}}this.stopHandle=H(eh,(()=>{var e;this.isSelected=null!=(e=eh.currentState)&&e&&eh.currentState===this.config.sidebarContent}),{deep:!1})}get icon(){return this.config.icon}get uuid(){return this.sidebarUUID}get displayName(){return this.config.displayName}get component(){return this.config.component}dispose(){var e;x(eh.sidebarElements,this.sidebarUUID),null==(e=this.stopHandle)||e.call(this),this.stopHandle=void 0}setSidebarContent(e){this.config.sidebarContent=e}async click(){Yp.audioManager.playAudio("click5.ogg",1),this.isLoading=!0,this.config.sidebarContent&&function(e){e===eh.currentState?eh.currentState=null:eh.currentState=e;Yp.getApp().then((e=>e.windowResize.dispatch()))}(this.config.sidebarContent),"function"==typeof this.config.onClick&&await this.config.onClick(),this.isLoading=!1}}class yr{constructor({items:e,text:t,isOpen:i,shouldSort:n}){d(this,"type","category"),d(this,"id",h()),d(this,"text"),d(this,"items"),d(this,"isOpen"),d(this,"shouldSort"),this.text=t,this.items=e,this.isOpen=null==i||i,this.shouldSort=null==n||n,this.shouldSort&&this.sortCategory()}addItem(e){this.items.push(e),this.shouldSort&&this.sortCategory()}removeItems(){this.items=[]}getText(){return this.text}getSearchText(){return this.text.toLowerCase()}getItems(){return this.items}setOpen(e){Yp.audioManager.playAudio("click5.ogg",1),this.isOpen=e}getCurrentElement(e){return this.items.find((({id:t})=>t===e))}sortCategory(){this.items=this.items.sort(((e,t)=>e.getSearchText().localeCompare(t.getSearchText())))}hasFilterMatches(e){return void 0!==this.items.find((t=>t.getSearchText().includes(e)))}filtered(e){return 0===e.length?this:new yr({items:this.items.filter((t=>t.getSearchText().includes(e))),text:this.text,isOpen:!0})}}class br{constructor({id:e,text:t,icon:i,color:n}){d(this,"type","item"),d(this,"id"),d(this,"text"),d(this,"icon"),d(this,"color"),this.id=e,this.text=t,this.icon=i,this.color=n}getText(){return this.text}getSearchText(){return this.text.toLowerCase()}}class kr{constructor(e){d(this,"_selected"),d(this,"_filter",""),d(this,"reselectedForFilter",""),d(this,"state",{}),this._elements=e,this.selected=this.findDefaultSelected()}addElement(e,t){"item"===e.type&&t&&(this.state[e.id]=t),this.has(e)?this.replace(e):this._elements.push(e)}has(e){return void 0!==this._elements.find((t=>t.id===e.id))}replace(e){this._elements=this._elements.map((t=>t.id===e.id?e:t))}removeElements(){this._elements=[]}get filter(){return this._filter.toLowerCase()}get elements(){const e=this.sortSidebar(this._elements.filter((e=>"item"===e.type?e.getSearchText().includes(this.filter):e.hasFilterMatches(this.filter))).map((e=>"item"===e.type?e:e.filtered(this.filter))));if(this.filter!==this.reselectedForFilter&&e.length>0){const t=e[0];"category"===t.type&&t.getItems().length>0&&(t.setOpen(!0),this.setDefaultSelected(t.getItems()[0].id)),this.reselectedForFilter=this.filter}return e}get rawElements(){return this._elements}get currentElement(){if(this.selected)for(const e of this._elements){if("item"===e.type){if(e.id===this.selected)return e;continue}const t=e.getCurrentElement(this.selected);if(t)return t}}get currentState(){var e;return this.selected&&null!=(e=this.state[this.selected])?e:{}}getState(e){var t;return null!=(t=this.state[e])?t:{}}setState(e,t){S(this.state,e,t)}sortSidebar(e){return e.sort(((e,t)=>e.type!==t.type?e.type.localeCompare(t.type):e.getSearchText().localeCompare(t.getSearchText())))}findDefaultSelected(){for(const e of this.sortSidebar(this.elements)){if("category"===e.type&&e.getItems().length>0)return e.getItems()[0].id;if("item"===e.type)return e.id}}setDefaultSelected(e){e?this.selected=e:this.selected||(this.selected=this.findDefaultSelected())}resetSelected(){this.selected=void 0}clearFilter(){this._filter=""}get selected(){return this._selected}set selected(e){e&&Yp.audioManager.playAudio("click5.ogg",1),this._selected=e}}const Sr={name:"SidebarItem",props:{isSelected:Boolean,text:String,icon:String,color:String,compact:Boolean}},xr={};var Cr=Le(Sr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"ripple",rawName:"v-ripple",value:!e.isSelected,expression:"!isSelected"}],staticClass:"pa-1 rounded-lg category",class:{selected:e.isSelected},on:{click:function(t){return e.$emit("click")}}},[i("span",{staticClass:"d-flex align-center",class:{"justify-center":e.compact}},[i("v-icon",{class:{"pr-1":!e.compact},style:{"font-size":(e.compact?30:22)+"px"},attrs:{color:e.color}},[e._v(" "+e._s(e.icon)+" ")]),e.compact?e._e():i("span",[e._v(e._s(e.text))])],1)])}),[],!1,jr,"60fa9412",null,null);function jr(e){for(let t in xr)this[t]=xr[t]}var _r=function(){return Cr.exports}();const Pr={name:"SidebarGroup",mixins:[Be],components:{SidebarItem:_r},props:{text:String,isOpen:Boolean,items:Array,selected:String,compact:Boolean}},Ar={};var Tr=Le(Pr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("details",{attrs:{open:e.isOpen}},[i("summary",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"rounded-lg",on:{click:function(t){return t.preventDefault(),e.$emit("toggleOpen")}}},[i("span",{staticClass:"d-flex",class:{"justify-center":e.compact}},[e.compact?e._e():i("h2",{staticClass:"d-inline"},[e._v(e._s(e.t(e.text)))]),e.compact?e._e():i("v-spacer"),i("v-icon",{attrs:{color:"primary",large:""}},[e._v(" "+e._s(e.isOpen?"mdi-chevron-down":"mdi-chevron-right")+" ")])],1)]),e._l(e.items,(function(t,n){var s=t.text,a=t.icon,r=t.color,o=t.id;return i("SidebarItem",{key:s+"."+n,attrs:{icon:a,color:r,text:s,isSelected:e.selected===o,compact:e.compact},on:{click:function(t){return e.$emit("click",o)}}})})),e.compact?i("v-divider"):e._e()],2)}),[],!1,Er,"5cde7409",null,null);function Er(e){for(let t in Ar)this[t]=Ar[t]}const Fr={};var Dr=Le({inheritAttrs:!1,components:{BaseWindow:St,SidebarItem:_r,SidebarGroup:function(){return Tr.exports}()},props:{sidebarItems:Array,value:{type:String,default:void 0}},computed:{selected(){return this.value},isMobile(){return this.$vuetify.breakpoint.mobile}},methods:{onSidebarChanged(e){this.$emit("input",e)},toggleOpenCategory(e){e.isOpen=!e.isOpen}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseWindow",e._g(e._b({scopedSlots:e._u([{key:"toolbar",fn:function(){return[e._t("toolbar",null,{selectedTab:e.selected})]},proxy:!0},{key:"sidebar",fn:function(){return[e.isMobile?e._e():e._t("sidebar",null,{selectedSidebar:e.selected}),e._l(e.sidebarItems,(function(t,n){return["item"===t.type?i("SidebarItem",{key:t.text+"."+n,attrs:{icon:t.icon,color:t.color,text:t.text,isSelected:e.selected===t.id,compact:e.isMobile},on:{click:function(i){return e.onSidebarChanged(t.id)}}}):i("SidebarGroup",{key:t.text+"."+n+"."+t.isOpen,attrs:{isOpen:t.isOpen,items:t.items,text:t.text,selected:e.selected,compact:e.isMobile},on:{toggleOpen:function(i){return e.toggleOpenCategory(t)},click:e.onSidebarChanged}})]}))]},proxy:!0},{key:"default",fn:function(){return[e._t("default",null,{selectedSidebar:e.selected})]},proxy:!0},{key:"actions",fn:function(){return[e._t("actions",null,{selectedSidebar:e.selected})]},proxy:!0}],null,!0)},"BaseWindow",e.$attrs,!1),e.$listeners))}),[],!1,Or,null,null,null);function Or(e){for(let t in Fr)this[t]=Fr[t]}var Mr=function(){return Dr.exports}();const $r={};var Ir=Le({name:"PackExplorerWindow",mixins:[Be],components:{SidebarWindow:Mr},props:["currentWindow"],setup:()=>({pointerDevice:Ss}),data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()}},computed:{title(){return this.sidebar.currentElement?`[${this.sidebar.currentElement.text} - ${this.t("windows.settings.title")}]`:"windows.settings.title"}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("SidebarWindow",{attrs:{windowTitle:e.title,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,percentageWidth:80,percentageHeight:80,sidebarItems:e.sidebar.elements},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"sidebar",fn:function(){return[i("v-text-field",{staticClass:"pt-2",attrs:{"prepend-inner-icon":"mdi-magnify",label:e.t("windows.settings.searchSettings"),autocomplete:"off",autofocus:"mouse"===e.pointerDevice,outlined:"",dense:""},model:{value:e.sidebar._filter,callback:function(t){e.$set(e.sidebar,"_filter","string"==typeof t?t.trim():t)},expression:"sidebar._filter"}})]},proxy:!0},{key:"default",fn:function(t){var n=t.selectedSidebar;return[0===e.sidebar.currentState.length&&""!==e.sidebar.filter?i("span",[e._v(' No setting matches your search for "'+e._s(e.sidebar.filter)+'". ')]):e._e(),e._l(e.sidebar.currentState,(function(t,s){return i(t.component,{key:n+"."+s+"."+t.value,tag:"component",staticClass:"mb-6",attrs:{config:t.config,value:t.value},on:{change:t.onChange,closeWindow:e.onClose}})}))]}}]),model:{value:e.sidebar.selected,callback:function(t){e.$set(e.sidebar,"selected",t)},expression:"sidebar.selected"}})}),[],!1,Rr,null,null,null);function Rr(e){for(let t in $r)this[t]=$r[t]}var Wr=function(){return Ir.exports}();class Nr{constructor(e,t,i=Re){d(this,"component"),d(this,"config"),d(this,"onChange",(async e=>{Yp.audioManager.playAudio("click5.ogg",1),await(this.value=e),"function"==typeof this.config.onChange&&await this.config.onChange(e),Yp.audioManager.playAudio("click5.ogg",1)})),this.state=i,S(this,"config",t),S(this,"component",e),void 0===this.value&&void 0!==t.default&&(this.value=t.default)}set value(e){void 0===this.state[this.config.category]&&S(this.state,this.config.category,{}),S(this.state[this.config.category],this.config.key,e)}get value(){var e;return null==(e=this.state[this.config.category])?void 0:e[this.config.key]}}const Br={};var Lr=Le({props:{config:Object,value:String},mixins:[Be],data:()=>({value_:void 0}),created(){this.value_=this.config.options.findIndex((e=>e===this.value))||0},methods:{onChange(e){this.$nextTick((()=>this.$emit("change",this.config.options[e])))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v(e._s(e.t(e.config.name)))]),i("div",{staticClass:"d-flex"},[i("div",[i("v-btn-toggle",{attrs:{inset:"",dense:"",mandatory:"",label:e.config.description,value:e.value_},on:{change:e.onChange}},e._l(e.config.options,(function(t){return i("v-btn",{key:t,attrs:{color:"sidebarSelection"}},[e._v(" "+e._s(t)+" ")])})),1)],1),i("span",{staticClass:"ml-4 text-normal"},[e._v(e._s(e.t(e.config.description)))])])])}),[],!1,Hr,null,null,null);function Hr(e){for(let t in Br)this[t]=Br[t]}var Vr=function(){return Lr.exports}();class zr extends Nr{constructor(e){super(Vr,e)}matches(e){return this.config.name.toLowerCase().includes(e)||this.config.description.toLowerCase().includes(e)||this.config.options.some((t=>t.toLowerCase().includes(e)))}}const Ur={props:{value:[Boolean,Promise],config:Object},mixins:[Be],data:()=>({value_:void 0}),async mounted(){this.value_=await this.value},methods:{onChange(e){this.$emit("change",null!==e&&e)}}},Gr={};var Jr=Le(Ur,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v(e._s(e.t(e.config.name)))]),i("v-switch",{staticStyle:{"margin-top":"0"},attrs:{inset:"",dense:"",label:e.t(e.config.description),value:e.value_},on:{change:e.onChange}})],1)}),[],!1,qr,null,null,null);function qr(e){for(let t in Gr)this[t]=Gr[t]}var Kr=function(){return Jr.exports}();class Qr extends Nr{constructor(e){super(Kr,e)}matches(e){return this.config.name.toLowerCase().includes(e)||this.config.description.toLowerCase().includes(e)}}const Xr={};var Zr=Le({props:{config:Object},components:{ActionViewer:Ht},mixins:[Be]},(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ActionViewer",{attrs:{action:e.config.action}})}),[],!1,Yr,null,null,null);function Yr(e){for(let t in Xr)this[t]=Xr[t]}var eo=function(){return Zr.exports}();class to extends Nr{constructor(e){var t,i;super(eo,{category:"actions",action:{},description:null!=(t=e.description)?t:"No description provided",key:e.id,name:null!=(i=e.name)?i:"general.unknown"},void 0),d(this,"config",j({category:"actions",action:{}})),d(this,"onChange",(async()=>{})),this.config.action=e}matches(e){return this.config.action.name.includes(e)||this.config.action.description.includes(e)}}const io={};var no=Le({props:{config:Object,value:[String,Promise]},mixins:[Be],data:()=>({value_:void 0}),async created(){this.value_=await this.value||this.config.default},methods:{onChange(e){this.$nextTick((()=>this.$emit("change",e)))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v(e._s(e.t(e.config.name)))]),i("div",{staticClass:"d-flex align-center"},[i("div",[i("v-autocomplete",{attrs:{inset:"",dense:"",mandatory:"",outlined:"",value:e.value_,items:e.config.options,"hide-details":"","menu-props":{maxHeight:220}},on:{change:e.onChange}})],1),i("span",{staticClass:"ml-4 text-normal"},[e._v(e._s(e.t(e.config.description)))])])])}),[],!1,so,null,null,null);function so(e){for(let t in io)this[t]=io[t]}var ao=function(){return no.exports}();class ro extends Nr{constructor(e){super(ao,e)}matches(e){return this.config.name.toLowerCase().includes(e)||this.config.description.toLowerCase().includes(e)||this.config.options.some((t=>"string"==typeof t?t.toLowerCase().includes(e):t.text.toLowerCase().includes(e)))}}class oo extends ro{get value(){return Yp.getApp().then((e=>{var t;return null==(t=e.projectConfig.get().bridge)?void 0:t[this.config.key]}))}set value(e){Yp.getApp().then((async t=>{t.projectConfig.get().bridge||(t.projectConfig.get().bridge={}),t.projectConfig.get().bridge[this.config.key]=e,await t.projectConfig.save()}))}}const lo={};var co=Le({props:{config:Object},mixins:[Be]},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d-flex align-center"},[i("v-btn",{attrs:{color:"primary"},on:{click:e.config.onClick}},[e._v(" "+e._s(e.t(e.config.name))+" ")]),i("span",{staticClass:"ml-4 text-normal"},[e._v(e._s(e.t(e.config.description)))])],1)}),[],!1,uo,null,null,null);function uo(e){for(let t in lo)this[t]=lo[t]}var po=function(){return co.exports}();class ho extends Nr{constructor(e){super(po,c(l({},e),{key:"N/A"})),d(this,"onChange",(async()=>{}))}matches(e){return this.config.name.includes(e)||this.config.description.includes(e)}}const mo={};var go=Le({name:"Confirm",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onCancel(){this.currentWindow.onCancel()},onConfirm(){this.currentWindow.onConfirm()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:e.$data.title,isVisible:e.isVisible,isPersistent:!0,hasMaximizeButton:!1,isFullscreen:!1,width:440,height:130,hasCloseButton:!1,isSmallPopup:!0},scopedSlots:e._u([{key:"default",fn:function(){return[i("p",{staticClass:"mt-2"},[e._v(e._s(e.t(e.$data.description)))])]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"sidebarSelection"},on:{click:e.onCancel}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-close")]),i("span",[e._v(e._s(e.t(e.$data.cancelText)))])],1),i("v-btn",{attrs:{color:"primary"},on:{click:e.onConfirm}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-check")]),i("span",[e._v(e._s(e.t(e.$data.confirmText)))])],1)]},proxy:!0}],null,!1,1493399650)}):e._e()}),[],!1,fo,null,null,null);function fo(e){for(let t in mo)this[t]=mo[t]}var wo=function(){return go.exports}();class vo extends Je{constructor(e){super(wo,!0,!1),this.opts=e,this.defineWindow(),this.open()}get confirmText(){var e;return null!=(e=this.opts.confirmText)?e:"general.okay"}get cancelText(){var e;return null!=(e=this.opts.cancelText)?e:"general.cancel"}get description(){return this.opts.description}get title(){var e;return null!=(e=this.opts.title)?e:"general.confirm"}onConfirm(){Yp.audioManager.playAudio("click5.ogg",1),"function"==typeof this.opts.onConfirm&&this.opts.onConfirm(),this.close(!0)}onCancel(){Yp.audioManager.playAudio("click5.ogg",1),"function"==typeof this.opts.onCancel&&this.opts.onCancel(),this.close(!1)}}class yo extends Ce{constructor(e){super(),d(this,"fileSystem",new La),d(this,"setup",new Ce),d(this,"_hasComMojang",!1),d(this,"_permissionDenied",!1),this.app=e,g("comMojangDirectory").then((async e=>{e&&(await this.app.fileSystem.fired,await this.requestPermissions(e).catch((()=>{this.createPermissionWindow(e)})),this._hasComMojang&&this.setup.dispatch()),this.dispatch()}))}get hasComMojang(){return this._hasComMojang}get status(){return{hasComMojang:this._hasComMojang,didDenyPermission:this._permissionDenied}}async createPermissionWindow(e){const t=new Pt({name:"comMojang.title",description:"comMojang.permissionRequest",onClose:async()=>{await this.requestPermissions(e)}});t.open(),await t.fired}async requestPermissions(e){"granted"!==await e.requestPermission({mode:"readwrite"})?(this._hasComMojang=!1,this._permissionDenied=!0,await this.app.projectManager.recompileAll()):(this.fileSystem.setup(e),this._hasComMojang=!0)}async set(e){f("comMojangDirectory",e),await this.requestPermissions(e),this._hasComMojang&&this.setup.dispatch()}async handleComMojangDrop(e){const t=new vo({description:"comMojang.folderDropped",confirmText:"general.yes",cancelText:"general.no"});await t.fired&&(await this.set(e),await this.app.projectManager.recompileAll())}async unlink(){await this.app.projectManager.recompileAll(),await w("comMojangDirectory")}}const bo={};var ko=Le({data:()=>({sidebarState:eh.sidebarElements}),components:{ActionViewer:Ht},methods:{onClick(e){e.isVisible=!e.isVisible,Re.sidebar||(Re.sidebar={}),Re.sidebar.sidebarElements||(Re.sidebar.sidebarElements={}),Re.sidebar.sidebarElements[e.uuid]=e.isVisible}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(e.sidebarState,(function(t,n){return i("ActionViewer",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{selected:t.isVisible,action:Object.assign({},t.config,{name:t.displayName}),hideTriggerButton:""},nativeOn:{click:function(i){return e.onClick(t)}}})})),1)}),[],!1,So,null,null,null);function So(e){for(let t in bo)this[t]=bo[t]}var xo=function(){return ko.exports}();class Co extends Nr{constructor(e){super(xo,e)}matches(e){return Object.values(eh.sidebarElements).some((t=>Yp.instance.locales.translate(t.displayName).includes(e)))}}const jo={};var _o=Le({props:{config:Object,value:[String,Promise]},mixins:[Be],data:()=>({value_:void 0}),async created(){this.value_=await this.value||this.config.default},methods:{onChange(e){this.$nextTick((()=>this.$emit("change",e)))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v(e._s(e.t(e.config.name)))]),i("div",{staticClass:"d-flex align-center"},[i("div",[i("v-text-field",{attrs:{inset:"",dense:"",mandatory:"",outlined:"",value:e.value_,items:e.config.options,"hide-details":"","menu-props":{maxHeight:220}},on:{change:e.onChange}})],1),i("span",{staticClass:"ml-4 text-normal"},[e._v(e._s(e.t(e.config.description)))])])])}),[],!1,Po,null,null,null);function Po(e){for(let t in jo)this[t]=jo[t]}var Ao=function(){return _o.exports}();class To extends Nr{constructor(e){super(Ao,e)}matches(e){return this.config.name.toLowerCase().includes(e)||this.config.description.toLowerCase().includes(e)}}class Eo extends kr{constructor(){super(...arguments),d(this,"lastFilter")}get elements(){let e;const t=this._elements.filter((t=>{if("category"===t.type)return!0;const i=this.getState(t.id).some((e=>e.matches(this.filter)));return!e&&i&&(e=t.id),i}));return e&&this.lastFilter!==this.filter&&0===this.currentState.length&&this.setDefaultSelected(e),this.lastFilter=this.filter,this.sortSidebar(t)}get currentState(){var e;return this.selected?(null!=(e=this.state[this.selected])?e:[]).filter((e=>e.matches(this.filter))):[]}}const Fo=class extends Je{constructor(e){super(Wr,!1,!0),d(this,"sidebar",new Eo([])),d(this,"bridgeCategory",new yr({items:[],text:"bridge."})),this.parent=e,this.defineWindow()}async setup(){const e=await Yp.getApp().then((e=>e.locales));this.addCategory("general",e.translate("windows.settings.general.name"),"mdi-circle-outline"),this.addCategory("appearance",e.translate("windows.settings.appearance.name"),"mdi-palette-outline"),this.addCategory("editor","Editor","mdi-pencil-outline"),this.addCategory("actions",e.translate("windows.settings.actions.name"),"mdi-keyboard-outline"),this.addCategory("audio",e.translate("windows.settings.audio.name"),"mdi-volume-high"),this.addCategory("sidebar",e.translate("windows.settings.sidebar.name"),"mdi-table-column"),this.addCategory("developers",e.translate("windows.settings.developer.name"),"mdi-wrench-outline"),this.addCategory("projects",e.translate("windows.settings.projects.name"),"mdi-folder-open-outline"),await async function(e){e.addControl(new zr({category:"appearance",name:"windows.settings.appearance.colorScheme.name",description:"windows.settings.appearance.colorScheme.description",key:"colorScheme",options:["auto","dark","light"],default:"auto",onChange:()=>{Yp.getApp().then((e=>e.themeManager.updateTheme()))}})),e.addControl(new ro({category:"appearance",name:"windows.settings.appearance.darkTheme.name",description:"windows.settings.appearance.darkTheme.description",key:"darkTheme",get options(){return e.parent.themeManager.getThemes("dark").map((e=>({text:e.name,value:e.id})))},default:"bridge.default.dark",onChange:()=>{Yp.getApp().then((e=>e.themeManager.updateTheme()))}})),e.addControl(new ro({category:"appearance",name:"windows.settings.appearance.lightTheme.name",description:"windows.settings.appearance.lightTheme.description",key:"lightTheme",get options(){return e.parent.themeManager.getThemes("light").map((e=>({text:e.name,value:e.id})))},default:"bridge.default.light",onChange:()=>{Yp.getApp().then((e=>e.themeManager.updateTheme()))}})),e.addControl(new oo({category:"appearance",name:"windows.settings.appearance.localDarkTheme.name",description:"windows.settings.appearance.localDarkTheme.description",key:"darkTheme",get options(){return e.parent.themeManager.getThemes("dark",!1).map((e=>({text:e.name,value:e.id}))).concat([{text:"None",value:"bridge.noSelection"}])},default:"bridge.noSelection",onChange:()=>{Yp.getApp().then((e=>e.themeManager.updateTheme()))}})),e.addControl(new oo({category:"appearance",name:"windows.settings.appearance.localLightTheme.name",description:"windows.settings.appearance.localLightTheme.description",key:"lightTheme",get options(){return e.parent.themeManager.getThemes("light",!1).map((e=>({text:e.name,value:e.id}))).concat([{text:"None",value:"bridge.noSelection"}])},default:"bridge.noSelection",onChange:()=>{Yp.getApp().then((e=>e.themeManager.updateTheme()))}})),e.addControl(new ro({category:"appearance",name:"windows.settings.appearance.font.name",description:"windows.settings.appearance.font.description",key:"font",default:"Roboto",options:["Roboto","Arial","Verdana","Helvetica","Tahome","Trebuchet MS","Menlo","Monaco","Courier New","monospace"]})),e.addControl(new ro({category:"appearance",name:"windows.settings.appearance.editorFont.name",description:"windows.settings.appearance.editorFont.description",key:"editorFont",default:"darwin"===qe()?"Menlo":"Consolas",options:["Roboto","Arial","Consolas","Menlo","Monaco",'"Courier New"',"monospace"],onChange:async e=>{(await Yp.getApp()).projectManager.updateAllEditorOptions({fontFamily:e})}})),e.addControl(new ro({category:"appearance",name:"windows.settings.appearance.editorFontSize.name",description:"windows.settings.appearance.editorFontSize.description",key:"editorFontSize",default:"14px",options:["8px","10px","12px","14px","16px","18px","20px"],onChange:async e=>{(await Yp.getApp()).projectManager.updateAllEditorOptions({fontSize:Number(e.replace("px",""))})}})),e.addControl(new Qr({category:"sidebar",name:"windows.settings.sidebar.sidebarRight.name",description:"windows.settings.sidebar.sidebarRight.description",key:"isSidebarRight",default:!1})),e.addControl(new Qr({category:"sidebar",name:"windows.settings.sidebar.shrinkSidebarElements.name",description:"windows.settings.sidebar.shrinkSidebarElements.description",key:"smallerSidebarElements",default:!1})),e.addControl(new zr({category:"sidebar",name:"windows.settings.sidebar.sidebarSize.name",description:"windows.settings.sidebar.sidebarSize.description",key:"sidebarSize",options:["tiny","small","normal","large"],default:"normal",onChange:()=>{Yp.getApp().then((e=>e.windowResize.dispatch()))}})),e.addControl(new Co({category:"sidebar",name:"windows.settings.sidebar.shrinkSidebarElements.name",description:"windows.settings.sidebar.shrinkSidebarElements.description",key:"hideElements"})),e.addControl(new zr({category:"developers",name:"windows.settings.developer.simulateOS.name",description:"windows.settings.developer.simulateOS.description",key:"simulateOS",options:["auto","win32","darwin","linux"],default:"auto"})),e.addControl(new Qr({category:"developers",name:"windows.settings.developer.devMode.name",description:"windows.settings.developer.devMode.description",key:"isDevMode"}));const t=await Yp.getApp().then((e=>e.locales));e.addControl(new ro({category:"general",name:"windows.settings.general.language.name",description:"windows.settings.general.language.description",key:"locale",get options(){return t.getLanguages().map((e=>({text:e[1],value:e[0]})))},default:t.getCurrentLanguage(),onChange:e=>{t.selectLanguage(e)}})),e.addControl(new Qr({category:"general",name:"windows.settings.general.collaborativeMode.name",description:"windows.settings.general.collaborativeMode.description",key:"fullLightningCacheRefresh",default:!0})),e.addControl(new Qr({category:"general",name:"windows.settings.general.packSpider.name",description:"windows.settings.general.packSpider.description",key:"enablePackSpider",default:!1})),e.addControl(new Qr({category:"general",name:"windows.settings.general.formatOnSave.name",description:"windows.settings.general.formatOnSave.description",key:"formatOnSave",default:!0})),e.addControl(new Qr({category:"general",name:"windows.settings.general.openLinksInBrowser.name",description:"windows.settings.general.openLinksInBrowser.description",key:"openLinksInBrowser",default:!1})),e.addControl(new Qr({category:"general",name:"windows.settings.general.restoreTabs.name",description:"windows.settings.general.restoreTabs.description",key:"restoreTabs",default:!0})),e.addControl(new Qr({category:"general",name:"windows.settings.general.openProjectChooserOnAppStartup.name",description:"windows.settings.general.openProjectChooserOnAppStartup.description",key:"openProjectChooserOnAppStartup",default:!1})),Ie||e.addControl(new ho({category:"general",name:"windows.settings.general.resetBridgeFolder.name",description:"windows.settings.general.resetBridgeFolder.description",onClick:async()=>{await w("bridgeBaseDir"),await w("comMojangDirectory"),location.reload()}})),e.addControl(new Qr({category:"audio",name:"windows.settings.audio.volume.name",description:"windows.settings.audio.volume.description",key:"playAudio",default:!1,onChange:e=>{Yp.audioManager.isMuted=!e}})),e.addControl(new ro({category:"editor",name:"windows.settings.editor.jsonEditor.name",description:"windows.settings.editor.jsonEditor.description",key:"jsonEditor",options:[{text:"Tree Editor",value:"treeEditor"},{text:"Raw Text",value:"rawText"}],default:"rawText"})),e.addControl(new Qr({category:"editor",name:"windows.settings.editor.bracketPairColorization.name",description:"windows.settings.editor.bracketPairColorization.description",key:"bracketPairColorization",default:!1,onChange:async e=>{(await Yp.getApp()).projectManager.updateAllEditorOptions({"bracketPairColorization.enabled":e})}})),e.addControl(new Qr({category:"editor",name:"windows.settings.editor.wordWrap.name",description:"windows.settings.editor.wordWrap.description",key:"wordWrap",default:!1,onChange:async e=>{(await Yp.getApp()).projectManager.updateAllEditorOptions({wordWrap:e?"bounded":"off"})}})),e.addControl(new ro({category:"editor",name:"windows.settings.editor.wordWrapColumns.name",description:"windows.settings.editor.wordWrapColumns.description",key:"wordWrapColumns",default:"80",options:["40","60","80","100","120","140","160"],onChange:async e=>{(await Yp.getApp()).projectManager.updateAllEditorOptions({wordWrapColumn:Number(e)})}})),e.addControl(new Qr({category:"editor",name:"windows.settings.editor.compactTabDesign.name",description:"windows.settings.editor.compactTabDesign.description",key:"compactTabDesign",default:!0})),e.addControl(new Qr({category:"editor",name:"windows.settings.editor.automaticallyOpenTreeNodes.name",description:"windows.settings.editor.automaticallyOpenTreeNodes.description",key:"automaticallyOpenTreeNodes",default:!0})),e.addControl(new Qr({category:"editor",name:"windows.settings.editor.dragAndDropTreeNodes.name",description:"windows.settings.editor.dragAndDropTreeNodes.description",key:"dragAndDropTreeNodes",default:!0})),e.addControl(new To({category:"projects",name:"windows.settings.projects.defaultAuthor.name",description:"windows.settings.projects.defaultAuthor.description",key:"defaultAuthor",default:""}));const i=await Yp.getApp();Object.values(i.actionManager.state).forEach((t=>{"action"===t.type&&e.addControl(new to(t))}))}(this),this.sidebar.setDefaultSelected()}addCategory(e,t,i){void 0===Re[e]&&(Re[e]={}),this.sidebar.addElement(new br({color:"primary",text:t,icon:i,id:e}),[])}addControl(e){const t=this.sidebar.state[e.config.category];if(!t)throw new Error(`Undefined settings category: ${e.config.category}`);t.push(e)}static async saveSettings(e){e||(e=await Yp.getApp()),await e.fileSystem.writeJSON("data/settings.json",Re)}static async loadSettings(e){try{!function(e){for(const t in e)S(Re,t,e[t])}(await e.fileSystem.readJSON("data/settings.json"))}catch{}finally{this.loadedSettings.dispatch(Re)}}async open(){Yp.audioManager.playAudio("click5.ogg",1),this.isVisible||(this.sidebar.removeElements(),await this.setup(),super.open())}async close(){Yp.audioManager.playAudio("click5.ogg",1),super.close();const e=await Yp.getApp();e.windows.loadingWindow.open(),await Fo.saveSettings(),e.windows.loadingWindow.close()}};let Do=Fo;d(Do,"loadedSettings",new Ce);const Oo={};var Mo=Le({name:"Dropdown",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],setup:()=>({pointerDevice:Ss}),data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()},onConfirm(){this.currentWindow.confirm()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:e.$data.title,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,isPersistent:!e.$data.isClosable,hasCloseButton:!1,width:440,height:140},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("v-select",{staticClass:"mt-4",attrs:{autofocus:"mouse"===e.pointerDevice,outlined:"",dense:"",items:e.$data.options,"background-color":"background"},model:{value:e.$data.currentSelection,callback:function(t){e.$set(e.$data,"currentSelection",t)},expression:"$data.currentSelection"}})]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary",disabled:""===e.$data.currentSelection},on:{click:e.onConfirm}},[i("v-icon",[e._v("mdi-check")]),i("span",[e._v(e._s(e.t("general.confirm")))])],1)]},proxy:!0}],null,!1,3980933220)}):e._e()}),[],!1,$o,null,null,null);function $o(e){for(let t in Oo)this[t]=Oo[t]}var Io=function(){return Mo.exports}();class Ro extends Je{constructor(e){super(Io,!0,!1),d(this,"currentSelection"),this.opts=e,this.currentSelection=e.default,this.defineWindow(),this.open()}get title(){return this.opts.name}get options(){return this.opts.options}get placeholder(){return this.opts.placeholder}get isClosable(){return this.opts.isClosable}async confirm(){var e;Yp.audioManager.playAudio("click5.ogg",1),"function"==typeof this.opts.onConfirm&&await this.opts.onConfirm(this.currentSelection),super.close(null!=(e=this.currentSelection)?e:null)}}const Wo={};var No=Le({name:"Input",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],setup:()=>({pointerDevice:Ss}),data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close(null),this.currentWindow.inputValue=""},onConfirm(){this.currentWindow.confirm(),this.currentWindow.inputValue=""}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:e.$data.title,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,width:440,height:120},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("div",{staticClass:"d-flex justify-center align-center"},[i("v-text-field",{staticClass:"mr-2",attrs:{label:e.t(e.$data.label),outlined:"",dense:"",autofocus:"mouse"===e.pointerDevice,"hide-details":""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onConfirm(t)}},model:{value:e.$data.inputValue,callback:function(t){e.$set(e.$data,"inputValue",t)},expression:"$data.inputValue"}}),""!==e.$data.expandText?i("span",{staticClass:"expand-text text--secondary"},[e._v(" "+e._s(e.$data.expandText)+" ")]):e._e()],1)]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary",disabled:""===e.$data.inputValue},on:{click:e.onConfirm}},[i("v-icon",[e._v("mdi-check")]),i("span",[e._v(e._s(e.t("general.confirm")))])],1)]},proxy:!0}],null,!1,3968493615)}):e._e()}),[],!1,Bo,null,null,null);function Bo(e){for(let t in Wo)this[t]=Wo[t]}var Lo=function(){return No.exports}();class Ho extends Je{constructor(e){var t;super(Lo,!0,!1),d(this,"inputValue"),this.opts=e,this.inputValue=null!=(t=e.default)?t:"",super.defineWindow(),super.open()}get title(){return this.opts.name}get label(){return this.opts.label}get expandText(){return this.opts.expandText}async confirm(){var e;Yp.audioManager.playAudio("click5.ogg",1);const t=this.inputValue+(null!=(e=this.expandText)?e:"");"function"==typeof this.opts.onConfirm&&await this.opts.onConfirm(t),super.close(t)}}let Vo;class zo extends xe{constructor(e,t){super(),d(this,"id",h()),d(this,"type","category"),d(this,"shouldRender",!0),d(this,"isVisible",!1),d(this,"state",j({})),d(this,"disposables",{}),this.icon=e,this.name=t}setShouldRender(e){this.shouldRender=e}addItem(e){return S(this.state,e.id,e),this.disposables[e.id]=e.on((()=>this.trigger())),this}disposeItem(e){var t;x(this.state,e.id),null==(t=this.disposables[e.id])||t.dispose(),this.disposables[e.id]=void 0}trigger(){this.isVisible=!1,this.dispatch()}dispose(){Yp.toolbar.disposeCategory(this)}}const Uo={};var Go=Le({name:"ThreePreviewTab",props:{tab:Object},activated(){this.tab.receiveCanvas(this.$refs.canvas)},mounted(){this.tab.receiveCanvas(this.$refs.canvas)},watch:{"tab.uuid"(){this.tab.receiveCanvas(this.$refs.canvas)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{position:"relative"}},[i("div",{staticStyle:{width:"100%",height:"100%"},on:{click:function(t){return e.tab.parent.setActive(!0)}}},[i("canvas",{ref:"canvas"})])])}),[],!1,Jo,null,null,null);function Jo(e){for(let t in Uo)this[t]=Uo[t]}var qo=function(){return Go.exports}();class Ko extends Nn{constructor(e,t){super(t),d(this,"isForeignFile",!0),this.tab=e,this.onCreate()}static is(){return!1}onCreate(){}async onActivate(){this.onChange(),this.isActive=!0}get name(){return`${this.parent.app.locales.translate("preview.name")}: ${this.tab.name}`}save(){}getFile(){return this.tab.getFile()}}class Qo extends Ko{constructor(){super(...arguments),d(this,"component",qo),d(this,"setupComplete",new Ce),d(this,"disposables",[]),d(this,"canvas"),d(this,"renderer"),d(this,"_camera"),d(this,"controls"),d(this,"_scene"),d(this,"renderingRequested",!1),d(this,"width",0),d(this,"height",0)}get scene(){if(!this._scene)throw new Error("Scene is not defined yet");return this._scene}get camera(){if(!this._camera)throw new Error("Camera is not defined yet");return this._camera}async is(){return!1}async receiveCanvas(e){var t;const i=await Yp.getApp();this.canvas=y(e),this.renderer=y(new V({antialias:!1,canvas:e})),this.renderer.setPixelRatio(window.devicePixelRatio),this._camera||(this._camera=y(new z(70,2,.1,1e3)),this._camera.position.x=-16,this._camera.position.y=16,this._camera.position.z=-16),null==(t=this.controls)||t.dispose(),this.controls=y(new U(this.camera,e)),this.controls.addEventListener("change",(()=>{this.requestRendering(),this.parent.isActive||this.parent.setActive(!0)})),this._scene||(this._scene=y(new G),this._scene.add(new J(16777215))),this._scene.background=new q(i.themeManager.getColor("background")),this.disposables.push(i.windowResize.on((()=>setTimeout((()=>this.onResize()))))),this.onResize(),this.setupComplete.dispatch()}async onActivate(){await this.setupComplete.fired,await super.onActivate();const e=await Yp.getApp();this.disposables.push(e.themeManager.on((()=>{const t=e.themeManager.getColor("background");this.scene.background=new q(t),this.requestRendering()})))}onDeactivate(){var e,t,i;this.setupComplete.resetSignal(),null==(e=this.controls)||e.dispose(),null==(t=this.renderer)||t.resetState(),null==(i=this.renderer)||i.dispose(),this.renderer=void 0,this.controls=void 0,super.onDeactivate()}render(){var e,t;null==(e=this.controls)||e.update(),null==(t=this.renderer)||t.render(this.scene,this.camera),this.renderingRequested=!1}requestRendering(e=!1){if(e)return this.render();this.renderingRequested||(this.renderingRequested=!0,requestAnimationFrame((()=>this.render())))}onResize(){var e,t,i,n,s;const a=null==(t=null==(e=this.canvas)?void 0:e.parentElement)?void 0:t.getBoundingClientRect();this.width=null!=(i=null==a?void 0:a.width)?i:0,this.height=null!=(n=null==a?void 0:a.height)?n:0,null==(s=this.renderer)||s.setSize(this.width,this.height,!0),this.camera&&(this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()),this.requestRendering()}async toOtherTabSystem(e){await super.toOtherTabSystem(e),await this.setupComplete.fired,this.onResize()}}function Xo({isGlobal:e,func:t,disposables:i,app:n}){e?i.push(n.projectManager.forEachProject(t)):t(n.project)}class Zo{constructor(e){this.config=e}get displayData(){return{icon:this.config.icon,name:this.config.name}}isDisabled(){if("function"==typeof this.config.isDisabled)return this.config.isDisabled()}export(){if("function"==typeof this.config.export)return this.config.export()}}const Yo={},el=new Map([["@bridge/ui",({uiStore:e})=>c(l({},null==e?void 0:e.UI),{BuiltIn:{BaseWindow:St,SidebarWindow:Mr}})],["@bridge/sidebar",({disposables:e})=>({SidebarContent:fr,create(t){var i,n,s;const a=wr(c(l({},t),{isVisible:!t.id||(null==(s=null==(n=null==(i=null==Re?void 0:Re.sidebar)?void 0:i.sidebarElements)?void 0:n[t.id])||s)}));return t.id&&Do.loadedSettings.once((e=>{var i,n,s;a.isVisible=null==(s=null==(n=null==(i=null==e?void 0:e.sidebar)?void 0:i.sidebarElements)?void 0:n[t.id])||s})),e.push(a),a},getSelected(){throw new Error("This function no longer works with bridge. v2")},onChange(){throw new Error("This function no longer works with bridge. v2")},select(){throw new Error("This function no longer works with bridge. v2")}})],["@bridge/notification",({disposables:e})=>({create(t){const i=Et(t);return e.push(i),i},createError(t){const i=Dt(t);return e.push(i),i}})],["@bridge/fs",({})=>new Promise((e=>{Yp.ready.once((t=>{const i={};for(const e of Object.getOwnPropertyNames(Object.getPrototypeOf(t.fileSystem)))"constructor"!==e&&"function"==typeof t.fileSystem[e]&&(i[e]=t.fileSystem[e].bind(t.fileSystem));e(i)}))}))],["@bridge/path",()=>On],["@bridge/env",({})=>({APP_VERSION:"2.1.5",getCurrentBP:()=>`projects/${Yp.instance.selectedProject}/BP`,getCurrentRP:()=>`projects/${Yp.instance.selectedProject}/RP`,getCurrentProject:()=>`projects/${Yp.instance.selectedProject}`,getProjectPrefix:()=>Yp.getApp().then((e=>e.projectConfig.get().namespace)),getProjectTargetVersion:()=>Yp.getApp().then((e=>e.projectConfig.get().targetVersion)),getProjectAuthor:()=>Yp.getApp().then((e=>e.projectConfig.get().author)),getContext:()=>(console.warn("This API is deprecated!"),{})})],["@bridge/project",async({disposables:e,isGlobal:t})=>{const i=await Yp.getApp();return{hasPacks:e=>i.project.hasPacks(e),registerExporter(n){t?i.projectManager.forEachProject((t=>{e.push(t.exportProvider.register(new Zo(n)))})):e.push(i.project.exportProvider.register(new Zo(n)))},async compile(e){await i.project.compilerManager.start(e,"build")},async compileFiles(e){await i.project.updateFiles(e)},async unlinkFile(e){await i.project.unlinkFile(e)}}}],["@bridge/globals",async({})=>{try{if(void 0===Vo)return new Promise((e=>{Yp.ready.once((async t=>{Vo=await t.fileSystem.readJSON(`projects/${t.selectedProject}/globals.json`),e(Vo)}))}))}catch{return{}}return l({},Vo)}],["@bridge/utils",({})=>({openExternal:e=>window.open(e,"_blank")})],["@bridge/file-importer",({disposables:e})=>{throw new Error("Module not yet supported on bridge. v2")}],["@bridge/fetch-definition",({})=>({fetchDefinition:async(e,t,i,n=!1)=>{var s;const a=null==(s=(await Yp.getApp()).project)?void 0:s.packIndexer;if(!a)return[];return(await Promise.all(t.map((t=>{var s,r;return null!=(r=null==(s=a.service)?void 0:s.find(e,t,[i],n))?r:[]})))).flat()}})],["@bridge/windows",({})=>({BaseWindow:Je,createWindow:(e,t)=>(console.warn('[@bridge/windows] Calling "createWindow" is deprecated. Please replace direct function calls by defining a class based window instead.'),function(e,t={},i=!0,n=(()=>{})){const s={};s.done=new Promise((e=>{s.setDone=e}));const a=h(),r=j(Object.assign(t,{isVisible:!1,shouldRender:!1})),o={component:e,getState:()=>r,close:()=>{n(),r.isVisible=!1,setTimeout((()=>{r.shouldRender=!1,i&&o.dispose()}),600)},open:()=>{r.shouldRender=!0,r.isVisible=!0},dispose:()=>x(Yp.windowState.state,a),status:s,get isVisible(){return r.isVisible}};return S(Yp.windowState.state,a,o),o}(e,t)),createInformationWindow:(e,t)=>new Pt({name:e,description:t}),createInputWindow:(e,t,i,n,s)=>new Ho({name:e,label:t,default:i,expandText:s,onConfirm:n}),createDropdownWindow:(e,t,i,n,s)=>new Ro({name:e,default:n,options:i,placeholder:t,onConfirm:s}),createConfirmWindow:(e,t,i,n,s)=>new vo({description:e,confirmText:t,cancelText:i,onConfirm:n,onCancel:s})})],["@bridge/toolbar",async({disposables:e})=>({ToolbarCategory:zo,actionManager:(await Yp.getApp()).actionManager,addCategory(t){Yp.toolbar.addCategory(t),e.push(t)}})],["@bridge/compare-versions",()=>({compare:N.exports.compare})],["@bridge/monaco",({disposables:e})=>({registerDocumentFormattingEditProvider:(t,i)=>{e.push(_.registerDocumentFormattingEditProvider(t,i))}})],["@bridge/json5",()=>({parse:e=>T.parse(e)})],["@bridge/com-mojang",async({})=>{const e=await Yp.getApp();return{setup:e.comMojang.setup,requestFileSystem:async()=>{const t={};for(const i of Object.getOwnPropertyNames(Object.getPrototypeOf(e.comMojang.fileSystem)))"constructor"!==i&&"function"==typeof e.comMojang.fileSystem[i]&&(t[i]=e.comMojang.fileSystem[i].bind(e.comMojang.fileSystem));return t}}}],["@bridge/tab",async({disposables:e})=>({ContentTab:Nn,FileTab:Bn,ThreePreviewTab:Qo,register:t=>{const i=Ea.register(t);return e.push(i),i},openTab:async(e,t=!1)=>{var i,n,s;const a=(await Yp.getApp()).project;if(t){const t=new e(a.inactiveTabSystem);return null==(i=a.inactiveTabSystem)||i.add(t,!0),null==(n=a.inactiveTabSystem)||n.setActive(!0),t}{const t=new e(a.tabSystem);return null==(s=a.tabSystem)||s.add(t,!0),t}},openFilePath:async(e,t=!1)=>{const i=(await Yp.getApp()).project,n=await i.fileSystem.getFileHandle(e);await i.openFile(n,{selectTab:t})}})],["@bridge/tab-actions",async({disposables:e,isGlobal:t})=>({addTabActions:async e=>{(await Yp.getApp()).project.tabActionProvider.addTabActions(e)},register:async i=>{Xo({app:await Yp.getApp(),disposables:e,isGlobal:t,func:t=>{e.push(t.tabActionProvider.register(i))}})},registerPreview:async i=>{Xo({app:await Yp.getApp(),disposables:e,isGlobal:t,func:t=>{e.push(t.tabActionProvider.registerPreview(i))}})}})],["@bridge/theme",async({disposables:e})=>{const t=await Yp.getApp(),i=t.themeManager;return{onChange:t=>{const n=i.on(t);return e.push(n),n},getCurrentMode:()=>t.themeManager.getCurrentMode(),getColor:e=>i.getColor(e),getHighlighterInfo:e=>i.getHighlighterInfo(e)}}],["@bridge/three",()=>{return e=()=>import("./vendor.52db306a.js").then((function(e){return e.ae})),(t=["assets/vendor.52db306a.js","assets/vendor.a8e7d3ec.css"])&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in Yo)return;Yo[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${i}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e())):e();var e,t}]]);function tl(e=[],t,i=!1){return function(e=[],t,i=!1,n=el){return async s=>{const a=n.get(s);if(a)return await a({uiStore:t,disposables:e,isGlobal:i})}}(e,t,i)}async function il(e,t,i,n=!1){for await(const s of e.values())if("directory"===s.kind)await il(s,t,i,n);else if("file"===s.kind){const e=await s.getFile();await nl(await e.text(),{uiStore:t,disposables:i,isGlobal:n,language:s.name.endsWith(".ts")?"typeScript":"javaScript"})}}function nl(e,{uiStore:t,disposables:i,language:n,isGlobal:s=!1}){return ss({async:!0,script:e,language:n,env:{require:tl(i,t,s)}})}async function sl(e,t,i,n="ui"){let s=[];try{s=await e.readdir(n,{withFileTypes:!0})}catch{}await Promise.all(s.map((s=>"file"===s.kind?async function(e,t,i,n){if(".vue"!==An(t))return void Dt(new Error(`NOT A VUE FILE: Provided UI file "${Tn(t)}" is not a vue file!`));const s=new Promise((async(s,a)=>{var r,o,c,d;const{template:p,script:h,styles:m,errors:g}=K.parseComponent(await(await e.readFile(t)).text());if(g.length>0)return g.forEach((e=>Dt(e))),a(g[0]);const f=l(l({name:Tn(t)},await nl(null!=(o=null==(r=null==h?void 0:h.content)?void 0:r.replace("export default","return"))?o:"",{uiStore:i,disposables:n})),u.compile(null!=(c=null==p?void 0:p.content)?c:'<p color="red">NO TEMPLATE DEFINED</p>'));f.components=Object.assign(null!=(d=f.components)?d:{},Q),m.forEach((e=>n.push(function(e){const t=document.createElement("style");return t.innerHTML=e,document.head.appendChild(t),{dispose:()=>{document.head.contains(t)&&document.head.removeChild(t)}}}(e.content)))),s(f)}));i.set(t.replace("ui/","").split("/"),(()=>s))}(e,`${n}/${s.name}`,t,i):sl(e,t,i,`${n}/${s.name}`))))}class al{constructor(e,t){d(this,"icon"),d(this,"text"),d(this,"color"),this.parent=e,this.icon=this.parent.getTagIcon(t),this.text=t,this.color=this.parent.getTagColor(t)}getText(){return this.text}asSidebarElement(){return new br({id:this.text.toLowerCase(),text:this.text,color:this.color,icon:this.icon})}}class rl{constructor(e,t,i=!1){d(this,"tags"),d(this,"isLoading",!1),d(this,"_isInstalled",!1),d(this,"isUpdateAvailable",!1),d(this,"connected"),d(this,"showMenu",!1),d(this,"isActive",!0),this.parent=e,this.config=t,this.isLocalOnly=i,this.tags=this.config.tags.map((e=>(this.parent.tags[e]||(this.parent.tags[e]=new al(this.parent,e)),this.parent.tags[e]))).sort(((e,t)=>e.getText().localeCompare(t.getText())))}get author(){return this.config.author}get name(){return this.config.name}get version(){return this.config.version}get description(){return this.config.description}get icon(){return this.config.icon}get id(){return this.config.id}get releaseTimestamp(){var e;return null!=(e=this.config.releaseTimestamp)?e:Date.now()}get isInstalled(){return this._isInstalled}get displayVersion(){var e,t;return null!=(t=null==(e=this.connected)?void 0:e.version)?t:this.config.version}get actions(){return e=this,[new Ke({name:"windows.extensionStore.deleteExtension",icon:"mdi-delete",onTrigger:()=>{e.delete(),e.closeActionMenu()}}),new Ke({name:"windows.extensionStore."+(e.isActive?"deactivateExtension":"activateExtension"),icon:e.isActive?"mdi-close":"mdi-check",onTrigger:()=>{e.setActive(!e.isActive),e.closeActionMenu()}})];var e}get extension(){return this.connected}get isGlobal(){var e,t;return null!=(t=null==(e=this.connected)?void 0:e.isGlobal)&&t}hasTag(e){return this.tags.includes(e)}async download(e){if(void 0!==e)return this.downloadExtension(e);const t=new Xa("windows.pluginInstallLocation.title"),i=await t.actionManager;i.create({icon:"mdi-folder-multiple-outline",name:"actions.pluginInstallLocation.global.name",description:"actions.pluginInstallLocation.global.description",onTrigger:()=>{this.downloadExtension(!0)}}),i.create({icon:"mdi-folder-outline",name:"actions.pluginInstallLocation.local.name",description:"actions.pluginInstallLocation.local.description",onTrigger:()=>{this.downloadExtension(!1)}})}async downloadExtension(e,t=!1){var i,n;this.isLoading=!0;const s=await Yp.getApp(),a=await fetch(this.parent.getBaseUrl()+this.config.link).then((e=>e.arrayBuffer())),r=e?"extensions":`projects/${s.selectedProject}/.bridge/extensions`,o=e?s.extensionLoader:s.project.extensionLoader,l=r+`/${this.name.replace(/\s+/g,"")}.zip`;await s.fileSystem.writeFile(l,a);try{await s.fileSystem.unlink(l.replace(".zip",""))}catch{}for(const d of null!=(i=this.config.dependencies)?i:[]){const t=this.parent.getExtensionById(d);t&&(t.isInstalled?!t.isActive&&t.connected&&(null==(n=t.connected)||n.activate()):await t.downloadExtension(e))}const c=await o.loadExtension(await s.fileSystem.getDirectoryHandle(r),await s.fileSystem.getFileHandle(l),!0);c&&this.setConnected(c),this.setInstalled(),this.isUpdateAvailable=!1,this.isLoading=!1,t||(null==c?void 0:c.contributesCompilerPlugins)&&new vo({title:"windows.extensionStore.compilerPluginDownload.title",description:"windows.extensionStore.compilerPluginDownload.description",cancelText:"general.later",confirmText:"windows.extensionStore.compilerPluginDownload.openConfig",onConfirm:async()=>{this.parent.close();const e=(await Yp.getApp()).project;e.config.get().compiler?await e.openFile(await e.fileSystem.getFileHandle("config.json")):await e.openFile(await e.fileSystem.getFileHandle(".bridge/compiler/default.json"))}}),Yp.audioManager.playAudio("confirmation_002.ogg",1)}async update(e=!0){this.connected&&(e&&this.parent.updateInstalled(this),this.connected.deactivate(),await this.connected.resetInstalled(),await this.downloadExtension(this.connected.isGlobal,!0))}delete(){var e;this.connected&&(null==(e=this.connected)||e.delete(),this.parent.delete(this),this._isInstalled=!1)}setInstalled(){this._isInstalled=!0,this.parent.addInstalledExtension(this)}setIsUpdateAvailable(){this.isUpdateAvailable=!0}setConnected(e){var t;this.connected=e,this.isActive=null==(t=this.connected)?void 0:t.isActive}setActive(e){if(Yp.audioManager.playAudio("click5.ogg",1),!this.connected)throw new Error("No extension connected to ExtensionViewer");this.connected.setActive(e),this.isActive=e}closeActionMenu(){Yp.audioManager.playAudio("click5.ogg",1),this.showMenu=!1}}class ol{constructor(e,t){this.fileSystem=e,this.contributeFiles=t}async execute(e){const t=Yp.instance;for(const[i,n]of Object.entries(this.contributeFiles)){const s=e?t.projects:[t.project];if(await this.fileSystem.fileExists(i)){const e=await this.fileSystem.readFile(i);for(const t of s)await t.fileSystem.writeFile(n,await e.arrayBuffer())}else{if(!(await this.fileSystem.directoryExists(i))){console.warn(`Failed to install files from "${i}": No such file or directory`);continue}await Ba(await this.fileSystem.getDirectoryHandle(i),(async(e,t)=>{for(const i of s){const s=await i.fileSystem.getFileHandle(Pn(n,t),!0);await i.fileSystem.copyFileHandle(e,s)}}))}}}}class ll{constructor(e,t,i,n=!1){var s,a;d(this,"disposables",[]),d(this,"uiStore",function(){let e={},t=h();return{get UI(){return e},set(t,i){let n=e;for(;t.length>1;){const e=t.shift();void 0===n[e]&&(n[e]={}),n=n[e]}const s=t.shift();n[Tn(s,An(s))]=i},dispose(){e=null,t=null}}}()),d(this,"fileSystem"),d(this,"_compilerPlugins",{}),d(this,"isLoaded",!1),d(this,"installFiles"),this.parent=e,this.manifest=t,this.baseDirectory=i,this._isGlobal=n,this.fileSystem=new La(this.baseDirectory),this.installFiles=new ol(this.fileSystem,null!=(a=null!=(s=null==t?void 0:t.contributeFiles)?s:t.install)?a:{})}get isActive(){var e;if(!this.parent.activeStatus)throw new Error("Accessed activeStatus property before the corresponding ActiveClass instance was initialized");return null==(e=this.parent.activeStatus)?void 0:e.isActive(this.manifest.id)}get compilerPlugins(){return this._compilerPlugins}get contributesCompilerPlugins(){var e,t,i;return Object.keys(null!=(i=null==(t=null==(e=this.manifest)?void 0:e.compiler)?void 0:t.plugins)?i:{}).length>0}get version(){return this.manifest.version}get isGlobal(){return this._isGlobal}async activate(){var e,t,i,n;if(this.isLoaded)return;this.isLoaded=!0;const s=await Yp.getApp(),a=(null!=(e=await s.fileSystem.baseDirectory.resolve(this.baseDirectory))?e:[]).join("/");for(const c of null!=(t=this.manifest.dependencies)?t:[])if(!(await this.parent.activate(c)))return void Dt(new Error(`Failed to activate extension "${this.manifest.name}": Failed to load one of its dependencies`));for(const[c,d]of Object.entries(null!=(n=null==(i=this.manifest.compiler)?void 0:i.plugins)?n:{}))this._compilerPlugins[c]=`${a}/${d}`;this.disposables.push(s.windows.createPreset.addPresets(`${a}/presets`));try{await Ba(await this.baseDirectory.getDirectoryHandle("themes"),(e=>s.themeManager.loadTheme(e,this.isGlobal,this.disposables)))}catch{}try{await(r=await this.baseDirectory.getDirectoryHandle("fileDefinitions"),o=this.disposables,Ba(r,(async e=>{const t=await e.getFile(),i=T.parse(await t.text());o.push(Fn.addPluginFileType(i))})))}catch{}var r,o;let l;try{l=await this.baseDirectory.getDirectoryHandle("scripts")}catch{}if(await Promise.all([sl(this.fileSystem,this.uiStore,this.disposables).then((async()=>l?await il(l,this.uiStore,this.disposables,this.isGlobal):void 0))]),await this.fileSystem.directoryExists("snippets")){const e=await this.baseDirectory.getDirectoryHandle("snippets");this.isGlobal?this.disposables.push(s.projectManager.onActiveProject((async t=>{this.disposables.push(...await t.snippetLoader.loadFrom(e))}))):this.disposables.push(...await s.project.snippetLoader.loadFrom(e))}Yp.eventSystem.dispatch("presetsChanged",null),await this.fileSystem.fileExists(".installed")||(await this.installFiles.execute(this.isGlobal),await this.fileSystem.writeFile(".installed",""))}async resetInstalled(){await this.fileSystem.unlink(".installed")}deactivate(){Yp.eventSystem.dispatch("presetsChanged",null),this.disposables.forEach((e=>e.dispose())),this.isLoaded=!1}async delete(){this.deactivate(),this.parent.deleteExtension(this.manifest.id)}async setActive(e){var t;e?await this.activate():this.deactivate(),await(null==(t=this.parent.activeStatus)?void 0:t.setActive(this.manifest.id,e))}forStore(e){const t=new rl(e,this.manifest,!0);return t.setInstalled(),t.setConnected(this),t}async installFilesToCurrentProject(){await this.installFiles.execute(!1)}}class cl extends Ce{constructor(e,t){super(),d(this,"inactiveExtensions",new Set),this.fileSystem=e,this.savePath=t,this.loadFile().finally((()=>this.dispatch()))}async loadFile(){try{this.inactiveExtensions=new Set(await this.fileSystem.readJSON(this.savePath))}catch{}}async save(){await this.fileSystem.writeJSON(this.savePath,[...this.inactiveExtensions])}async setActive(e,t){t?this.inactiveExtensions.delete(e):this.inactiveExtensions.add(e),await this.save()}isActive(e){return!this.inactiveExtensions.has(e)}}class dl extends Ce{constructor(e,t,i,n=!1){super(),d(this,"_extensions",new Map),d(this,"extensionPaths",new Map),d(this,"_loadedInstalledExtensions",new Ce(2)),d(this,"activeStatus"),this.fileSystem=e,this.loadExtensionsFrom=t,this.saveInactivePath=i,this.isGlobal=n}get extensions(){return this._extensions}async loadActiveExtensions(){this.activeStatus=new cl(this.fileSystem,this.saveInactivePath),await this.activeStatus.fired}async getInstalledExtensions(){return await this.fired,new Map(this.extensions.entries())}async loadExtensions(e=this.loadExtensionsFrom){const t=await this.fileSystem.getDirectoryHandle(e,{create:!0});await this.loadActiveExtensions();const i=[];for await(const n of t.values())".DS_Store"!==n.name&&i.push(this.loadExtension(t,n,!1));await Promise.all(i),this._loadedInstalledExtensions.dispatch();for(const[n,s]of this._extensions)s.isActive&&await s.activate();this.dispatch()}async loadExtension(e,t,i=!1){let n;return"file"===t.kind&&t.name.endsWith(".zip")?(n=await this.unzipExtension(t,await e.getDirectoryHandle(t.name.replace(".zip",""),{create:!0})),await e.removeEntry(t.name)):"directory"===t.kind&&(n=await this.loadManifest(t)),i&&n&&await n.activate(),n}async unzipExtension(e,t){const i=new La(t),n=await e.getFile(),s=await new Promise((async(e,t)=>X(new Uint8Array(await n.arrayBuffer()),((i,n)=>{i?t(i):e(n)}))));for(const a in s)a.startsWith(".")||(a.endsWith("/")?await i.mkdir(a.slice(0,-1),{recursive:!0}):await i.writeFile(a,s[a]));return await this.loadManifest(t)}async loadManifest(e){var t;let i;try{i=await e.getFileHandle("manifest.json")}catch{return}const n=await i.getFile(),s=await n.text().then((e=>JSON.parse(e)));if(s.id){const t=new ll(this,s,e,this.isGlobal);return this._extensions.set(s.id,t),this.extensionPaths.set(s.id,`${this.loadExtensionsFrom}/${e.name}`),t}Dt(new Error(`Failed to load extension "${null!=(t=s.name)?t:e.name}": Invalid extension ID`))}async activate(e){const t=await this.extensions.get(e);return t?(t.isActive||await t.activate(),!0):(Dt(new Error(`Failed to activate extension with ID "${e}": Extension not found`)),!1)}deactiveAll(e=!1){for(const[t,i]of this._extensions)i.deactivate(),e&&this._extensions.delete(t)}disposeAll(){this.deactiveAll(!0),this.resetSignal()}deleteExtension(e){const t=this.extensionPaths.get(e);t&&(this.fileSystem.unlink(t),this.extensionPaths.delete(e),this.extensions.delete(e))}mapActive(e){const t=[];for(const i of this._extensions.values())i.isActive&&t.push(e(i));return t}}class ul{constructor(e=[],t=!1){d(this,"events",new Map),d(this,"any",new xe),this.autoCleanEmptyDispatchers=t,e.forEach((e=>this.create(e)))}create(e){if(void 0!==this.events.get(e))throw new Error(`Dispatcher for event "${e}" is already defined.`);return this.events.set(e,new xe),{dispose:()=>{this.events.delete(e)}}}hasEvent(e){return this.events.has(e)}getDispatcher(e){const t=this.events.get(e);if(void 0===t)throw new Error(`No dispatcher defined for event "${e}".`);return t}dispatch(e,t){return this.any.dispatch([e,t]),this.getDispatcher(e).dispatch(t)}on(e,t){const i=this.getDispatcher(e),n=i.on(t);return{dispose:()=>{n.dispose(),this.autoCleanEmptyDispatchers&&!i.hasListeners&&this.events.delete(e)}}}off(e,t){const i=this.getDispatcher(e);i.off(t),this.autoCleanEmptyDispatchers&&!i.hasListeners&&this.events.delete(e)}once(e,t){const i=this.getDispatcher(e);i.once((n=>{t(n),this.autoCleanEmptyDispatchers&&!i.hasListeners&&this.events.delete(e)}))}}class pl extends ul{constructor(){super([],!0)}dispatch(e,t){this.hasEvent(e)?super.dispatch(e,t):this.any.dispatch([e,t])}on(e,t){return this.hasEvent(e)||this.create(e),super.on(e,t)}}class hl{constructor(){d(this,"definitions",new Set),d(this,"processedFileTabs",new Set)}register(e){return this.definitions.add(e),this.processedFileTabs.forEach((t=>{e.isFor(t)&&t.addAction(new Ke({icon:e.icon,name:e.name,isDisabled:()=>{var i,n;return null!=(n=null==(i=e.isDisabled)?void 0:i.call(e,t))&&n},onTrigger:()=>e.trigger(t)}))})),{dispose:()=>{this.definitions.delete(e),this.processedFileTabs.forEach((t=>{e.isFor(t)&&(t.clearActions(),this.addTabActions(t))}))}}}registerPreview(e){return this.register({icon:"mdi-play",name:e.name,isFor:t=>t instanceof Bn&&t.getProjectPath().startsWith(e.fileMatch),trigger:async t=>{var i,n;const s=await Yp.getApp(),a=await e.createPreview(s.project.inactiveTabSystem,t);a&&(a.isTemporary=!1,t.connectedTabs.push(a),null==(i=s.project.inactiveTabSystem)||i.add(a,!0),null==(n=s.project.inactiveTabSystem)||n.setActive(!0))}})}async addTabActions(e){this.processedFileTabs.add(e),e.onClose.on((()=>this.processedFileTabs.delete(e)));for(const t of this.definitions)await t.isFor(e)&&e.addAction(new Ke({icon:t.icon,name:t.name,onTrigger:()=>t.trigger(e)}))}}class ml{constructor({name:e,description:t,fileTypes:i,locations:n,data:s,targetFormatVersion:a}){d(this,"name"),d(this,"description"),d(this,"fileTypes"),d(this,"locations"),d(this,"data"),d(this,"minTargetFormatVersion"),d(this,"maxTargetFormatVersion"),this.name=e,this.description=t,this.fileTypes=new Set(i),this.locations=null!=n?n:[],this.data=s,this.minTargetFormatVersion=null==a?void 0:a.min,this.maxTargetFormatVersion=null==a?void 0:a.max}get displayData(){return{name:this.name,description:this.description}}get insertData(){return[this.name,this.data]}get insertText(){return"string"==typeof this.data?this.data:Array.isArray(this.data)?this.data.join("\n"):JSON.stringify(this.data,null,"\t").slice(1,-1).replaceAll("\n\t","\n").trim()}isValid(e,t,i){return("string"!=typeof e||(!this.minTargetFormatVersion||N.exports.compare(e,this.minTargetFormatVersion,">="))&&(!this.maxTargetFormatVersion||N.exports.compare(e,this.maxTargetFormatVersion,"<=")))&&this.fileTypes.has(t)&&(0===this.locations.length||this.locations.some((e=>i.some((t=>e===t||""!==e&&kn(t,e))))))}}_.registerCompletionItemProvider("json",{provideCompletionItems:async(e,t)=>{var i;const n=await Yp.getApp(),s=is(e,t),a=null==(i=n.project.tabSystem)?void 0:i.selectedTab;if(!(a instanceof Bn))return{suggestions:[]};const r=a.getFileType();let o;try{o=T.parse(e.getValue())}catch{o={}}const l=o.format_version||n.project.config.get().targetVersion||await ja();return{suggestions:n.project.snippetLoader.getSnippetsFor(l,r,[s]).map((e=>({kind:_.CompletionItemKind.Snippet,label:e.displayData.name,documentation:e.displayData.description,insertText:e.insertText,insertTextRules:_.CompletionItemInsertTextRule.InsertAsSnippet})))}}});const gl={provideCompletionItems:async(e,t)=>{var i;const n=await Yp.getApp(),s=null==(i=n.project.tabSystem)?void 0:i.selectedTab;if(!(s instanceof Bn))return{suggestions:[]};const a=s.getFileType(),r=n.project.config.get().targetVersion||await ja();return{suggestions:n.project.snippetLoader.getSnippetsFor(r,a,[]).map((e=>({kind:_.CompletionItemKind.Snippet,label:e.displayData.name,documentation:e.displayData.description,insertText:e.insertText,insertTextRules:_.CompletionItemInsertTextRule.InsertAsSnippet})))}}};["mcfunction","molang","javascript","typescript"].forEach((e=>_.registerCompletionItemProvider(e,gl)));class fl{constructor(e){d(this,"snippets",new Set),this.project=e}async activate(){const e=await Yp.getApp(),t=await e.project.getCurrentDataPackage(),i=await t.getDirectoryHandle("snippet",{create:!0});await this.loadFrom(i)}async loadFrom(e){const t=[];return await Ba(e,(async(e,i)=>{let n;try{n=T.parse(await e.getFile().then((e=>e.text())))}catch(s){return void console.error(`Invalid JSON within snippet "${i}"`)}t.push(this.addSnippet(new ml(n)))})),t}async deactivate(){this.snippets.clear()}addSnippet(e){return this.snippets.add(e),{dispose:()=>{this.snippets.delete(e)}}}getSnippetsFor(e,t,i){return[...this.snippets].filter((n=>n.isValid(e,t,i)))}}class wl{constructor(){d(this,"exports",new Set)}register(e){return this.exports.add(e),{dispose:()=>this.exports.delete(e)}}async getExporters(){return await Promise.all([...this.exports].map((async e=>c(l({},e.displayData),{isDisabled:await e.isDisabled(),onTrigger:()=>e.export()}))))}}function vl(e){let t=e.map((e=>e.split("/").reverse()));const i=t.map((()=>null)),n=t.map((()=>0));if(!e.every((t=>t.split("/").reverse()[0]===e[0].split("/").reverse()[0])))throw new Error("All files must have the same name");for(;n.some(((e,i)=>e<t[i].length));){const e=t.map(((e,t)=>e[n[t]]));e.every((t=>t===e[0]))||i.forEach(((t,n)=>{null===t&&(i[n]=e[n])})),n.forEach(((e,i)=>{e<t[i].length&&n[i]++}))}return i}function yl(e){if(e["minecraft:geometry"])return e;const t=Object.entries(e).filter((([e,t])=>"string"!=typeof t)),i=[];for(const[n,s]of t)i.push({description:{identifier:n,texture_width:s.texturewidth,texture_height:s.textureheight},bones:s.bones});return{format_version:"1.12.0","minecraft:geometry":i}}class bl extends xe{constructor(e,t){super(),d(this,"fileContent"),d(this,"disposable"),d(this,"children",[]),d(this,"ready",new Ce),this.app=e,this.filePath=t,this.activate(),e.project.getFileFromDiskOrTab(t).then((async e=>{await this.onFileChange(e),await this.setup(e),this.ready.dispatch()}))}async setup(e){}async activate(){void 0===this.disposable&&(this.disposable=this.app.project.fileChange.on(this.filePath,(e=>this.onFileChange(e))))}async requestFile(e){return await this.onFileChange(e),new Promise((e=>{this.once((t=>e(t)))}))}async compileFile(e){await this.app.project.compilerManager.fired;const[t,i]=await this.app.project.compilerManager.compileWithFile(this.filePath,e);return this.children.forEach((e=>e.dispose())),this.children=[],t.forEach((t=>{const i=new kl(this.app,t);this.children.push(i),i.on((()=>this.onFileChange(e)))})),new File([i],e.name)}async onFileChange(e){this.dispatch(await this.compileFile(e))}async getFile(){return this.compileFile(await this.app.project.getFileFromDiskOrTab(this.filePath))}dispose(){var e;null==(e=this.disposable)||e.dispose(),this.disposable=void 0,this.children.forEach((e=>e.dispose()))}}class kl extends xe{constructor(e,t){super(),d(this,"disposable"),this.app=e,this.filePath=t,this.activate()}async activate(){void 0===this.disposable&&(this.disposable=this.app.project.fileSave.on(this.filePath,(e=>this.onFileChange(e))))}async onFileChange(e){this.dispatch()}dispose(){var e;null==(e=this.disposable)||e.dispose(),this.disposable=void 0}}class Sl extends bl{constructor(e,t){super(e,t),this.ready.on((()=>{this.on((e=>this.onChange(e)))}))}async setup(e){return await this.onChange(await this.compileFile(e),!0)}}class xl extends Sl{constructor(e,t,i){super(e.app,t),d(this,"geometryJson",{}),d(this,"selected"),this.parent=e,this.includedGeometryIdentifiers=i}select(e){this.selected=e}async onChange(e,t=!1){try{this.geometryJson=yl(T.parse(await e.text())),t||this.parent.onChange()}catch{}}get includedGeometries(){var e,t,i,n,s;return void 0===this.includedGeometryIdentifiers?null!=(t=null==(e=this.geometryJson)?void 0:e["minecraft:geometry"])?t:[]:null!=(s=null==(n=null==(i=this.geometryJson)?void 0:i["minecraft:geometry"])?void 0:n.filter((({description:e})=>!this.includedGeometryIdentifiers.includes(e.identifier))))?s:[]}get identifiers(){return this.includedGeometries.map((({description:e})=>e.identifier))}get geometry(){return this.includedGeometries.find((({description:e})=>e.identifier===this.selected))}get fallbackGeometry(){return this.includedGeometries[0]}}class Cl extends Sl{constructor(e,t,i){super(e.app,t),d(this,"animationJson",{}),this.parent=e,this.includedAnimationIdentifiers=i}async onChange(e,t=!1){try{this.animationJson=T.parse(await e.text()),t||this.parent.onChange()}catch{}}get includedAnimations(){var e,t;return void 0===this.includedAnimationIdentifiers?Object.entries(null!=(t=null==(e=this.animationJson)?void 0:e.animations)?t:{}):Object.entries(this.animationJson.animations).filter((([e,{description:t}])=>!this.includedAnimationIdentifiers.includes(t.identifier)))}get identifiers(){return this.includedAnimations.map((([e])=>e))}}class jl extends Sl{constructor(e,t,i){super(e.app,i),d(this,"particleData",{}),this.parent=e,this.shortName=t}async onChange(e,t=!1){try{this.particleData=T.parse(await e.text()),t||this.parent.onChange()}catch{}}get identifier(){var e,t,i;return null==(i=null==(t=null==(e=this.particleData)?void 0:e.particle_effect)?void 0:t.description)?void 0:i.identifier}get json(){return this.particleData}}class _l extends Sl{constructor(e,t){super(e.app,t),d(this,"entityData",{}),this.parent=e}async onChange(e,t=!1){try{this.entityData=T.parse(await e.text()),t||this.parent.onChange()}catch{}}findComponent(e){const t=[],i=e=>t.push(e);return[`*/components/${e}`,`*/component_groups/*/${e}`].forEach((e=>Sn(e,this.entityData,i))),t}getSeatBoxHelpers(){var e;const t=this.findComponent("minecraft:rideable"),i={x:12.8,y:28.8,z:12.8};return null==(e=t.map((e=>{var t;return null!=(t=null==e?void 0:e.seats)?t:[]})).flat().map((e=>null==e?void 0:e.position)).filter((e=>Array.isArray(e)&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2])))?void 0:e.map((e=>({color:"#ff0000",position:{x:-16*e[0],y:16*e[1],z:-16*e[2]},size:i})))}getCollisionBoxes(){return this.findComponent("minecraft:collision_box").filter((e=>"number"==typeof(null==e?void 0:e.width)&&"number"==typeof(null==e?void 0:e.height))).map((e=>({color:"#ffff00",position:{x:0,y:0,z:0},size:{x:16*e.width,y:16*e.height,z:16*e.width}})))}getHitboxes(){return this.findComponent("minecraft:custom_hit_test").map((e=>{var t;return null!=(t=null==e?void 0:e.hitboxes)?t:[]})).flat().filter((e=>"number"==typeof(null==e?void 0:e.width)&&"number"==typeof(null==e?void 0:e.height)&&(void 0===(null==e?void 0:e.pivot)||Array.isArray(null==e?void 0:e.pivot)&&"number"==typeof e.pivot[0]&&"number"==typeof e.pivot[1]&&"number"==typeof e.pivot[2]))).map((e=>{var t,i,n,s,a,r;return{color:"#0000ff",position:{x:-16*(null!=(i=null==(t=null==e?void 0:e.pivot)?void 0:t[0])?i:0),y:16*((null!=(s=null==(n=null==e?void 0:e.pivot)?void 0:n[1])?s:0)-e.height/2),z:-16*(null!=(r=null==(a=null==e?void 0:e.pivot)?void 0:a[2])?r:0)},size:{x:16*e.width,y:16*e.height,z:16*e.width}}}))}}class Pl extends xe{constructor(e,t){super(),d(this,"_geometries",[]),d(this,"_animations",[]),d(this,"readyPromises",[]),d(this,"_currentTexturePath"),d(this,"_runningAnimations",new Set),d(this,"particleEffects",[]),d(this,"_serverEntity"),this.app=e,this.renderData=t,this._currentTexturePath=this.texturePaths[0]}get ready(){return Promise.all(this.readyPromises)}update(e){this.renderData=e}createGeometry(e,t){const i=new xl(this,e,t);this._geometries.push(i),this.readyPromises.push(i.ready.fired)}createAnimation(e,t){const i=new Cl(this,e,t);this._animations.push(i),this.readyPromises.push(i.ready.fired)}createParticle(e,t){const i=new jl(this,e,t);this.particleEffects.push(i),this.readyPromises.push(i.ready.fired)}addServerEntity(e){this._serverEntity=new _l(this,e),this.readyPromises.push(this._serverEntity.ready.fired)}selectGeometry(e){for(const t of this._geometries)if(t.identifiers.includes(e))return t.select(e);throw new Error(`Failed to find geometry with ID "${e}"`)}selectTexturePath(e){this._currentTexturePath=e}onChange(){this.dispatch()}get identifier(){return this.renderData.identifier}get texturePaths(){return this.renderData.texturePaths}get geometryIdentifiers(){return this._geometries.map((e=>e.identifiers)).flat()}get animations(){return this._animations.map((e=>e.includedAnimations)).flat().filter((([e])=>this.renderData.connectedAnimations.has(e)))}get runningAnimations(){return this._runningAnimations}get modelData(){for(const e of this._geometries){let t=e.geometry;if(t)return t}return this._geometries[0].fallbackGeometry}get currentTexturePath(){return this._currentTexturePath}get particles(){return this.particleEffects.map((e=>[e.shortName,e.json]))}get serverEntity(){return this._serverEntity}activate(){this._geometries.forEach((e=>e.activate()))}dispose(){var e;this._geometries.forEach((e=>e.dispose())),this._animations.forEach((e=>e.dispose())),null==(e=this._serverEntity)||e.dispose()}}const Al={alphanumeric:e=>null!==e.match(/^[a-zA-Z0-9_\/]*$/),noEmptyFolderNames:e=>null===e.match(/\/\//g)},Tl={};var El=Le({name:"PresetPath",props:{value:String},data:()=>({mode:"view",editedPath:"",validationText:"",rules:Object.fromEntries(Object.entries(Al).map((([e,t])=>[e,i=>t(i)||Yp.instance.locales.translate(`windows.createPreset.validationRule.${e}`)])))}),mounted(){this.mode="view",this.editedPath=this.value,this.sanitizeEditedPath()},computed:{path(){return this.value.substring(0,this.value.length-1)}},methods:{sanitizeEditedPath(){this.editedPath=this.editedPath.replaceAll("\\","/").replace(/\s+/g,"_"),this.editedPath.endsWith("/")||""===this.editedPath||(this.editedPath=this.editedPath+"/")},isPathValid(){return void 0===Object.values(this.rules).map((e=>e(this.editedPath))).find((e=>"string"==typeof e))},tryToViewMode(){this.isPathValid()&&(this.mode="view")}},watch:{value(){this.editedPath=this.value,this.sanitizeEditedPath()},mode(){"view"===this.mode&&(this.sanitizeEditedPath(),this.$emit("input",this.editedPath))},editedPath(){this.validationText=Object.values(this.rules).map((e=>e(this.editedPath))).find((e=>"string"==typeof e))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mb-6 flex justify-center align-start path-container"},[i("v-icon",{staticClass:"mr-1",attrs:{"x-large":"",color:"primary"}},[e._v("mdi-folder-outline")]),"view"===e.mode?[i("v-btn",{staticClass:"mr-2",attrs:{text:"",small:""},on:{click:function(t){e.mode="edit"}}},[i("v-icon",{staticClass:"mr-1",attrs:{small:""}},[e._v(" "+e._s(0===e.path.length?"mdi-plus":"mdi-pencil-outline")+" ")]),e._v(" "+e._s(0===e.path.length?"Add subfolder":"Edit subfolders")+" ")],1),i("span",{on:{dblclick:function(t){e.mode="edit"}}},e._l(e.path.split("/"),(function(t,n){return i("span",{key:n,staticClass:"mr-1"},[e._v(" "+e._s(t)+"/ ")])})),0)]:i("v-text-field",{staticStyle:{display:"inline-block",width:"calc(100% - 44px)","margin-top":"0","padding-top":"0"},attrs:{rules:Object.values(e.rules),dense:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.tryToViewMode()},blur:function(t){return e.tryToViewMode()}},model:{value:e.editedPath,callback:function(t){e.editedPath=t},expression:"editedPath"}})],2)}),[],!1,Fl,"391b64c8",null,null);function Fl(e){for(let t in Tl)this[t]=Tl[t]}var Dl=function(){return El.exports}();const Ol={};var Ml=Le({name:"FilePathWindow",mixins:[Be],components:{BaseWindow:St,PresetPath:Dl},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close(this.$data.options.filter((({isSelected:e})=>e)).map((({name:e})=>e)))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:e.$data.name,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,isPersistent:!e.$data.isClosable,hasCloseButton:!1,width:440,height:400},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return e._l(e.$data.options,(function(t,n){return i("v-checkbox",{key:n,attrs:{label:t.name,"hide-details":""},model:{value:t.isSelected,callback:function(i){e.$set(t,"isSelected",i)},expression:"option.isSelected"}})}))},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary"},on:{click:e.onClose}},[i("v-icon",[e._v("mdi-check")]),i("span",[e._v(" "+e._s(e.t("general.confirm"))+" ")])],1)]},proxy:!0}],null,!1,3783976996)}):e._e()}),[],!1,$l,null,null,null);function $l(e){for(let t in Ol)this[t]=Ol[t]}var Il=function(){return Ml.exports}();class Rl extends Je{constructor(e){super(Il,!0,!1),this.config=e,this.defineWindow(),this.open()}get name(){return this.config.name}get options(){return this.config.options}get isClosable(){return this.config.isClosable}}async function Wl(e,t,i){const n=await Yp.getApp(),s=Et({icon:"mdi-export",color:"success",textColor:"white",message:"general.successfulExport.title",isVisible:!0,onClick:()=>{Ie?Nl(Tn(e),t):new Pt({description:`[${n.locales.translate("general.successfulExport.description")}: "${e}"]`}),s.dispose()}});Ie||await i.writeFile(e,t)}function Nl(e,t){const i=URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.download=e,n.href=i,n.click(),URL.revokeObjectURL(i)}class Bl extends Qo{constructor(e,t){super(e,t),d(this,"winterskyScene",y(Object.freeze(new Z.Scene({fetchTexture:async e=>{const t=await Yp.getApp();try{return await ds(e.particle_texture_path,t.project.fileSystem)}catch(i){}}})))),d(this,"model"),d(this,"_renderContainer"),d(this,"boxHelperDisposables",[]),this.winterskyScene.global_options.loop_mode="once",this.winterskyScene.global_options.tick_rate=60,this.winterskyScene.global_options.max_emitter_particles=1e3,this.winterskyScene.global_options.scale=16,this.setupComplete.once((()=>this.scene.add(this.winterskyScene.space)))}get renderContainer(){if(!this._renderContainer)throw new Error("Preview.renderContainer was not defined yet");return this._renderContainer}get icon(){return"mdi-cube-outline"}get iconColor(){return"primary"}async onActivate(){var e;await super.onActivate(),null==(e=this._renderContainer)||e.activate()}onCreate(){this.registerActions()}registerActions(){this.actions=[],this.addAction(new Ke({icon:"mdi-refresh",name:"general.reload",onTrigger:()=>this.reload()}),new Ke({icon:"mdi-image-outline",name:"fileType.texture",isDisabled:()=>{var e,t,i;return(null!=(i=null==(t=null==(e=this._renderContainer)?void 0:e.texturePaths)?void 0:t.length)?i:0)<=1},onTrigger:async()=>{const e=this.renderContainer.texturePaths,t=new Ro({name:"fileType.texture",isClosable:!1,options:e,default:this.renderContainer.currentTexturePath}),i=await t.fired;this.renderContainer.selectTexturePath(i),this.createModel()}}),new Ke({icon:"mdi-cube-outline",name:"fileType.geometry",isDisabled:()=>{var e,t,i;return(null!=(i=null==(t=null==(e=this._renderContainer)?void 0:e.geometryIdentifiers)?void 0:t.length)?i:0)<=1},onTrigger:async()=>{const e=this.renderContainer.geometryIdentifiers,t=new Ro({name:"fileType.geometry",isClosable:!1,options:e,default:e[0]}),i=await t.fired;this.renderContainer.selectGeometry(i),this.createModel()}}),new Ke({icon:"mdi-movie-open-outline",name:"fileType.clientAnimation",isDisabled:()=>{var e,t,i;return 0==(null!=(i=null==(t=null==(e=this._renderContainer)?void 0:e.animations)?void 0:t.length)?i:0)},onTrigger:async()=>{var e;const t=this.renderContainer.animations,i=new Rl({name:"fileType.clientAnimation",options:t.map((([e])=>({name:e,isSelected:this.renderContainer.runningAnimations.has(e)})))}),n=await i.fired;null==(e=this.model)||e.animator.pauseAll(),this.renderContainer.runningAnimations.clear(),n.forEach((e=>{this.renderContainer.runningAnimations.add(e)})),this.createModel()}}),new Ke({icon:"mdi-collage",name:"[Asset Preview]",onTrigger:()=>{this.renderAssetPreview()}}))}onDestroy(){var e;null==(e=this._renderContainer)||e.dispose(),super.onDestroy()}onChange(){}async createModel(){var e;if(!this._renderContainer)return;const t=await Yp.getApp();if(this.model&&(null==(e=this.scene)||e.remove(this.model.getGroup()),this.model.animator.disposeAnimations(),this.boxHelperDisposables.forEach((e=>e.dispose()))),this.registerActions(),!this.renderContainer.currentTexturePath)return;this.model=y(new Y(this.renderContainer.modelData,await ds(this.renderContainer.currentTexturePath,t.project.fileSystem))),await this.model.create(),this.scene.add(this.model.getGroup()),this.model.animator.setupWintersky(this.winterskyScene),this.renderContainer.particles.forEach((([e,t])=>{var i;e&&(null==(i=this.model)||i.animator.addEmitter(e,new Z.Config(this.winterskyScene,t)))}));for(const[n,s]of this.renderContainer.animations)this.model.animator.addAnimation(n,s);this.renderContainer.runningAnimations.forEach((e=>{var t;return null==(t=this.model)?void 0:t.animator.play(e)}));const i=this.renderContainer.serverEntity;i&&(this.boxHelperDisposables.push(),this.createOutlineBoxes([...i.getHitboxes(),...i.getCollisionBoxes(),...i.getSeatBoxHelpers()])),this.requestRendering(),setTimeout((()=>{this.requestRendering()}),100)}createOutlineBoxes(e){this.boxHelperDisposables=e.map((e=>this.model.createOutlineBox(e.color,e.position,e.size)))}render(e=!0){this.winterskyScene.updateFacingRotation(this.camera),super.render(),e&&this.model&&this.model.shouldTick&&(this.model.tick(),this.isActive&&this.requestRendering())}async close(){var e;const t=await super.close();return t&&(null==(e=this._renderContainer)||e.dispose(),this._renderContainer=void 0),t}async renderAssetPreview(e=1.5,t=4,i=1184274){if(!this._renderContainer)return;const n=this.parent.project.fileSystem,s=document.createElement("canvas");s.width=500*t,s.height=500*t;const a=new ee(s,this.renderContainer.modelData,await n.loadFileHandleAsDataUrl(await n.getFileHandle(this.renderContainer.currentTexturePath)),{antialias:!0,height:500*t,width:500*t});await a.loadedModel,a.scene.background=new q(i);const r=document.createElement("canvas");r.width=1400*t,r.height=600*t;const o=r.getContext("2d");if(!o)return;o.imageSmoothingEnabled=!1;const l=a.getModel().getGroup();var c;a.positionCamera(e),a.requestRendering(),await(c=100,new Promise((e=>setTimeout((()=>e()),c))));const d=[];for(let v=0;v<5;v++)1===v&&l.rotateY(Math.PI/4),0!==v&&l.rotateY(Math.PI/2),a.requestRendering(!0),d.push(s.toDataURL("image/png"));const u=(new te).setFromObject(l).getCenter(new ie);l.position.setY(u.y),l.rotation.set(.25*Math.PI,1.75*Math.PI,.75*Math.PI),a.positionCamera(e,!1),a.requestRendering(!0),d.push(s.toDataURL("image/png")),l.position.setY(0),l.rotation.set(0,1.75*Math.PI,1.75*Math.PI),a.positionCamera(e,!1),a.requestRendering(!0),d.push(s.toDataURL("image/png"));const[p,...h]=await Promise.all([this.loadImageFromDisk(this.renderContainer.currentTexturePath),...d.map((e=>this.loadImage(e)))]);o.fillStyle="#"+i.toString(16),o.fillRect(0,0,r.width,r.height),o.drawImage(h[0],0,100*t,400*t,400*t);for(let v=0;v<3;v++)o.drawImage(h[v+1],650*t,200*v*t,200*t,200*t);for(let v=0;v<3;v++)o.drawImage(h[v+4],1050*t,200*v*t,200*t,200*t);console.log(p.width,p.height);const m=200*(p.width>p.height?0:(p.height-p.width)/p.width/2),g=200*(p.height>p.width?0:(p.width-p.height)/p.height/2),f=p.width>p.height?200:p.width/p.height*200,w=p.height>p.width?200:p.height/p.width*200;console.log(m,g,f,w),o.drawImage(p,(400+m)*t,(200+g)*t,f*t,w*t),o.fillStyle="#ffffff",o.font=30*t+"px Arial",o.fillText(this.tab.getFileHandle().name.split(".").shift(),20*t,50*t),await new Promise((e=>{r.toBlob((async t=>{t&&(await Wl(`previews/${this.tab.getFileHandle().name.split(".").shift()}.png`,new Uint8Array(await t.arrayBuffer()),this.parent.project.fileSystem),e())}))})),a.dispose()}loadImage(e){return new Promise((async(t,i)=>{const n=new Image;n.addEventListener("load",(()=>t(n))),n.src=e}))}async loadImageFromDisk(e){const t=this.parent.project.fileSystem;return await this.loadImage(await t.loadFileHandleAsDataUrl(await t.getFileHandle(e)))}}function Ll(e){return Array.isArray(e)&&3===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]}class Hl extends Bl{constructor(e,t,i){super(t,i),d(this,"blockWatcher"),d(this,"blockJson",{}),d(this,"previewOptions",{}),this.blockFilePath=e,this.blockWatcher=new bl(Yp.instance,e),this.blockWatcher.on((e=>this.reload(e)))}setPreviewOptions({loadComponents:e=!0}){this.previewOptions={loadComponents:e}}async close(){const e=await super.close();return e&&this.blockWatcher.dispose(),e}async reload(e){var t;e||(e=await this.blockWatcher.getFile()),null==(t=this._renderContainer)||t.dispose(),this._renderContainer=void 0,this.loadRenderContainer(e)}async loadRenderContainer(e){var t,i,n,s,a,r;if(void 0!==this._renderContainer)return;await this.setupComplete;const o=await Yp.getApp();await o.project.packIndexer.fired;const l=o.project.packIndexer.service;if(!l)return;try{this.blockJson=Object.freeze(null!=(i=null==(t=T.parse(await e.text()))?void 0:t["minecraft:block"])?i:{})}catch{return}const c=await l.getCacheDataFor("block",this.blockFilePath),d=null!=(n=null==c?void 0:c.texture)?n:[];let u;try{u=null!=(a=null==(s=T.parse(await o.project.getFileFromDiskOrTab("RP/textures/terrain_texture.json").then((e=>e.text()))))?void 0:s.texture_data)?a:{}}catch{return}const p=await Promise.all(d.map((e=>{var t,i;return null!=(i=null==(t=u[e])?void 0:t.textures)?i:[]})).flat().map((e=>as(o.project.fileSystem,`RP/${e}`,[".tga",".png",".jpg",".jpeg"]))));if(0===p.length)return;const h=await l.find("geometry","identifier",null!=(r=c.geometryIdentifier)?r:[]);0!==h.length&&(this._renderContainer=y(new Pl(o,{identifier:c.geometryIdentifier[0],texturePaths:p.filter((e=>void 0!==e)),connectedAnimations:new Set([])})),this._renderContainer.createGeometry(h[0]),this.renderContainer.ready.then((()=>{this.createModel()})),this._renderContainer.on((()=>{this.createModel()})))}async createModel(){await super.createModel(),this.previewOptions.loadComponents&&this.createOutlineBoxes([...this.loadCollisionBoxes("entity"),...this.loadCollisionBoxes("pick")])}findComponents(e,t){const i=[],n=e=>i.push(e);return[`components/${t}`,`permutations/*/components/${t}`].forEach((t=>Sn(t,e,n))),i}loadCollisionBoxes(e){return this.findComponents(this.blockJson,`minecraft:${e}_collision`).filter((e=>Ll(e.origin)&&Ll(e.size))).map((({origin:t,size:i})=>({color:"entity"===e?"#ffff00":"#0000ff",position:{x:t[0]+i[0]/2,y:t[1],z:t[2]+i[2]/2},size:{x:i[0],y:i[1],z:i[2]}})))}}class Vl extends Bl{constructor(e,t,i){super(t,i),d(this,"previewOptions",{}),d(this,"clientEntityWatcher"),this.clientEntityFilePath=e,this.clientEntityWatcher=new bl(Yp.instance,e),this.clientEntityWatcher.on((e=>this.reload(e)))}setPreviewOptions(e){this.previewOptions=e}async close(){const e=await super.close();return e&&this.clientEntityWatcher.dispose(),e}async reload(e){var t,i;e||(e=await this.clientEntityWatcher.getFile());const n=null==(t=this._renderContainer)?void 0:t.runningAnimations;null==(i=this._renderContainer)||i.dispose(),this._renderContainer=void 0,this.loadRenderContainer(e,n)}async loadRenderContainer(e,t=new Set){var i,n,s,a,r,o,l,c;if(void 0!==this._renderContainer)return;await this.setupComplete;const d=await Yp.getApp(),u=d.project.packIndexer.service;if(!u)return;let p;try{p=null!=(n=null==(i=T.parse(await e.text()))?void 0:i["minecraft:client_entity"])?n:{}}catch{return}const h=await u.getCacheDataFor("clientEntity",this.clientEntityFilePath),m=h.texturePath,g=await u.find("clientAnimation","identifier",null!=(s=h.animationIdentifier)?s:[],!0),f=await u.find("geometry","identifier",null!=(a=h.geometryIdentifier)?a:[]);if(0===f.length)return new Pt({description:"preview.noGeometry"}),void this.close();const w=await Promise.all(Object.entries(null!=(o=null==(r=null==p?void 0:p.description)?void 0:r.particle_effects)?o:{}).map((async([e,t])=>[e,(await u.find("particle","identifier",[t],!1))[0]])));if(this._renderContainer=y(new Pl(d,{identifier:h.geometryIdentifier[0],texturePaths:m,connectedAnimations:new Set(h.animationIdentifier)})),this._renderContainer.createGeometry(f[0]),g.forEach((e=>this._renderContainer.createAnimation(e))),w.forEach((([e,t],i)=>{t&&this._renderContainer.createParticle(e,t)})),t&&t.forEach((e=>{var t;return null==(t=this._renderContainer)?void 0:t.runningAnimations.add(e)})),this.previewOptions.loadServerEntity&&(null==(l=null==p?void 0:p.description)?void 0:l.identifier)){const e=await u.find("entity","identifier",[null==(c=null==p?void 0:p.description)?void 0:c.identifier],!1);e.length>0&&this._renderContainer.addServerEntity(e[0])}this.renderContainer.ready.then((()=>{this.createModel()})),this._renderContainer.on((()=>{this.createModel()}))}}class zl extends Sl{constructor(e,t){super(e.tabSystem.app,t),this.tab=e}onChange(e){this.tab.onChange(e)}}class Ul extends Qo{constructor(e,t){super(e,t),d(this,"emitter"),d(this,"config"),d(this,"fileWatcher"),d(this,"isReloadingDone",new Ce),d(this,"wintersky",y(new Z.Scene({fetchTexture:async e=>{const t=await Yp.getApp();try{return await ds(`RP/${e.particle_texture_path}.png`,t.project.fileSystem)}catch(i){}}}))),this.setupComplete.once((()=>{this.scene.add(new ne(16)),this.wintersky.global_options.tick_rate=60,this.wintersky.global_options.max_emitter_particles=1e3,this.wintersky.global_options.scale=16})),this.isReloadingDone.dispatch()}async onActivate(){await super.onActivate(),await this.onChange()}onDeactivate(){var e;null==(e=this.emitter)||e.stop(!0),super.onDeactivate()}onDestroy(){var e,t;null==(e=this.fileWatcher)||e.dispose(),null==(t=this.emitter)||t.delete(),super.onDestroy()}onCreate(){this.addAction(new Ke({icon:"mdi-refresh",name:"general.reload",onTrigger:()=>this.reload()}))}async receiveCanvas(e){const t=!this._camera;await super.receiveCanvas(e),t&&this.camera.position.set(60,30,60)}async loadParticle(e){var t,i,n;let s;this.fileWatcher||(this.fileWatcher=y(new zl(this,this.tab.getProjectPath()))),e||(e=null!=(i=await(null==(t=this.fileWatcher)?void 0:t.requestFile(await this.getFile())))?i:await this.getFile());try{s=T.parse(await e.text())}catch{return}null==(n=this.emitter)||n.delete(),this.scene.children.includes(this.wintersky.space)||this.scene.add(this.wintersky.space),this.config=y(new Z.Config(this.wintersky,s,{path:this.tab.getProjectPath()})),this.emitter=y(new Z.Emitter(this.wintersky,this.config,{loop_mode:"looping",parent_mode:"world"})),this.emitter.start()}render(){var e,t,i;null==(e=this.controls)||e.update(),this.wintersky.updateFacingRotation(this.camera),null==(t=this.emitter)||t.tick(),null==(i=this.renderer)||i.render(this.scene,this.camera),this.renderingRequested=!1,this.isActive&&this.requestRendering()}async onChange(e){await this.isReloadingDone.fired,this.isReloadingDone.resetSignal(),await this.loadParticle(e),this.isReloadingDone.dispatch()}async close(){var e;const t=await super.close();return t&&(null==(e=this.fileWatcher)||e.dispose()),t}async reload(){await this.onChange()}get icon(){return"mdi-cube-outline"}get iconColor(){return"primary"}}const Gl=e=>({register:t=>{e.exports=({name:e,schema:i,template:n})=>{e(t.command_name),i([]),n((e=>(new t).onApply(e)))}}});function Jl(e){let t=0,i=0,n=0,s=0,a="",r=[];for(;n<e.length;)"^"===e[n]&&"^"===a[0]||"~"===e[n]&&"~"===a[0]?(r.push({startColumn:s,endColumn:n,word:a}),s=n+1,a=e[n]):" "===e[n]||"\t"===e[n]?0===t&&0===i&&""!==a&&(r.push({startColumn:s,endColumn:n,word:a}),s=n+1,a=""):("{"===e[n]?t++:"}"===e[n]?t--:"["===e[n]?i++:"]"===e[n]&&i--,""!==e[n].trim()&&(a+=e[n])),n++;return r.push({startColumn:s,endColumn:n,word:a}),{tokens:r}}function ql(e){return"true"===e||"false"!==e&&("null"===e?null:"undefined"===e?void 0:function(e){return!isNaN(Number(e))}(e)?Number(e):e)}class Kl{constructor(e,t,i){d(this,"_name"),d(this,"schema"),d(this,"template"),this.commandSrc=e,this.mode=t,this.v1Compat=i}get name(){var e;return null!=(e=this._name)?e:"unknown"}async load(e){const t={exports:{}};try{ss({script:this.commandSrc,env:{module:t,defineCommand:e=>e,Bridge:this.v1Compat?Gl(t):void 0}})}catch(s){console.error(s)}if("function"!=typeof t.exports)return;let i=e=>this.schema=e,n=()=>{};e&&"server"!==e||(i=()=>{},n=e=>{this.template=(t,i)=>{try{return e(t,i)}catch(s){return console.error(s),[]}}}),await t.exports({name:e=>this._name=e,schema:i,template:n})}process(e){var t;e.startsWith("/")&&(e=e.slice(1));const[i,...n]=Jl(e).tokens.map((({word:e})=>e)),s=null==(t=this.template)?void 0:t.call(this,n.map((e=>ql(e))),{compilerMode:this.mode});let a=[];if("string"==typeof s)a=s.split("\n");else if(Array.isArray(s))a=s.filter((e=>"string"==typeof e));else{const e=`Failed to process command ${this._name}; Invalid command template return type: Expected string[] or string, received ${typeof s}`;console.error(e),a.push(`# ${e}`)}return a.map((e=>e.startsWith("/")||e.startsWith("#")?e:`/${e}`))}getSchema(){return this.schema?Array.isArray(this.schema)?0===this.schema.length?[{commandName:this.name}]:this.schema.map((e=>l({commandName:this.name},e))):(this.schema.commandName||(this.schema.commandName=this.name),[this.schema]):[{commandName:this.name}]}toString(){return this.commandSrc}}class Ql{constructor(e){d(this,"experimentalGameplay",{}),d(this,"projectTargetVersion",""),this.requires=e}async isValid(){var e,t,i;if(!this.requires)return!0;const n=await Yp.getApp(),s=n.project.config.get();this.experimentalGameplay=null!=(e=s.experimentalGameplay)?e:{},this.projectTargetVersion=null!=(t=s.targetVersion)?t:await ja();const a=n.project.hasPacks(null!=(i=this.requires.packTypes)?i:[]),r=!this.requires.targetVersion||N.exports.compare(this.projectTargetVersion,this.requires.targetVersion[1],this.requires.targetVersion[0]),o=!this.requires.experimentalGameplay||this.requires.experimentalGameplay.some((e=>e.startsWith("!")?!this.experimentalGameplay[e.replace("!","")]:this.experimentalGameplay[e]));return a&&o&&r}}function Xl(e,t){return t.includes(e)?"full":t.some((t=>t.includes(e)))?"partial":"none"}class Zl{constructor(e){this.commandData=e}getSchema(){return this.commandData.getSelectorArgumentsSchema()}async getNextCompletionItems(e){if(1===e.length||","===e[e.length-2])return this.getArgumentNameCompletions();if("="===e[e.length-2]||"=!"===e[e.length-2]){const t=e[e.length-3];return await this.getArgumentTypeCompletions(t)}return[]}async getArgumentFromWord(e){return(await this.getSchema()).find((t=>t.argumentName===e))}getArgumentNameCompletions(){return this.getSchema().then((e=>e.map((e=>({label:e.argumentName,insertText:e.argumentName,kind:_.CompletionItemKind.Property,documentation:e.description})))))}async getArgumentTypeCompletions(e){const t=await this.getSchema();return(await Promise.all(t.filter((t=>t.argumentName===e)).map((e=>this.commandData.getCompletionItemsForArgument(e))))).flat()}}class Yl extends Ce{constructor(){super(...arguments),d(this,"selectorArguments",new Zl(this)),d(this,"_data")}async loadCommandData(e){var t;const i=await Yp.getApp();this._data=y(await i.dataLoader.readJSON(`data/packages/${e}/language/mcfunction/main.json`));const n=null!=(t=this._data.$customTypes)?t:{};for(const{commands:s}of this._data.vanilla)for(const e of s)e.arguments&&(e.arguments=e.arguments.map((e=>{if(!e.type||!e.type.startsWith("$"))return e;const t=n[e.type.slice(1)];return t?t.map((t=>l(l({},e),t))):e})).flat());this.dispatch()}get shouldIgnoreCustomCommands(){return Yp.getApp().then((e=>!e.projectManager.projectReady.hasFired))}async getSchema(){if(!this._data)throw new Error("Acessing commandData before it was loaded.");const e=[];for await(const t of this._data.vanilla){const i=new Ql(t.requires);await i.isValid()?e.push(t):t.requires||e.push(t)}return e}async getCommandsSchema(e=!1){return(await this.getSchema()).map((e=>e.commands)).flat().concat(e?[]:await async function(){var e,t;const i=await Yp.getApp();await i.project.compilerManager.fired;const n=null!=(t=null==(e=i.project.config.get().bridge)?void 0:e.v1CompatMode)&&t,s="BP/commands";let a;try{a=await i.project.fileSystem.getDirectoryHandle(s)}catch{return[]}const r=[];return await Ba(a,(async(e,t)=>{const[s,a]=await i.project.compilerManager.compileWithFile(t,await e.getFile()),o=new File([a],e.name),l=new Kl(await o.text(),"dev",n);await l.load("client"),r.push(...l.getSchema())}),void 0,s),r}()).filter((e=>void 0!==e))}async getSelectorArgumentsSchema(){return(await this.getSchema()).map((e=>e.selectorArguments)).flat().filter((e=>void 0!==e))}allCommands(e,t=!1){return this.getCommandsSchema(t).then((t=>[...new Set(t.map((e=>null==e?void 0:e.commandName)).filter((t=>!e||(null==t?void 0:t.includes(e)))))]))}allSelectorArguments(){return this.getSelectorArgumentsSchema().then((e=>[...new Set(e.map((e=>null==e?void 0:e.argumentName)))]))}getCommandCompletionItems(e,t=!1){return this.getCommandsSchema(t).then((t=>{const i=[];return t.filter((t=>{var i;return!e||(null==(i=t.commandName)?void 0:i.includes(e))})).forEach((e=>{i.some((t=>t.label===e.commandName))||i.push({insertText:e.commandName,label:e.commandName,documentation:e.description,kind:_.CompletionItemKind.Method})})),i}))}async getCommandDefinitions(e,t){return await this.getCommandsSchema(t).then((t=>t.filter((t=>t.commandName===e))))}async getNextCompletionItems(e){if(e.length<=1)return await this.getCommandCompletionItems(e[0],await this.shouldIgnoreCustomCommands);const t=e.shift(),i=await this.getCommandDefinitions(t,await this.shouldIgnoreCustomCommands);if(!i||0===i.length)return[];const n=[];return(await Promise.all(i.map((async t=>{const i=await this.getNextCommandArgument(t,[...e]);return 0===i.length?[]:await Promise.all(i.map((e=>this.getCompletionItemsForArgument(e))))})))).flat(2).forEach((e=>{n.some((t=>t.label===e.label))||n.push(e)})),n}async getNextCommandArgument(e,t){var i;if(!e.arguments||0===e.arguments.length)return[];const n=null!=(i=e.arguments)?i:[];let s=0;for(let a=0;a<t.length;a++){const e=t[a];if(""===e)continue;const i=await this.isArgumentType(e,n[s]);if("none"===i)return[];if("partial"===i)return t.length===a+1?[n[s]]:[];if("command"===n[s].type&&a+1<t.length)return(await Promise.all((await this.getCommandDefinitions(e,await this.shouldIgnoreCustomCommands)).map((e=>this.getNextCommandArgument(e,t.slice(a+1)))))).flat();if(s++,s>=n.length)return[]}return n[s]?[n[s]]:[]}async isArgumentType(e,t){var i,n,s,a;switch(t.type){case"string":if(!(null==(i=t.additionalData)?void 0:i.values))return"full";return Xl(e,null!=(a=null!=(s=null==(n=t.additionalData)?void 0:n.values)?s:this.resolveDynamicReference(t.additionalData.schemaReference))?a:[]);case"command":return Xl(e,await this.allCommands(void 0,await Yp.getApp().then((e=>e.projectManager.hasFired))));case"number":return isNaN(Number(e))?"none":"full";case"selector":return e.startsWith("@")?"full":"none";case"boolean":return"true"===e||"false"===e?"full":"none";case"coordinate":return e.startsWith("~")||e.startsWith("^")||!isNaN(Number(e))?"full":"none";case"jsonData":return/^\{.*\}$/.test(e)?"full":"none";case"blockState":return/^\[.*\]$/.test(e)?"full":"none";case"molang":{const t=new se;try{t.parse(e)}catch(r){return"none"}return"full"}default:return"none"}}async getCompletionItemsForArgument(e){var t,i,n,s,a;if(!e.type)return(null==(t=e.additionalData)?void 0:t.values)?this.toCompletionItem(null==(i=e.additionalData)?void 0:i.values):(null==(n=e.additionalData)?void 0:n.schemaReference)?this.toCompletionItem(this.resolveDynamicReference(e.additionalData.schemaReference).map((({value:e})=>e))):[];switch(e.type){case"command":return this.mergeCompletionItems(await this.getCommandCompletionItems(),{documentation:e.description});case"selector":return this.toCompletionItem(["@a","@e","@p","@s","@r","@initiator"],e.description);case"boolean":return this.toCompletionItem(["true","false"],e.description,_.CompletionItemKind.Value);case"number":return this.toCompletionItem(["0","1","2","3","4","5","6","7","8","9"],e.description,_.CompletionItemKind.Value);case"coordinate":return this.toCompletionItem(["~","^"],e.description,_.CompletionItemKind.Operator);case"string":return(null==(s=e.additionalData)?void 0:s.values)?this.toCompletionItem(e.additionalData.values,e.description):(null==(a=e.additionalData)?void 0:a.schemaReference)?this.toCompletionItem(this.resolveDynamicReference(e.additionalData.schemaReference).map((({value:e})=>e)),e.description):[];case"jsonData":return this.toCompletionItem([["{}","{${1:json data}}"]],e.description,_.CompletionItemKind.Struct);case"blockState":return this.toCompletionItem([["[]","[${1:block states}]"]],e.description,_.CompletionItemKind.Struct);case"scoreData":return this.toCompletionItem([["{}","{${1:scores}}"]],e.description,_.CompletionItemKind.Struct)}return[]}toCompletionItem(e,t,i=_.CompletionItemKind.Text){return e.map((e=>({label:Array.isArray(e)?e[0]:e,insertText:Array.isArray(e)?e[1]:e,kind:i,documentation:t,insertTextRules:Array.isArray(e)?_.CompletionItemInsertTextRule.InsertAsSnippet:void 0})))}mergeCompletionItems(e,t){return e.map((e=>{var i;return c(l({},e),{documentation:t.documentation?`${t.documentation}\n\n${null!=(i=e.documentation)?i:""}`:e.documentation})}))}resolveDynamicReference(e){return new fa(e,"$ref",e).getCompletionItems({})}}const ec=[{name:"preview.viewModel",fileMatch:"RP/models/",createPreview:(e,t)=>async function(e,t){const i=await Yp.getApp();await i.project.packIndexer.fired;const n=i.project.packIndexer.service,s=await t.getFile(),a=await s.text();let r;try{r=yl(T.parse(a))}catch{return}const o=r["minecraft:geometry"].map((e=>{var t;return null==(t=null==e?void 0:e.description)?void 0:t.identifier})).filter((e=>void 0!==e));let l=o[0];if(o.length>1){const e=new Ro({default:o[0],options:o,name:"preview.chooseGeometry",isClosable:!1});l=await e.fired}if(!l)return void new Pt({description:"preview.noGeometry"});const c=await n.find("clientEntity","geometryIdentifier",[l]);if(0!==c.length)return new Vl(c[0],t,e);{const i=await n.find("block","geometryIdentifier",[l]);if(i.length>0){const n=new Hl(i[0],t,e);return n.setPreviewOptions({loadComponents:!1}),n}new Pt({description:"preview.failedClientEntityLoad"})}}(e,t)},{name:"preview.viewModel",fileMatch:"RP/entity/",createPreview:(e,t)=>async function(e,t){return new Vl(t.getProjectPath(),t,e)}(e,t)},{name:"preview.viewEntity",fileMatch:"BP/entities/",createPreview:(e,t)=>async function(e,t){var i,n,s;const a=await Yp.getApp();await a.project.packIndexer.fired;const r=a.project.packIndexer.service,o=await t.getFile(),l=await o.text();let c;try{c=null!=(n=null==(i=T.parse(l))?void 0:i["minecraft:entity"])?n:{}}catch{return void new Pt({description:"preview.invalidEntity"})}const d=await r.find("clientEntity","identifier",[null==(s=null==c?void 0:c.description)?void 0:s.identifier]);if(0===d.length)return void new Pt({description:"preview.failedClientEntityLoad"});const u=new Vl(d[0],t,e);return u.setPreviewOptions({loadServerEntity:!0}),u}(e,t)},{name:"preview.viewParticle",fileMatch:"RP/particles/",createPreview:async(e,t)=>new Ul(t,e)},{name:"preview.viewBlock",fileMatch:"BP/blocks/",createPreview:async(e,t)=>new Hl(t.getProjectPath(),t,e)}];class tc extends class{constructor(e,t,i){d(this,"recentFiles"),d(this,"tabSystems"),d(this,"_projectData"),d(this,"packIndexer"),d(this,"_fileSystem"),d(this,"compilerManager",new tr(this)),d(this,"jsonDefaults",y(new ur(this))),d(this,"typeLoader"),d(this,"config"),d(this,"extensionLoader"),d(this,"fileChange",new pl),d(this,"fileSave",new pl),d(this,"tabActionProvider",new hl),d(this,"snippetLoader",new fl(this)),d(this,"exportProvider",new wl),this.parent=e,this.app=t,this._baseDirectory=i,this._fileSystem=y(new La(i)),this.config=new Oa(this._fileSystem,this),this.packIndexer=new Na(this,i),this.extensionLoader=new dl(t.fileSystem,`projects/${this.name}/.bridge/extensions`,`projects/${this.name}/.bridge/inactiveExtensions.json`),this.typeLoader=new hr(this.app.dataLoader),this.recentFiles=k(new Ma(t,`projects/${this.name}/.bridge/recentFiles.json`)),this.fileChange.any.on((e=>Yp.eventSystem.dispatch("fileChange",e))),this.fileSave.any.on((e=>Yp.eventSystem.dispatch("fileSave",e))),this.tabSystems=[new Fa(this),new Fa(this,1)],setTimeout((()=>this.onCreate()),0)}get projectData(){return this._projectData}get name(){return this.baseDirectory.name}get tabSystem(){return this.tabSystems[0].isActive?this.tabSystems[0]:this.tabSystems[1].isActive?this.tabSystems[1]:void 0}get inactiveTabSystem(){return this.tabSystems[0].isActive?this.tabSystems[1].isActive?void 0:this.tabSystems[1]:this.tabSystems[0]}get baseDirectory(){return this._baseDirectory}get fileSystem(){return this._fileSystem}get isActiveProject(){return this.name===this.parent.selectedProject}async activate(e=!1){var t;if(this.parent.title.setProject(this.name),this.parent.activatedProject.dispatch(this),!e)for(const n of this.tabSystems)await n.activate();await this.extensionLoader.loadExtensions();const i=null==(t=this.tabSystem)?void 0:t.selectedTab;this.typeLoader.activate(i instanceof Bn?i.getProjectPath():void 0),await this.packIndexer.activate(e),await Promise.all([this.jsonDefaults.activate(),this.compilerManager.start("default","dev")]),this.snippetLoader.activate()}deactivate(e=!1){e||this.tabSystems.forEach((e=>e.deactivate())),this.typeLoader.deactivate(),this.packIndexer.deactivate(),this.compilerManager.deactivate(),this.jsonDefaults.deactivate(),this.extensionLoader.disposeAll(),this.snippetLoader.deactivate()}disposeWorkers(){this.packIndexer.dispose(),this.compilerManager.dispose()}dispose(){this.disposeWorkers(),this.tabSystems.forEach((e=>e.dispose())),this.extensionLoader.disposeAll()}async refresh(){this.app.packExplorer.refresh(),this.deactivate(!0),this.disposeWorkers(),await this.activate(!0)}async openFile(e,t={}){var i,n;for(const s of this.tabSystems){const n=await s.getTab(e);if(n)return null==(i=t.selectTab)||i?s.select(n):void 0}null==(n=this.tabSystem)||n.open(e,t)}async closeFile(e){for(const t of this.tabSystems){const i=await t.getTab(e);null==i||i.close()}}async getFileTab(e){for(const t of this.tabSystems){const i=await t.getTab(e);if(void 0!==i)return i}}async getFileTabWithPath(e){for(const t of this.tabSystems){const i=await t.get((t=>t instanceof Bn&&t.getProjectPath()===e));if(void 0!==i)return i}}async openTab(e,t=!0){var i;for(const n of this.tabSystems)if(await n.hasTab(e))return void(t&&n.select(e));null==(i=this.tabSystem)||i.add(e,t)}updateTabFolders(){const e={};for(const t of this.tabSystems)t.tabs.forEach((t=>{if(!(t instanceof Bn))return;const i=t.name;e[i]||(e[i]=[]),e[i].push(t)}));for(const t in e){const i=e[t];if(1===i.length)i[0].setFolderName(null);else{const e=vl(i.map((e=>e.getProjectPath())));i.forEach(((t,i)=>t.setFolderName(e[i])))}}}absolutePath(e){return`projects/${this.name}/${e}`}getProjectPath(e){return this.baseDirectory.resolve(e).then((e=>null==e?void 0:e.join("/")))}async updateFile(e){try{await this.fileSystem.getFileHandle(e)}catch{return}await Promise.all([this.packIndexer.updateFile(e),this.compilerManager.updateFiles("default",[e])]),await this.jsonDefaults.updateDynamicSchemas(e)}async updateFiles(e){await Promise.all([this.packIndexer.updateFiles(e),this.compilerManager.updateFiles("default",e)]),await this.jsonDefaults.updateMultipleDynamicSchemas(e)}async unlinkFile(e){await this.packIndexer.unlink(e),await this.compilerManager.unlink(e),await this.fileSystem.unlink(e)}async updateChangedFiles(){this.packIndexer.deactivate(),this.compilerManager.deactivate(),await this.packIndexer.activate(!0),await this.compilerManager.start("default","dev")}async getFileFromDiskOrTab(e){const t=await this.getFileTabWithPath(e);return t&&t instanceof Bn?await t.getFile():await this.fileSystem.readFile(e)}setActiveTabSystem(e,t){this.tabSystems.forEach((i=>e!==i?i.setActive(t,!1):void 0))}hasPacks(e){var t;for(const i of e)if(!(null==(t=this._projectData.contains)?void 0:t.some((({id:e})=>e===i))))return!1;return!0}getPacks(){var e;return(null!=(e=this._projectData.contains)?e:[]).map((e=>e.id))}addPack(e){this._projectData.contains.push(e)}getFilePath(e,t){return this.config.getPackFilePath(e,t)}isFileWithinAnyPack(e){return this.getPacks().map((e=>this.config.getPackFilePath(e))).some((t=>e.startsWith(t)))}isFileWithinProject(e){return e.startsWith(`projects/${this.name}/`)||this.isFileWithinAnyPack(e)}async loadProject(){await this.config.setup(),S(this,"_projectData",c(l({},this.config.get()),{path:this.name,name:this.name,imgSrc:await $a(this,this.app.fileSystem),contains:[]})),await async function(e,t){var i,n,s;await Dn.ready.fired;const a=Object.keys(null!=(i=t.config.get().packs)?i:Da),r=[];for(const o of a){const i=t.getFilePath(o);if(!(await e.fileSystem.directoryExists(i)))continue;const a=Dn.getFromId(o);if(!a)continue;let d={};try{d=await Ia(e,i)}catch{}r.push(c(l({},a),{packPath:i,version:null!=(s=null==(n=null==d?void 0:d.header)?void 0:n.version)?s:[1,0,0]}))}return r}(this.app,this).then((e=>S(this._projectData,"contains",e.sort(((e,t)=>e.id.localeCompare(t.id))))))}async recompile(e=!0){e&&this.compilerManager.dispose(),e&&this.isActiveProject?this.compilerManager.start("default","dev",!0):await this.fileSystem.writeFile(".bridge/.restartDevServer","")}}{constructor(){super(...arguments),d(this,"commandData",new Yl)}onCreate(){ec.forEach((e=>this.tabActionProvider.registerPreview(e))),this.commandData.loadCommandData("minecraftBedrock")}getCurrentDataPackage(){return this.app.dataLoader.getDirectoryHandle("data/packages/minecraftBedrock")}}_.registerCompletionItemProvider("json",{provideCompletionItems:async(e,t)=>{var i,n,s;const a=await Yp.getApp(),r=a.project;if(!(r instanceof tc))return;const o=r.commandData,l=is(e,t),c=null==(i=a.project.tabSystem)?void 0:i.selectedTab;if(!c)return;const d=await a.dataLoader.readJSON("data/packages/minecraftBedrock/location/validCommand.json"),{id:u,meta:{commandsUseSlash:p}={commandsUseSlash:!1}}=null!=(n=Fn.get(c.getProjectPath()))?n:{id:"unknown",meta:{commandsUseSlash:!1}},h=null!=(s=d[u])?s:[];if(0===h.length)return;if(!kn(l,h)||!ls(e,t))return;let{word:m,range:g}=ns(e,t);if(p&&!m.startsWith("/"))return;let f=!1;m.startsWith("/")&&(m=m.slice(1),f=!0);const{tokens:w}=Jl(m),v=w[w.length-1];return{suggestions:(await o.getNextCompletionItems(w.map((e=>e.word)))).map((({label:e,insertText:i,documentation:n,kind:s})=>({label:null!=e?e:i,insertText:i,documentation:n,kind:s,range:new O(t.lineNumber,Math.min(g.endColumn+1,g.startColumn+v.startColumn+(f?2:1)),t.lineNumber,Math.min(g.endColumn+1,t.column+i.length))})))}}});const ic={brackets:[["(",")","delimiter.parenthesis"],["[","]","delimiter.square"],["{","}","delimiter.curly"]],keywords:[],selectors:["@a","@e","@p","@r","@s"],targetSelectorArguments:[],tokenizer:{root:[[/#.*/,"comment"],[/\{/,{token:"delimiter.bracket",bracket:"@open",next:"@embeddedJson"}],[/\[/,{token:"delimiter.bracket",next:"@targetSelectorArguments",bracket:"@open"}],{include:"@common"},...Ot,[/[a-z_][\w\/]*/,{cases:{"@keywords":"keyword","@default":"identifier"}}],[/@[a|p|r|e|s]/,{cases:{"@selectors":"type.identifier","@default":"identifier"}}]],common:[[/"[^"]*"|'[^']*'/,"string"],[/\=|\,|\!|%=|\*=|\+=|-=|\/=|<|=|>|<>/,"definition"],[/true|false/,"number"],[/-?([0-9]+(\.[0-9]+)?)|(\~|\^-?([0-9]+(\.[0-9]+)?)?)/,"number"]],embeddedJson:[[/\{/,"delimiter.bracket","@embeddedJson"],[/\}/,"delimiter.bracket","@pop"],{include:"@common"}],targetSelectorArguments:[[/\]/,{token:"@brackets",bracket:"@close",next:"@pop"}],[/{/,{token:"@brackets",bracket:"@open",next:"@targetSelectorScore"}],[/[a-z_][\w\/]*/,{cases:{"@targetSelectorArguments":"variable","@default":"identifier"}}],{include:"@common"}],targetSelectorScore:[[/}/,{token:"@brackets",bracket:"@close",next:"@pop"}],{include:"@common"}]}};function nc(e,t){for(let i=t;i<e.length;i++)if("]"==e[i])return i;return-1}const sc={wordPattern:/[aA-zZ]+/,comments:{lineComment:"#"},brackets:[["(",")"],["[","]"],["{","}"]],autoClosingPairs:[{open:"(",close:")"},{open:"[",close:"]"},{open:"{",close:"}"},{open:'"',close:'"'}]},ac={triggerCharacters:[" ","[","{","=",",","!"],async provideCompletionItems(e,t,i,n){const s=await Yp.getApp().then((e=>e.project));if(!(s instanceof tc))return;const a=s.commandData;await a.fired;const r=e.getLineContent(t.lineNumber),o=r.slice(0,t.column-1),l=function(e,t){const i=function(e,t){for(let i=t;i>=0;i--){if("["==e[i])return i;if("]"===e[i])return-1}return-1}(e,t-1);if(-1===i)return!1;let n="",s=i-1;for(;s>=0&&" "!==e[s];)n=e[s]+n,s--;return!!n.startsWith("@")&&{selectorStart:i+1,selectorEnd:nc(e,t)}}(r,t.column-1);if(l){const e=r.slice(l.selectorStart,t.column-1),{tokens:i}=function(e,t=0){let i=0,n=0,s="",a=[];for(;i<e.length;)"="===e[i]?(a.push({startColumn:n+t,endColumn:i+t,word:s}),n=i+1,s="","!"===e[i+1]?(a.push({startColumn:i+t,endColumn:n+t+1,word:"=!"}),i++,n++):a.push({startColumn:i+t,endColumn:n+t,word:"="})):","===e[i]?(a.push({startColumn:n+t,endColumn:i+t,word:s}),n=i+1,s="",a.push({startColumn:i+t,endColumn:n+t,word:","})):(""===e[i].trim()&&n===i&&n++,s+=e[i].trim()),i++;return a.push({startColumn:n+t,endColumn:i+t,word:s}),{tokens:a}}(e,l.selectorStart),n=i[i.length-1];return{suggestions:await a.selectorArguments.getNextCompletionItems(i.map((e=>e.word))).then((e=>e.map((({label:e,insertText:i,documentation:s,kind:a,insertTextRules:r})=>{var o,l;return{label:null!=e?e:i,insertText:i,documentation:s,kind:a,range:new O(t.lineNumber,(null!=(o=null==n?void 0:n.startColumn)?o:0)+1,t.lineNumber,(null!=(l=null==n?void 0:n.endColumn)?l:0)+1),insertTextRules:r}}))))}}const{tokens:c}=Jl(o),d=c[c.length-1];return{suggestions:(await a.getNextCompletionItems(c.map((e=>e.word)))).map((({label:e,insertText:i,documentation:n,kind:s,insertTextRules:a})=>{var r,o;return{label:null!=e?e:i,insertText:i,documentation:n,kind:s,range:new O(t.lineNumber,(null!=(r=null==d?void 0:d.startColumn)?r:0)+1,t.lineNumber,(null!=(o=null==d?void 0:d.endColumn)?o:0)+1),insertTextRules:a}}))}}},rc=async e=>{const t=await Yp.getApp();await t.projectManager.fired;const i=t.project;if(!(i instanceof tc))return;await i.commandData.fired;const n=await i.commandData.allCommands(void 0,!i.compilerManager.hasFired);ic.keywords=n.map((e=>e));const s=await i.commandData.allSelectorArguments();ic.targetSelectorArguments=s,e.updateTokenProvider(ic)};class oc extends Mt{constructor(){super({id:"mcfunction",extensions:["mcfunction"],config:sc,tokenProvider:ic,completionItemProvider:ac});let e=null;const t=Yp.eventSystem.on("projectChanged",(t=>{e=t,rc(this),t.compilerManager.fired.then((()=>{t===e&&rc(this)}))}));Yp.getApp().then((async e=>{await e.projectManager.projectReady.fired,this.disposables.push(e.projectManager.forEachProject((e=>{this.disposables.push(e.fileSave.any.on((([e])=>{"customCommand"===Fn.getId(e)&&rc(this)})))})),t)}))}onModelAdded(e){return!!super.onModelAdded(e)&&(rc(this),!0)}validate(){}}const lc={comments:{lineComment:"#"},brackets:[["(",")"],["[","]"],["{","}"]],autoClosingPairs:[{open:"(",close:")"},{open:"[",close:"]"},{open:"{",close:"}"},{open:"'",close:"'"}]},cc={ignoreCase:!0,brackets:[["(",")","delimiter.parenthesis"],["[","]","delimiter.square"],["{","}","delimiter.curly"]],keywords:["return","loop","for_each","break","continue","this","function"],identifiers:["v","t","c","q","f","a","arg","variable","temp","context","query"],tokenizer:{root:[[/#.*/,"comment"],[/'[^']'/,"string"],[/[0-9]+(\.[0-9]+)?/,"number"],[/true|false/,"number"],[/\=|\,|\!|%=|\*=|\+=|-=|\/=|<|=|>|<>/,"definition"],[/[a-z_$][\w$]*/,{cases:{"@keywords":"keyword","@identifiers":"type.identifier","@default":"identifier"}}]]}};class dc extends Mt{constructor(){super({id:"molang",extensions:["molang"],config:lc,tokenProvider:cc}),d(this,"molang",new ae({}))}validate(e){try{this.molang.parse(e.getValue()),P.setModelMarkers(e,this.id,[])}catch(t){let{startColumn:i=0,endColumn:n=1/0,startLineNumber:s=0,endLineNumber:a=1/0}={};P.setModelMarkers(e,this.id,[{startColumn:i+1,endColumn:n+1,startLineNumber:s+1,endLineNumber:a+1,message:t.message,severity:re.Error}])}}}class uc{constructor(){d(this,"languages",new Set([new dc,new Rt,new oc]))}}const pc=function(e={}){const{immediate:t=!1,onNeedRefresh:i,onOfflineReady:n,onRegistered:s,onRegisterError:a}=e;let r,o;if("serviceWorker"in navigator){r=new oe("/service-worker.js",{scope:"/"}),r.addEventListener("activated",(e=>{e.isUpdate||null==n||n()}));{const e=()=>{null==i||i()};r.addEventListener("waiting",e),r.addEventListener("externalwaiting",e)}r.register({immediate:t}).then((e=>{o=e,null==s||s(e)})).catch((e=>{null==a||a(e)}))}return async(e=!0)=>{e&&(null==r||r.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),o&&o.waiting&&await le(o.waiting,{type:"SKIP_WAITING"})}}({async onNeedRefresh(){console.log("New content is available; please refresh."),await f("firstStartAfterUpdate",!0),"waiting"===Yp.fileSystemSetup.status?pc():Et({icon:"mdi-update",color:"primary",message:"sidebar.notifications.updateAvailable.message",textColor:"white",onClick:()=>pc()})},onOfflineReady(){console.log("bridge. is ready to work offline")}}),hc=e=>({"colorCode.darkRed":{color:"#AA0000"},"colorCode.red":{color:"#FF5555"},"colorCode.gold":{color:"#FFAA00"},"colorCode.yellow":{color:"#FFFF55"},"colorCode.darkGreen":{color:"#00AA00"},"colorCode.green":{color:"#55FF55"},"colorCode.aqua":{color:"#55FFFF"},"colorCode.darkAqua":{color:"#00AAAA"},"colorCode.darkBlue":{color:"#0000AA"},"colorCode.blue":{color:"#5555FF"},"colorCode.lightPurple":{color:"#FF55FF"},"colorCode.darkPurple":{color:"#AA00AA"},"colorCode.white":{color:"#FFFFFF"},"colorCode.gray":{color:"#AAAAAA"},"colorCode.darkGray":{color:"#555555"},"colorCode.black":{color:"#000000"},"colorCode.minecoinGold":{color:"#ff0000"},"colorCode.bold":{color:e,textDecoration:"bold"},"colorCode.italic":{color:e,textDecoration:"italic"},"colorCode.underline":{color:e,textDecoration:"underline"}}),mc={id:"bridge.default.dark",name:"Default Dark",colorScheme:"dark",colors:{text:"#ffffff",primary:zt||zt?"#3bb6a3":"#0073FF",secondary:zt?"#3bb6a3":"#0073FF",accent:zt?"#3bb6a3":"#0073FF",error:"#ff5252",info:"#2196f3",warning:"#fb8c00",success:"#4caf50",background:"#121212",sidebarNavigation:"#1F1F1F",expandedSidebar:"#1F1F1F",sidebarSelection:"#151515",menu:"#252525",footer:"#111111",tooltip:"#1F1F1F",toolbar:"#000000",tabActive:"#121212",tabInactive:"#1F1F1F",lineHighlightBackground:"#292929",scrollbarThumb:"#000000",behaviorPack:"#ff5252",resourcePack:"#0073FF",skinPack:"#fb8c00",worldTemplate:"#4caf50"},highlighter:l({type:{color:"#a6e22e"},keyword:{color:"#f92672"},definition:{color:"#fd971f"},atom:{color:"#ae81ff"},number:{color:"#ae81ff"},string:{color:"#e6db74"},variable:{color:"#6e9eff"},variableStrong:{color:"#6e9eff"},meta:{color:"white"},comment:{color:"#75715e"}},hc("#fff"))},gc={id:"bridge.default.light",name:"Default Light",colorScheme:"light",colors:{text:"#000000",primary:zt?"#3bb6a3":"#0073FF",secondary:zt?"#3bb6a3":"#0073FF",accent:zt?"#3bb6a3":"#0073FF",error:"#ff5252",info:"#2196f3",warning:"#fb8c00",success:"#4caf50",background:"#fafafa",sidebarNavigation:"#e8e8e8",expandedSidebar:"#e8e8e8",sidebarSelection:"#FFFFFF",menu:"#FFFFFF",tooltip:"#424242",toolbar:"#e0e0e0",footer:"#f5f5f5",tabActive:"#fafafa",tabInactive:"#e0e0e0",lineHighlightBackground:"#e0e0e0",scrollbarThumb:"#c8c8c8",behaviorPack:"#ff5252",resourcePack:"#0073FF",skinPack:"#fb8c00",worldTemplate:"#4caf50"},highlighter:l({type:{color:"black"},keyword:{color:"#5A5CAD"},definition:{textDecoration:"underline"},atom:{color:"#6C8CD5"},number:{color:"#164"},string:{color:"red"},variable:{color:"black"},variableStrong:{color:"black"},meta:{color:"yellow"},comment:{color:"#0080FF"}},hc("#000"))};class fc{constructor(e){this.theme=e}apply(){P.defineTheme("bridgeMonacoDefault",{base:"light"===this.theme.colorScheme?"vs":"vs-dark",inherit:!1,colors:l({"editor.background":this.convertColor(this.theme.getColor("background")),"editor.lineHighlightBackground":this.convertColor(this.theme.getColor("lineHighlightBackground")),"editorWidget.background":this.convertColor(this.theme.getColor("background")),"editorWidget.border":this.convertColor(this.theme.getColor("sidebarNavigation")),"pickerGroup.background":this.convertColor(this.theme.getColor("background")),"pickerGroup.border":this.convertColor(this.theme.getColor("sidebarNavigation")),"badge.background":this.convertColor(this.theme.getColor("background")),"input.background":this.convertColor(this.theme.getColor("sidebarNavigation")),"input.border":this.convertColor(this.theme.getColor("menu")),"inputOption.activeBorder":this.convertColor(this.theme.getColor("primary")),focusBorder:this.convertColor(this.theme.getColor("primary")),"list.focusBackground":this.convertColor(this.theme.getColor("menu")),"list.hoverBackground":this.convertColor(this.theme.getColor("sidebarNavigation")),contrastBorder:this.convertColor(this.theme.getColor("sidebarNavigation")),"peekViewTitle.background":this.convertColor(this.theme.getColor("background")),"peekView.border":this.convertColor(this.theme.getColor("primary")),"peekViewResult.background":this.convertColor(this.theme.getColor("sidebarNavigation")),"peekViewResult.selectionBackground":this.convertColor(this.theme.getColor("menu")),"peekViewEditor.background":this.convertColor(this.theme.getColor("background")),"peekViewEditor.matchHighlightBackground":this.convertColor(this.theme.getColor("menu"))},this.theme.getMonacoDefinition()),rules:[{background:this.convertColor(this.theme.getColor("background")),foreground:this.convertColor(this.theme.getColor("text"))},...Object.entries(this.theme.getHighlighterDefinition()).map((([e,{color:t,background:i,textDecoration:n,isItalic:s}])=>({token:e,foreground:this.convertColor(t),background:i?this.convertColor(i):void 0,fontStyle:`${s?"italic ":""}${n}`}))).filter((({foreground:e})=>void 0!==e))]})}convertColor(e){return e?e.startsWith("#")?4===e.length?`#${e[1]}${e[1]}${e[2]}${e[2]}${e[3]}${e[3]}`:e:ce.keyword.hex(e):e}}class wc{constructor(e,t){var i;d(this,"id"),d(this,"colorScheme"),d(this,"name"),d(this,"colorMap"),d(this,"highlighterDef"),d(this,"monacoDef"),d(this,"monacoSubTheme"),this.themeDefinition=e,this.isGlobal=t,this.id=e.id,this.name=e.name,this.colorScheme=null!=(i=e.colorScheme)?i:"dark",this.colorMap=new Map(Object.entries(e.colors)),this.monacoDef=e.monaco,this.highlighterDef=e.highlighter,this.monacoSubTheme=new fc(this)}apply(e,t){var i;u.set(t.theme.themes,this.colorScheme,Object.fromEntries(this.colorMap.entries())),u.set(t.theme,"dark","dark"===this.colorScheme),e.setThemeColor(null!=(i=this.colorMap.get("toolbar"))?i:"red"),this.monacoSubTheme.apply()}getColor(e){var t;return null!=(t=this.colorMap.get(e))?t:"red"}getHighlighterInfo(e){var t;return null==(t=this.highlighterDef)?void 0:t[e]}getMonacoDefinition(){var e;return null!=(e=this.monacoDef)?e:{}}getHighlighterDefinition(){var e;return null!=(e=this.highlighterDef)?e:{}}getThemeDefinition(){return this.themeDefinition}}class vc extends xe{constructor(e){super(),d(this,"mode"),d(this,"themeMap",new Map),d(this,"themeColorTag",document.querySelector("meta[name='theme-color']")),d(this,"currentTheme","bridge.default.dark"),d(this,"colorScheme",new Ce),this.vuetify=e;const t=window.matchMedia("(prefers-color-scheme: light)");this.mode=t.matches?"light":"dark";const i=e=>{this.colorScheme.dispatch(e.matches?"light":"dark"),this.mode=e.matches?"light":"dark",this.updateTheme()};"addEventListener"in t?t.addEventListener("change",(e=>i(e))):t.addListener((e=>i(e))),this.themeColorTag||(this.themeColorTag=document.createElement("meta"),document.head.appendChild(this.themeColorTag)),this.themeColorTag.setAttribute("name","theme-color"),this.themeColorTag.id="theme-color-tag",this.addTheme(mc,!0),this.addTheme(gc,!0),this.applyTheme(this.themeMap.get("bridge.default.dark"))}getCurrentMode(){return this.mode}applyTheme(e){null==e||e.apply(this,this.vuetify)}async updateTheme(){var e,t,i,n,s;const a=await Yp.getApp();let r=null==(e=null==Re?void 0:Re.appearance)?void 0:e.colorScheme;r&&"auto"!==r||(r=this.mode),await a.projectManager.projectReady.fired;const o=a.projectConfig.get().bridge,l=null!=(t="light"===r?null==o?void 0:o.lightTheme:null==o?void 0:o.darkTheme)?t:"bridge.noSelection",c=null!=(n=null==(i=null==Re?void 0:Re.appearance)?void 0:i[`${r}Theme`])?n:`bridge.default.${r}`,d="bridge.noSelection"!==l?l:c,u=this.themeMap.get("bridge.noSelection"!==l?l:c),p=this.themeMap.get(`bridge.default.${r}`);this.currentTheme!==(u?d:`bridge.default.${r}`)&&(this.currentTheme=u?d:`bridge.default.${r}`,this.applyTheme(null!=u?u:p),this.dispatch(null!=(s=null==u?void 0:u.colorScheme)?s:"dark"))}async loadDefaultThemes(e){await e.dataLoader.fired,await Ba(await e.dataLoader.getDirectoryHandle("data/packages/common/themes"),(e=>this.loadTheme(e))),this.updateTheme()}async loadTheme(e,t=!0,i){const n=await e.getFile();let s;try{s=T.parse(await n.text())}catch{throw new Error(`Failed to load theme "${n.name}"`)}const a=this.addTheme(s,t);i&&i.push(a)}getThemes(e,t){const i=[];for(const[n,s]of this.themeMap)e&&s.colorScheme!==e||!s.isGlobal&&t!==s.isGlobal||i.push(s);return i}setThemeColor(e){this.themeColorTag.setAttribute("content",e)}addTheme(e,t){var i,n;const s=this.themeMap.get(`bridge.default.${null!=(i=e.colorScheme)?i:"dark"}`);return this.themeMap.set(e.id,new wc(er(null!=(n=null==s?void 0:s.getThemeDefinition())?n:{},e),t)),this.updateTheme(),{dispose:()=>this.themeMap.delete(e.id)}}getColor(e){const t=this.themeMap.get(this.currentTheme);if(!t)throw new Error("No theme currently loaded");return t.getColor(e)}getHighlighterInfo(e){const t=this.themeMap.get(this.currentTheme);if(!t)throw new Error("No theme currently loaded");return t.getHighlighterInfo(e)}}class yc{}d(yc,"ready",new Ce);const bc=class{constructor(){d(this,"confirmPermissionWindow",null),d(this,"_status","waiting")}get status(){return this._status}setStatus(e){this._status=e}async setupFileSystem(e){let t=await g("bridgeBaseDir");if(!Ie&&t&&(t=await this.verifyPermissions(t)),(Ie||await(async e=>void 0!==await Fe(e))("bridgeFolder"))&&(t=new Me(null,"bridgeFolder",void 0),await t.setupDone.fired),t)yc.ready.dispatch();else{const e=bc.state;e.showInitialSetupDialog.value=!0,t=await e.receiveDirectoryHandle.fired,await this.verifyPermissions(t),t instanceof Me||await f("bridgeBaseDir",t),e.setupDone.dispatch()}return Ie&&!(await g("confirmedUnsupportedBrowser"))&&e.windows.browserUnsupported.open(),this._status="done",t}async verifyPermissions(e,t=!0){const i={writable:!0,mode:"readwrite"};try{t&&"granted"!==await e.requestPermission(i)&&await this.verifyPermissions(e,!1)}catch{}"granted"!==await e.queryPermission(i)&&null===this.confirmPermissionWindow&&(this.confirmPermissionWindow=new Pt({name:"windows.projectFolder.title",description:"windows.projectFolder.content",onClose:async()=>{this._status="userInteracted",this.confirmPermissionWindow=null,"granted"!==await e.requestPermission(i)&&await this.verifyPermissions(e,!1)}}),await this.confirmPermissionWindow.fired);try{await e.getDirectoryHandle("data",{create:!0})}catch{return}return e}};let kc=bc;var Sc,xc;d(kc,"state",{showInitialSetupDialog:R(!1),receiveDirectoryHandle:new Ce,setupDone:new Ce}),(xc=Sc||(Sc={}))[xc.matchCase=0]="matchCase",xc[xc.ignoreCase=1]="ignoreCase",xc[xc.useRegExp=2]="useRegExp";const Cc={};var jc=Le({name:"SearchType",props:{value:Number}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn-toggle",{attrs:{dense:"",mandatory:"",value:e.value},on:{change:function(t){return e.$emit("input",t)}}},[i("v-btn",{staticStyle:{"min-width":"unset"},attrs:{title:"Match Case",color:"menu"}},[i("v-icon",[e._v("mdi-format-letter-case-upper")])],1),i("v-btn",{staticStyle:{"min-width":"unset"},attrs:{title:"Ignore Case",color:"menu"}},[i("v-icon",[e._v("mdi-format-letter-case")])],1),i("v-btn",{staticStyle:{"min-width":"unset"},attrs:{title:"Use Regular Expression",color:"menu"}},[i("v-icon",[e._v("mdi-regex")])],1)],1)}),[],!1,_c,null,null,null);function _c(e){for(let t in Cc)this[t]=Cc[t]}var Pc=function(){return jc.exports}();const Ac={name:"Match",props:{replaceWith:String,showReplaceWith:Boolean,item:Object}},Tc={};var Ec=Le(Ac,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"code-font code-match",staticStyle:{width:"100%","overflow-x":"hidden"}},[i("span",[e._v(e._s(e.item.isStartOfFile?"":"...")+e._s(e.item.beforeMatch))]),i("span",{class:{"error--text text-decoration-line-through":e.showReplaceWith,"success--text":!e.showReplaceWith}},[e._v(e._s(e.item.match))]),e.showReplaceWith?i("span",{staticClass:"success--text"},[e._v(e._s(e.replaceWith))]):e._e(),i("span",[e._v(e._s(e.item.afterMatch)+"...")])])}),[],!1,Fc,"6cc24f6a",null,null);function Fc(e){for(let t in Tc)this[t]=Tc[t]}var Dc=function(){return Ec.exports}();const Oc={};var Mc=Le({name:"FileName",props:{filePath:String},methods:{getFileIcon(e){var t;return null!=(t=(Fn.get(e)||{}).icon)?t:"mdi-file-outline"},getIconColor:e=>(Dn.getWithRelativePath(e)||{}).color,async openFile(e){const t=await Yp.getApp(),i=await t.fileSystem.getFileHandle(`projects/${t.project.name}/${e}`);t.project.openFile(i)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"font-weight-black clickable px-1",staticStyle:{display:"inline-block",width:"fit-content"},on:{click:function(t){return e.openFile(e.filePath)}}},[i("v-icon",{staticStyle:{position:"relative",top:"-2px"},attrs:{small:"",color:e.getIconColor(e.filePath)}},[e._v(" "+e._s(e.getFileIcon(e.filePath))+" ")]),e._v(" "+e._s(e.filePath)+" ")],1)}),[],!1,$c,null,null,null);function $c(e){for(let t in Oc)this[t]=Oc[t]}var Ic=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"px-3"},[i("div",{staticClass:"d-flex",class:{"flex-column":e.hasLimitedSpace}},[i("v-col",{staticClass:"flex-grow-0 flex-shrink-0 align-center",attrs:{cols:e.hasLimitedSpace?12:3}},[i("v-text-field",{staticClass:"mb-2",attrs:{"prepend-inner-icon":"mdi-magnify",outlined:"",dense:"","hide-details":"",autofocus:"mouse"===e.pointerDevice,label:e.t("findAndReplace.search")},model:{value:e.searchFor,callback:function(t){e.searchFor=t},expression:"searchFor"}}),i("v-text-field",{staticClass:"mb-2",attrs:{"prepend-inner-icon":"mdi-file-replace-outline",outlined:"",dense:"","hide-details":"",label:e.t("findAndReplace.replace")},model:{value:e.replaceWith,callback:function(t){e.replaceWith=t},expression:"replaceWith"}}),i("SearchType",{staticClass:"mb-2",model:{value:e.queryOptions.searchType,callback:function(t){e.$set(e.queryOptions,"searchType",t)},expression:"queryOptions.searchType"}}),i("v-btn",{staticClass:"mb-2",attrs:{color:"primary",disabled:""===e.replaceWith||""===e.searchFor,loading:e.tab.isLoading},on:{click:function(t){return e.onReplaceAll()}}},[i("v-icon",{staticClass:"mr-1",attrs:{small:""}},[e._v("mdi-file-replace-outline")]),e._v(" "+e._s(e.t("findAndReplace.replaceAll"))+" ")],1)],1),i("v-col",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{cols:e.hasLimitedSpace?12:9}},[i("v-card",{staticClass:"pa-2",staticStyle:{background:"var(--v-expandedSidebar-base)"},style:"white-space: nowrap; height: "+((e.hasLimitedSpace?400:e.height)-24)+"px",attrs:{outlined:"",rounded:""}},[0===e.queryResults.length?i("p",{staticStyle:{"white-space":"normal"}},[e._v(" "+e._s(e.t("findAndReplace.no"+(""===e.searchFor?"Search":"Results")))+" ")]):e._e(),i("v-virtual-scroll",{ref:"virtualScroller",attrs:{items:e.tab.displayQueryResults,height:(e.hasLimitedSpace?400:e.height)-40,bench:30,"item-height":"22"},nativeOn:{scroll:function(t){return e.onScroll(t)}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return["string"==typeof n?i("div",{staticStyle:{display:"inline-flex",width:"calc(100% - 8px)"}},[i("FilePath",{attrs:{filePath:n}}),i("v-spacer"),i("v-btn",{staticStyle:{position:"relative",top:"3px"},attrs:{icon:"","x-small":"",disabled:""===e.replaceWith},on:{click:function(t){return e.onReplaceSingleFile(n)}}},[i("v-icon",[e._v("mdi-file-replace-outline")])],1)],1):i("Match",{attrs:{showReplaceWith:!!e.replaceWith,replaceWith:e.processReplaceWith(n.match),item:n}})]}}])})],1)],1)],1)])},Rc=[];const Wc={name:"FindAndReplaceTab",mixins:[Be],components:{SearchType:Pc,Match:Dc,FilePath:function(){return Mc.exports}()},props:{tab:Object,height:Number},setup:()=>({pointerDevice:Ss}),mounted(){this.$refs.virtualScroller.$el.scrollTop=this.scrollTop},activated(){this.$refs.virtualScroller.$el.scrollTop=this.scrollTop},data(){return this.tab.state},methods:{updateQuery:E.exports.debounce((async function(){await this.tab.updateQuery()}),750),onScroll(e){this.scrollTop=e.target.scrollTop},onReplaceAll(){this.tab.executeQuery()},processReplaceWith(e){return t=e,i=function(e,t){let i;try{i=new RegExp(t===Sc.useRegExp?e:de(e),"g"+(t===Sc.ignoreCase?"i":""))}catch{return}return i}(this.searchFor,this.queryOptions.searchType),n=this.replaceWith,t.replace(i,((e,...t)=>(t=t.slice(0,-2),n.replace(/{(\d+)}/g,((e,...i)=>{var n;return null!=(n=t[Number(i[0])])?n:e})))));var t,i,n},onReplaceSingleFile(e){this.tab.executeSingleQuery(e)}},computed:{hasLimitedSpace(){return this.$vuetify.breakpoint.mobile||this.tab.parent.isSharingScreen}},watch:{"tab.uuid"(){for(const e in this.tab.state)S(this,e,this.tab.state[e])},searchFor(){this.updateQuery()},"queryOptions.searchType"(){this.updateQuery()},scrollTop(){this.$refs.virtualScroller.$el.scrollTop=this.scrollTop}}},Nc={};var Bc=Le(Wc,Ic,Rc,!1,Lc,null,null,null);function Lc(e){for(let t in Nc)this[t]=Nc[t]}var Hc=function(){return Bc.exports}();const Vc=B(new function(){return new Worker("/assets/Worker.5bf2028f.js",{type:"module"})});class zc extends Nn{constructor(){super(...arguments),d(this,"component",Hc),d(this,"findAndReplace"),d(this,"state",k({scrollTop:0,searchFor:"",replaceWith:"",queryOptions:{searchType:Sc.matchCase},queryResults:[]})),d(this,"searchReady",new Ce)}get displayQueryResults(){return this.state.queryResults.map((({filePath:e,matches:t})=>[e,...t])).flat()}async setup(){this.findAndReplace=await new Vc(this.parent.projectRoot),await super.setup(),this.searchReady.dispatch()}async updateQuery(){await this.searchReady.fired,this.searchReady.resetSignal(),this.isLoading=!0,this.state.queryResults=await this.findAndReplace.createQuery(this.state.searchFor,this.state.queryOptions),this.isLoading=!1,this.state.scrollTop=0,this.searchReady.dispatch()}async executeQuery(){await this.searchReady.fired,this.searchReady.resetSignal(),this.isLoading=!0,await this.findAndReplace.executeQuery(this.state.searchFor,this.state.replaceWith,this.state.queryOptions),await this.parent.app.project.updateFiles(this.state.queryResults.map((({filePath:e})=>e))),this.state.queryResults=[],this.state.scrollTop=0,this.isLoading=!1,this.searchReady.dispatch()}async executeSingleQuery(e){await this.searchReady.fired,this.searchReady.resetSignal(),this.isLoading=!0;const t=await this.findAndReplace.setMatchedFiles([e]);await this.findAndReplace.executeQuery(this.state.searchFor,this.state.replaceWith,this.state.queryOptions),await this.findAndReplace.setMatchedFiles(t.filter((t=>t!==e))),await this.parent.app.project.updateFile(e),this.state.queryResults=this.state.queryResults.filter((t=>t.filePath!==e)),this.isLoading=!1,this.searchReady.dispatch()}static is(){return!1}async is(){return!1}async onActivate(){}get icon(){return"mdi-file-search-outline"}get iconColor(){return"success"}get name(){return this.parent.app.locales.translate("findAndReplace.name")}save(){}}class Uc{constructor(e){this.handle=e}async package(){let e={};return await Ba(this.handle,(async(t,i)=>{const n=await t.getFile();e[i]=new Uint8Array(await n.arrayBuffer())})),ue(e)}}async function Gc(){const e=await Yp.getApp();e.windows.loadingWindow.open();const t=new Uc(Ie?e.fileSystem.baseDirectory:e.project.baseDirectory),i=`projects/${e.project.name}/builds/${e.project.name}.brproject`;try{await Wl(i,await t.package(),e.fileSystem)}catch(n){console.error(n)}e.windows.loadingWindow.close()}class Jc extends class{constructor(e){d(this,"fileSystem"),d(this,"task"),this.directory=e,this.fileSystem=new La(e)}createTask(e,t={icon:"mdi-folder-zip",name:"taskManager.tasks.unzipper.name",description:"taskManager.tasks.unzipper.description"}){this.task=e.create(t)}}{unzip(e){return new Promise((async(t,i)=>{X(e,(async(e,n)=>{var s,a,r,o,l;if(e)return i(e);const c=new La(this.directory);null==(s=this.task)||s.update(0,Object.keys(n).length);let d=0;for(const t in n){Tn(t).startsWith(".")?(null==(a=this.task)||a.update(++d),n[t]=void 0):t.endsWith("/")?(null==(r=this.task)||r.update(++d),n[t]=void 0):(await this.fileSystem.write(await c.getFileHandle(t,!0),n[t]),n[t]=void 0,null==(o=this.task)||o.update(++d))}null==(l=this.task)||l.complete(),t()})),e=void 0}))}}async function qc(e,t=!1){const i=await Yp.getApp(),n=i.fileSystem,s=await n.getDirectoryHandle("import",{create:!0}),a=new Jc(s);t||await i.projectManager.projectReady.fired;const r=await e.getFile(),o=new Uint8Array(await r.arrayBuffer());a.createTask(i.taskManager),await a.unzip(o);let l="import";if(!(await n.fileExists("import/config.json"))){if(Ie){try{await n.move("import/data","data")}catch{}try{await n.move("import/extensions","extensions")}catch{}await Do.loadSettings(i),await i.extensionLoader.reload(),i.locales.setDefaultLanguage()}try{const[e]=await n.readdir("import/projects");l=`import/projects/${e}`}catch{return}}if(Ie&&!t){const e=new vo({description:"windows.projectChooser.openNewProject.saveCurrentProject",cancelText:"general.no",confirmText:"general.yes"});await e.fired&&await Gc()}const c="import"===l?`projects/${Tn(e.name,".brproject")}`:l.replace("import/","");let d;await n.move(l,c),t||(d=i.project.name),yc.ready.hasFired&&await i.projectManager.addProject(await n.getDirectoryHandle(c),!0),Ie&&!t&&await i.projectManager.removeProject(d),await n.unlink("import")}const Kc={name:"SelectedStatus",mixins:[Be],props:{selected:{type:Boolean,required:!0}}},Qc={};var Xc=Le(Kc,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d-flex align-center mb-2"},[e.selected?[i("v-icon",{staticClass:"mr-1",attrs:{color:"success",small:""}},[e._v(" mdi-checkbox-marked-circle-outline ")]),i("span",[e._v(" "+e._s(e.t("general.active"))+" ")])]:[i("v-icon",{staticClass:"mr-1",attrs:{small:""}},[e._v(" mdi-checkbox-blank-circle-outline ")]),i("span",[e._v(" "+e._s(e.t("general.inactive"))+" ")])]],2)}),[],!1,Zc,null,null,null);function Zc(e){for(let t in Qc)this[t]=Qc[t]}var Yc=function(){return Xc.exports}();const ed={name:"BridgeSheet",props:{dark:Boolean}},td={};var id=Le(ed,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"rounded-lg",class:{"bg-dark":e.dark,bg:!e.dark}},[e._t("default")],2)}),[],!1,nd,"70b3f4d8",null,null);function nd(e){for(let t in td)this[t]=td[t]}var sd=function(){return id.exports}();const ad={name:"PackTypeViewer",mixins:[Be],components:{SelectedStatus:Yc,BridgeSheet:sd},props:{packType:Object,selected:Boolean,isSelectable:Boolean}},rd={};var od=Le(ad,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BridgeSheet",{directives:[{name:"ripple",rawName:"v-ripple",value:e.isSelectable,expression:"isSelectable"}],class:{"rounded-lg pa-3 content-area":!0,selected:e.selected},nativeOn:{click:function(t){return t.stopPropagation(),e.$emit("click")}}},[i("div",{staticClass:"d-flex"},[i("v-icon",{staticClass:"mr-2",attrs:{color:e.packType.color}},[e._v(" "+e._s(e.packType.icon)+" ")]),i("h1",{staticClass:"header"},[e._v(" "+e._s(e.t("packType."+e.packType.id+".name"))+" ")])],1),e.isSelectable?i("SelectedStatus",{attrs:{selected:e.selected}}):e._e(),e.packType.version?i("div",{staticClass:"mb-2"},[e._v(" Pack Version: v"+e._s(e.packType.version.join("."))+" ")]):e._e(),i("span",[e._v(e._s(e.t("packType."+e.packType.id+".description")))]),e._t("default",null,{selected:e.selected})],2)}),[],!1,ld,"6c7805f7",null,null);function ld(e){for(let t in rd)this[t]=rd[t]}var cd=function(){return od.exports}();const dd={name:"ToogleSheet",components:{BridgeSheet:sd},props:{value:Boolean,dark:Boolean,isToggleable:{type:Boolean,default:!0}},data(){return{internalValue:this.value}},methods:{onClick(){this.isToggleable&&(this.internalValue=!this.internalValue,this.$emit("input",this.internalValue))}}},ud={};var pd=Le(dd,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("BridgeSheet",{directives:[{name:"ripple",rawName:"v-ripple",value:e.isToggleable,expression:"isToggleable"}],class:{"content-area pa-2":!0,selected:e.internalValue},attrs:{dark:e.dark},nativeOn:{click:function(t){return e.onClick(t)}}},[e._t("default",null,{value:e.internalValue})],2)}),[],!1,hd,"573a92b2",null,null);function hd(e){for(let t in ud)this[t]=ud[t]}var md=function(){return pd.exports}();const gd={name:"ExperimentalGameplay",mixins:[Be],components:{ToggleSheet:md,SelectedStatus:Yc},props:{experiment:{type:Object,required:!0},isToggleable:{type:Boolean,default:!0},value:Boolean,dense:Boolean}},fd={};var wd=Le(gd,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ToggleSheet",{attrs:{value:e.value,dark:!0,isToggleable:e.isToggleable},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.value;return[i("div",{staticClass:"d-flex align-center"},[i("v-icon",{staticClass:"mr-1",attrs:{color:"primary"}},[e._v(" "+e._s(e.experiment.icon)+" ")]),i("h1",{staticClass:"header"},[e._v(" "+e._s(e.t("experimentalGameplay."+e.experiment.id+".name"))+" ")])],1),i("SelectedStatus",{attrs:{selected:n}}),e.dense?e._e():i("p",[e._v(" "+e._s(e.t("experimentalGameplay."+e.experiment.id+".description"))+" ")])]}}])})}),[],!1,vd,"219a16e7",null,null);function vd(e){for(let t in fd)this[t]=fd[t]}var yd=function(){return wd.exports}();const bd={name:"ExperimentalGameplay",mixins:[Be],components:{ToggleSheet:md,SelectedStatus:Yc},props:{file:{type:Object,required:!0},isToggleable:{type:Boolean,default:!0},value:Boolean}},kd={};var Sd=Le(bd,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ToggleSheet",{attrs:{value:e.value,dark:!0,isToggleable:e.isToggleable},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.value;return[i("div",{staticClass:"d-flex align-center"},[i("v-icon",{staticClass:"mr-1",attrs:{color:"primary"}},[e._v(" "+e._s(e.file.icon)+" ")]),i("h1",{staticClass:"header"},[e._v(" "+e._s(e.t("windows.createProject.individualFiles.file."+e.file.id+".name"))+" ")])],1),i("h2",{staticClass:"text-normal font-weight-light"},[e._v(" "+e._s(e.t("packType."+e.file.packId+".name"))+" ")]),i("SelectedStatus",{attrs:{selected:n}}),i("p",[e._v(" "+e._s(e.t("windows.createProject.individualFiles.file."+e.file.id+".description"))+" ")])]}}])})}),[],!1,xd,"6f4db92c",null,null);function xd(e){for(let t in kd)this[t]=kd[t]}function Cd(e,t){if(!t||"*"===t)return!0;const i=t.split(","),n=e.name||"",s=e.type||"",a=s.replace(/\/.*$/,"");return i.some((e=>{const t=e.trim();return"."===t.charAt(0)?n.toLowerCase().endsWith(t.toLowerCase()):/\/\*$/.test(t)?a===t.replace(/\/.*$/,""):s===t}))}const jd={};var _d=Le({name:"CreateProjectWindow",mixins:[Be],components:{BaseWindow:St,PackTypeViewer:cd,BridgeSheet:sd,ExperimentalGameplay:yd,CreateFile:function(){return Sd.exports}()},props:["currentWindow"],data(){return this.currentWindow},computed:{shouldLoad(){return this.isFirstProject,this.isCreatingProject},nameRules(){return this.projectNameRules.map((e=>t=>{const i=e(t);return!0===i||this.t(i)}))}},methods:{close(){this.currentWindow.close()},async createProject(){this.isCreatingProject=!0,await this.currentWindow.createProject(),this.isCreatingProject=!1,this.currentWindow.close()},togglePack(e){const t=this.createOptions.packs,i=t.indexOf(e);i>-1?t.splice(i,1):t.push(e)},setModel(e,t){this.createOptions[e]=t},onDropFile(e){const t=e.dataTransfer.files[0];Cd(t,"image/png")&&(this.createOptions.icon=t)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:"windows.createProject.title",isVisible:e.isVisible,hasMaximizeButton:!1,hasCloseButton:!e.isFirstProject,isFullscreen:!1,isPersistent:e.isCreatingProject||e.isFirstProject,percentageWidth:80,percentageHeight:80},on:{closeWindow:e.close},scopedSlots:e._u([{key:"default",fn:function(){return[e.isFirstProject?i("BridgeSheet",{staticClass:"pa-3 mb-2"},[i("h1",[e._v(" "+e._s(e.t("windows.createProject.welcome"))+" ")]),i("span",[e._v(" "+e._s(e.t("windows.createProject.welcomeDescription"))+" ")])]):e._e(),i("v-row",{staticClass:"mb-6",attrs:{dense:""}},e._l(e.availablePackTypes,(function(t){return i("v-col",{key:t.id,attrs:{xs:"12",sm:"6",md:"4",lg:"3",xl:"2"}},[i("PackTypeViewer",{staticStyle:{height:"100%"},attrs:{packType:t,isSelectable:"",selected:e.createOptions.packs.includes(t.id)},on:{click:function(i){return e.togglePack(t.id)}},scopedSlots:e._u(["behaviorPack"===t.id?{key:"default",fn:function(t){var n=t.selected;return[i("v-switch",{staticClass:"mt-3",attrs:{inset:"",dense:"",label:e.t("windows.createProject.bpAsRpDependency"),value:e.createOptions.rpAsBpDependency||e.createOptions.packs.includes("resourcePack"),disabled:!n||!e.createOptions.packs.includes("resourcePack")},nativeOn:{click:function(t){t.stopPropagation(),e.createOptions.bpAsRpDependency=!e.createOptions.bpAsRpDependency}}})]}}:"resourcePack"===t.id?{key:"default",fn:function(t){var n=t.selected;return[i("v-switch",{staticClass:"mt-3",attrs:{inset:"",dense:"",label:e.t("windows.createProject.rpAsBpDependency"),value:e.createOptions.rpAsBpDependency||e.createOptions.packs.includes("behaviorPack"),disabled:!n||!e.createOptions.packs.includes("behaviorPack")},nativeOn:{click:function(t){t.stopPropagation(),e.createOptions.rpAsBpDependency=!e.createOptions.rpAsBpDependency}}})]}}:null],null,!0)})],1)})),1),i("v-expansion-panels",{staticClass:"mb-6"},[i("v-expansion-panel",[i("v-expansion-panel-header",{attrs:{color:"expandedSidebar","expand-icon":"mdi-menu-down"}},[e._v(" "+e._s(e.t("general.experimentalGameplay"))+" ")]),i("v-expansion-panel-content",{attrs:{color:"expandedSidebar"}},[i("v-row",{attrs:{dense:""}},e._l(e.experimentalToggles,(function(t){return i("v-col",{key:t.id,attrs:{xs:"12",sm:"6",md:"4",lg:"3",xl:"2"}},[i("ExperimentalGameplay",{staticStyle:{height:"100%"},attrs:{experiment:t},model:{value:e.createOptions.experimentalGameplay[t.id],callback:function(i){e.$set(e.createOptions.experimentalGameplay,t.id,i)},expression:"\n\t\t\t\t\t\t\t\t\tcreateOptions.experimentalGameplay[\n\t\t\t\t\t\t\t\t\t\texperiment.id\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t"}})],1)})),1)],1)],1)],1),e.$data.packCreateFiles.length>0?i("v-expansion-panels",{staticClass:"mb-6"},[i("v-expansion-panel",[i("v-expansion-panel-header",{attrs:{color:"expandedSidebar","expand-icon":"mdi-menu-down"}},[e._v(" "+e._s(e.t("windows.createProject.individualFiles.name"))+" ")]),i("v-expansion-panel-content",{attrs:{color:"expandedSidebar"}},[i("v-row",{attrs:{dense:""}},e._l(e.$data.packCreateFiles,(function(t,n){return i("v-col",{key:n+"-"+t.id,attrs:{xs:"12",sm:"6",md:"4",lg:"3",xl:"3"}},[i("CreateFile",{staticStyle:{height:"100%"},attrs:{file:t},model:{value:t.isActive,callback:function(i){e.$set(t,"isActive",i)},expression:"file.isActive"}})],1)})),1)],1)],1)],1):e._e(),i("div",{staticClass:"d-flex"},[i("div",{staticStyle:{width:"40%"},on:{drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onDropFile(t)},dragover:function(e){e.preventDefault(),e.stopPropagation()}}},[i("v-file-input",{staticClass:"mr-2",attrs:{label:e.t("windows.createProject.packIcon"),"prepend-icon":null,"prepend-inner-icon":"mdi-image-outline",accept:"image/png",outlined:"",dense:""},model:{value:e.createOptions.icon,callback:function(t){e.$set(e.createOptions,"icon",t)},expression:"createOptions.icon"}})],1),i("v-text-field",{staticClass:"ml-2",attrs:{label:e.t("windows.createProject.projectName.name"),rules:e.nameRules,autocomplete:"off",outlined:"",dense:""},model:{value:e.createOptions.name,callback:function(t){e.$set(e.createOptions,"name",t)},expression:"createOptions.name"}})],1),i("v-textarea",{attrs:{label:e.t("windows.createProject.projectDescription"),autocomplete:"off","auto-grow":"",rows:"1",counter:"",outlined:"",dense:""},model:{value:e.createOptions.description,callback:function(t){e.$set(e.createOptions,"description",t)},expression:"createOptions.description"}}),i("div",{staticClass:"d-flex"},[i("v-text-field",{staticClass:"mr-2",attrs:{label:e.t("windows.createProject.projectPrefix"),autocomplete:"off",outlined:"",dense:""},model:{value:e.createOptions.namespace,callback:function(t){e.$set(e.createOptions,"namespace",t)},expression:"createOptions.namespace"}}),i("v-text-field",{staticClass:"mx-2",attrs:{label:e.t("windows.createProject.projectAuthor"),autocomplete:"off",outlined:"",dense:""},model:{value:e.createOptions.author,callback:function(t){e.$set(e.createOptions,"author",t)},expression:"createOptions.author"}}),i("v-autocomplete",{staticClass:"ml-2",attrs:{label:e.t("windows.createProject.projectTargetVersion"),autocomplete:"off",items:e.availableTargetVersions,loading:e.availableTargetVersionsLoading,outlined:"",dense:"","menu-props":{maxHeight:220}},model:{value:e.createOptions.targetVersion,callback:function(t){e.$set(e.createOptions,"targetVersion",t)},expression:"createOptions.targetVersion"}})],1),i("div",{staticClass:"d-flex"},[i("v-switch",{staticClass:"ma-3",attrs:{inset:"",dense:"",label:e.t("windows.createProject.useLangForManifest"),value:e.createOptions.useLangForManifest},nativeOn:{click:function(t){t.stopPropagation(),e.createOptions.useLangForManifest=!e.createOptions.useLangForManifest}}})],1)]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary",disabled:!e.currentWindow.hasRequiredData||e.isCreatingProject,loading:e.shouldLoad},on:{click:e.createProject}},[i("v-icon",{staticClass:"pr-2"},[e._v("mdi-plus")]),i("span",[e._v(e._s(e.t("windows.createProject.create")))])],1)]},proxy:!0}],null,!1,3080505887)}):e._e()}),[],!1,Pd,"0dd7079f",null,null);function Pd(e){for(let t in jd)this[t]=jd[t]}var Ad=function(){return _d.exports}();class Td{async create(e,t){await e.mkdir(this.packPath);for(const i of this.createFiles)i.isActive&&await i.create(e,t)}}class Ed{constructor(){d(this,"icon","mdi-file-outline"),d(this,"isActive",!0),d(this,"isConfigurable",!0)}}class Fd extends Ed{constructor(e){super(),d(this,"id","packManifest"),d(this,"isConfigurable",!1),this.pack=e}get type(){switch(this.pack){case"BP":return"data";case"RP":return"resources";case"SP":return"skin_pack";case"WT":return"world_template"}}async transformTargetVersion(e,t){var i;const n=await Yp.getApp();return null!=(i=(await n.dataLoader.readJSON("data/packages/minecraftBedrock/minEngineVersionMap.json"))[t])?i:t}async create(e,t){var i,n,s,a,r,o;t.packs.includes("behaviorPack")&&(null!=(i=t.uuids).data||(i.data=h())),t.packs.includes("resourcePack")&&(null!=(n=t.uuids).resources||(n.resources=h())),t.packs.includes("skinPack")&&(null!=(s=t.uuids).skin_pack||(s.skin_pack=h())),t.packs.includes("worldTemplate")&&(null!=(a=t.uuids).world_template||(a.world_template=h()));const l={format_version:2,metadata:{authors:Array.isArray(t.author)?t.author:[t.author],generated_with:{bridge:["2.1.5"]}},header:{name:t.useLangForManifest?t.name:"pack.name",description:t.useLangForManifest?t.description:"pack.description",min_engine_version:(this.type,(await this.transformTargetVersion(e,t.targetVersion)).split(".").map((e=>Number(e)))),uuid:null!=(o=t.uuids[null!=(r=this.type)?r:"data"])?o:h(),version:[1,0,0]},modules:[{type:this.type,uuid:h(),version:[1,0,0]}]};if(t.rpAsBpDependency&&t.packs.includes("resourcePack")&&"data"===this.type){if(!t.uuids.resources)throw new Error("Trying to register RP uuid before it was defined");l.dependencies=[{uuid:t.uuids.resources,version:[1,0,0]}]}if(t.bpAsRpDependency&&t.packs.includes("behaviorPack")&&"resources"===this.type){if(!t.uuids.data)throw new Error("Trying to register RP uuid before it was defined");l.dependencies=[{uuid:t.uuids.data,version:[1,0,0]}]}"data"===this.type&&t.experimentalGameplay.additionalModdingCapabilities&&l.modules.push({type:"client_data",uuid:h(),version:[1,0,0]}),"data"===this.type&&t.experimentalGameplay.enableGameTestFramework&&(l.modules.push({type:"javascript",uuid:h(),entry:"scripts/main.js",version:[1,0,0]}),null!=l.dependencies||(l.dependencies=[]),l.dependencies.push({uuid:"b26a4d4c-afdf-4690-88f8-931846312678",version:[0,1,0]},{uuid:"6f4b6893-1bb6-42fd-b458-7fa3d0c89616",version:[0,1,0]})),"world_template"===this.type&&(l.header.lock_template_options=!0,l.header.base_game_version=t.targetVersion.split(".").map((e=>Number(e)))),await e.writeJSON(`${this.pack}/manifest.json`,l,!0)}}class Dd extends Ed{constructor(e){super(),d(this,"id","lang"),d(this,"isConfigurable",!1),this.packPath=e}async create(e,t){"BP"===this.packPath&&t.useLangForManifest||(await e.mkdir(`${this.packPath}/texts`),await e.writeFile(`${this.packPath}/texts/en_US.lang`,t.useLangForManifest?"":`pack.name=${t.name} ${this.packPath}\npack.description=${t.description}`),await e.writeJSON(`${this.packPath}/texts/languages.json`,["en_US"],!0))}}class Od extends Ed{constructor(e){super(),d(this,"id","packIcon"),d(this,"isConfigurable",!1),this.packPath=e}async create(e,t){let i=t.icon;if(!i){const e=await Yp.getApp();await e.dataLoader.fired,i=await e.dataLoader.readFile("data/packages/common/packIcon.png")}await e.writeFile(`${this.packPath}/pack_icon.png`,i)}}class Md extends Ed{constructor(){super(...arguments),d(this,"id","tick")}async create(e,t){await e.writeJSON("BP/functions/tick.json",{values:[]},!0)}}class $d extends Ed{constructor(){super(...arguments),d(this,"id","gameTestMain"),d(this,"isConfigurable",!1)}async create(e,t){t.experimentalGameplay.enableGameTestFramework&&(await e.mkdir("BP/scripts",{recursive:!0}),await e.writeFile("BP/scripts/main.js",""))}}class Id extends Ed{constructor(){super(...arguments),d(this,"id","player")}async create(e){const t=await Yp.getApp();await t.dataLoader.fired;const i=await t.dataLoader.readJSON("data/packages/minecraftBedrock/vanilla/player.json");await e.writeJSON("BP/entities/player.json",i,!0),await e.writeFile("BP/loot_tables/empty.json","{}")}}class Rd extends Td{constructor(){super(...arguments),d(this,"packPath","BP"),d(this,"createFiles",[new Fd(this.packPath),new Dd(this.packPath),new Od(this.packPath),new Md,new $d,new Id])}}class Wd extends Ed{constructor(){super(...arguments),d(this,"id","blocks")}async create(e,t){await e.writeJSON("RP/blocks.json",{format_version:[1,1,0]},!0)}}class Nd extends Ed{constructor(){super(...arguments),d(this,"id","itemTexture")}async create(e,t){await e.mkdir("RP/textures",{recursive:!0}),await e.writeJSON("RP/textures/item_texture.json",{resource_pack_name:t.name,texture_name:"atlas.items",texture_data:{}},!0)}}class Bd extends Ed{constructor(){super(...arguments),d(this,"id","terrainTexture")}async create(e,t){await e.mkdir("RP/textures",{recursive:!0}),await e.writeJSON("RP/textures/terrain_texture.json",{num_mip_levels:4,padding:8,resource_pack_name:t.name,texture_name:"atlas.terrain",texture_data:{}},!0)}}class Ld extends Ed{constructor(){super(...arguments),d(this,"id","flipbookTextures")}async create(e,t){await e.mkdir("RP/textures",{recursive:!0}),await e.writeJSON("RP/textures/flipbook_textures.json",[],!0)}}class Hd extends Ed{constructor(){super(...arguments),d(this,"id","biomesClient")}async create(e,t){await e.writeJSON("RP/biomes_client.json",{biomes:{}},!0)}}class Vd extends Ed{constructor(){super(...arguments),d(this,"id","sounds")}async create(e,t){await e.writeJSON("RP/sounds.json",{},!0)}}class zd extends Ed{constructor(){super(...arguments),d(this,"id","soundDefinitions")}async create(e,t){await e.mkdir("RP/sounds",{recursive:!0}),await e.writeJSON("RP/sounds/sound_definitions.json",{sound_definitions:{}},!0)}}class Ud extends Td{constructor(){super(...arguments),d(this,"packPath","RP"),d(this,"createFiles",[new Fd(this.packPath),new Dd(this.packPath),new Od(this.packPath),new Wd,new Nd,new Bd,new Ld,new Hd,new Vd,new zd])}}class Gd extends Ed{constructor(){super(...arguments),d(this,"id","skins")}create(e,t){return e.writeJSON("SP/skins.json",{geometry:"skinpacks/skins.json",skins:[],serialize_name:t.namespace,localization_name:t.namespace},!0)}}class Jd extends Td{constructor(){super(...arguments),d(this,"packPath","SP"),d(this,"createFiles",[new Fd(this.packPath),new Dd(this.packPath),new Od(this.packPath),new Gd])}}class qd extends Ed{constructor(){super(...arguments),d(this,"id","compilerConfig"),d(this,"isConfigurable",!1)}async create(e,t){await e.mkdir(".bridge/compiler")}}class Kd extends Td{constructor(){super(...arguments),d(this,"packPath",".bridge"),d(this,"createFiles",[new qd])}}class Qd extends Ed{constructor(){super(...arguments),d(this,"id","gitignore")}async create(e,t){await e.writeFile(".gitignore","Desktop.ini    \n.DS_Store \n!.bridge/\n.bridge/*\n!.bridge/compiler/\n!.bridge/extensions\n!.bridge/config.json\nbuilds")}}class Xd extends Td{constructor(){super(...arguments),d(this,"packPath","WT"),d(this,"createFiles",[new Fd(this.packPath)])}}class Zd extends Ed{constructor(){super(...arguments),d(this,"id","bridgeConfig")}async create(e,t){await e.writeJSON("config.json",{type:"minecraftBedrock",name:t.name,namespace:t.namespace,authors:Array.isArray(t.author)?t.author:[t.author],targetVersion:t.targetVersion,description:t.description,experimentalGameplay:t.experimentalGameplay,packs:Object.fromEntries(t.packs.filter((e=>".bridge"!==e)).map((e=>[e,Da[e]]))),compiler:{plugins:["typeScript","entityIdentifierAlias","customEntityComponents","customItemComponents","customBlockComponents","customCommands","moLang",["simpleRewrite",{packName:t.name}]]}},!0)}}class Yd extends Je{constructor(){super(Ad,!1),d(this,"isFirstProject",!1),d(this,"createOptions",this.getDefaultOptions()),d(this,"isCreatingProject",!1),d(this,"availableTargetVersions",[]),d(this,"availableTargetVersionsLoading",!0),d(this,"packs",{behaviorPack:new Rd,resourcePack:new Ud,skinPack:new Jd,worldTemplate:new Xd,".bridge":new Kd}),d(this,"availablePackTypes",[]),d(this,"createFiles",[new Qd,new Zd]),d(this,"experimentalToggles",[]),d(this,"projectNameRules",[e=>null!==e.match(/^[a-zA-Z0-9_ ]*$/)||"windows.createProject.projectName.invalidLetters",e=>""!==e.trim()||"windows.createProject.projectName.mustNotBeEmpty"]),this.defineWindow(),Yp.ready.once((async e=>{await e.dataLoader.fired,this.availableTargetVersions=(await e.dataLoader.readJSON("data/packages/minecraftBedrock/formatVersions.json")).reverse(),this.createOptions.targetVersion=this.availableTargetVersions[0],this.availableTargetVersionsLoading=!1,this.experimentalToggles=await e.dataLoader.readJSON("data/packages/minecraftBedrock/experimentalGameplay.json"),this.createOptions.experimentalGameplay=Object.fromEntries(this.experimentalToggles.map((e=>[e.id,!1])))})),Dn.ready.once((()=>{this.availablePackTypes=Dn.all()}))}get packCreateFiles(){return Object.entries(this.packs).map((([e,t])=>this.createOptions.packs.includes(e)?t.createFiles.map((t=>Object.assign(t,{packId:e}))):[])).flat().filter((e=>e.isConfigurable))}get hasRequiredData(){return this.createOptions.packs.length>1&&this.projectNameRules.every((e=>!0===e(this.createOptions.name)))&&this.createOptions.namespace.length>0&&this.createOptions.author.length>0&&this.createOptions.targetVersion.length>0}open(e=!1){this.createOptions=this.getDefaultOptions(),this.isFirstProject=e,this.packCreateFiles.forEach((e=>e.isActive=!0)),super.open()}async createProject(){const e=await Yp.getApp();if(Ie&&!this.isFirstProject){const e=new vo({description:"windows.createProject.saveCurrentProject",cancelText:"general.no",confirmText:"general.yes"});await e.fired&&await Gc()}const t=e.fileSystem,i=await t.getDirectoryHandle(`projects/${this.createOptions.name}`,{create:!0}),n=new La(i);for(const r of this.createFiles)await r.create(n,this.createOptions);const s=this.createOptions.packs.sort(((e,t)=>t.localeCompare(e)));for(const r of s)await this.packs[r].create(n,this.createOptions);let a;this.isFirstProject||(a=e.project.name),await e.projectManager.addProject(i),await e.extensionLoader.installFilesToCurrentProject(),Ie&&!this.isFirstProject&&await e.projectManager.removeProject(a),this.createOptions=this.getDefaultOptions(),await Yp.audioManager.playAudio("confirmation_002.ogg",1)}static getDefaultOptions(){var e,t;return{author:null!=(t=null==(e=null==Re?void 0:Re.projects)?void 0:e.defaultAuthor)?t:"",description:"",icon:null,name:"",namespace:"bridge",targetVersion:"",packs:[".bridge","behaviorPack","resourcePack"],rpAsBpDependency:!1,bpAsRpDependency:!1,useLangForManifest:!1,experimentalGameplay:{},uuids:{}}}getDefaultOptions(){return c(l({},Yd.getDefaultOptions()),{targetVersion:this.availableTargetVersions?this.availableTargetVersions[0]:"",experimentalGameplay:this.experimentalToggles?Object.fromEntries(this.experimentalToggles.map((e=>[e.id,!1]))):{}})}static async loadFromConfig(){var e,t,i,n,s,a,r;const o=await Yp.getApp();let l;try{return l=await o.project.fileSystem.readJSON("config.json"),{author:null!=(e=l.author)?e:"",description:null!=(t=l.description)?t:"",icon:null,name:null!=(i=l.name)?i:"",namespace:null!=(n=l.namespace)?n:"bridge",targetVersion:null!=(s=l.targetVersion)?s:"",packs:null!=(a=l.packs)?a:[".bridge","behaviorPack","resourcePack"],useLangForManifest:!1,rpAsBpDependency:!1,bpAsRpDependency:!1,experimentalGameplay:null!=(r=l.experimentalGameplay)?r:{},uuids:{}}}catch{return this.getDefaultOptions()}}}async function eu(e,t=!1){var i,n,s;const a=await Yp.getApp(),r=a.fileSystem,o=await r.getDirectoryHandle("import",{create:!0}),l=new Jc(o);t||await a.projectManager.projectReady.fired;const c=await e.getFile(),d=new Uint8Array(await c.arrayBuffer());l.createTask(a.taskManager),await l.unzip(d);const u=e.name.replace(".mcaddon","");if(Ie&&!t){const e=new vo({description:"windows.projectChooser.openNewProject.saveCurrentProject",cancelText:"general.no",confirmText:"general.yes"});await e.fired&&await Gc()}let p,h;const m=[".bridge"];for await(const w of o.values())if("directory"===w.kind&&await r.fileExists(`import/${w.name}/manifest.json`)){const e=await r.readJSON(`import/${w.name}/manifest.json`),t=null!=(i=null==e?void 0:e.modules)?i:[];p||(p=null==(n=null==e?void 0:e.metadata)?void 0:n.authors),h||(h=null==(s=null==e?void 0:e.header)?void 0:s.description);const a=tu(t);if(!a)return;m.push(a);const o=Da[a];await r.move(`import/${w.name}`,`projects/${u}/${o}`)}const g=Yd.getDefaultOptions();let f;g.name=u,g.author=null!=p?p:["Unknown"],g.description=null!=h?h:"",g.packs=m,g.targetVersion=await ja(),await(new Zd).create(new La(await r.getDirectoryHandle(`projects/${u}`)),g),await r.mkdir(`projects/${u}/.bridge/extensions`),await r.mkdir(`projects/${u}/.bridge/compiler`),t||(f=a.project.name),yc.ready.hasFired&&await a.projectManager.addProject(await r.getDirectoryHandle(`projects/${u}`),!0),Ie&&!t&&await a.projectManager.removeProject(f),await r.unlink("import")}function tu(e){for(const{type:t}of e)switch(t){case"data":return"behaviorPack";case"resources":return"resourcePack";case"skin_pack":return"skinPack";case"world_template":return"worldTemplate"}}async function iu(){let e;try{[e]=await window.showOpenFilePicker({multiple:!1,types:[{description:"Choose a Project",accept:{"application/zip":[".brproject",".mcaddon"]}}]})}catch{return}const t=e.name;t.endsWith(".brproject")?await qc(e):t.endsWith(".mcaddon")?await eu(e):new Pt({description:"windows.projectChooser.wrongFileType"})}async function nu(){const e=new Xa("windows.projectChooser.title",{isPersistent:!1}),t=await e.actionManager;t.create({icon:"mdi-plus",name:"windows.projectChooser.newProject.name",description:"windows.projectChooser.saveCurrentProject.description",onTrigger:async()=>{(await Yp.getApp()).windows.createProject.open()}}),t.create({icon:"mdi-content-save-outline",name:"windows.projectChooser.saveCurrentProject.name",description:"windows.projectChooser.saveCurrentProject.description",onTrigger:()=>Gc()}),t.create({icon:"mdi-folder-open-outline",name:"windows.projectChooser.openNewProject.name",description:"windows.projectChooser.openNewProject.description",onTrigger:()=>iu()})}class su{constructor(e,t){d(this,"currentStepCount",0),d(this,"window"),this.taskManager=e,this.taskDetails=t}update(e,t){void 0!==e&&(this.currentStepCount=e),void 0!==t&&(this.taskDetails.totalTaskSteps=t)}createWindow(){this.window=new Pt({name:this.name,description:this.description})}complete(){this.window&&this.window.dispose(),this.dispose()}dispose(){var e;null==(e=this.taskManager)||e.delete(this)}get name(){return this.taskDetails.name}get description(){return this.taskDetails.description}get totalStepCount(){var e;return null!=(e=this.taskDetails.totalTaskSteps)?e:100}get icon(){return this.taskDetails.icon}get progress(){return Math.round(this.currentStepCount/this.totalStepCount*100)}}const au=k([]);class ru{create(e){const t=new su(this,e);return au.push(t),t}delete(e){au.splice(au.indexOf(e),1)}get hasRunningTasks(){return au.length>0}}class ou extends xe{constructor(){super(...arguments),d(this,"id",h()),d(this,"type","divider")}}const lu=new Set(["INPUT","TEXTAREA"]);function cu(e){const t=new zo("mdi-wrench-outline","toolbar.tools.name");t.addItem(e.actionManager.create({icon:"mdi-book-open-page-variant",name:"actions.docs.name",description:"actions.docs.description",onTrigger:()=>Yp.openUrl("https://bedrock.dev","DocWindow")})),t.addItem(new ou),t.addItem(e.actionManager.create({id:"bridge.action.refreshProject",icon:"mdi-folder-refresh-outline",name:"windows.packExplorer.refresh.name",description:"windows.packExplorer.refresh.description",keyBinding:"win32"===qe()?"Ctrl + Alt + R":"Ctrl + Meta + R",onTrigger:async()=>{await e.projectManager.projectReady.fired,await e.project.refresh()}})),t.addItem(e.actionManager.create({icon:"mdi-reload",name:"actions.reloadAutoCompletions.name",description:"actions.reloadAutoCompletions.description",keyBinding:"Ctrl + Shift + R",onTrigger:async()=>{await e.projectManager.projectReady.fired,e.project.jsonDefaults.reload()}})),t.addItem(e.actionManager.create({icon:"mdi-puzzle-outline",name:"actions.reloadExtensions.name",description:"actions.reloadExtensions.description",onTrigger:async()=>{e.extensionLoader.deactiveAll(!0),e.extensionLoader.loadExtensions(),await e.projectManager.projectReady.fired,e.project.extensionLoader.deactiveAll(!0),e.project.extensionLoader.loadExtensions()}})),t.addItem(new ou),t.addItem(e.actionManager.create({icon:"mdi-cancel",name:"actions.clearAllNotifications.name",description:"actions.clearAllNotifications.description",onTrigger:()=>function(){"function"==typeof navigator.clearAppBadge&&navigator.clearAppBadge();for(const[e]of Object.entries(At))u.delete(At,e)}()})),Yp.toolbar.addCategory(t)}async function du(e){!function(e){const t=new zo("mdi-view-dashboard-outline","toolbar.project.name");e.mobile.change.on((e=>t.setShouldRender(!e))),t.addItem(e.actionManager.create({icon:"mdi-folder-open-outline",name:"windows.projectChooser.title",description:"windows.projectChooser.description",onTrigger:()=>{Ie?nu():Yp.instance.windows.projectChooser.open()}})),t.addItem(new ou),t.addItem(e.actionManager.create({id:"bridge.action.newProject",icon:"mdi-folder-plus-outline",name:"actions.newProject.name",description:"actions.newProject.description",onTrigger:()=>e.windows.createProject.open()})),t.addItem(e.actionManager.create({icon:"mdi-import",name:"actions.importBrproject.name",description:"actions.importBrproject.description",onTrigger:()=>iu()})),t.addItem(new ou),t.addItem(e.actionManager.create({icon:"mdi-puzzle-outline",name:"actions.extensions.name",description:"actions.extensions.description",onTrigger:()=>e.windows.extensionStore.open()})),t.addItem(e.actionManager.create({id:"bridge.action.openSettings",icon:"mdi-cog-outline",name:"actions.settings.name",description:"actions.settings.description",keyBinding:"Ctrl + ,",onTrigger:()=>e.windows.settings.open()})),Yp.toolbar.addCategory(t)}(e),function(e){const t=new zo("mdi-file-outline","toolbar.file.name");t.addItem(e.actionManager.create({id:"bridge.action.newFile",icon:"mdi-file-plus-outline",name:"actions.newFile.name",description:"actions.newFile.description",keyBinding:"Ctrl + N",onTrigger:()=>e.windows.createPreset.open()})),t.addItem(e.actionManager.create({id:"bridge.action.openFile",icon:"mdi-open-in-app",name:"actions.openFile.name",description:"actions.openFile.description",keyBinding:"Ctrl + O",onTrigger:async()=>{let t;try{t=await window.showOpenFilePicker({multiple:!0})}catch{return}for(const i of t)await e.fileDropper.importFile(i)||e.project.openFile(i,{isTemporary:!1})}})),t.addItem(e.actionManager.create({id:"bridge.action.searchFile",icon:"mdi-magnify",name:"actions.searchFile.name",description:"actions.searchFile.description",keyBinding:"Ctrl + P",onTrigger:()=>e.windows.filePicker.open()})),t.addItem(e.actionManager.create({icon:"mdi-file-cancel-outline",name:"actions.closeFile.name",description:"actions.closeFile.description",keyBinding:"Ctrl + W",onTrigger:()=>Yp.ready.once((e=>{var t;return null==(t=e.tabSystem)?void 0:t.close()}))})),t.addItem(new ou),t.addItem(e.actionManager.create({icon:"mdi-content-save-outline",name:"actions.saveFile.name",description:"actions.saveFile.description",keyBinding:"Ctrl + S",onTrigger:()=>Yp.ready.once((e=>{var t;return null==(t=e.tabSystem)?void 0:t.save()}))})),Ie?t.addItem(e.actionManager.create({icon:"mdi-file-download-outline",name:"actions.downloadFile.name",description:"actions.downloadFile.description",keyBinding:"Ctrl + Shift + S",onTrigger:async()=>{var e;const t=await Yp.getApp();await t.project.compilerManager.fired;const i=null==(e=t.project.tabSystem)?void 0:e.selectedTab;if(!(i instanceof Bn))return;const[n,s]=await t.project.compilerManager.compileWithFile(i.getProjectPath(),await i.getFile());let a;a="string"==typeof s?(new TextEncoder).encode(s):s instanceof Blob?new Uint8Array(await s.arrayBuffer()):new Uint8Array(s),Nl(i.name,a)}})):t.addItem(e.actionManager.create({icon:"mdi-content-save-edit-outline",name:"actions.saveAs.name",description:"actions.saveAs.description",keyBinding:"Ctrl + Shift + S",onTrigger:()=>Yp.ready.once((e=>{var t;return null==(t=e.tabSystem)?void 0:t.saveAs()}))})),t.addItem(e.actionManager.create({icon:"mdi-content-save-settings-outline",name:"actions.saveAll.name",description:"actions.saveAll.description",keyBinding:"win32"===qe()?"Ctrl + Alt + S":"Ctrl + Meta + S",onTrigger:()=>Yp.ready.once((e=>{var t;return null==(t=e.tabSystem)?void 0:t.saveAll()}))}));const i=e.actionManager.getAction("bridge.action.openSettings");i&&e.mobile.isCurrentDevice()&&(t.addItem(new ou),t.addItem(i)),Yp.toolbar.addCategory(t)}(e),function(e){const t=new zo("mdi-pencil-outline","toolbar.edit.name");t.addItem(e.actionManager.create({icon:"mdi-undo",name:"actions.undo.name",description:"actions.undo.description",keyBinding:"Ctrl + Z",prevent:e=>"INPUT"===e.tagName||"TEXTAREA"===e.tagName,onTrigger:()=>{var t;const i=null==(t=e.tabSystem)?void 0:t.selectedTab;i instanceof Ta?i.treeEditor.undo():i instanceof Gn?i.editorInstance.trigger("toolbar","undo",null):document.execCommand("undo")}})),t.addItem(e.actionManager.create({icon:"mdi-redo",name:"actions.redo.name",description:"actions.redo.description",keyBinding:Sa,prevent:e=>"INPUT"===e.tagName||"TEXTAREA"===e.tagName,onTrigger:()=>{var t;const i=null==(t=e.tabSystem)?void 0:t.selectedTab;i instanceof Ta?i.treeEditor.redo():i instanceof Gn?i.editorInstance.trigger("toolbar","redo",null):document.execCommand("redo")}})),t.addItem(new ou),t.addItem(e.actionManager.create({icon:"mdi-content-copy",name:"actions.copy.name",description:"actions.copy.description",keyBinding:"Ctrl + C",prevent:e=>lu.has(e.tagName),onTrigger:()=>{var t,i;return null==(i=null==(t=e.tabSystem)?void 0:t.selectedTab)?void 0:i.copy()}})),t.addItem(e.actionManager.create({icon:"mdi-content-cut",name:"actions.cut.name",description:"actions.cut.description",keyBinding:"Ctrl + X",prevent:e=>lu.has(e.tagName),onTrigger:()=>{var t,i;return null==(i=null==(t=e.tabSystem)?void 0:t.selectedTab)?void 0:i.cut()}})),t.addItem(e.actionManager.create({icon:"mdi-content-paste",name:"actions.paste.name",description:"actions.paste.description",keyBinding:"Ctrl + V",prevent:e=>lu.has(e.tagName),onTrigger:()=>{var t,i;return null==(i=null==(t=e.tabSystem)?void 0:t.selectedTab)?void 0:i.paste()}})),t.addItem(new ou),t.addItem(e.actionManager.create({icon:"mdi-pencil-outline",name:"actions.toggleReadOnly.name",description:"actions.toggleReadOnly.description",onTrigger:()=>{var t;const i=null==(t=e.tabSystem)?void 0:t.selectedTab;i instanceof Bn&&i.setReadOnly(!i.isReadOnly)}})),Yp.toolbar.addCategory(t)}(e),cu(e),function(e){const t=new zo("mdi-help","toolbar.help.name");t.addItem(e.actionManager.create({name:"actions.releases.name",icon:"mdi-alert-decagram",description:"actions.releases.description",onTrigger:()=>window.open("https://github.com/bridge-core/editor/releases","_blank")})),t.addItem(e.actionManager.create({name:"actions.bugReports.name",icon:"mdi-bug-outline",description:"actions.bugReports.description",onTrigger:()=>window.open("https://github.com/bridge-core/editor/issues/new/choose","_blank")})),t.addItem(new ou),t.addItem(e.actionManager.create({name:"actions.extensionAPI.name",icon:"mdi-puzzle-outline",description:"actions.extensionAPI.description",onTrigger:()=>Yp.openUrl("https://bridge-core.github.io/extension-docs/","_blank")})),t.addItem(e.actionManager.create({name:"actions.gettingStarted.name",icon:"mdi-help-circle-outline",description:"actions.gettingStarted.description",onTrigger:()=>Yp.openUrl("https://bridge-core.github.io/editor-docs/getting-started/","_blank")})),t.addItem(e.actionManager.create({name:"actions.faq.name",icon:"mdi-frequently-asked-questions",description:"actions.faq.description",onTrigger:()=>Yp.openUrl("https://bridge-core.github.io/editor-docs/faq/","_blank")})),Yp.toolbar.addCategory(t)}(e)}const uu={};var pu=Le({name:"Discord",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()},async onContinue(){await f("confirmedUnsupportedBrowser",!0),this.onClose()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:"windows.browserUnsupported.title",isVisible:e.isVisible,isPersistent:!0,hasCloseButton:!1,width:420,height:240},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("div",{staticClass:"text-center"},[i("v-icon",{staticStyle:{"font-size":"8em"},attrs:{color:"error"}},[e._v(" mdi-alert-octagon-outline ")]),i("p",[e._v(e._s(e.t("windows.browserUnsupported.description")))])],1)]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"error"},on:{click:e.onContinue}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-check")]),e._v(" "+e._s(e.t("windows.browserUnsupported.continue"))+" ")],1),i("v-spacer")]},proxy:!0}],null,!1,3226775507)}):e._e()}),[],!1,hu,null,null,null);function hu(e){for(let t in uu)this[t]=uu[t]}var mu=function(){return pu.exports}();class gu extends Je{constructor(){super(mu),this.defineWindow()}}const fu={};var wu=Le({name:"ExtensionCard",mixins:[Be],props:{extension:Object},computed:{tags(){return[{icon:"mdi-account-outline",color:"primary",text:this.extension.author,type:"search"},{icon:"mdi-code-braces",text:this.extension.displayVersion,type:"search"}].concat(this.extension.tags)},isMobile(){return this.$vuetify.breakpoint.mobile},compilerPlugins(){return Object.keys(this.extension.connected.compilerPlugins).map((e=>`"${e}"`)).join(", ")}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"text-normal pa-4 mb-2 rounded-lg card"},[i("div",{staticClass:"d-flex align-center mb-2"},[e.extension.icon?i("v-icon",{staticClass:"mr-1",attrs:{color:"accent"}},[e._v(" "+e._s(e.extension.icon)+" ")]):e._e(),i("h3",[e._v(e._s(e.extension.name))]),i("v-spacer"),e.extension.isInstalled?e.extension.isUpdateAvailable?i("v-btn",{staticClass:"rounded-lg elevation-0",attrs:{loading:e.extension.isLoading,color:"primary",small:""},on:{click:function(t){return e.extension.update()}}},[i("v-icon",{class:{"mr-1":!e.isMobile},attrs:{small:!e.isMobile}},[e._v(" mdi-sync ")]),e.isMobile?e._e():i("span",[e._v("Update")])],1):i("v-tooltip",{attrs:{color:e.extension.isActive?"success":"error",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[e.extension.isActive?i("v-icon",e._g({attrs:{color:"success"}},n),[e._v(" mdi-check ")]):i("v-icon",e._g({attrs:{color:"error"}},n),[e._v("mdi-close")])]}}])},[i("span",[e._v(" "+e._s(e.extension.isActive?"Extension Active":"Extension Inactive")+" ")])]):i("v-btn",{staticClass:"rounded-lg elevation-0",attrs:{loading:e.extension.isLoading,color:"primary",small:""},on:{click:function(t){return e.extension.download()}}},[i("v-icon",{class:{"mr-1":!e.isMobile},attrs:{small:!e.isMobile}},[e._v(" mdi-download ")]),e.isMobile?e._e():i("span",[e._v("Download")])],1),e.extension.isInstalled?i("v-menu",{attrs:{"offset-y":"","offset-x":"",rounded:"lg"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("v-btn",e._g(e._b({attrs:{small:"",icon:""}},"v-btn",s,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3448670655),model:{value:e.extension.showMenu,callback:function(t){e.$set(e.extension,"showMenu",t)},expression:"extension.showMenu"}},[i("v-list",{attrs:{color:"menu",dense:""}},e._l(e.extension.actions,(function(t,n){return i("v-list-item",{key:n,on:{click:function(e){return e.stopPropagation(),t.trigger()}}},[i("v-list-item-icon",[i("v-icon",{attrs:{color:"primary"}},[e._v(" "+e._s(t.icon))])],1),i("v-list-item-title",[e._v(" "+e._s(e.t(t.name))+" ")])],1)})),1)],1):e._e()],1),i("v-row",{staticClass:"mb-4",attrs:{dense:""}},e._l(e.tags,(function(t){return i("v-col",{key:t.text,staticClass:"flex-grow-0"},[i("v-chip",{attrs:{color:t.color,"text-color":t.color?"white":void 0,small:""},on:{click:function(i){"search"===t.type?e.$emit("search",t.text):e.$emit("select",t.text.toLowerCase())}}},[i("v-icon",{staticClass:"mr-1"},[e._v(e._s(t.icon))]),e._v(" "+e._s(t.text)+" ")],1)],1)})),1),i("span",[e._v(e._s(e.extension.description))]),e.extension.connected&&e.extension.connected.contributesCompilerPlugins?[i("v-divider",{staticClass:"my-2"}),i("span",{staticClass:"font-weight-bold"},[e._v(" "+e._s(e.t("windows.extensionStore.compilerPluginDownload.compilerPlugins"))+": ")]),i("span",[e._v(" "+e._s(e.compilerPlugins)+" ")])]:e._e()],2)}),[],!1,vu,"5b631fba",null,null);function vu(e){for(let t in fu)this[t]=fu[t]}const yu={};var bu=Le({name:"CreatePresetWindow",mixins:[Be],components:{SidebarWindow:Mr,ExtensionCard:function(){return wu.exports}()},props:["currentWindow"],setup:()=>({pointerDevice:Ss}),data(){return this.currentWindow},computed:{title(){return this.sidebar.currentElement?`[${this.sidebar._filter||this.sidebar.currentElement.text} - ${this.t("windows.extensionStore.title")}]`:"windows.extensionStore.title"},currentExtensions(){if(""!==this.sidebar._filter){const e=this.sidebar._filter.toLowerCase();return this.extensions.filter((t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.author.toLowerCase().includes(e)||t.version.includes(e)||t.tags.some((t=>t.text.toLowerCase().includes(e)))))}return this.sidebar.currentState}},methods:{onClose(){this.currentWindow.close()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("SidebarWindow",{attrs:{windowTitle:e.title,isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,percentageWidth:80,percentageHeight:80,sidebarItems:e.sidebar.elements},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"sidebar",fn:function(){return[i("v-text-field",{staticClass:"pt-2",attrs:{"prepend-inner-icon":"mdi-magnify",label:e.t("windows.extensionStore.searchExtensions"),autocomplete:"off",autofocus:"mouse"===e.pointerDevice,outlined:"",dense:""},model:{value:e.sidebar._filter,callback:function(t){e.$set(e.sidebar,"_filter",t)},expression:"sidebar._filter"}})]},proxy:!0},{key:"default",fn:function(){return[0===e.currentExtensions.length?i("div",[e._v(" No plugins match your search... ")]):e._l(e.currentExtensions,(function(t){return i("ExtensionCard",{key:t.id+"."+t.isInstalled+"."+t.isUpdateAvailable,attrs:{extension:t},on:{search:function(t){return e.sidebar._filter=t},select:function(t){return e.$data.selectedSidebar=t}}})}))]},proxy:!0}]),model:{value:e.$data.selectedSidebar,callback:function(t){e.$set(e.$data,"selectedSidebar",t)},expression:"$data.selectedSidebar"}})}),[],!1,ku,null,null,null);function ku(e){for(let t in yu)this[t]=yu[t]}var Su=function(){return bu.exports}();let xu;class Cu extends Je{constructor(){super(Su),d(this,"baseUrl","https://raw.githubusercontent.com/bridge-core/plugins/master"),d(this,"sidebar",new kr([])),d(this,"extensions",[]),d(this,"extensionTags"),d(this,"installedExtensions",[]),d(this,"tags",{}),d(this,"updates",new Set),Yp.eventSystem.on("projectChanged",(()=>{null==xu||xu.dispose(),xu=void 0})),this.defineWindow()}async open(){Yp.audioManager.playAudio("click5.ogg",1);const e=await Yp.getApp();e.windows.loadingWindow.open(),this.sidebar.removeElements(),this.installedExtensions=[],await e.dataLoader.fired,this.extensionTags=await e.dataLoader.readJSON("data/packages/common/extensionTags.json");const t=await e.extensionLoader.getInstalledExtensions();let i;try{i=await fetch(`${this.baseUrl}/extensions.json`).then((e=>e.json()))}catch{return this.close(),e.windows.loadingWindow.close(),void new Pt({description:"windows.extensionStore.offlineError"})}this.extensions=i.map((e=>new rl(this,e))),this.updates.clear(),t.forEach(((e,t)=>{const i=this.extensions.find((e=>e.id===t));i?(i.setInstalled(),i.setConnected(e),N.exports.compare(e.version,i.version,"<")&&(i.setIsUpdateAvailable(),this.updates.add(i))):this.extensions.push(e.forStore(this))})),null==xu||xu.dispose(),this.setupSidebar(),e.windows.loadingWindow.close(),super.open()}close(){Yp.audioManager.playAudio("click5.ogg",1),super.close(),this.updates.size>0&&(xu=new Tt({icon:"mdi-sync",color:"primary",message:"sidebar.notifications.updateExtensions",onClick:()=>{this.updates.forEach((e=>e.update(!1))),null==xu||xu.dispose()}}))}updateInstalled(e){this.updates.delete(e)}delete(e){const t=this.installedExtensions.findIndex((t=>t.id===e.id));-1!==t&&(this.installedExtensions.splice(t,1),e.isLocalOnly&&(this.extensions=this.extensions.filter((t=>t.id!==e.id))))}setupSidebar(){this.sidebar.addElement(new br({id:"all",text:"All",icon:"mdi-format-list-bulleted-square",color:"primary"}),this.getExtensions()),this.sidebar.addElement(new br({id:"installed",text:"Installed",icon:"mdi-download-circle-outline",color:"primary"}),this.installedExtensions),Object.values(this.tags).forEach((e=>this.sidebar.addElement(e.asSidebarElement(),this.getExtensionsByTag(e)))),this.sidebar.setDefaultSelected()}getExtensions(e){return[...new Set([...this.extensions,...this.installedExtensions])].filter((t=>!t.isLocalOnly&&(!e||t.hasTag(e)))).sort((({releaseTimestamp:e},{releaseTimestamp:t})=>t-e))}getExtensionsByTag(e){return this.getExtensions(e)}getTagIcon(e){var t;return null==(t=this.extensionTags[e])?void 0:t.icon}getTagColor(e){var t;return null==(t=this.extensionTags[e])?void 0:t.color}getExtensionById(e){return this.getExtensions().find((t=>t.id===e))}get selectedSidebar(){return this.sidebar.selected}set selectedSidebar(e){this.sidebar.clearFilter(),this.sidebar.selected=e}getBaseUrl(){return this.baseUrl}addInstalledExtension(e){this.installedExtensions.push(e)}}const ju={};var _u=Le({name:"LoadingWindow",components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseWindow",{attrs:{windowTitle:e.$data.message||"windows.loadingWindow.titles.loading",isVisible:e.isVisible,hasMaximizeButton:!1,hasCloseButton:!1,isPersistent:!0,isFullscreen:!1,width:300,height:40,isSmallPopup:!0},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("v-progress-linear",{attrs:{indeterminate:""}})]},proxy:!0}])})}),[],!1,Pu,null,null,null);function Pu(e){for(let t in ju)this[t]=ju[t]}var Au=function(){return _u.exports}();class Tu extends Je{constructor(){super(Au),d(this,"virtualWindows",0),d(this,"loadingMessages",[]),this.defineWindow()}get message(){return this.loadingMessages[this.loadingMessages.length-1]}open(e){this.virtualWindows++,this.loadingMessages.push(e),this.isVisible||super.open()}close(){this.virtualWindows--,this.loadingMessages.pop(),0===this.virtualWindows?super.close():this.virtualWindows<0&&(this.virtualWindows=0)}closeAll(){this.virtualWindows=0,this.loadingMessages=[],super.close()}}const Eu={};var Fu=Le({name:"CreatePresetWindow",mixins:[Be],components:{SidebarWindow:Mr,PresetPath:Dl},props:["currentWindow"],data(){return this.currentWindow},computed:{content(){return this.sidebar.currentState},fieldsReady(){return Object.values(this.content.fields||{}).every((([e,t,i={}])=>(!i.validate||!i.validate.some((e=>!0!==this.$data.validationRules[e](this.content.models[t]))))&&(!!this.content.models[t]||i.optional)))}},methods:{onClose(){this.currentWindow.close()},onCreatePreset(){this.fieldsReady&&this.currentWindow.createPreset(this.content)},onDropFile(e,t,i){const{accept:n,multiple:s}=t,a=[...i.dataTransfer.files].filter((e=>Cd(e,n)));0!==a.length&&(s?this.content.models[e]?this.content.models[e].push(...a):this.content.models[e]=[...a]:this.content.models[e]=a[a.length-1])}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("SidebarWindow",{attrs:{windowTitle:"windows.createPreset.title",isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,percentageWidth:80,percentageHeight:80,sidebarItems:e.sidebar.elements},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"sidebar",fn:function(){return[i("v-text-field",{staticClass:"pt-2",attrs:{"prepend-inner-icon":"mdi-magnify",label:e.t("windows.createPreset.searchPresets"),autocomplete:"off",autofocus:"",outlined:"",dense:""},model:{value:e.sidebar._filter,callback:function(t){e.$set(e.sidebar,"_filter",t)},expression:"sidebar._filter"}})]},proxy:!0},{key:"default",fn:function(){return[i("h1",{staticClass:"mt-2 d-flex align-center",class:{"mb-6":!e.content.description}},[i("v-icon",{staticClass:"mr-1",attrs:{large:""}},[e._v(e._s(e.content.icon))]),e._v(" "+e._s(e.content.name)+" ")],1),e.content.description?i("p",{staticClass:"mt-2 mb-6"},[e._v(" "+e._s(e.content.description)+" ")]):e._e(),"string"==typeof e.content.models.PRESET_PATH?i("PresetPath",{model:{value:e.content.models.PRESET_PATH,callback:function(t){e.$set(e.content.models,"PRESET_PATH",t)},expression:"content.models.PRESET_PATH"}}):e._e(),e._l(e.content.fields,(function(t,n){var s=t[0],a=t[1],r=t[2];return void 0===r&&(r={}),[r.type&&"textInput"!==r.type?"fileInput"===r.type?i("span",{key:n,on:{drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onDropFile(a,r,t)},dragover:function(e){e.preventDefault(),e.stopPropagation()}}},[i("v-file-input",{staticClass:"mb-1",attrs:{accept:r.accept,"prepend-icon":null,"prepend-inner-icon":r.icon||"mdi-paperclip",label:s,multiple:r.multiple||!1,autocomplete:"off",outlined:"",dense:""},model:{value:e.content.models[a],callback:function(t){e.$set(e.content.models,a,t)},expression:"content.models[id]"}})],1):"selectInput"===r.type?i(r.options.length>4?"v-autocomplete":"v-select",{key:n,tag:"component",staticClass:"mb-1",attrs:{loading:r.isLoading,disabled:r.isLoading,items:r.options,"menu-props":{maxHeight:220},label:s,autocomplete:"off",outlined:"",dense:""},model:{value:e.content.models[a],callback:function(t){e.$set(e.content.models,a,t)},expression:"content.models[id]"}}):"switch"===r.type?i("v-switch",{key:n,staticClass:"mb-1",attrs:{label:s},model:{value:e.content.models[a],callback:function(t){e.$set(e.content.models,a,t)},expression:"content.models[id]"}}):"numberInput"===r.type?i("v-slider",{key:n,staticClass:"mb-1",attrs:{min:r.min||0,max:r.max||10,discrete:"",step:r.step||1,"thumb-label":"always",label:s},model:{value:e.content.models[a],callback:function(t){e.$set(e.content.models,a,t)},expression:"content.models[id]"}}):e._e():i("v-text-field",{key:n,staticClass:"mb-1",attrs:{label:s,rules:r.validate?r.validate.map((function(t){return e.$data.validationRules[t]})):[],autocomplete:"off",outlined:"",dense:""},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onCreatePreset(t)}},model:{value:e.content.models[a],callback:function(t){e.$set(e.content.models,a,t)},expression:"content.models[id]"}})]}))]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary",disabled:!e.fieldsReady},on:{click:e.onCreatePreset}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-plus")]),e._v(" Create ")],1)]},proxy:!0}],null,!1,1038933285),model:{value:e.sidebar.selected,callback:function(t){e.$set(e.sidebar,"selected",t)},expression:"sidebar.selected"}}):e._e()}),[],!1,Du,null,null,null);function Du(e){for(let t in Eu)this[t]=Eu[t]}var Ou=function(){return Fu.exports}();function Mu(e,t,i){return t.forEach((t=>e=e.replaceAll(`{{${t}}}`,i[t]))),e}class $u extends La{constructor(e,t){super(e),this.dataLoader=t}getDirectoryHandle(e,t){return e.startsWith("data/packages/")?this.dataLoader.getDirectoryHandle(e,t):super.getDirectoryHandle(e,t)}}async function Iu(e,t,i,n){var s;const a=await Yp.getApp(),r=null==(s=a.project)?void 0:s.fileSystem,o=new $u(a.fileSystem.baseDirectory,a.dataLoader);let l;l=t.startsWith("./")?t=t.replaceAll("./",e+"/"):`data/packages/minecraftBedrock/${t}`,await a.dataLoader.fired;const c=await o.readFile(l),d=await c.text(),u={exports:void 0};try{ss({script:d,env:{module:u}})}catch(g){throw new Error(`Failed to execute PresetScript "${t}": ${g}`)}if("function"!=typeof u.exports)throw new Error(`Failed to execute PresetScript "${t}": module.exports is of type ${typeof u.exports}`);const p=[],h=[],m=async(e,t,{inject:s=[],openFile:a=!1}={inject:[],openFile:!1})=>{if(void 0===n.mayOverwriteFiles&&await r.fileExists(e)){const e=new vo({description:"windows.createPreset.overwriteFiles",confirmText:"windows.createPreset.overwriteFilesConfirm"});if(!(await e.fired))return void(n.mayOverwriteFiles=!1);n.mayOverwriteFiles=!0}else if(!1===n.mayOverwriteFiles)return;const o=await r.getFileHandle(e,!0);p.push(o),a&&h.push(o),r.write(o,"string"==typeof t?Mu(t,s,i):t)};return await u.exports({models:i,createFile:m,expandFile:async(e,t,{inject:s=[],openFile:o=!1}={inject:[],openFile:!1})=>{const l=await a.project.fileSystem.getFileHandle(e,!0);if(void 0===n.mayOverwriteUnsavedChanges){const e=await a.project.getFileTab(l);if(void 0!==e&&e.isUnsaved){const t=new vo({description:"windows.createPreset.overwriteUnsavedChanges",confirmText:"windows.createPreset.overwriteUnsavedChangesConfirm"});if(!(await t.fired))return void(n.mayOverwriteUnsavedChanges=!1);n.mayOverwriteUnsavedChanges=!0,e.close()}}else if(!1===n.mayOverwriteUnsavedChanges)return;let c=null;try{c=await(await r.readFile(e)).text()}catch{}p.push(l),o&&h.push(l),"string"==typeof t?(t=Mu(t,s,i),await r.writeFile(e,c?`${c}\n${t}`:t)):(t=Mu(T.stringify(t),s,i),await r.writeJSON(e,er(c?T.parse(c):{},T.parse(t)),!0))},loadPresetFile:t=>o.readFile(`${e}/${t}`),createJSONFile:(e,t,i={inject:[],openFile:!1})=>("string"!=typeof t&&(t=JSON.stringify(t,null,"\t")),m(e,t,i))}),{createdFiles:p,openFile:h}}async function Ru(e,[t,i,n],s){var a;const r=await Yp.getApp(),o=new $u(r.fileSystem.baseDirectory,r.dataLoader),l=null!=(a=null==n?void 0:n.inject)?a:[],c=`${e}/${t}`,d=Mu(`projects/${r.selectedProject}/${i}`,l,s),u=An(d);let p;if(await o.mkdir(_n(d),{recursive:!0}),".json"===u){const e=await o.readJSON(c);let t;try{t=await o.readJSON(d)}catch{t={}}p=await o.writeFile(d,Mu(JSON.stringify(er(t,e),null,"\t"),l,s))}else{const e=await o.readFile(c),t=await e.text();let i;try{i=await(await o.readFile(d)).text()}catch{i=""}const n=Mu(t,l,s);p=await o.writeFile(d,`${i}${""!==i?"\n":""}${n}`)}return p}const Wu=[".mcfunction",".json",".js",".ts",".txt",".molang"];async function Nu(e,[t,i,n],s){var a;const r=await Yp.getApp(),o=new $u(r.fileSystem.baseDirectory,r.dataLoader),l=null!=(a=null==n?void 0:n.inject)?a:[],c=`${e}/${t}`,d=Mu(`projects/${r.selectedProject}/${i}`,l,s),u=An(d);let p;if(await o.mkdir(_n(d),{recursive:!0}),0!==l.length&&Wu.includes(u)){const e=await o.readFile(c),t=await e.text();p=await o.writeFile(d,Mu(t,l,s))}else p=await o.copyFile(c,d);return p}class Bu extends br{constructor(e){super(e),d(this,"resetState"),this.resetState=e.resetState}}class Lu extends Je{constructor(){super(Ou),d(this,"loadPresetPaths",new Map),d(this,"sidebar",new kr([])),d(this,"shouldReloadPresets",!0),d(this,"modelResetters",[]),d(this,"_validationRules",{alphanumeric:e=>null!==e.match(/^[a-zA-Z0-9_\.]*$/),lowercase:e=>e.toLowerCase()===e,required:e=>!!e}),this.defineWindow(),Yp.eventSystem.on("presetsChanged",(()=>{this.onPresetsChanged()}))}get validationRules(){return Object.fromEntries(Object.entries(this._validationRules).map((([e,t])=>[e,i=>t(i)||Yp.instance.locales.translate(`windows.createPreset.validationRule.${e}`)])))}onPresetsChanged(){this.shouldReloadPresets=!0}async addPreset(e,t){var i,n,s;const a=await Yp.getApp();let r;try{r=await e.readJSON(t)}catch(f){return}if(!r.category)throw new Error(`Error loading ${t}: Missing preset category`);const o=new Ql(r.requires);if(!(await o.isValid()))return;let d=this.sidebar.rawElements.find((e=>e.getText()===r.category));d||(d=new yr({isOpen:!1,text:r.category,items:[]}),this.sidebar.addElement(d));const u=h(),p=()=>{var e,i,n;null==(e=r.fields)||e.forEach((([e,t,i={}])=>{var n;if("selectInput"!==i.type||Array.isArray(i.options))return;const{fileType:s,cacheKey:r}=null!=(n=i.options)?n:{};s&&r&&(i.options=[],i.isLoading=!0,a.project.packIndexer.once((async()=>{const e=await a.project.packIndexer.service.getCacheDataFor(s,void 0,r);i.options=null!=e?e:[],i.isLoading=!1})))})),this.sidebar.setState(u,c(l({},r),{presetPath:_n(t),models:l(l({PROJECT_PREFIX:null!=(i=a.projectConfig.get().namespace)?i:"bridge"},null!=(n=r.additionalModels)?n:{}),Object.fromEntries(r.fields.map((([e,t,i={}])=>{var n;return[t,null!=(n=i.default)?n:i.type&&"textInput"!==i.type?null:""]}))))}))},m=null==(i=r.additionalModels)?void 0:i.PRESET_PATH,g="string"==typeof m&&"fileType.simpleFile"===r.category&&null!=(s=null==(n=Dn.getWithRelativePath(m+"test.json"))?void 0:n.color)?s:"primary";d.addItem(new Bu({id:u,text:r.name,icon:r.icon,color:g,resetState:p})),p(),this.modelResetters.push(p)}async loadPresets(e,t="data/packages/minecraftBedrock/preset"){await e.fired;let i=[];try{i=await e.readdir(t,{withFileTypes:!0})}catch{}for(const n of i)if("directory"===n.kind)await this.loadPresets(e,`${t}/${n.name}`);else if("manifest.json"===n.name)return await this.addPreset(e,`${t}/${n.name}`)}async open(){const e=await Yp.getApp(),t=e.fileSystem;if(e.windows.loadingWindow.open(),this.shouldReloadPresets){this.sidebar.removeElements(),await this.loadPresets(e.dataLoader);for(const[e,i]of this.loadPresetPaths)await this.loadPresets(t,i);this.sidebar.setDefaultSelected(),this.shouldReloadPresets=!1}else this.modelResetters.forEach((e=>e()));e.windows.loadingWindow.close(),super.open()}addPresets(e){const t=h();return this.loadPresetPaths.set(t,e),{dispose:()=>this.loadPresetPaths.delete(t)}}async createPreset({presetPath:e,createFiles:t=[],expandFiles:i=[]}){var n,s,a,r,o,l;if(!e)return;const c=await Yp.getApp();c.windows.loadingWindow.open();const d=c.project.fileSystem,u=[],p={mayOverwriteFiles:void 0,mayOverwriteUnsavedChanges:void 0};for(const f of t){if("string"==typeof f)continue;const e=Mu(f[1],null!=(s=null==(n=f[2])?void 0:n.inject)?s:[],this.sidebar.currentState.models);if(await d.fileExists(e)){const e=new vo({description:"windows.createPreset.overwriteFiles",confirmText:"windows.createPreset.overwriteFilesConfirm"});if(await e.fired){p.mayOverwriteFiles=!0;break}return void c.windows.loadingWindow.close()}}const h=c.project;for(const f of i){if("string"==typeof f)continue;let e=Mu(f[1],null!=(r=null==(a=f[2])?void 0:a.inject)?r:[],this.sidebar.currentState.models),t=null;try{t=await h.fileSystem.getFileHandle(e)}catch{continue}const i=await h.getFileTab(t);if(void 0!==i&&i.isUnsaved){const e=new vo({description:"windows.createPreset.overwriteUnsavedChanges",confirmText:"windows.createPreset.overwriteUnsavedChangesConfirm"});if(!(await e.fired))return void c.windows.loadingWindow.close();p.mayOverwriteUnsavedChanges=!0,h.closeFile(t)}}const m=[];for(const f of t)if("string"==typeof f){const t=await Iu(e,f,this.sidebar.currentState.models,p);u.push(...t.createdFiles),m.push(...t.openFile)}else{const t=await Nu(e,f,this.sidebar.currentState.models);u.push(t),(null==(o=f[2])?void 0:o.openFile)&&m.push(t)}for(const f of i){const t=await Ru(e,f,this.sidebar.currentState.models);u.push(t),(null==(l=f[2])?void 0:l.openFile)&&m.push(t)}Yp.eventSystem.dispatch("fileAdded",void 0),!1!==p.mayOverwriteFiles&&this.close();const g=[];for(const f of u){const e=await c.project.getProjectPath(f);e&&(g.push(e),m.includes(f)&&await c.project.openFile(f,{selectTab:f===m[m.length-1],isTemporary:!1}))}await c.project.updateFiles(g),this.sidebar.currentElement instanceof Bu&&this.sidebar.currentElement.resetState(),c.windows.loadingWindow.close()}}const Hu={};var Vu=Le({name:"OpenFileWindow",mixins:[Be],components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()},onChange(e){e&&this.currentWindow.openFile(e)},getFileIcon(e){const t=Fn.get(e);return t&&t.icon||"mdi-file-outline"},getFileIconColor(e){const t=Dn.getWithRelativePath(e);return t&&t.color||"primary"}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseWindow",{attrs:{windowTitle:"windows.openFile.title",isVisible:e.isVisible,hasMaximizeButton:!1,hasCloseButton:!0,isFullscreen:!1,width:500,height:120},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("v-autocomplete",{attrs:{label:e.t("windows.openFile.search"),items:e.packFiles,dense:"","no-data-text":e.t("windows.openFile.noData"),outlined:"","auto-select-first":"",autofocus:""},on:{change:e.onChange},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return[i("v-icon",{staticClass:"mr-1",attrs:{color:e.getFileIconColor(n)}},[e._v(" "+e._s(e.getFileIcon(n))+" ")]),i("span",[e._v(e._s(n))])]}}]),model:{value:e.selectedFile,callback:function(t){e.selectedFile=t},expression:"selectedFile"}})]},proxy:!0}])})}),[],!1,zu,null,null,null);function zu(e){for(let t in Hu)this[t]=Hu[t]}var Uu=function(){return Vu.exports}();class Gu extends Je{constructor(){super(Uu,!1,!0),d(this,"packFiles",[]),d(this,"selectedFile",""),d(this,"isCurrentlyOpening",!1),this.defineWindow()}async open(){var e,t,i;if(Yp.audioManager.playAudio("click5.ogg",1),this.isCurrentlyOpening)return;this.isCurrentlyOpening=!0,this.selectedFile="";const n=await Yp.getApp();n.windows.loadingWindow.open();const s=null==(e=n.project)?void 0:e.packIndexer;s&&(this.packFiles=null!=(i=await(null==(t=s.service)?void 0:t.getAllFiles(!0)))?i:[]),n.windows.loadingWindow.close(),super.open(),this.isCurrentlyOpening=!1}openFile(e){Yp.ready.once((async t=>{var i;const n=await t.fileSystem.getFileHandle(`projects/${t.selectedProject}/${e}`);null==(i=t.project)||i.openFile(n)})),Yp.audioManager.playAudio("confirmation_002.ogg",1),this.close()}}var Ju=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("SidebarWindow",{attrs:{windowTitle:"windows.projectChooser.title",isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,percentageWidth:80,percentageHeight:80,sidebarItems:e.sidebar.elements,actions:e.actions},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"sidebar",fn:function(){return[i("v-text-field",{staticClass:"pt-2",attrs:{"prepend-inner-icon":"mdi-magnify",label:e.t("windows.projectChooser.searchProjects"),outlined:"",dense:""},model:{value:e.sidebar._filter,callback:function(t){e.$set(e.sidebar,"_filter",t)},expression:"sidebar._filter"}})]},proxy:!0},{key:"default",fn:function(){return[i("div",{staticClass:"d-flex align-center mb-4 rounded-lg content-area pa-4"},[i("img",{staticClass:"mr-2 project-logo rounded-lg",attrs:{height:"64",src:e.sidebar.currentState.imgSrc,draggable:"false"}}),i("div",[i("h1",{staticStyle:{"overflow-wrap":"anywhere"}},[e._v(" "+e._s(e.sidebar.currentState.name)+" ")]),i("h2",{staticClass:"subheader"},[e._v("by "+e._s(e.authors))])])]),i("v-row",{staticClass:"mb-6",attrs:{dense:""}},e._l(e.sidebar.currentState.contains,(function(e){return i("v-col",{key:e.id},[i("PackTypeViewer",{staticStyle:{height:"100%"},attrs:{packType:e}})],1)})),1),i("h2",{staticClass:"subheader"},[e._v(e._s(e.t("general.experimentalGameplay")))]),i("v-row",{attrs:{dense:""}},e._l(e.sidebar.currentState.experimentalGameplay,(function(e){return i("v-col",{key:e.id+"."+e.isActive,attrs:{xs:"12",sm:"6",md:"4",lg:"3",xl:"2"}},[i("ExperimentalGameplay",{staticStyle:{height:"100%"},attrs:{experiment:e,isToggleable:!1,value:e.isActive}})],1)})),1)]},proxy:!0},{key:"actions",fn:function(t){var n=t.selectedSidebar;return[i("v-btn",{attrs:{color:"primary",disabled:e.currentProject!==n},on:{click:e.onAddPack}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-plus-box")]),e._v(" "+e._s(e.t("windows.projectChooser.addPack"))+" ")],1),i("v-spacer"),i("v-btn",{attrs:{color:"error",disabled:e.currentProject===n},on:{click:function(t){return e.onDeleteProject(n)}}},[i("v-icon",[e._v("mdi-delete")]),e._v(" "+e._s(e.t("general.delete"))+" ")],1),i("v-btn",{attrs:{color:"primary",disabled:e.currentProject===n},on:{click:e.onSelectProject}},[i("v-icon",[e._v("mdi-check")]),e._v(" "+e._s(e.t("general.select"))+" ")],1)]}}]),model:{value:e.sidebar.selected,callback:function(t){e.$set(e.sidebar,"selected",t)},expression:"sidebar.selected"}})},qu=[];let Ku;Ku="ListFormat"in Intl?new Intl.ListFormat("en",{style:"long",type:"conjunction"}):{format:e=>e.join(", ")};const Qu={};var Xu=Le({name:"ProjectChooserWindow",mixins:[Be],components:{SidebarWindow:Mr,PackTypeViewer:cd,ExperimentalGameplay:yd},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()},async onSelectProject(){(await Yp.getApp()).projectManager.selectProject(this.sidebar.selected),this.currentWindow.close()},onDeleteProject(e){new vo({description:"windows.deleteProject.description",confirmText:"windows.deleteProject.confirm",cancelText:"general.cancel",onConfirm:async()=>{const t=await Yp.getApp();await t.projectManager.removeProject(e),await this.currentWindow.loadProjects()}})},onAddPack(){!async function(){const e=await Yp.getApp(),t=new Xa("windows.projectChooser.addPack"),i=await t.actionManager,n=e.project.getPacks();Dn.all().filter((e=>!n.includes(e.id))).forEach((t=>i.create({icon:t.icon,color:t.color,name:`packType.${t.id}.name`,description:`packType.${t.id}.description`,onTrigger:async()=>{var i;e.windows.loadingWindow.open();const n=e.project.fileSystem,s=await Yd.loadFromConfig();switch(t.id){case"behaviorPack":await(new Rd).create(n,s);break;case"resourcePack":await(new Ud).create(n,s);break;case"skinPack":await(new Jd).create(n,s);break;case"worldTemplate":await(new Xd).create(n,s);break;default:throw e.windows.loadingWindow.close(),new Error(`Unable to add pack with id "${t.id}"`)}const a=await n.readJSON("config.json");await n.writeJSON("config.json",c(l({},a),{packs:c(l({},null!=(i=a.packs)?i:{}),{[t.id]:Da[t.id]})}),!0),e.project.addPack(c(l({},t),{packPath:Da[t.id],version:[1,0,0]})),e.project.updateChangedFiles(),Yp.eventSystem.dispatch("projectChanged",void 0),e.windows.loadingWindow.close()}}))),t.open()}(),this.currentWindow.close()}},computed:{authors(){const e=this.sidebar.currentState.authors||"Unknown";return Array.isArray(e)?Ku.format(e):e}}},Ju,qu,!1,Zu,"69068460",null,null);function Zu(e){for(let t in Qu)this[t]=Qu[t]}var Yu=function(){return Xu.exports}();class ep extends Je{constructor(){super(Yu,!1,!0),d(this,"sidebar",new kr([])),d(this,"currentProject"),d(this,"experimentalToggles",[]),this.defineWindow(),this.actions.push(new Ke({icon:"mdi-import",name:"actions.importBrproject.name",color:"accent",onTrigger:()=>{this.close(),iu()}}),new Ke({icon:"mdi-plus",name:"windows.projectChooser.newProject.name",color:"accent",onTrigger:async()=>{const e=await Yp.getApp();this.close(),e.windows.createProject.open()}}))}addProject(e,t,i){this.sidebar.addElement(new br({color:"primary",text:null!=t?t:"Unknown",icon:`mdi-alpha-${t[0].toLowerCase()}-box-outline`,id:null!=e?e:h()}),i),this.sidebar.setDefaultSelected()}async loadProjects(){this.sidebar.removeElements();const e=await Yp.getApp(),t=await e.projectManager.getProjects(),i=await e.dataLoader.readJSON("data/packages/minecraftBedrock/experimentalGameplay.json");return t.forEach((e=>this.addProject(e.projectData.path,e.name,c(l({},e.projectData),{experimentalGameplay:i.map((t=>{var i,n;return l({isActive:null!=(n=null==(i=e.config.get().experimentalGameplay)?void 0:i[t.id])&&n},t)}))})))),this.sidebar.setDefaultSelected(e.projectManager.selectedProject),e.projectManager.selectedProject}async open(){this.currentProject=await this.loadProjects(),super.open()}}const tp={};var ip=Le({name:"ChangelogComponent",components:{BaseWindow:St},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(){this.currentWindow.close()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseWindow",{attrs:{windowTitle:"windows.changelogWindow.title",isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,width:600,height:600},on:{closeWindow:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[i("div",{staticClass:"mt-4 mb-2 d-flex align-center"},[i("v-icon",{staticClass:"mr-2",attrs:{color:"primary",large:""}},[e._v("mdi-update")]),i("h1",[e._v("v"+e._s(e.$data.version))])],1),i("v-divider",{staticClass:"mb-4"}),i("div",{staticClass:"changelog",domProps:{innerHTML:e._s(e.$data.changelog)}})]},proxy:!0}])})}),[],!1,np,null,null,null);function np(e){for(let t in tp)this[t]=tp[t]}var sp=function(){return ip.exports}();class ap extends Je{constructor(){super(sp),d(this,"changelog"),d(this,"version"),this.defineWindow()}async open(){Yp.audioManager.playAudio("click5.ogg",1);const e=await Yp.getApp();e.windows.loadingWindow.open(),await fetch("/changelog.html").then((e=>e.text())).then((e=>{this.changelog=e,this.version="2.1.5"})),e.windows.loadingWindow.close(),super.open()}}const rp={};var op=Le({name:"Socials",mixins:[Be],components:{BaseWindow:St},data(){return this.currentWindow},props:["currentWindow"],methods:{close(){this.currentWindow.close()},openDiscord(){window.open("https://discord.gg/jj2PmqU","_blank")},openTwitter(){window.open("https://twitter.com/bridgeEditor","_blank")},openGithub(){window.open("https://github.com/bridge-core","_blank")}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:"windows.socials.title",isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,width:420,height:140},on:{closeWindow:e.close},scopedSlots:e._u([{key:"default",fn:function(){return[i("p",[e._v(e._s(e.t("windows.socials.content")))])]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"#7289DA"},on:{click:e.openDiscord}},[i("v-icon",{attrs:{color:"white"}},[e._v("mdi-discord")]),i("span",{staticClass:"white--text"},[e._v(e._s(e.t("windows.socials.discord")))])],1),i("v-btn",{attrs:{color:"#1DA1F2"},on:{click:e.openTwitter}},[i("v-icon",{attrs:{color:"white"}},[e._v("mdi-twitter")]),i("span",{staticClass:"white--text"},[e._v(e._s(e.t("windows.socials.twitter")))])],1),i("v-btn",{attrs:{color:"#333"},on:{click:e.openGithub}},[i("v-icon",{attrs:{color:"white"}},[e._v("mdi-github")]),i("span",{staticClass:"white--text"},[e._v(e._s(e.t("windows.socials.github")))])],1)]},proxy:!0}],null,!1,533919895)}):e._e()}),[],!1,lp,null,null,null);function lp(e){for(let t in rp)this[t]=rp[t]}var cp=function(){return op.exports}();class dp extends Je{constructor(){super(cp),this.defineWindow()}}class up{constructor(e){d(this,"settings"),d(this,"socialsWindow",new dp),d(this,"projectChooser",new ep),d(this,"createProject",new Yd),d(this,"loadingWindow",new Tu),d(this,"filePicker",new Gu),d(this,"createPreset",new Lu),d(this,"extensionStore",new Cu),d(this,"browserUnsupported",new gu),d(this,"changelogWindow",new ap),this.app=e,this.settings=new Do(e)}}class pp extends La{constructor(e=!1){super(),d(this,"_virtualFileSystem"),this.loadData(e)}get virtualFileSystem(){if(!this._virtualFileSystem)throw new Error("DataLoader: virtualFileSystem is not initialized");return this._virtualFileSystem}async loadData(e=!1){const t=await fetch("/packages.zip").then((e=>e.arrayBuffer())),i=await new Promise(((e,i)=>X(new Uint8Array(t),(async(t,n)=>{if(t)return i(t);e(n)}))));this._virtualFileSystem=new Me(null,"bridgeFolder",new Map,e),await this._virtualFileSystem.setupDone.fired;const n={".":await this._virtualFileSystem.getDirectoryHandle("data",{create:!0})};for(const s in i){const e=Tn(s),t=_n(s);if(s.endsWith("/")){const i=await n[t].getDirectoryHandle(e,{create:!0});n[s.slice(0,-1)]=i}else await n[t].getFileHandle(e,{create:!0,initialData:i[s]})}this.setup(this._virtualFileSystem)}}class hp extends xe{constructor(){super(),d(this,"state",k({currentHeight:window.innerHeight,currentWidth:window.innerWidth})),window.addEventListener("resize",C((()=>this.dispatch()),50,{trailing:!0})),this.on((([e,t])=>{this.state.currentWidth=e,this.state.currentHeight=t})),Yp.getApp().then((e=>e.projectManager.projectReady.fired.then((()=>this.dispatch()))))}dispatch(){super.dispatch([window.innerWidth,window.innerHeight])}}class mp extends es{constructor(e,t){super(e,5,t)}isEquals(e,t){return e.path===t.path}}const gp=zt?"bridge. Nightly":"bridge. v2";class fp{constructor(){d(this,"titleTag"),d(this,"current",R(gp)),this.titleTag=document.head.getElementsByTagName("title")[0]}setProject(e){this.titleTag.innerText=`${e} - ${gp}`,this.current.value=`${e} - ${gp}`}}class wp extends Ce{constructor(e){super(),d(this,"addedProject",new xe),d(this,"activatedProject",new xe),d(this,"recentProjects"),d(this,"state",j({})),d(this,"title",Object.freeze(new fp)),d(this,"_selectedProject"),d(this,"projectReady",new Ce),this.app=e,this.loadProjects(),this.recentProjects=k(new mp(this.app,"data/recentProjects.json")),this.once((()=>{this.recentProjects.keep((e=>Object.values(this.state).findIndex((t=>t.projectData.path===e.path))>-1))}))}get currentProject(){if(this.selectedProject)return this.state[this.selectedProject]}get selectedProject(){return this._selectedProject}async getProjects(){return await this.fired,Object.values(this.state)}async addProject(e,t=!0){const i=new tc(this,this.app,e);return await i.loadProject(),S(this.state,i.name,i),t&&(await this.selectProject(i.name),this.addedProject.dispatch(i)),i}async removeProject(e){const t=this.state[e];t&&(x(this.state,e),await this.app.fileSystem.unlink(`projects/${e}`),this.recentProjects.remove(t.projectData))}async loadProjects(){await this.app.fileSystem.fired,await this.app.dataLoader.fired,await yc.ready.fired;let e=[];try{e=await this.app.fileSystem.readdir("projects",{withFileTypes:!0})}catch{}const t=e.filter((({kind:e})=>"directory"===e));if(0===t.length){const e=this.app.windows.createProject;e.open(!0),await e.fired}else for(const i of t)await this.addProject(i,!1);this.dispatch()}async selectProject(e){var t,i;if(void 0===this.state[e])throw new Error(`Cannot select project "${e}" because it no longer exists`);const n=await Yp.getApp();null==(t=this.currentProject)||t.deactivate(),this._selectedProject=e,Yp.eventSystem.dispatch("disableValidation",null),null==(i=this.currentProject)||i.activate(),this.currentProject&&await this.recentProjects.add(this.currentProject.projectData),await f("selectedProject",e),n.themeManager.updateTheme(),Yp.eventSystem.dispatch("projectChanged",this.currentProject),this.projectReady.hasFired||this.projectReady.dispatch()}async selectLastProject(e){await this.fired;let t=await g("selectedProject");if("string"==typeof t)try{await e.fileSystem.getDirectoryHandle(`projects/${t}`)}catch{t=await this.loadFallback()}else t=await this.loadFallback();if("string"!=typeof t)throw new Error("Expected string, found "+typeof t);await this.selectProject(t)}async loadFallback(){await this.fired;const e=Object.keys(this.state)[0];return await f("selectedProject",e),e}updateAllEditorOptions(e){Object.values(this.state).forEach((t=>t.tabSystems.forEach((t=>t.updateOptions(e)))))}forEachProject(e){return Object.values(this.state).forEach(e),this.addedProject.on(e)}onActiveProject(e){return this.projectReady.hasFired&&this.currentProject&&e(this.currentProject),this.activatedProject.on(e)}async recompileAll(e=!0){for(const t of Object.values(this.state))await t.recompile(e)}}class vp{constructor(){d(this,"mayCloseOnClickOutside",!0),d(this,"isVisible",!1),d(this,"actionManager"),d(this,"position",{x:0,y:0})}show(e,t,i=!0){this.position.x=e.clientX,this.position.y=e.clientY,this.actionManager=t,this.mayCloseOnClickOutside=i,this.isVisible=!0}setMayCloseOnClickOutside(e){setTimeout((()=>{this.mayCloseOnClickOutside=e}),100)}}class yp extends dl{constructor(e){super(e.fileSystem,"extensions","data/inactiveExtensions.json",!0),this.app=e}async getInstalledExtensions(){return new Map([...(await super.getInstalledExtensions()).entries(),...(await this.app.project.extensionLoader.getInstalledExtensions()).entries()])}mapActive(e){const t=this.app.project.extensionLoader.mapActive(e);for(const i of this._extensions.values())i.isActive&&t.push(e(i));return t}installFilesToCurrentProject(){return Promise.all([...this.extensions.values()].map((e=>e.installFilesToCurrentProject())))}async reload(){this.disposeAll(),this.loadExtensions()}}class bp{constructor(e){d(this,"state",k({isHovering:!1})),d(this,"fileHandlers",new Map),this.app=e,window.addEventListener("dragover",(e=>{var t;e.preventDefault(),Yp.windowState.isAnyWindowVisible.value&&yc.ready.hasFired||"move"!==(null==(t=e.dataTransfer)?void 0:t.effectAllowed)&&(this.state.isHovering=!0)})),window.addEventListener("mouseout",(e=>{e.preventDefault(),null==e.relatedTarget&&(this.state.isHovering=!1)})),window.addEventListener("dragend",(e=>{e.preventDefault(),this.state.isHovering=!1})),window.addEventListener("drop",(e=>{var t,i;e.preventDefault(),Yp.windowState.isAnyWindowVisible.value&&yc.ready.hasFired||(this.onDrop([...null!=(i=null==(t=e.dataTransfer)?void 0:t.items)?i:[]]),this.state.isHovering=!1)})),"launchQueue"in window&&window.launchQueue.setConsumer((async e=>{if(e.files.length)for(const t of e.files)await this.importFile(t)}))}async onDrop(e){for(const t of e){const e=await t.getAsFileSystemHandle();if(!e)return;"directory"===e.kind?Ie||"com.mojang"!==e.name||this.app.comMojang.handleComMojangDrop(e):"file"===e.kind&&await this.importFile(e)}}async importFile(e){const t=An(e.name),i=this.fileHandlers.get(t);if(!i)return!1;try{await i(e)}catch(n){return console.error(n),!1}return!0}addFileImporter(e,t){if(this.fileHandlers.has(e))throw new Error(`Handler for ${e} already exists`);return this.fileHandlers.set(e,t),{dispose:()=>this.fileHandlers.delete(e)}}}class kp{constructor(e,t){d(this,"disposables",[]);for(const i of e)this.disposables.push(t.addFileImporter(i,this.onImport.bind(this)))}dispose(){this.disposables.forEach((e=>e.dispose()))}}class Sp extends kp{constructor(e){super([".mcaddon"],e)}async onImport(e){const t=await Yp.getApp();t.windows.loadingWindow.open();try{await eu(e)}catch(i){console.error(i)}finally{t.windows.loadingWindow.close()}}}const xp={};var Cp=Le({name:"FilePathWindow",mixins:[Be],components:{BaseWindow:St,PresetPath:Dl},props:["currentWindow"],data(){return this.currentWindow},methods:{onClose(e){this.currentWindow.close(e?null:this.currentFilePath)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldRender?i("BaseWindow",{attrs:{windowTitle:"windows.filePath.title",isVisible:e.isVisible,hasMaximizeButton:!1,isFullscreen:!1,isPersistent:e.$data.isPersistent,hasCloseButton:!1,width:440,height:140},on:{closeWindow:function(t){return e.onClose(!0)}},scopedSlots:e._u([{key:"default",fn:function(){return[i("PresetPath",{model:{value:e.currentFilePath,callback:function(t){e.currentFilePath=t},expression:"currentFilePath"}})]},proxy:!0},{key:"actions",fn:function(){return[i("v-spacer"),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.onClose(!1)}}},[i("v-icon",[e._v("mdi-check")]),i("span",[e._v(" "+e._s(e.t("general.confirm"))+" ")])],1)]},proxy:!0}],null,!1,2163908922)}):e._e()}),[],!1,jp,null,null,null);function jp(e){for(let t in xp)this[t]=xp[t]}var _p=function(){return Cp.exports}();class Pp extends Je{constructor(e,t=!0){super(_p,!0,!1),d(this,"currentFilePath"),this.isPersistent=t,this.currentFilePath=null!=e?e:"",this.defineWindow(),this.open()}}class Ap extends kp{constructor(e){super([".mcfunction",".mcstructure",".json",".molang",".js",".ts",".lang",".tga",".png",".jpg",".jpeg"],e)}async onImport(e){const t=await Yp.getApp(),i=t.locales.translate.bind(t.locales),n=new Xa("fileDropper.importMethod",{isPersistent:!0}),s=await n.actionManager;s.create({icon:"mdi-content-save-outline",name:"fileDropper.saveToProject.title",description:`[${i("fileDropper.saveToProject.description1")} "${e.name}" ${i("fileDropper.saveToProject.description2")}]`,onTrigger:()=>this.onSave(e)}),s.create({icon:"mdi-share-outline",name:"fileDropper.openFile.title",description:`[${i("fileDropper.openFile.description1")} "${e.name}" ${i("fileDropper.openFile.description2")}]`,onTrigger:()=>this.onOpen(e)}),n.open(),await n.fired}async onSave(e){var t;const i=await Yp.getApp(),n=new Pp(null!=(t=await Fn.guessFolder(e))?t:"",!1);n.open();const s=await n.fired;if(null===s)return;if(await i.project.fileSystem.fileExists(`${s}${e.name}`)){const e=new vo({description:"windows.createPreset.overwriteFiles",confirmText:"windows.createPreset.overwriteFilesConfirm"});if(e.open(),!(await e.fired))return}i.windows.loadingWindow.open();const a=await i.project.fileSystem.getFileHandle(`${s}${e.name}`,!0);await i.project.fileSystem.copyFileHandle(e,a),Yp.eventSystem.dispatch("fileAdded",void 0),await i.project.updateFile(`${s}${e.name}`),await i.project.openFile(a,{isTemporary:!1}),i.windows.loadingWindow.close()}async onOpen(e){const t=await Yp.getApp();await t.project.openFile(e)}}class Tp extends kp{constructor(e){super([".brproject"],e)}async onImport(e){await qc(e)}}class Ep extends kp{constructor(e){super([".bbmodel"],e)}async onImport(e){const t=await Yp.getApp(),i=await e.getFile(),n=T.parse(await i.text());t.windows.loadingWindow.open(),await this.exportImages(t,n.textures),await this.exportModel(t,n),t.windows.loadingWindow.close()}async exportImages(e,t){for(let i of t){const t=await fetch(i.source),n=await t.arrayBuffer();let s="png";switch(t.headers.get("content-type")){case"image/png":s="png";break;case"image/jpeg":case"image/jpg":s="jpg";break;case"image/tga":case"image/x-tga":case"image/x-targa":case"image/target":case"application/x-tga":case"application/x-targa":s="tga"}const a=Pn("RP","textures","entity",i.folder,`${i.name}.${s}`);if(await e.project.fileSystem.fileExists(a)){const e=new vo({description:"general.confirmOverwriteFile",confirmText:"windows.createPreset.overwriteFilesConfirm"});if(e.open(),!(await e.fired))continue}const r=await e.project.fileSystem.writeFile(a,n);Yp.eventSystem.dispatch("fileAdded",void 0),await e.project.updateFile(a),await e.project.openFile(r,{isTemporary:!1})}}async exportModel(e,t){var i,n,s,a,r,o;const l={description:{identifier:"geometry."+(t.geometry_name||"unknown"),texture_width:t.resolution.width||16,texture_height:t.resolution.height||16,visible_bounds_width:null!=(n=null==(i=t.visible_box)?void 0:i[0])?n:0,visible_bounds_height:null!=(a=null==(s=t.visible_box)?void 0:s[1])?a:0,visible_bounds_offset:[0,null!=(o=null==(r=t.visible_box)?void 0:r[2])?o:0,0]}},c={format_version:"1.12.0","minecraft:geometry":[l]},d=this.extractCubes(t.elements,t.meta.box_uv),u=this.extractLocators(t.elements),p=this.createBones(t,d,u);p.size>0&&(l.bones=[...p.values()]);const h=Pn("RP","models","entity",t.name+".json");if(await e.project.fileSystem.fileExists(h)){const e=new vo({description:"general.confirmOverwriteFile",confirmText:"windows.createPreset.overwriteFilesConfirm"});if(e.open(),!(await e.fired))return}const m=await e.project.fileSystem.getFileHandle(h,!0);await e.project.fileSystem.writeJSON(h,c,!0),Yp.eventSystem.dispatch("fileAdded",void 0),await e.project.updateFile(h),await e.project.openFile(m,{isTemporary:!1})}extractCubes(e,t=!0){const i=new Map;return e.forEach((e=>{if("locator"===e.type)return;const n=Array.isArray(e.rotation)&&e.rotation.every((e=>0!==e)),s={origin:e.from?[...e.from]:void 0,size:e.to.map(((t,i)=>t-e.from[i])),rotation:n?e.rotation.map(((e,t)=>2===t?e:-e)):void 0,pivot:n?[-1*e.origin[0],e.origin[1],e.origin[2]]:void 0,inflate:e.inflate};if(s.origin&&(s.origin[0]=-(s.origin[0]+s.size[0])),t)s.uv=e.uv_offset,e.mirror_uv&&(s.mirror=e.mirror_uv);else{s.uv={};for(const[t,i]of Object.entries(e.faces))null!==i.texture&&(s.uv[t]={uv:[i.uv[0],i.uv[1]],uv_size:[i.uv[2]-i.uv[0],i.uv[3]-i.uv[1]]},i.material_name&&(s.uv[t].material_instance=i.material_name),"up"!==t&&"down"!==t||(s.uv[t].uv[0]+=s.uv[t].uv_size[0],s.uv[t].uv[1]+=s.uv[t].uv_size[1],s.uv[t].uv_size[0]*=-1,s.uv[t].uv_size[1]*=-1))}i.set(e.uuid,s)})),i}extractLocators(e){const t=new Map;return e.forEach((e=>{if("locator"!==e.type)return;const i={offset:[...e.from]};i.offset[0]*=-1,0===e.rotation[0]&&0===e.rotation[1]&&0===e.rotation[2]||(i.rotation=[-e.rotation[0],-e.rotation[0],e.rotation[0]]),t.set(e.name,i)})),t}createBones(e,t,i){const n=new Map;return Array.isArray(e.outliner)&&e.outliner.forEach((e=>this.parseOutlinerElement(e,n,t,i))),n}parseOutlinerElement(e,t,i,n,s){const a={name:e.name,parent:null==s?void 0:s.name,pivot:[-1*e.origin[0],e.origin[1],e.origin[2]],rotation:e.rotation?[-1*e.rotation[0],-1*e.rotation[1],e.rotation[2]]:void 0,binding:e.bedrock_binding,mirror:e.mirror_uv,material:e.material,reset:e.reset,cubes:e.children.filter((e=>"string"==typeof e)).map((e=>i.get(e))).filter((e=>void 0!==e)),locators:Object.fromEntries(e.children.filter((e=>"string"==typeof e)).map((e=>[e,n.get(e)])).filter((([e,t])=>void 0!==t)))};if(0===a.cubes.length&&(a.cubes=void 0),0===Object.keys(a.locators).length&&(a.locators=void 0),t.set(e.name,a),Array.isArray(e.children))for(let r of e.children)r instanceof Object&&this.parseOutlinerElement(r,t,i,n,a)}}class Fp{constructor(e){new Sp(e),new Ap(e),new Tp(e),new Ep(e)}}class Dp extends xe{constructor(){super(),d(this,"currentLanguage"),d(this,"loadedFileType"),d(this,"baseKeywords",["minecraft"]),d(this,"dynamicKeywords",[]),d(this,"typeIdentifiers",[]),d(this,"variables",[]),d(this,"definitions",[]),Yp.getApp().then((async e=>{await e.projectManager.projectReady.fired,e.projectManager.onActiveProject((e=>{this.updateKeywords(e.config),e.fileSave.on("config.json",(()=>this.updateKeywords(e.config)))}))})),Yp.eventSystem.on("currentTabSwitched",(e=>this.loadWords(e))),this.loadWords()}get keywords(){return this.baseKeywords.concat(this.dynamicKeywords)}get knownWords(){return{keywords:this.keywords,typeIdentifiers:this.typeIdentifiers,variables:this.variables,definitions:this.definitions}}async updateKeywords(e){await e.refreshConfig(),this.baseKeywords=[...new Set(["minecraft","bridge",e.get().namespace].filter((e=>void 0!==e)))],this.updateHighlighter()}async loadWords(e){var t,i,n,s,a,r;const o=await Yp.getApp();await o.projectManager.projectReady.fired,await Fn.ready.fired;const l=null!=e?e:null==(t=o.project.tabSystem)?void 0:t.selectedTab;if(!(l instanceof Gn||l instanceof Ta))return;const{id:c,highlighterConfiguration:d={}}=null!=(i=Fn.getGlobal(o.project.config,l.getPath()))?i:{};if(!c)return this.resetWords(l);c!==this.loadedFileType&&(this.dynamicKeywords=null!=(n=d.keywords)?n:[],this.typeIdentifiers=null!=(s=d.typeIdentifiers)?s:[],this.variables=null!=(a=d.variables)?a:[],this.definitions=null!=(r=d.definitions)?r:[],l instanceof Gn?this.updateHighlighter():l instanceof Ta&&this.dispatch(this.knownWords),this.loadedFileType=c)}resetWords(e){this.dynamicKeywords=[],this.typeIdentifiers=[],this.variables=[],this.definitions=[],e instanceof Gn?this.updateHighlighter():e instanceof Ta&&this.dispatch(this.knownWords),this.loadedFileType="unknown"}updateHighlighter(){var e;const t=_.setMonarchTokensProvider("json",{defaultToken:"invalid",tokenPostfix:".json",atoms:["false","true","null"],keywords:this.keywords,typeIdentifiers:this.typeIdentifiers,variables:this.variables,definitions:this.definitions,symbols:/[=><!~?:&|+\-*\/\^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,tokenizer:{root:[[/[{}]/,"delimiter.bracket"],{include:"common"}],common:[[/[a-z_$][\w$]*/,{cases:{"@atoms":"atom","@default":"identifier"}}],{include:"@whitespace"},[/(@digits)[eE]([\-+]?(@digits))?/,"number.float"],[/(@digits)\.(@digits)([eE][\-+]?(@digits))?/,"number.float"],[/(@digits)/,"number"],[/[:,]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"\//,{token:"identifier",next:"@embeddedCommand",nextEmbedded:"mcfunction"}],[/"/,"identifier","@string"]],embeddedCommand:[[/@escapes/,"string.escape"],[/"/,{token:"identifier",next:"@pop",nextEmbedded:"@pop"}]],whitespace:[[/[ \t\r\n]+/,""],[/\/\*\*(?!\/)/,"comment.doc","@jsdoc"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^\/*]+/,"comment"],[/\*\//,"comment","@pop"],[/[\/*]/,"comment"]],jsdoc:[[/[^\/*]+/,"comment.doc"],[/\*\//,"comment.doc","@pop"],[/[\/*]/,"comment.doc"]],string:[[/[^\"\:]+/,{cases:{"@keywords":"keyword","@variables":"variable","@typeIdentifiers":"type.identifier","@definitions":"definition","@default":"string"}}],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"identifier","@pop"]]}});null==(e=this.currentLanguage)||e.dispose(),this.currentLanguage=t,this.dispatch(this.knownWords)}}class Op{constructor(){d(this,"highlighter",new Dp),this.setModeConfiguration()}getHighlighter(){return this.highlighter}setModeConfiguration(){_.json.jsonDefaults.setModeConfiguration({colors:!1,tokens:!1,completionItems:!0,diagnostics:!0,hovers:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0,documentSymbols:!0,foldingRanges:!0,selectionRanges:!0})}}class Mp{constructor(e){d(this,"change",new xe),this.vuetify=e,H(e.breakpoint,(()=>{this.change.dispatch(e.breakpoint.mobile)})),this.change.dispatch(e.breakpoint.mobile)}isCurrentDevice(){return this.vuetify.breakpoint.mobile}}class $p{constructor(e,t,i,n=!1){var s,a;d(this,"children",[]),d(this,"displayName"),d(this,"uuid",h()),d(this,"isFolderOpen",!1),d(this,"hasLoadedChildren"),d(this,"isLoading",!1),d(this,"type"),this.fileSystem=e,this.parent=t,this.path=i,this._isFile=n,n||this.isFolderOpen&&this.loadChildren(i),this.type=this._isFile?"file":null!=(a=null==(s=null==Re?void 0:Re.general)?void 0:s.enablePackSpider)&&a?"virtualFolder":"folder",this.hasLoadedChildren=this._isFile}static async create(e=[],t=!1){const i=new $p(Yp.instance.fileSystem,null,e,t);return i.open(),k(i)}async loadChildren(e){var t,i,n;this.isLoading=!0;const s=await Yp.getApp(),a=null!=(i=await(null==(t=s.project)?void 0:t.packIndexer.readdir(e,{withFileTypes:!0})))?i:[];this.children=[];for(const r of a){if("darwin"===qe()&&".DS_Store"===r.name&&"file"===r.kind)return;const t=new $p(this.fileSystem,this,null!=(n="string"==typeof r.path?r.path.split("/"):r.path)?n:e.concat([r.name]),"file"===r.kind);t.setDisplayName(r.displayName),r.filePath&&t.setPath(r.filePath),this.children.push(t)}this.sortChildren(),this.isLoading=!1,this.hasLoadedChildren=!0}async createOpenStateMap(){const e={};return await this.iterate((t=>{t._isFile||(e[t.getPath()]=t.isFolderOpen)})),e}async refresh(){const e=await this.createOpenStateMap();await this.loadChildren(this.path),await this.iterate((async t=>{!t._isFile&&e[t.getPath()]&&await t.open()}))}get name(){var e;return null!=(e=this.displayName)?e:this.path[this.path.length-1]}get isFile(){return this._isFile}get color(){var e;return null==(e=Dn.get(this.getPath()))?void 0:e.color}get icon(){var e;return null==(e=Fn.getGlobal(Yp.instance.project.config,this.getPath()))?void 0:e.icon}getPath(){var e,t;return null!=(t=null==(e=this.path)?void 0:e.join("/"))?t:[]}getPathWithoutPack(){const e=[...this.path];return e.shift(),e.join("/")}setPath(e){return this.path=e.split("/")}updatePath(e){this.path=e.split("/"),this._isFile||this.children.forEach((t=>{t.updatePath(Pn(e,t.name))}))}async open(){return this.isFile?(Yp.ready.once((async e=>{var t;const i=await e.fileSystem.getFileHandle(this.getPath());await(null==(t=e.project)?void 0:t.openFile(i))})),!0):(this.isFolderOpen=!this.isFolderOpen,this.hasLoadedChildren||await this.loadChildren(this.path),!1)}setDisplayName(e){this.displayName=e}remove(){if(void 0===this.parent)throw new Error("FileDisplayer: Cannot delete root of FS");this.parent.children=this.parent.children.filter((e=>e!==this))}sortChildren(){this.children=this.children.sort(((e,t)=>{if(e.isFile&&!t.isFile)return 1;if(!e.isFile&&t.isFile)return-1;if(e.isFile){if(e.getPathWithoutPack()>t.getPathWithoutPack())return 1;if(e.getPathWithoutPack()<t.getPathWithoutPack())return-1}else{if(e.name>t.name)return 1;if(e.name<t.name)return-1}return 0}))}updateUUID(){this.uuid=h()}async iterate(e){await e(this),await Promise.all(this.children.map((t=>t.iterate(e))))}}const Ip={};var Rp=Le({name:"FileDisplayer",mixins:[{data:()=>({settingsState:Re}),computed:{enablePackSpider(){var e,t;return null!=(t=null==(e=null==Re?void 0:Re.general)?void 0:e.enablePackSpider)&&t}}}],components:{Draggable:W},props:{entry:Object,startPath:Array},setup(e,{emit:t}){const i=R(!1),n=function(e,t=!1){let i=null,n=0;return(...s)=>{if("touch"===Ss.value)return e(!1,...s);0===n?(n++,t&&e(!1,...s),i=window.setTimeout((()=>{n=0,i=null,t||e(!1,...s)}),500)):(i&&window.clearTimeout(i),n=0,e(!0,...s))}}(((e,n)=>{if(e)Yp.getApp().then((e=>{const t=e.project.tabSystem.selectedTab;t&&t.isTemporary&&(t.isTemporary=!1)}));else{if(i.value)return;n.open()&&t("closeWindow")}}),!0);return{pointerDevice:Ss,onClick:n,isHoveringBtn:i}},mounted(){this.loadDirectory()},data:()=>({directoryEntry:null,tree:[]}),methods:{onClickFolder(e){this.isHoveringBtn||e.open()},async loadDirectory(){if(this.entry)this.directoryEntry=this.entry;else{const e=await Yp.getApp();await e.projectManager.projectReady.fired,e.project.packIndexer.once((async()=>{this.directoryEntry=await $p.create(this.startPath)}))}},async draggedFile(e){const t=Object.values(e)[0].element;if("added"in e){const e=await Yp.getApp(),i=t.getPath();t.updatePath(Pn(this.directoryEntry.getPath(),t.name));const n=t.getPath();t.parent=this.directoryEntry,await e.project.fileSystem.move(i,n),await e.project.updateChangedFiles(),await e.project.recentFiles.removeFile(`projects/${e.project.name}/${i}`)}t.parent&&t.parent.sortChildren()}},watch:{startPath(){this.loadDirectory()},entry(){this.loadDirectory()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.directoryEntry&&!e.directoryEntry.isLoading?i("div",{staticClass:"text-normal"},[i("Draggable",{attrs:{group:"pack-explorer",disabled:e.enablePackSpider||"touch"===e.pointerDevice},on:{change:e.draggedFile},model:{value:e.directoryEntry.children,callback:function(t){e.$set(e.directoryEntry,"children",t)},expression:"directoryEntry.children"}},[e._l(e.directoryEntry.children,(function(t){return[t.isFile?i("div",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,staticClass:"file d-flex align-center rounded-lg",on:{click:function(i){return i.stopPropagation(),e.onClick(t)},contextmenu:function(i){i.preventDefault(),i.stopPropagation(),e.$emit("contextmenu",{type:"file",path:t.path.join("/"),clientX:i.clientX,clientY:i.clientY,entry:t})}}},[i("v-icon",{staticClass:"pr-1",attrs:{color:t.color,small:""}},[e._v(" "+e._s(t.icon||"mdi-file-outline")+" ")]),e._v(" "+e._s(t.name)+" "),i("v-spacer"),"touch"===e.pointerDevice?i("v-btn",{attrs:{text:"",icon:"",small:""},on:{click:function(i){e.$emit("contextmenu",{type:"file",path:t.path.join("/"),clientX:i.clientX,clientY:i.clientY,entry:t})},mouseenter:function(t){e.isHoveringBtn=!0},mouseleave:function(t){e.isHoveringBtn=!1}}},[i("v-icon",[e._v(" mdi-dots-vertical-circle-outline ")])],1):e._e()],1):i("details",{key:t.uuid,staticClass:"folder",attrs:{open:t.isFolderOpen}},[i("summary",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"rounded-lg",on:{click:function(i){return i.preventDefault(),e.onClickFolder(t)},contextmenu:function(i){i.preventDefault(),i.stopPropagation(),e.$emit("contextmenu",{type:t.type,path:t.path.join("/"),clientX:i.clientX,clientY:i.clientY,entry:t})}}},[i("span",{staticClass:"d-flex align-center"},[i("v-icon",{staticClass:"pr-1",attrs:{color:t.color,small:""}},[e._v(" "+e._s(t.isFolderOpen?"mdi-folder-open":"mdi-folder")+" ")]),i("span",{staticClass:"folder"},[e._v(e._s(t.name))]),i("v-spacer"),"touch"===e.pointerDevice?i("v-btn",{attrs:{text:"",icon:"",small:""},on:{click:function(i){e.$emit("contextmenu",{type:t.type,path:t.path.join("/"),clientX:i.clientX,clientY:i.clientY,entry:t})},mouseenter:function(t){e.isHoveringBtn=!0},mouseleave:function(t){e.isHoveringBtn=!1}}},[i("v-icon",[e._v(" mdi-dots-vertical-circle-outline ")])],1):e._e()],1)]),i("FileDisplayer",{attrs:{entry:t},on:{closeWindow:function(t){return e.$emit("closeWindow")},contextmenu:function(t){return e.$emit("contextmenu",t)}}})],1)]}))],2)],1):i("v-progress-linear",{attrs:{indeterminate:""}})}),[],!1,Wp,"0a7d026a",null,null);function Wp(e){for(let t in Ip)this[t]=Ip[t]}const Np={};var Bp=Le({props:{sidebarContent:Object},components:{FileDisplayer:function(){return Rp.exports}()},methods:{async onContextMenu(e){Wn(e,await this.sidebarContent.getContextMenu(e.type,e.path,e.entry))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.sidebarContent.selectedAction?i("FileDisplayer",{key:e.sidebarContent.selectedAction.config.id,attrs:{entry:e.sidebarContent.directoryEntries[e.sidebarContent.selectedAction.config.id]},on:{contextmenu:e.onContextMenu}}):e._e()}),[],!1,Lp,null,null,null);function Lp(e){for(let t in Np)this[t]=Np[t]}var Hp=function(){return Bp.exports}();const Vp={};var zp=Le({data:()=>({imgSrc:"/img/icons/android-chrome-192x192.png",name:"Unknown"}),mounted(){this.onProjectChanged(),Yp.eventSystem.on("projectChanged",this.onProjectChanged)},destroyed(){Yp.eventSystem.off("projectChanged",this.onProjectChanged)},methods:{onClick(){Yp.getApp().then((e=>e.windows.projectChooser.open()))},async onProjectChanged(){var e,t;const i=await Yp.getApp();await i.projectManager.projectReady.fired;const n=i.project.projectData;this.name=null!=(e=n.name)?e:"Unknown",this.imgSrc=null!=(t=n.imgSrc)?t:"/img/icons/android-chrome-192x192.png"}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"d-flex align-center pa-2 clickable",on:{click:e.onClick}},[i("img",{staticClass:"rounded-lg",staticStyle:{"image-rendering":"pixelated"},attrs:{src:e.imgSrc,draggable:"false",height:"44px",alt:"Pack Icon of "+e.name}}),i("h1",{staticClass:"header ml-2",staticStyle:{opacity:"0.7",display:"block",width:"calc(100% - 52px)","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}},[e._v(" "+e._s(e.name)+" ")])])}),[],!1,Up,"795d3f16",null,null);function Up(e){for(let t in Vp)this[t]=Vp[t]}var Gp=function(){return zp.exports}();async function Jp(e=!1){var t,i,n,s,a;const r=await Yp.getApp(),o=r.project,l=o.fileSystem;r.windows.loadingWindow.open(),await r.project.compilerManager.start("default","build");let c,d=[];if(o.hasPacks(["worldTemplate"])&&d.push("WT"),await l.directoryExists("worlds")&&d.push(...(await l.readdir("worlds")).map((e=>`worlds/${e}`))),0===d.length)return void r.windows.loadingWindow.close();if(1===d.length)c=d[0];else{const e=new Ro({default:d[0],name:"windows.packExplorer.exportAsMctemplate.chooseWorld",options:d});c=await e.fired}await l.mkdir("builds/mctemplate/behavior_packs",{recursive:!0}),await l.mkdir("builds/mctemplate/resource_packs",{recursive:!0});const u=await l.readdir("builds/dist"),p=Object.fromEntries(Object.entries({BP:u.find((e=>e.endsWith("BP"))),RP:u.find((e=>e.endsWith("RP"))),WT:u.find((e=>e.endsWith("WT")))}).map((([e,t])=>[e,`builds/dist/${t}`])));if("WT"===c?await l.move(p.WT,"builds/mctemplate"):await l.copyFolder(c,"builds/mctemplate"),p.BP){const e=await l.readJSON(`${p.BP}/manifest.json`).catch((()=>null));null!==e&&(null==(t=null==e?void 0:e.header)?void 0:t.uuid)&&(null==(i=null==e?void 0:e.header)?void 0:i.version)&&await l.writeJSON("builds/mctemplate/world_behavior_packs.json",[{pack_id:e.header.uuid,version:e.header.version}])}if(p.RP){const e=await l.readJSON(`${p.RP}/manifest.json`).catch((()=>null));null!==e&&(null==(n=null==e?void 0:e.header)?void 0:n.uuid)&&(null==(s=null==e?void 0:e.header)?void 0:s.version)&&await l.writeJSON("builds/mctemplate/world_resource_packs.json",[{pack_id:e.header.uuid,version:e.header.version}])}p.BP&&await l.move(p.BP,`builds/mctemplate/behavior_packs/BP_${r.project.name}`),p.RP&&await l.move(p.RP,`builds/mctemplate/resource_packs/RP_${r.project.name}`),await l.fileExists("builds/mctemplate/manifest.json")||e?e&&"WT"===c&&await l.unlink("builds/mctemplate/manifest.json"):await l.writeJSON("builds/mctemplate/manifest.json",{format_version:2,header:{name:"pack.name",description:"pack.description",version:[1,0,0],uuid:h(),lock_template_options:!0,base_game_version:(null!=(a=r.project.config.get().targetVersion)?a:await ja()).split(".")},modules:[{type:"world_template",version:[1,0,0],uuid:h()}]});const m=new Uc(await r.project.fileSystem.getDirectoryHandle("builds/mctemplate",{create:!0})),g=`projects/${r.project.name}/builds/${r.project.name}.${e?"mcworld":"mctemplate"}`;try{await Wl(g,await m.package(),r.fileSystem)}catch(f){console.error(f)}await l.unlink("builds/mctemplate"),o.app.windows.loadingWindow.close()}async function qp(){const e=await Yp.getApp();return e.project.hasPacks(["worldTemplate"])||await e.project.fileSystem.directoryExists("worlds")&&(await e.project.fileSystem.readdir("worlds")).length>0}class Kp extends fr{constructor(){super(),d(this,"component",Hp),d(this,"actions",[]),d(this,"directoryEntries",{}),d(this,"topPanel",Ie?new Ha({type:"warning",text:"general.fileSystemPolyfill",isDismissible:!0}):void 0),Yp.eventSystem.on("projectChanged",(()=>this.setup())),Yp.eventSystem.on("fileAdded",(()=>this.refresh())),Yp.getApp().then((e=>{e.mobile.isCurrentDevice()||(this.headerSlot=Gp),e.mobile.change.on((e=>{this.headerSlot=e?void 0:Gp}))})),this.headerHeight="60px"}async setup(){var e,t,i;const n=await Yp.getApp();this.unselectAllActions();for(const s of null!=(e=n.project.projectData.contains)?e:[])S(this.directoryEntries,s.packPath,await $p.create([s.packPath]));this.actions=null!=(i=null==(t=n.project.projectData.contains)?void 0:t.map((e=>new gr(this,{id:e.packPath,name:`packType.${e.id}.name`,icon:e.icon,color:e.color}))))?i:[],Ie&&this.actions.push(new mr({icon:"mdi-content-save-outline",name:"general.save",onTrigger:()=>Gc()})),this.actions.push(new mr({icon:"mdi-dots-vertical",name:"general.more",onTrigger:e=>{this.showMoreMenu(e)}}))}async refresh(){await Promise.all(Object.values(this.directoryEntries).map((e=>e.refresh())))}async getContextMenu(e,t,i){if("virtualFolder"===e)return[];const n=await Yp.getApp().then((e=>e.project));return[{icon:"mdi-delete-outline",name:"windows.packExplorer.fileActions.delete.name",description:"windows.packExplorer.fileActions.delete.description",onTrigger:async()=>{const e=new vo({description:"windows.packExplorer.fileActions.delete.confirmText"});if(await e.fired){i.remove(),await Promise.all([n.packIndexer.unlink(t),n.compilerManager.unlink(t)]),await n.jsonDefaults.reload();try{await n.fileSystem.unlink(t)}catch{}await n.recentFiles.removeFile(`projects/${n.name}/${t}`)}}},..."file"===e?[{icon:"mdi-pencil-outline",name:"windows.packExplorer.fileActions.rename.name",description:"windows.packExplorer.fileActions.rename.description",onTrigger:async()=>{const e=i.name.split(".").slice(0,-1).join("."),s=new Ho({name:"windows.packExplorer.fileActions.rename.name",label:"general.fileName",default:e,expandText:An(t)}),a=await s.fired;if(!a)return;const r=Pn(_n(t),a);if(await n.fileSystem.fileExists(r)){const e=new vo({description:"general.confirmOverwriteFile"});if(!(await e.fired))return}await Promise.all([n.packIndexer.unlink(t),n.compilerManager.unlink(t)]),await n.fileSystem.move(t,r),await n.updateFile(r),await n.recentFiles.removeFile(`projects/${n.name}/${t}`),this.refresh()}},{icon:"mdi-content-duplicate",name:"windows.packExplorer.fileActions.duplicate.name",description:"windows.packExplorer.fileActions.duplicate.description",onTrigger:async()=>{const e=i.name.split(".").slice(0,-1).join("."),s=new Ho({name:"windows.packExplorer.fileActions.duplicate.name",label:"general.fileName",default:e,expandText:An(t)}),a=await s.fired;if(!a)return;const r=Pn(_n(t),a);if(await n.fileSystem.fileExists(r)){const e=new vo({description:"general.confirmOverwriteFile"});if(!(await e.fired))return}await n.fileSystem.copyFile(t,r),await n.updateFile(r),Yp.eventSystem.dispatch("fileAdded",void 0)}},{type:"divider"},{icon:"mdi-cogs",name:"windows.packExplorer.fileActions.viewCompilerOutput.name",description:"windows.packExplorer.fileActions.viewCompilerOutput.description",onTrigger:async()=>{const e=n.app,i=await n.compilerManager.current.getCompilerOutputPath(t),s=e.comMojang.hasComMojang?e.comMojang.fileSystem:n.fileSystem;if(!(await s.fileExists(i)))return void new Pt({description:"windows.packExplorer.fileActions.viewCompilerOutput.fileMissing"});const a=await s.getFileHandle(i);await(null==n?void 0:n.openFile(a,{selectTab:!0,isReadOnly:!0}))}}]:[{icon:"mdi-file-plus-outline",name:"windows.packExplorer.fileActions.createFile.name",description:"windows.packExplorer.fileActions.createFile.description",onTrigger:async()=>{const e=new Ho({name:"windows.packExplorer.fileActions.createFile.name",label:"general.fileName",default:"",expandText:An(t)}),i=await e.fired;if(!i)return;const s=await n.fileSystem.writeFile(`${t}/${i}`,"");Yp.eventSystem.dispatch("fileAdded",void 0),await n.openFile(s,{selectTab:!0}),n.updateChangedFiles()}},{icon:"mdi-folder-plus-outline",name:"windows.packExplorer.fileActions.createFolder.name",description:"windows.packExplorer.fileActions.createFolder.description",onTrigger:async()=>{const e=new Ho({name:"windows.packExplorer.fileActions.createFolder.name",label:"general.fileName",default:"",expandText:An(t)}),i=await e.fired;i&&(await n.fileSystem.mkdir(`${t}/${i}`,{recursive:!0}),this.refresh())}},{type:"divider"}],{icon:"mdi-folder-outline",name:"windows.packExplorer.fileActions.revealFilePath.name",description:"windows.packExplorer.fileActions.revealFilePath.description",onTrigger:()=>new Pt({name:"windows.packExplorer.fileActions.revealFilePath.name",description:`[${t}]`,isPersistent:!1}).open()}]}async showMoreMenu(e){const t=await Yp.getApp();Wn(e,[{icon:"mdi-plus",name:"windows.packExplorer.createPreset",onTrigger:async()=>{const e=await Yp.getApp();await e.windows.createPreset.open()}},{icon:"mdi-refresh",name:"windows.packExplorer.refresh.name",onTrigger:async()=>{t.actionManager.trigger("bridge.action.refreshProject")}},{icon:"mdi-restart-alert",name:"windows.packExplorer.restartDevServer.name",onTrigger:()=>{new vo({description:"windows.packExplorer.restartDevServer.description",onConfirm:async()=>{await Promise.all([t.project.fileSystem.unlink(".bridge/.lightningCache"),t.project.fileSystem.unlink(".bridge/.compilerFiles")]),await t.project.fileSystem.writeFile(".bridge/.restartDevServer",""),t.actionManager.trigger("bridge.action.refreshProject")}})}},{type:"divider"},{icon:"mdi-export",name:"windows.packExplorer.exportAsBrproject.name",onTrigger:()=>Gc()},{icon:"mdi-folder-zip-outline",name:"windows.packExplorer.exportAsMcaddon.name",onTrigger:()=>async function(){var e,t,i,n;const s=await Yp.getApp();if(s.windows.loadingWindow.open(),Ie){const a=s.project.fileSystem;let r={};for(const d of s.project.getPacks()){const o=s.project.getFilePath(d);if(await a.fileExists(`${o}/manifest.json`)){const s=null!=(e=await a.readJSON(`${o}/manifest.json`))?e:{},[d,u,p]=null!=(i=null==(t=s.header)?void 0:t.version)?i:[0,0,0],h=[d,u,p+1];r[`${o}/manifest.json`]=c(l({},s),{header:c(l({},null!=(n=s.header)?n:{}),{version:h})})}}const o=Object.values(r);for(const e of o)Array.isArray(e.dependencies)&&e.dependencies.forEach((e=>{const t=o.find((t=>t.header.uuid===e.uuid));t&&(e.version=t.header.version)}));for(const[e,t]of Object.entries(r))await a.writeJSON(e,t,!0)}await s.project.compilerManager.start("default","build");const a=new Uc(await s.project.fileSystem.getDirectoryHandle("builds/dist",{create:!0})),r=`projects/${s.project.name}/builds/${s.project.name}.mcaddon`;try{await Wl(r,await a.package(),s.fileSystem)}catch(o){console.error(o)}s.windows.loadingWindow.close()}()},{icon:"mdi-earth-box",name:"windows.packExplorer.exportAsMcworld.name",isDisabled:!(await qp()),onTrigger:()=>Jp(!0)},{icon:"mdi-earth-box-plus",name:"windows.packExplorer.exportAsMctemplate.name",isDisabled:!(await qp()),onTrigger:()=>Jp()},...await t.project.exportProvider.getExporters(),{type:"divider"},{icon:"mdi-cog-outline",name:"windows.packExplorer.projectConfig.name",onTrigger:async()=>{var e;const i=t.project;await i.fileSystem.fileExists("config.json")?await(null==(e=i.tabSystem)?void 0:e.openPath(`projects/${i.name}/config.json`)):new Pt({description:"windows.packExplorer.projectConfig.missing"})}}])}}const Qp=m("app-notifications","app-notification-store");class Xp extends Tt{constructor(e){if(super(e),!e.id)throw new Error("PersistentNotification requires an id")}async show(){await g(this.id,Qp)||super.show()}dispose(){super.dispose(),f(this.id,!0,Qp)}}const Zp=class{constructor(e){d(this,"packExplorer",new Kp),d(this,"keyBindingManager",new ca),d(this,"actionManager",new Rn(this.keyBindingManager)),d(this,"themeManager"),d(this,"taskManager",new ru),d(this,"dataLoader",y(new pp(!0))),d(this,"fileSystem",new La),d(this,"projectManager",new wp(this)),d(this,"extensionLoader",new yp(this)),d(this,"windowResize",new hp),d(this,"contextMenu",new vp),d(this,"locales"),d(this,"fileDropper",new bp(this)),d(this,"fileImportManager",new Fp(this.fileDropper)),d(this,"comMojang",new yo(this)),d(this,"configuredJsonLanguage",y(new Op)),d(this,"mobile"),d(this,"languageManager",y(new uc)),d(this,"_windows"),this.themeManager=new vc(e.$vuetify),this.locales=new Ne(e.$vuetify),this._windows=new up(this),this.mobile=new Mp(e.$vuetify);const t="Are you sure that you want to close bridge.? Unsaved progress will be lost.";window.addEventListener("beforeunload",(e=>{var i;if((null==(i=this.tabSystem)?void 0:i.hasUnsavedTabs)||this.taskManager.hasRunningTasks||Ie)return e.preventDefault(),e.returnValue=t,t})),Do.loadedSettings.once((e=>{var t,i;null!=(i=null==(t=null==e?void 0:e.general)?void 0:t.openProjectChooserOnAppStartup)&&i&&this.projectManager.projectReady.once((()=>{Ie?nu():Zp.instance.windows.projectChooser.open()}))}))}get windows(){return this._windows}get tabSystem(){var e;return null==(e=this.projectManager.currentProject)?void 0:e.tabSystem}get selectedProject(){return this.projectManager.selectedProject}get project(){if(!this.projectManager.currentProject)throw new Error("Trying to access project before it is defined. Make sure to await app.projectManager.projectReady.fired");return this.projectManager.currentProject}get projects(){return Object.values(this.projectManager.state)}get projectConfig(){return this.project.config}static get instance(){return this._instance}static getApp(){return new Promise((e=>Zp.ready.once((t=>e(t)))))}static openUrl(e,t){var i;return(null==(i=null==Re?void 0:Re.general)?void 0:i.openLinksInBrowser)?window.open(e,"_blank"):window.open(e,t,"toolbar=no,menubar=no,status=no")}static async main(e){this._instance=y(Object.freeze(new Zp(e))),this.instance.windows.loadingWindow.open(),await this.instance.beforeStartUp();const t=await this.fileSystemSetup.setupFileSystem(this.instance);if(!t)return this.instance.windows.loadingWindow.close();this.instance.fileSystem.setup(t),await g("firstStartAfterUpdate")&&(await f("firstStartAfterUpdate",!1),this.instance.windows.changelogWindow.open()),await Do.loadSettings(this.instance).then((async()=>{await this.instance.dataLoader.fired,this.instance.themeManager.loadDefaultThemes(this.instance),this.audioManager.loadIsMuted()})),await this.instance.startUp(),this.ready.dispatch(this.instance),await this.instance.projectManager.selectLastProject(this.instance),this.instance.windows.loadingWindow.close()}async beforeStartUp(){console.time("[APP] beforeStartUp()"),navigator.clearAppBadge&&navigator.clearAppBadge(),async function(){wr({id:"projects",displayName:"windows.projectChooser.title",icon:"mdi-view-dashboard-outline",onClick:async()=>{Ie?nu():Yp.instance.windows.projectChooser.open()}});const e=wr({id:"packExplorer",displayName:"windows.packExplorer.title",icon:"mdi-folder-outline"});Yp.getApp().then((t=>{e.setSidebarContent(t.packExplorer),e.click()})),wr({id:"fileSearch",displayName:"findAndReplace.name",icon:"mdi-file-search-outline",onClick:async()=>{var e;const t=await Yp.getApp();null==(e=t.project.tabSystem)||e.add(new zc(t.project.tabSystem),!0)}}),wr({id:"compiler",displayName:"sidebar.compiler.name",icon:"mdi-cogs",onClick:async()=>{var e;const t=await Yp.getApp();await(null==(e=t.project)?void 0:e.compilerManager.openWindow())}}),wr({id:"extensions",displayName:"sidebar.extensions.name",icon:"mdi-puzzle-outline",onClick:async()=>{const e=await Yp.getApp();await e.windows.extensionStore.open()}}),Do.loadedSettings.once((e=>{var t,i,n;for(const s of Object.values(eh.sidebarElements))s.isVisible=null==(n=null==(i=null==(t=null==e?void 0:e.sidebar)?void 0:t.sidebarElements)?void 0:i[s.uuid])||n}))}(),du(this);{const e=new Xp({id:"bridge-social-links",icon:"mdi-link-variant",message:"sidebar.notifications.socials.message",color:"#1DA1F2",textColor:"white",onClick:()=>{this.windows.socialsWindow.open(),e.dispose()}}),t=new Xp({id:"bridge-getting-started",icon:"mdi-help-circle-outline",message:"sidebar.notifications.gettingStarted.message",onClick:()=>{Zp.openUrl("https://bridge-core.github.io/editor-docs/getting-started/"),t.dispose()}})}console.timeEnd("[APP] beforeStartUp()")}async startUp(){console.time("[APP] startUp()"),this.locales.setDefaultLanguage(),await Promise.all([this.fileSystem.mkdir("projects"),this.fileSystem.mkdir("extensions"),this.fileSystem.mkdir("data"),Fn.setup(this.dataLoader),Dn.setup(this.dataLoader)]),this.projectManager.projectReady.fired.then((async()=>this.extensionLoader.loadExtensions())),console.timeEnd("[APP] startUp()")}};let Yp=Zp;d(Yp,"windowState",new class{constructor(){d(this,"state",j({})),d(this,"isAnyWindowVisible",R(!0)),H(this.state,(()=>{for(const e of Object.values(this.state))if(e.isVisible)return void(this.isAnyWindowVisible.value=!0);this.isAnyWindowVisible.value=!1}),{deep:!1})}}),d(Yp,"installApp",new class extends Tt{constructor(){super({message:"sidebar.notifications.installApp.message",color:"primary",icon:"mdi-download",textColor:"white",isVisible:!1}),d(this,"isInstallable",new Ce),d(this,"isInstalled",new Ce),d(this,"installEvent"),window.addEventListener("beforeinstallprompt",(e=>this.onInstallPrompt(e))),window.addEventListener("appinstalled",(()=>this.dispose())),this.addClickHandler((()=>this.prompt()))}onInstallPrompt(e){e.preventDefault(),this.installEvent=e,this.show(),this.isInstallable.dispatch()}prompt(){this.installEvent?(this.installEvent.prompt(),this.installEvent.userChoice.then((e=>{"accepted"===e.outcome&&(this.dispose(),this.isInstalled.dispatch())}))):this.dispose()}}),d(Yp,"fileSystemSetup",new kc),d(Yp,"toolbar",new class{constructor(){d(this,"state",j({}))}addCategory(e){S(this.state,e.id,e)}disposeCategory(e){x(this.state,e.id)}}),d(Yp,"eventSystem",new ul(["projectChanged","currentTabSwitched","refreshCurrentContext","disableValidation","fileAdded","fileChange","fileSave","presetsChanged"])),d(Yp,"ready",new Ce),d(Yp,"_instance"),d(Yp,"audioManager",new class{constructor(){d(this,"currentAudioPlaying"),d(this,"masterVolume",1),d(this,"isMuted",!(null==(e=null==Re?void 0:Re.audio)?void 0:e.playAudio))}loadIsMuted(){var e;this.isMuted=!(null==(e=null==Re?void 0:Re.audio)?void 0:e.playAudio)}playAudio(e="click5.ogg",t=1){const i="/audio/";this.isMuted||(this.currentAudioPlaying?this.currentAudioPlaying.currentTime/this.currentAudioPlaying.duration==1&&(this.currentAudioPlaying=new Audio(i+e),this.currentAudioPlaying.volume=t*this.masterVolume,this.currentAudioPlaying.play()):(this.currentAudioPlaying=new Audio(i+e),this.currentAudioPlaying.volume=t*this.masterVolume,this.currentAudioPlaying.play()))}});const eh=k({isNavigationVisible:!0,currentState:null,sidebarElements:{}});const th=R(!1);H(eh,(()=>{th.value=null!==eh.currentState}),{deep:!1});const ih={data:()=>({windowControlsOverlay:navigator.windowControlsOverlay&&navigator.windowControlsOverlay.visible}),mounted(){navigator.windowControlsOverlay&&navigator.windowControlsOverlay.addEventListener("geometrychange",(e=>{this.windowControlsOverlay=e.visible}))}},nh={mixins:[ih],computed:{appToolbarHeight(){return`env(titlebar-area-height, ${this.$vuetify.breakpoint.mobile?32:24}px)`},appToolbarHeightNumber(){return this.windowControlsOverlay?33:this.$vuetify.breakpoint.mobile?32:24}}};const sh={name:"Sidebar",mixins:[nh],props:{app:Boolean},components:{SidebarButton:Ge},data:()=>({SidebarState:eh,settingsState:Re,tasks:au,NotificationStore:At}),computed:{isMobile(){return this.$vuetify.breakpoint.mobile},isNavigationVisible:{get(){return!this.isMobile||eh.isNavigationVisible},set(e){eh.isNavigationVisible=e}},sidebarElements:()=>Object.values(eh.sidebarElements).filter((e=>e.isVisible)),hasVisibleNotifications(){return Object.values(this.NotificationStore).some((({isVisible:e})=>e))},isSidebarRight(){return this.settingsState&&this.settingsState.sidebar&&this.settingsState.sidebar.isSidebarRight}},methods:{closeSidebar(){eh.isNavigationVisible=!1}}},ah={};var rh=Le(sh,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-navigation-drawer",{style:{maxHeight:"calc(100% - "+e.appToolbarHeight+")",top:e.appToolbarHeight},attrs:{"mini-variant":"","mini-variant-width":"60",stateless:"",app:e.app,absolute:"",right:e.isSidebarRight,color:"sidebarNavigation",height:"calc(100% - "+e.appToolbarHeight+")"},model:{value:e.isNavigationVisible,callback:function(t){e.isNavigationVisible=t},expression:"isNavigationVisible"}},[e.isMobile?i("SidebarButton",{attrs:{displayName:"general.close",icon:"mdi-close",color:"error"},on:{click:e.closeSidebar}}):e._e(),i("v-list",e._l(e.sidebarElements,(function(e){return i("SidebarButton",{key:""+e.uuid,attrs:{displayName:e.displayName,icon:e.icon,isLoading:e.isLoading,isSelected:e.isSelected},on:{click:function(t){return e.click()}}})})),1),e.hasVisibleNotifications?i("v-list",[i("v-divider",{staticClass:"mx-3 mb-6"}),e._l(e.NotificationStore,(function(t){return[t.isVisible?i("SidebarButton",{key:t.id,attrs:{displayName:t.message,icon:t.icon,color:t.color,iconColor:t.textColor},on:{click:function(e){return t.onClick()},middleClick:function(e){return t.onMiddleClick()}}}):e._e()]}))],2):e._e(),e.tasks.length>0?i("v-list",[i("v-divider",{staticClass:"mx-3 mb-6"}),e._l(e.tasks,(function(e,t){return i("SidebarButton",{key:""+t,attrs:{displayName:e.name,icon:e.icon,color:"primary",isLoading:"",alwaysAllowClick:""},on:{click:function(t){return e.createWindow()}}},[i("v-progress-circular",{attrs:{rotate:"-90",size:"24",width:"2",color:"white",value:e.progress}})],1)}))],2):e._e()],1)}),[],!1,oh,null,null,null);function oh(e){for(let t in ah)this[t]=ah[t]}var lh=function(){return rh.exports}();const ch={};var dh=Le({name:"WindowAction",components:{},props:{action:Function,icon:String,color:String}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn",{staticClass:"toolbar-btn",attrs:{small:"",icon:"",color:e.color},on:{click:function(t){return t.stopPropagation(),e.action(t)}}},[i("v-icon",{attrs:{small:""}},[e._v(e._s(e.icon))])],1)}),[],!1,uh,"b0e50f88",null,null);function uh(e){for(let t in ch)this[t]=ch[t]}var ph=function(){return dh.exports}();const hh={};var mh=Le({name:"MenuList",mixins:[Be],props:{elements:Object},methods:{onClick(e){e.trigger()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list",{staticClass:"app-menu",staticStyle:{"border-radius":"0"},attrs:{color:"menu"}},[e._l(e.elements,(function(t,n,s){return["divider"===t.type?i("v-divider",{key:"menu."+s+"."+Math.random()}):i("v-menu",{key:"menu."+s+"."+Math.random(),attrs:{"open-on-hover":"","offset-x":"",tile:"","z-index":"11"},scopedSlots:e._u([{key:"activator",fn:function(n){var s=n.on;return[i("v-list-item",e._g({attrs:{dense:""},on:{click:function(i){return e.onClick(t)}}},"category"===t.type?s:void 0),[t.icon?i("v-list-item-icon",[i("v-icon",{attrs:{color:"accent",small:""}},[e._v(e._s(t.icon))])],1):e._e(),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.t(t.name))+" ")])],1),i("v-list-item-action",[i("v-list-item-action-text",["category"!==t.type&&t.keyBinding?i("span",[e._v(" "+e._s(t.keyBinding.toStrKeyCode())+" ")]):e._e(),"category"===t.type?i("v-icon",{attrs:{small:""}},[e._v(" mdi-chevron-right ")]):e._e()],1)],1)],1)]}}],null,!0)},[i("MenuList",{attrs:{elements:t.state}})],1)]}))],2)}),[],!1,gh,null,null,null);function gh(e){for(let t in hh)this[t]=hh[t]}var fh=function(){return mh.exports}();const wh={name:"MenuButton",mixins:[Be],props:{displayName:String,displayIcon:String,disabled:{type:Boolean}}},vh={};var yh=Le(wh,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn",{staticClass:"toolbar-btn",class:{"btn-enabled":!e.disabled,"btn-disabled":e.disabled,"px-1":e.$vuetify.breakpoint.mobile},attrs:{small:"",text:"",disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}},[e.displayIcon?i("v-icon",{class:{"pr-1":!e.$vuetify.breakpoint.mobile},attrs:{color:"accent","x-small":e.$vuetify.breakpoint.mobile}},[e._v(" "+e._s(e.displayIcon)+" ")]):e._e(),i("span",[e._v(" "+e._s(e.t(e.displayName))+" ")])],1)}),[],!1,bh,"574f7a7c",null,null);function bh(e){for(let t in vh)this[t]=vh[t]}var kh=function(){return yh.exports}();const Sh={name:"MenuActivator",components:{MenuList:fh,MenuButton:kh},props:{item:Object,disabled:Boolean}},xh={};var Ch=Le(Sh,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"min-width":"260px","offset-y":"",tile:"","z-index":"11"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("MenuButton",e._g({attrs:{disabled:e.disabled,displayIcon:e.item.icon,displayName:e.item.name}},n))]}}]),model:{value:e.item.isVisible,callback:function(t){e.$set(e.item,"isVisible",t)},expression:"item.isVisible"}},[e.item.isVisible?i("MenuList",{attrs:{elements:e.item.state}}):e._e()],1)}),[],!1,jh,null,null,null);function jh(e){for(let t in xh)this[t]=xh[t]}const _h={};var Ph=Le({name:"Toolbar",mixins:[ih,nh],components:{WindowAction:ph,MenuActivator:function(){return Ch.exports}(),MenuButton:kh,Logo:qt},setup(){const e=k({title:"bridge.",isAnyWindowVisible:Yp.windowState.isAnyWindowVisible});return Yp.getApp().then((t=>{e.title=t.projectManager.title.current})),e},data:()=>({toolbar:Yp.toolbar.state,isMacOS:"darwin"===qe(),appVersion:"2.1.5"}),methods:{async openChangelogWindow(){if(this.isAnyWindowVisible)return;const e=await Yp.getApp();await e.windows.changelogWindow.open()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-system-bar",{style:{"padding-left":0,"margin-left":"env(titlebar-area-x, 0)",width:"env(titlebar-area-width, 100%)","z-index":e.windowControlsOverlay?1e3:void 0},attrs:{color:"toolbar",fixed:"",app:"",clipped:"",padless:"",height:e.appToolbarHeight}},[e.isMacOS&&e.windowControlsOverlay?e._e():i("Logo",{staticStyle:{height:"20px","padding-right":"4px","padding-left":"calc(env(safe-area-inset-left) + 4px)"},attrs:{alt:"Logo of bridge. v2",draggable:"false"}}),i("v-divider",{attrs:{vertical:""}}),i("v-toolbar-items",{staticClass:"px14-font"},[e._l(e.toolbar,(function(t,n,s){return["category"!==t.type?i("MenuButton",{key:"button."+n,attrs:{displayName:t.name,displayIcon:t.icon,disabled:e.isAnyWindowVisible},on:{click:function(){return t.trigger()}}}):t.shouldRender?i("MenuActivator",{key:"activator."+n,attrs:{item:t,disabled:e.isAnyWindowVisible}}):e._e(),t.shouldRender&&(e.windowControlsOverlay||s+1<Object.keys(e.toolbar).length)?i("v-divider",{key:"divider."+n,attrs:{vertical:""}}):e._e()]}))],2),e.windowControlsOverlay?i("span",{staticClass:"pl-3"},[e._v(" "+e._s(e.title)+" ")]):e._e(),i("v-spacer"),i("div",{directives:[{name:"ripple",rawName:"v-ripple",value:!e.isAnyWindowVisible,expression:"!isAnyWindowVisible"}],staticClass:"px-1 mx-1 rounded-lg app-version-display",style:{opacity:e.isAnyWindowVisible?.4:null,"margin-right":"env(safe-area-inset-right, 0)"},on:{click:e.openChangelogWindow}},[e._v(" v"+e._s(e.appVersion)+" ")])],1)}),[],!1,Ah,"cf4fc784",null,null);function Ah(e){for(let t in _h)this[t]=_h[t]}var Th=function(){return Ph.exports}();const Eh={};var Fh=Le({name:"CollectedWindows",data:()=>({windows:Yp.windowState.state})},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(e.windows,(function(e,t){return i(e.component,{key:t,tag:"component",attrs:{currentWindow:e}})})),1)}),[],!1,Dh,null,null,null);function Dh(e){for(let t in Eh)this[t]=Eh[t]}var Oh=function(){return Fh.exports}();const Mh={mixins:[Vt],computed:{tabSystem(){if(this.project)return this.project.tabSystem},tabSystems(){if(this.project)return this.project.tabSystems},shouldRenderWelcomeScreen(){return this.tabSystems&&(this.tabSystems[0].shouldRender||this.tabSystems[1].shouldRender)}}};const $h={};var Ih=Le({name:"ContextMenu",mixins:[Be],props:{contextMenu:Object},data:()=>({shouldRender:!1,timeoutId:null}),computed:{isVisible:{set(e){this.contextMenu.isVisible=e},get(){return this.contextMenu.isVisible}},actions(){return this.contextMenu&&this.contextMenu.actionManager?this.contextMenu.actionManager.state:[]}},watch:{isVisible(){this.isVisible?(this.shouldRender=!0,this.timeoutId&&clearTimeout(this.timeoutId)):this.timeoutId=setTimeout((()=>{this.shouldRender=!1,this.timeoutId=null}),500)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"position-x":e.contextMenu.position.x,"position-y":e.contextMenu.position.y,rounded:"lg",absolute:"","offset-y":"",transition:"scale-transition","close-on-click":e.contextMenu.mayCloseOnClickOutside},model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},[i("v-list",{attrs:{color:"menu",dense:""}},[e._l(e.actions,(function(t,n){return["divider"===t.type?i("v-divider",{key:n}):i("v-list-item",{key:n,attrs:{origin:"center center",transition:"scale-transition",disabled:t.isDisabled},on:{click:function(e){return t.trigger()}}},[i("v-list-item-icon",{staticClass:"mr-2",style:{opacity:t.isDisabled?"38%":null}},[i("v-icon",{attrs:{color:"primary"}},[e._v(e._s(t.icon))])],1),i("v-list-item-action",{staticClass:"ma-0"},[e._v(" "+e._s(e.t(t.name))+" ")])],1)]}))],2)],1)}),[],!1,Rh,null,null,null);function Rh(e){for(let t in $h)this[t]=$h[t]}var Wh=function(){return Ih.exports}();const Nh={name:"TabSystemTab",props:{tab:Nn,isActive:Boolean},data:()=>({hoveringBtn:!1}),setup:()=>({pointerDevice:Ss}),mounted(){this.isSelected&&this.$refs.tabElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},computed:{compactDesign:()=>!Re.editor||(void 0===Re.editor.compactTabDesign||Re.editor.compactTabDesign),isSelected(){return this.tab.isSelected},tabName(){if(!this.compactDesign||this.isSelected)return this.tab.name;let e=this.tab.name.split(".");return e.pop(),e=e.join("."),e.length>5?e.slice(0,5)+"...":this.tab.name}},watch:{isSelected(){this.isSelected&&this.$refs.tabElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}},Bh={};var Lh=Le(Nh,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"tabElement",staticClass:"px-3 py-2 cursor-pointer",class:{selected:e.tab.isSelected,"default-tab-style":!0,"d-flex":!0,"align-center":!0,inactive:!e.isActive},staticStyle:{position:"relative"},on:{mousedown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:void(!e.hoveringBtn&&e.tab.select())},function(e){if("button"in e&&1!==e.button)return null;e.preventDefault()}],mouseup:function(t){return"button"in t&&1!==t.button?null:e.tab.close()},contextmenu:function(t){return t.preventDefault(),e.tab.onContextMenu(t)},dblclick:function(t){e.tab.isTemporary=!1}}},[e.tab.isSelected&&"touch"===e.pointerDevice?i("v-btn",{attrs:{text:"",icon:"",small:""},on:{click:function(t){return e.tab.onContextMenu(t)},mouseenter:function(t){e.hoveringBtn=!0},mouseleave:function(t){e.hoveringBtn=!1}}},[i("v-icon",[e._v("mdi-dots-vertical")])],1):e._e(),i("v-badge",{class:{"mr-3":e.tab.isReadOnly,"mr-1":e.tab.isUnsaved},attrs:{value:e.tab.isReadOnly||e.tab.isUnsaved,color:e.tab.iconColor,icon:e.tab.isReadOnly?"mdi-lock-outline":null,bordered:"",overlap:"",depressed:"",dot:e.tab.isUnsaved&&!e.tab.isReadOnly}},[i("v-icon",{staticClass:"mr-1",attrs:{color:e.tab.iconColor,small:""}},[e._v(" "+e._s(e.tab.icon)+" ")])],1),i("v-tooltip",{attrs:{color:"tooltip","open-delay":"1500",disabled:"touch"===e.pointerDevice||!e.tab.projectPath,bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("span",e._g({},n),[i("span",{style:{"font-style":e.tab.isTemporary?"italic":null,position:e.tab.folderName?"relative":null,top:e.tab.folderName?"-4px":null}},[e._v(" "+e._s(e.tabName)+" ")]),e.tab.folderName?i("span",{staticStyle:{position:"absolute",top:"22px",left:"32px","font-size":"12px",overflow:"hidden","text-overflow":"ellipsis"},style:{left:e.tab.isSelected&&"touch"===e.pointerDevice?"60px":"32px",width:e.tab.isSelected&&"touch"===e.pointerDevice?"calc(100% - 76px)":"calc(100% - 48px)"}},[e._v(" "+e._s(e.tab.folderName)+"/ ")]):e._e()])]}}])},[i("span",[e._v(e._s(e.tab.projectPath))])]),i("v-btn",{attrs:{text:"",icon:"",small:""},on:{click:function(t){return t.stopPropagation(),e.tab.close()},mouseenter:function(t){e.hoveringBtn=!0},mouseleave:function(t){e.hoveringBtn=!1}}},[i("v-icon",{attrs:{small:""}},[e._v("mdi-close")])],1)],1)}),[],!1,Hh,"c29a26fe",null,null);function Hh(e){for(let t in Bh)this[t]=Bh[t]}var Vh=function(){return Lh.exports}();const zh={};var Uh=Le({props:{action:Ke},mixins:[Be],methods:{onClick(){this.$emit("click"),this.action.trigger()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"ripple",rawName:"v-ripple",value:!e.action.isDisabled,expression:"!action.isDisabled"}],staticClass:"d-flex px-1 mx-1 align-center action",style:{opacity:e.action.isDisabled?.2:1,cursor:e.action.isDisabled?null:"pointer"},on:{click:e.onClick}},[i("v-icon",{staticClass:"mr-1",attrs:{color:e.action.color||"primary",small:""}},[e._v(" "+e._s(e.action.icon)+" ")]),i("span",{staticClass:"action-name"},[e._v(e._s(e.t(e.action.name)))])],1)}),[],!1,Gh,"42e47abc",null,null);function Gh(e){for(let t in zh)this[t]=zh[t]}const Jh={};var qh=Le({components:{Action:function(){return Uh.exports}()},props:{actions:Array}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"d-inline-flex mb-1",staticStyle:{height:"21px",width:"100%","overflow-x":"auto","overflow-y":"hidden"}},e._l(e.actions,(function(t){return i("Action",{key:t.id,attrs:{action:t},on:{click:function(t){return e.$emit("click")}}})})),1)}),[],!1,Kh,null,null,null);function Kh(e){for(let t in Jh)this[t]=Jh[t]}const Qh={};var Xh=Le({components:{TabSystemTab:Vh,ActionBar:function(){return qh.exports}(),Draggable:W},props:{tabSystem:Object},setup:()=>({pointerDevice:Ss}),methods:{updateTab({added:e}){e&&e.element.toOtherTabSystem(!1)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.tabSystem.shouldRender?i("Draggable",{style:"display: flex; overflow-x: scroll; white-space: nowrap; width: 100%; height: 48px;",attrs:{group:{name:"tabSystemTabRow"},disabled:"touch"===e.pointerDevice},on:{change:e.updateTab},nativeOn:{mousedown:function(t){return t.target!==t.currentTarget?null:e.tabSystem.setActive(!0)}},model:{value:e.tabSystem.tabs,callback:function(t){e.$set(e.tabSystem,"tabs",t)},expression:"tabSystem.tabs"}},e._l(e.tabSystem.tabs,(function(t){return i("TabSystemTab",{key:t.uuid,attrs:{tab:t,isActive:e.tabSystem.isActive}})})),1):e._e(),e.tabSystem.selectedTab&&e.tabSystem.selectedTab.actions.length>0?i("ActionBar",{class:{"inactive-action-bar":!e.tabSystem.isActive},attrs:{actions:e.tabSystem.selectedTab.actions},on:{click:function(t){return e.tabSystem.setActive(!0)}}}):e._e()],1)}),[],!1,Zh,"6e0b7f6a",null,null);function Zh(e){for(let t in Qh)this[t]=Qh[t]}const Yh={};var em=Le({name:"TabSystem",mixins:[nh],props:{tabSystem:Object,id:{type:Number,default:0}},components:{TabBar:function(){return Xh.exports}(),WelcomeScreen:Zt},data:()=>({windowHeight:window.innerHeight}),async mounted(){(await Yp.getApp()).windowResize.on(this.updateWindowHeight)},async destroyed(){(await Yp.getApp()).windowResize.off(this.updateWindowHeight)},computed:{tabBarHeight(){return this.tabSystem.selectedTab&&this.tabSystem.selectedTab.actions.length>0?73:48},tabHeight(){return(this.windowHeight-this.appToolbarHeightNumber)/(this.tabSystem.isSharingScreen&&this.isMobile?2:1)-this.tabBarHeight},isMobile(){return this.$vuetify.breakpoint.mobile}},methods:{updateWindowHeight(){this.windowHeight=window.innerHeight}},watch:{"tabSystem.shouldRender"(){Yp.getApp().then((e=>e.windowResize.dispatch()))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.tabSystem.shouldRender?i("div",{style:{"margin-right":"1px",width:e.isMobile?"100%":"calc(50% - 100px)",height:e.isMobile?"50%":"100%"}},[i("TabBar",{attrs:{tabSystem:e.tabSystem}}),e.tabSystem.selectedTab&&e.tabSystem.selectedTab.isLoading?i("v-progress-linear",{attrs:{absolute:"",indeterminate:""}}):e._e(),i("keep-alive",[i(e.tabSystem.currentComponent,{key:e.tabSystem.uuid+"."+(e.tabSystem.currentComponent.name||e.tabSystem.selectedTab.type||e.tabSystem.selectedTab.name),tag:"component",style:"height: "+e.tabHeight+"px; width: 100%;",attrs:{height:e.tabHeight,tab:e.tabSystem.selectedTab,id:e.id}})],1)],1):e._e()}),[],!1,tm,null,null,null);function tm(e){for(let t in Yh)this[t]=Yh[t]}var im=function(){return em.exports}();const nm={};var sm=Le({name:"FileDropperUI",mixins:[Be],data:()=>({state:{isHovering:!1}}),mounted(){Yp.getApp().then((e=>{this.state=e.fileDropper.state}))}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-overlay",{attrs:{opacity:.9},model:{value:e.state.isHovering,callback:function(t){e.$set(e.state,"isHovering",t)},expression:"state.isHovering"}},[i("div",{staticClass:"d-flex flex-column align-center justify-center"},[i("v-icon",{staticStyle:{"font-size":"8em"},attrs:{color:"primary"}},[e._v(" mdi-plus-circle-outline ")]),i("h1",[e._v(e._s(e.t("fileDropper.importFiles")))])],1)])}),[],!1,am,null,null,null);function am(e){for(let t in nm)this[t]=nm[t]}var rm=function(){return sm.exports}();const om={};var lm=Le({mixins:[Be],data:()=>({buttonDisabled:!1}),methods:{async onClick(){Yp.installApp.prompt()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{color:"transparent",elevation:"0",rounded:"lg"}},[i("v-card-actions",[i("v-btn",{attrs:{color:"primary",disabled:e.buttonDisabled},on:{click:e.onClick}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-download")]),e._v(" "+e._s(e.t("sidebar.notifications.installApp.message"))+" ")],1),i("v-spacer"),i("v-btn",{on:{click:function(t){return e.$emit("next")}}},[e._v(e._s(e.t("general.skip")))])],1)],1)}),[],!1,cm,null,null,null);function cm(e){for(let t in om)this[t]=om[t]}var dm=function(){return lm.exports}();const um={};var pm=Le({components:{ActionViewer:Ht},async mounted(){kc.state.receiveDirectoryHandle.dispatch(new Me(null,"bridgeFolder",void 0)),await kc.state.setupDone},data(){return{actions:[new Ke({icon:"mdi-plus",name:"initialSetup.step.bridgeProject.createNew.name",description:"initialSetup.step.bridgeProject.createNew.description",onTrigger:async()=>{this.$emit("next")}}),new Ke({icon:"mdi-import",name:"initialSetup.step.bridgeProject.importExisting.name",description:"initialSetup.step.bridgeProject.importExisting.description",onTrigger:async()=>{let e;try{[e]=await window.showOpenFilePicker({multiple:!1,types:[{description:"bridge. Project",accept:{"application/zip":[".brproject"]}}]})}catch(i){return}const t=new Tu;t.open(),await qc(e,!0),this.$emit("done"),t.close()}})]}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{color:"transparent",elevation:"0"}},e._l(e.actions,(function(e,t){return i("ActionViewer",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t,staticClass:"clickable",attrs:{action:e,hideTriggerButton:""},nativeOn:{click:function(t){return e.trigger()}}})})),1)}),[],!1,hm,null,null,null);function hm(e){for(let t in um)this[t]=um[t]}var mm=function(){return pm.exports}();const gm={};var fm=Le({mixins:[Be],data:()=>({buttonDisabled:!1}),methods:{async onClick(){let e;try{e=await window.showDirectoryPicker({writable:!0,startIn:"documents"})}catch{return}e&&(kc.state.receiveDirectoryHandle.dispatch(e),this.buttonDisabled=!0,await kc.state.setupDone,this.$emit("next"))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn",{attrs:{color:"primary",disabled:e.buttonDisabled},on:{click:e.onClick}},[i("v-icon",{staticClass:"mr-1"},[e._v("mdi-folder-open-outline")]),e._v(" "+e._s(e.t("general.selectFolder"))+" ")],1)}),[],!1,wm,null,null,null);function wm(e){for(let t in gm)this[t]=gm[t]}var vm=function(){return fm.exports}();const ym={};var bm=Le({mixins:[Be],mounted(){Yp.instance.comMojang.setup.fired.then((()=>{this.$emit("next")}))}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{color:"transparent",elevation:"0",rounded:"lg"}},[i("v-card-text",{staticClass:"d-flex align-center"},[i("v-icon",{staticClass:"pr-2",attrs:{color:"primary","x-large":""}},[e._v(" mdi-plus-circle-outline ")]),i("span",{staticClass:"text-h5"},[e._v(" "+e._s(e.t("initialSetup.step.comMojang.extraDescription"))+" ")])],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{on:{click:function(t){return e.$emit("next")}}},[e._v(e._s(e.t("general.skip")))])],1)],1)}),[],!1,km,null,null,null);function km(e){for(let t in ym)this[t]=ym[t]}var Sm=function(){return bm.exports}();const xm={};var Cm=Le({components:{ActionViewer:Ht},data(){return{isLoading:!1,actions:[new Ke({icon:"mdi-text",name:"initialSetup.step.editorType.rawText.name",description:"initialSetup.step.editorType.rawText.description",onTrigger:async()=>{this.isLoading||(this.isLoading=!0,await this.setJsonEditor("rawText"),this.$emit("next"))}}),new Ke({icon:"mdi-file-tree",name:"initialSetup.step.editorType.treeEditor.name",description:"initialSetup.step.editorType.treeEditor.description",onTrigger:async()=>{this.isLoading||(this.isLoading=!0,await this.setJsonEditor("treeEditor"),this.$emit("next"))}})]}},methods:{async setJsonEditor(e){await Do.loadSettings(Yp.instance),Re.editor||(Re.editor={}),Re.editor.jsonEditor=e,await Do.saveSettings(Yp.instance)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{color:"transparent",elevation:"0"}},e._l(e.actions,(function(e,t){return i("ActionViewer",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t,staticClass:"clickable",attrs:{action:e,hideTriggerButton:""},nativeOn:{click:function(t){return e.trigger()}}})})),1)}),[],!1,jm,null,null,null);function jm(e){for(let t in xm)this[t]=xm[t]}var _m=function(){return Cm.exports}();const Pm={};var Am=Le({name:"InitialSetupDialog",mixins:[Be,ih],components:{Logo:qt},setup:()=>({isVisible:kc.state.showInitialSetupDialog}),data:()=>({setupInProgress:!0,stepId:1,steps:[...Ie?[{name:"initialSetup.step.bridgeProject",component:mm}]:[{name:"initialSetup.step.bridge",component:vm},{name:"initialSetup.step.comMojang",component:Sm}],{name:"initialSetup.step.editorType",component:_m}]}),mounted(){let e=!1;Yp.installApp.isInstallable.on((()=>{e||this.stepId>1||(this.steps.unshift({name:"initialSetup.step.installApp",component:dm}),e=!0,this.stepId=0,this.$nextTick((()=>this.stepId=1)))})),Yp.installApp.isInstalled.on((()=>{this.onNext()}))},methods:{onNext(){this.stepId++,this.stepId>this.steps.length&&yc.ready.dispatch()},onDone(){this.stepId=this.steps.length+1,yc.ready.dispatch()}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isVisible?i("v-dialog",{attrs:{value:e.isVisible&&e.stepId<e.steps.length+1,fullscreen:"","hide-overlay":"",persistent:""}},[i("v-card",[i("v-container",{class:{"pt-12":e.windowControlsOverlay}},[i("div",{staticClass:"d-flex flex-column justify-center align-center text-center mb-6"},[i("Logo",{attrs:{height:"128"}}),i("h1",{staticClass:"text-h3"},[e._v(e._s(e.t("initialSetup.welcome")))]),i("h2",{staticClass:"text-h5"},[e._v(" - "+e._s(e.t("initialSetup.welcomeCaption"))+" - ")])],1),i("v-stepper",{attrs:{vertical:""},model:{value:e.stepId,callback:function(t){e.stepId=t},expression:"stepId"}},[e._l(e.steps,(function(t,n){var s=t.name,a=t.component;return[i("v-stepper-step",{key:s+".header",attrs:{complete:e.stepId>n+1,step:n+1}},[i("span",{staticClass:"text-h5"},[e._v(e._s(e.t(s+".name")))]),e.stepId===n+1?i("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.t(s+".description"))+" ")]):e._e()]),i("v-stepper-content",{key:s+".content",attrs:{step:n+1}},[i(a,{tag:"component",on:{next:function(t){return e.onNext()},done:function(t){return e.onDone()}}})],1)]}))],2)],1)],1)],1):e._e()}),[],!1,Tm,null,null,null);function Tm(e){for(let t in Pm)this[t]=Pm[t]}var Em=function(){return Am.exports}();const Fm={mixins:[Be],props:{color:String,icon:String,name:String,isSelected:Boolean}},Dm={};var Om=Le(Fm,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-tooltip",{attrs:{color:e.color||"tooltip",disabled:e.$vuetify.breakpoint.mobile,"open-delay":500,bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[i("div",e._g(e._b({directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"rounded-lg ma-1 d-flex justify-center sidebar-actions pa-2",class:{"elevation-4":e.isSelected},style:{background:e.isSelected?"var(--v-"+e.color+"-base)":null,transform:e.isSelected?"scale(1.05)":null},on:{click:function(t){return e.$emit("click",t)}}},"div",s,!1),n),[i("v-icon",{attrs:{color:e.isSelected?"white":e.color}},[e._v(" "+e._s(e.icon)+" ")])],1)]}}])},[i("span",[e._v(e._s(e.t(e.name)))])])}),[],!1,Mm,"49cd559f",null,null);function Mm(e){for(let t in Dm)this[t]=Dm[t]}const $m={};var Im=Le({props:{actions:Array},components:{Action:function(){return Om.exports}()},methods:{onClick(e,t){t instanceof gr?t.select():t.trigger(e)}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-row",{staticClass:"action-bar pa-1",attrs:{cols:"5","no-gutters":""}},e._l(e.actions,(function(t,n){return i("v-col",{key:n},[i("Action",{attrs:{color:t.config.color,icon:t.config.icon,name:t.config.name,isSelected:t.isSelected},on:{click:function(i){return e.onClick(i,t)}}})],1)})),1)}),[],!1,Rm,"30f490bd",null,null);function Rm(e){for(let t in $m)this[t]=$m[t]}const Wm={};var Nm=Le({mixins:[nh],components:{BridgeSheet:sd,ActionBar:function(){return Im.exports}(),InfoPanel:Ga},mounted(){Yp.getApp().then((e=>{this.windowDimensions=e.windowResize.state}))},data:()=>({SidebarState:eh,windowDimensions:{currentHeight:window.innerHeight}}),computed:{content(){return this.SidebarState.currentState}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.content?i("div",{staticClass:"pa-2",style:{height:"calc("+e.windowDimensions.currentHeight+"px - "+e.appToolbarHeight+")"}},[e.content.headerSlot?i("BridgeSheet",{staticClass:"mb-2",style:{height:e.content.headerHeight,overflow:"auto"}},[i(e.content.headerSlot,{tag:"component"})],1):e._e(),i("BridgeSheet",{style:{height:e.content.headerSlot?"calc(100% - "+e.content.headerHeight+" - 8px)":"100%",overflow:"auto"}},[e.content.topPanel?i("InfoPanel",{staticClass:"ma-2",attrs:{infoPanel:e.content.topPanel}}):e._e(),e.content.actions&&e.content.actions.length>0?i("ActionBar",{attrs:{actions:e.content.actions}}):e._e(),i(e.content.component,{tag:"component",attrs:{sidebarContent:e.content}})],1)],1):e._e()}),[],!1,Bm,null,null,null);function Bm(e){for(let t in Wm)this[t]=Wm[t]}const Lm={};var Hm=Le({name:"App",mixins:[Mh,nh],mounted(){Yp.getApp().then((e=>{this.contextMenu=e.contextMenu,this.windowSize=e.windowResize.state}))},components:{Sidebar:lh,Toolbar:Th,WindowRenderer:Oh,ContextMenu:Wh,TabSystem:im,WelcomeScreen:Zt,FileDropper:rm,InitialSetupDialog:Em,SidebarContent:function(){return Nm.exports}()},data:()=>({isMacOs:"darwin"===qe(),contextMenu:null,settingsState:Re,windowSize:{currentWidth:window.innerWidth,currentHeight:window.innerHeight}}),computed:{isSidebarContentVisible(){return this.sidebarNavigationVisible&&th.value},sidebarNavigationVisible:()=>eh.isNavigationVisible,isSidebarRight(){return this.settingsState&&this.settingsState.sidebar&&this.settingsState.sidebar.isSidebarRight},sidebarSize(){let e=this.settingsState&&this.settingsState.sidebar?this.settingsState.sidebar.sidebarSize:void 0;if(e||(e="normal"),this.$vuetify.breakpoint.mobile)return 9;switch(e){case"tiny":return-2;case"small":return-1;case"normal":return 0;case"large":return 1}},fontFamily(){return this.settingsState&&this.settingsState.appearance&&this.settingsState.appearance.font?`${this.settingsState.appearance.font} !important`:"Roboto !important"}},methods:{openSidebar(){eh.isNavigationVisible=!0}},watch:{"$vuetify.breakpoint.mobile"(){this.$nextTick((()=>{Yp.getApp().then((e=>e.windowResize.dispatch()))}))}}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{style:{fontFamily:e.fontFamily},nativeOn:{contextmenu:function(e){return e.preventDefault()}}},[i("Toolbar"),i("Sidebar",{attrs:{app:""}}),e.sidebarNavigationVisible?e._e():i("v-btn",{staticStyle:{bottom:"calc(env(safe-area-inset-bottom, 0) + 16px)"},attrs:{small:"",fab:"",fixed:"",left:!e.isSidebarRight,right:e.isSidebarRight,color:"primary"},on:{click:e.openSidebar}},[i("v-icon",[e._v("mdi-table-column")])],1),i("v-main",{style:{"padding-top":e.appToolbarHeight}},[i("WindowRenderer"),i("v-row",{staticClass:"d-flex fill-area",class:{"flex-row-reverse":e.isSidebarRight},attrs:{"no-gutters":""}},[e.isSidebarContentVisible?i("v-col",{attrs:{cols:e.isSidebarContentVisible?3+e.sidebarSize:0}},[i("SidebarContent")],1):e._e(),i("v-col",{staticClass:"flex-grow-1",attrs:{cols:e.isSidebarContentVisible?9-e.sidebarSize:12}},[e.shouldRenderWelcomeScreen?i("div",{staticClass:"d-flex",class:{"flex-column":e.$vuetify.breakpoint.mobile},style:{height:"calc("+e.windowSize.currentHeight+"px - "+e.appToolbarHeight+")"}},[e.isSidebarContentVisible&&!e.isSidebarRight?i("v-divider",{staticStyle:{"z-index":"1"},attrs:{vertical:""}}):e._e(),i("TabSystem",{staticClass:"flex-grow-1",attrs:{tabSystem:e.tabSystems[0],showWelcomeScreen:""}}),e.tabSystems[0].shouldRender&&e.tabSystems[1].shouldRender?i("v-divider",{staticStyle:{"z-index":"1"},attrs:{vertical:!e.$vuetify.breakpoint.mobile}}):e._e(),i("TabSystem",{staticClass:"flex-grow-1",attrs:{tabSystem:e.tabSystems[1],id:1}}),e.isSidebarContentVisible&&e.isSidebarRight?i("v-divider",{attrs:{vertical:""}}):e._e()],1):i("WelcomeScreen")],1)],1)],1),i("InitialSetupDialog"),e.contextMenu?i("ContextMenu",{attrs:{contextMenu:e.contextMenu}}):e._e(),i("FileDropper")],1)}),[],!1,Vm,null,null,null);function Vm(e){for(let t in Lm)this[t]=Lm[t]}var zm=function(){return Hm.exports}(),Um=c(l({},pe),{languageName:"English",general:{yes:"Yes",no:"No",okay:"Okay",confirm:"Confirm",cancel:"Cancel",close:"Close",reload:"Reload",information:"Information",continue:"Continue",delete:"Delete",select:"Select",skip:"Skip",save:"Save",more:"More...",selectFolder:"Select Folder",fileName:"File Name",inactive:"Inactive",active:"Active",later:"Later",confirmOverwriteFile:"This action overwrites a file with the same name. Do you want to continue?",fileSystemPolyfill:"Due to the browser you are using, you need to download your projects in order to actually save your progress. This is not necessary if you are using Chrome or Edge!",successfulExport:{title:"Export Successful",description:"You can find the exported package here"},experimentalGameplay:"Experimental Gameplay"},packType:{behaviorPack:{name:"Behavior Pack",description:"Create new game mechanics and change how Minecraft behaves"},resourcePack:{name:"Resource Pack",description:"Used for changing Minecraft's look and sound"},skinPack:{name:"Skin Pack",description:"Provide new appearances a player can select for their character"},worldTemplate:{name:"World Template",description:"Create a world that users can create to experience your project"}},fileType:{manifest:"Manifest",animation:"Animation",animationController:"Animation Controller",biome:"Biome",block:"Block",bridgeConfig:"Project Config",dialogue:"Dialogue",entity:"Entity",feature:"Feature",featureRule:"Feature Rule",functionTick:"Function Tick",function:"Function",item:"Item",lootTable:"Loot Table",recipe:"Recipe",clientScript:"Client Script",serverScript:"Server Script",script:"Script",spawnRule:"Spawn Rule",mcstructure:"Structure",tradeTable:"Trade Table",clientManifest:"Client Manifest",skinManifest:"Skin Manifest",geometry:"Geometry",customCommand:"Command",customComponent:"Component",clientAnimation:"Client Animation",clientAnimationController:"Client Animation Controller",attachable:"Attachable",clientEntity:"Client Entity",clientItem:"Client Item",clientLang:"Language",fog:"Fog",particle:"Particle",renderController:"Render Controller",texture:"Texture",textureSet:"Texture Set",itemTexture:"Item Texture",clientBlock:"Client Block",terrainTexture:"Terrain Texture",flipbookTexture:"Flipbook Texture",clientBiome:"Client Biome",soundDefinition:"Sound Definition",musicDefinition:"Music Definition",clientSound:"Client Sound",skins:"Skins",langDef:"Language Definitions",lang:"Language",molang:"Molang",gameTest:"Game Test",unknown:"Other",simpleFile:"Simple Files",ui:"UI",volume:"Volume",worldManifest:"World Manifest"},actions:{newProject:{name:"New Project",description:"Create a new bridge. project"},newFile:{name:"New File",description:"Create a new Add-On feature"},openFile:{name:"Open File",description:"Open a file from the current project"},searchFile:{name:"Search File",description:"Search and open a file from the current project"},saveFile:{name:"Save File",description:"Save the currently opened file"},saveAs:{name:"Save As",description:"Save the currently opened file under a different name"},saveAll:{name:"Save All",description:"Save all currently opened files"},closeFile:{name:"Close File",description:"Close the currently opened file"},settings:{name:"Settings",description:"Open bridge.'s app settings"},extensions:{name:"Extensions",description:"Install and manage your installed extensions"},copy:{name:"Copy",description:"Copy selected text to the clipboard"},cut:{name:"Cut",description:"Copy selected text to the clipboard and remove it from the original context"},paste:{name:"Paste",description:"Paste clipboard content"},docs:{name:"Documentation",description:"Opens the Minecraft Add-On documentation"},releases:{name:"Releases",description:"View the latest bridge. releases"},bugReports:{name:"Bug Reports",description:"Report an issue with bridge."},extensionAPI:{name:"Extension API",description:"Read more about bridge.'s extension API"},gettingStarted:{name:"Getting Started",description:"Read our guide on how to get started with bridge."},faq:{name:"FAQ",description:"Read through frequently asked questions about developing Add-Ons with bridge."},reloadAutoCompletions:{name:"Reload Auto-Completions",description:"Reloads all auto-completion data"},reloadExtensions:{name:"Reload Extensions",description:"Reloads all extensions"},moveToSplitScreen:{name:"Move to Split Screen",description:"Opens a split screen view and moves this tab to it"},closeTab:{name:"Close Tab",description:"Close this tab"},closeAll:{name:"Close All",description:"Close all tabs"},closeTabsToRight:{name:"Close Tabs to the Right",description:"Close all tabs to the right-hand side of this tab"},closeAllSaved:{name:"Close All Saved",description:"Close all saved tabs"},closeOtherTabs:{name:"Close other Tabs",description:"Close all tabs except this tab"},clearAllNotifications:{name:"Clear All Notifications",description:"Clears all current notifications"},pluginInstallLocation:{global:{name:"Install Globally",description:"Global extensions are accessible in all of your projects"},local:{name:"Install Locally",description:"Local extensions are only accessible inside of the projects you add them to"}},toObject:{name:"Transform to Object"},toArray:{name:"Transform to Array"},documentationLookup:{name:"View Documentation",noDocumentation:"No documentation available for"},toggleReadOnly:{name:"Toggle Read-Only Mode",description:"Toggle read-only mode for the currently opened file"},keepInTabSystem:{name:"Keep in Tab System",description:"Converts this tab to a permanent tab"},importBrproject:{name:"Import Project",description:"Import a project from a .brproject file"},downloadFile:{name:"Download File",description:"Download the currently opened file"},undo:{name:"Undo",description:"Undo the last action"},redo:{name:"Redo",description:"Redo the last action"},goToDefinition:{name:"Go to Definition",description:"Go to the definition of the selected symbol"},goToSymbol:{name:"Go to Symbol",description:"Opens a dialog to select a symbol to go to"},formatDocument:{name:"Format Document",description:"Format the currently opened document"},changeAllOccurrences:{name:"Change All Occurrences",description:"Change all occurrences of the selected text"}},toolbar:{project:{name:"Project"},file:{name:"File",preferences:{name:"Preferences"}},edit:{name:"Edit"},tools:{name:"Tools"},help:{name:"Help"}},sidebar:{compiler:{name:"Compiler",default:{name:"Default Config",description:"Run bridge.'s compiler with the default compiler configuration that is part of your project's \"config.json\" file."}},extensions:{name:"Extensions"},notifications:{socials:{message:"Socials"},gettingStarted:{message:"Getting Started"},installApp:{message:"Install App"},updateAvailable:{message:"Update Available"},updateExtensions:"Update All Extensions"}},welcome:{title:"Welcome to bridge.",subtitle:"Creating Minecraft addons has never been more convenient!",quickActions:"Quick Actions",recentFiles:"Recent Files",recentProjects:"Recent Projects"},experimentalGameplay:{cavesAndCliffs:{name:"Caves and Cliffs",description:"Enables auto-completions for the new mountain generation inside of biomes."},holidayCreatorFeatures:{name:"Holiday Creator Features",description:"Enables auto-completions for the data driven item and block features."},creationOfCustomBiomes:{name:"Creation of Custom Biomes",description:"Enables the creation of custom biomes, features and feature rules."},additionalModdingCapabilities:{name:"Additional Modding Capabilities",description:"Enables the Scripting API in the manifest and allows you to create scripts with auto-completions."},upcomingCreatorFeatures:{name:"Upcoming Creator Features",description:"Enables the creation of fog volume files and provides auto-completions for entity properties."},enableGameTestFramework:{name:"Enable GameTest Framework",description:"Enables the GameTest related modules in the manifest and allows you to create GameTest scripts with auto-completions."},experimentalMolangFeatures:{name:"Experimental Molang Features",description:"Enables auto-completions for experimental Molang queries."},educationEdition:{name:"Enable Education Edition",description:"Enables auto-completions for education features such as material reducer recipes."}},windows:{changelogWindow:{title:"What's new?"},openFile:{title:"Open",search:"Search file...",noData:"No results..."},createProject:{welcome:"Welcome to bridge.!",welcomeDescription:"Please create your first project in order to get started.",omitPack:"Omit",selectedPack:"Selected",title:"Create Project",packIcon:"Project Icon (optional)",projectName:{name:"Project Name",invalidLetters:"You may only use alphanumerical characters",mustNotBeEmpty:"You must enter a project name"},projectDescription:"Project Description (optional)",projectPrefix:"Project Prefix",projectAuthor:"Project Author",projectTargetVersion:"Project Target Version",rpAsBpDependency:"Register resource pack as behavior pack dependency",bpAsRpDependency:"Register behavior pack as a resource pack dependency",useLangForManifest:"Add pack name/description directly to the manifest",create:"Create",saveCurrentProject:"Do you want to save your current project before creating the new one? Any unsaved changes will get lost!",individualFiles:{name:"Individual Files",file:{player:{name:"player.json",description:"Edit how the default player behaves"},tick:{name:"tick.json",description:"Define which functions to execute every tick"},skins:{name:"skins.json",description:"Register the skins you have created"},blocks:{name:"blocks.json",description:"Used to define how multiple block faces are combined to a single block"},terrainTexture:{name:"terrain_texture.json",description:"Used to assign textures to block faces"},itemTexture:{name:"item_texture.json",description:"Used to assign textures to items"},flipbookTextures:{name:"flipbook_textures.json",description:"Used for animating block textures"},biomesClient:{name:"biomes_client.json",description:"Used to define how biome specific effects render"},sounds:{name:"sounds.json",description:"Used to define sounds for specific game features"},soundDefinitions:{name:"sound_definitions.json",description:"Used to register ids for sound files to be used elsewhere in the project"}}}},createPreset:{title:"Create Preset",searchPresets:"Search presets...",overwriteFiles:"This preset overwrites one or more existing files. Do you want to continue?",overwriteFilesConfirm:"Continue",overwriteUnsavedChanges:"This preset overwrites one or more files with unsaved changes. Do you want to continue?",overwriteUnsavedChangesConfirm:"Continue",validationRule:{alphanumeric:"You may only use alphanumeric characters and/or underscores",lowercase:"You may only use lowercase letters",required:"This field is required",noEmptyFolderNames:"Folder name may not be empty"}},deleteProject:{confirm:"Delete",description:"Are you sure you want to delete this project?"},socials:{title:"Socials",content:"Check out our Twitter, Github and join the official bridge. Discord server!",discord:"Discord",twitter:"Twitter",github:"Github"},projectChooser:{title:"Choose Project",description:"Select the currently active project",searchProjects:"Search projects...",newProject:{name:"New Project",description:"Create a new bridge. project."},saveCurrentProject:{name:"Save Project",description:"Download your current project as a .brproject file to save changes that you have made."},openNewProject:{name:"Open Project",description:"Open a different project by selecting the corresponding .brproject file.",saveCurrentProject:"Do you want to save your current project before loading in the new one?"},wrongFileType:"Project must be a .brproject or .mcaddon file",addPack:"Add Pack"},filePath:{title:"Choose File Path"},packExplorer:{title:"Pack Explorer",searchFiles:"Search files...",categories:"Categories",refresh:{name:"Refresh Project",description:"Fetch the current project for newly added files"},restartDevServer:{name:"Restart Dev Server",description:"Are you sure that you want to restart the compiler's dev server? This can take some time depending on the size of your project."},createPreset:"New File",projectConfig:{name:"Open Project Config",missing:"It looks like this project has no config.json file. Every project needs a project config in order to work correctly."},exportAsMcaddon:{name:"Export as .mcaddon"},exportAsMctemplate:{name:"Export as .mctemplate",chooseWorld:"Choose a World"},exportAsMcworld:{name:"Export as .mcworld",chooseWorld:"Choose a World"},exportAsBrproject:{name:"Export as .brproject"},fileActions:{delete:{name:"Delete",description:"Delete a file or folder",confirmText:"Are you sure that you want to delete this file? You won't be able to restore it later!"},rename:{name:"Rename",description:"Rename a file"},duplicate:{name:"Duplicate",description:"Duplicate a file"},viewCompilerOutput:{name:"View Compiler Output",description:"View the current compiler output for this file",fileMissing:"It doesn't look like this file was compiled yet."},revealFilePath:{name:"Reveal File Path",description:"Reveals the location of a file or folder"},createFile:{name:"Create File",description:"Create a new file"},createFolder:{name:"Create Folder",description:"Create a new folder"}}},settings:{title:"Settings",searchSettings:"Search settings...",sidebar:{name:"Sidebar",sidebarRight:{name:"Sidebar Right",description:"Moves the sidebar to the right side of the screen"},sidebarSize:{name:"Sidebar Size",description:"Changes the width of the expanded sidebar area."},shrinkSidebarElements:{name:"Shrink Sidebar Elements",description:"Shrink the size of bridge.'s sidebar elements"}},appearance:{name:"Appearance",colorScheme:{name:"Color Scheme",description:"Choose the color scheme of bridge.'s UI"},darkTheme:{name:"Dark Theme",description:"Select the default dark theme bridge. uses"},lightTheme:{name:"Light Theme",description:"Select the default light theme bridge. uses"},localDarkTheme:{name:"Local Dark Theme",description:"Choose a dark theme for the currently active project"},localLightTheme:{name:"Local Light Theme",description:"Choose a light theme for the currently active project"},fontSize:{name:"Font Size",description:"Change the font size of bridge.'s text"},editorFontSize:{name:"Code Font Size",description:"Change the font size of bridge.'s code editor"},editorFont:{name:"Code Font",description:"Change the font of bridge.'s code editor"},font:{name:"Font",description:"Change the font that is used inside of bridge.'s user interface"}},general:{name:"General",language:{name:"Language",description:"Choose a language for bridge. to use"},collaborativeMode:{name:"Collaborative Mode",description:"Forces full refresh of the cache upon switching projects. Disable when you work alone and you only use bridge. to edit your project"},packSpider:{name:"Pack Spider",description:"Pack Spider connects files inside of your projects and presents the connections to you in a virtual file system"},formatOnSave:{name:"Format On Save",description:"Formats your text files upon saving them"},openLinksInBrowser:{name:"Open Links in Default Browser",description:"Open links inside of your default browser instead of a native app window"},restoreTabs:{name:"Restore Tabs",description:"Restore your tabs from when you last used bridge. upon opening the app"},resetBridgeFolder:{name:"Select Root Folder",description:"Choose the main folder bridge. operates on"},openProjectChooserOnAppStartup:{name:"Open Project Chooser",description:"Automatically open the project chooser upon starting bridge."}},developer:{name:"Developer",simulateOS:{name:"Simulate OS",description:"Simulate a different OS for testing platform specific behavior"},devMode:{name:"Developer Mode",description:"Enable the developer mode for this app"}},audio:{name:"Audio",volume:{name:"Audio Enabled",description:"Enable or disable all bridge sounds"}},actions:{name:"Actions"},projects:{name:"Projects",defaultAuthor:{name:"Default Author",description:"The default author for new projects"}},editor:{jsonEditor:{name:"JSON Editor",description:"Choose how you want to edit JSON files"},bracketPairColorization:{name:"Bracket Pair Colorization",description:"Give matching brackets an unique color"},wordWrap:{name:"Word Wrap",description:"Wrap words to disable horizontal scrolling"},wordWrapColumns:{name:"Word Wrap Columns",description:"Defines after how many columns the editor should wrap words"},compactTabDesign:{name:"Compact Tab Design",description:"Display tabs inside of the tab system in a more compact way"},automaticallyOpenTreeNodes:{name:"Automatically Open Tree Nodes",description:"Inside of bridge.'s tree editor, automatically open nodes when you select them"},dragAndDropTreeNodes:{name:"Drag and Drop Tree Nodes",description:"Disable/enable drag & drop for tree nodes inside of bridge.'s tree editor"}}},projectFolder:{title:"Project Folder",content:"bridge. needs access to its project folder in order to work correctly."},extensionStore:{title:"Extension Store",searchExtensions:"Search Extension...",deleteExtension:"Delete Extension",activateExtension:"Activate Extension",deactivateExtension:"Deactivate Extension",offlineError:"Failed to load extensions. Please confirm that your device has an active network connection.",compilerPluginDownload:{compilerPlugins:"Compiler Plugins",title:"Downloaded Compiler Plugin",description:"You have just downloaded a new compiler plugin. Make sure to add it to your compiler config file or otherwise it won't have an effect.",openConfig:"Open Config"}},pluginInstallLocation:{title:"Choose Install Location"},unsavedFile:{description:"Do you want to save your changes to this file before closing it?",save:"Save & Close"},browserUnsupported:{title:"Unsupported Browser",description:"Please use Chrome (Desktop) or Edge (Chromium) in order to get the best experience using bridge. v2! Your browser does not support saving files directly and syncing projects to your com.mojang folder.",continue:"Continue Anyways"},invalidJson:{title:"Invalid JSON",description:'bridge.\'s tree editor cannot open files that contain invalid JSON. You can switch to the "Raw Text" editor type inside of the settings to manually fix the issue.'},loadingWindow:{titles:{loading:"Loading..."}}},taskManager:{tasks:{packIndexing:{title:"Indexing Packs",description:"bridge. is collecting data about your pack that is needed for its intelligent features"},compiler:{title:"Compiling Project",description:"bridge. is compiling your project to make it ready for import into Minecraft"},unzipper:{name:"Unpacking ZIP",description:"bridge. is currently unpacking a ZIP file."},loadingSchemas:{name:"Loading Auto-Completions",description:"bridge. is currently loading its auto-completion data."}}},fileDropper:{importFiles:"Drop files here to import them!",importFailed:"bridge. was unable to import the following files:",andMore:"...and more!",importMethod:"Import Method",saveToProject:{title:"Save to Project",description1:"Save the file ",description2:" inside of your project."},openFile:{title:"Open File",description1:"Open the file ",description2:" and save edits to the original file."}},comMojang:{folderDropped:"Do you want to set this folder as your default com.mojang folder?",title:'Access to folder "com.mojang"',permissionRequest:'bridge. needs access to your "com.mojang" folder in order to compile projects to it.',status:{sucess:"Syncing your projects to com.mojang is setup correctly.",deniedPermission:"You setup com.mojang syncing but you did not grant bridge. permission to the folder.",notSetup:"You have not setup com.mojang syncing yet.",notAvailable:"Syncing projects to the com.mojang folder is only available for Chrome and Edge users."}},findAndReplace:{name:"Find & Replace",search:"Search",replace:"Replace",replaceAll:"Replace All",noResults:"No results found.",noSearch:"Once you start typing, results for your search query will appear here."},preview:{name:"Preview",viewAnimation:"View Animation",viewModel:"View Model",viewParticle:"View Particle",viewEntity:"View Entity",viewBlock:"View Block",failedClientEntityLoad:"Failed to load connected client entity",invalidEntity:"Cannot open preview for an entity with invalid JSON. Please fix JSON errors inside of the file and try again.",chooseGeometry:"Choose Geometry",noGeometry:"No valid geometry found inside of this file. Make sure that your JSON is valid, that the file structure is correct and that a geometry with the provided identifier exists."},initialSetup:{welcome:"Welcome to bridge. v2!",welcomeCaption:"A powerful IDE for Minecraft Add-Ons",step:{installApp:{name:"Install bridge.",description:"For the best experience, install bridge. v2 as an app to your computer."},bridge:{name:"bridge. Folder",description:"Please create a folder where bridge. can save app related data and your add-on projects."},bridgeProject:{name:"bridge. Project",description:"Do you want to create a new project or import an existing project from a .brproject file?",createNew:{name:"New Project",description:"Create a new project."},importExisting:{name:"Import Project",description:"Import an existing project."}},comMojang:{name:"com.mojang Folder",description:"Now drag your com.mojang folder onto bridge. to setup syncing of projects to this folder. This makes your add-ons accessible inside of Minecraft for Windows 10 automatically. Setting up com.mojang syncing can be done at any point in time while bridge. is open.",extraDescription:"Drag your com.mojang folder onto bridge."},editorType:{name:"Choose Editor Type",description:"How do you want to edit JSON files? You can change your choice inside of bridge.'s settings later!",rawText:{name:"Raw Text",description:"Edit JSON as raw text. Ideal for intermediate to advanced developers. Comes with advanced auto-completions and JSON validation."},treeEditor:{name:"Tree Editor",description:"Edit JSON as a tree-like structure that requires little to no JSON knowledge. Ideal for beginners and intermediate creators."}}}},editors:{treeEditor:{addObject:"Add Object",addArray:"Add Array",addValue:"Add Value",edit:"Edit"}}}),Gm=c(l({},he),{languageName:"Deutsch",packType:{behaviorPack:{name:"Verhaltenspaket",description:"Erstelle neue Spielmechaniken und ändere, wie sich Minecraft verhält"},resourcePack:{name:"Ressourcenpaket",description:"Verändere Minecraft's Aussehen und Sound"},skinPack:{name:"Charakterpaket",description:"Erstelle verschieden Charakter, die ein Spieler auswählen kann"},worldTemplate:{name:"Weltvorlage",description:"Gebe Spielern eine Welt zum Erkunden"}},fileType:{manifest:"Manifest",animation:"Animation",animationController:"Animation Controller",biome:"Biome",block:"Block",entity:"Entity",feature:"Feature",featureRule:"Feature Rule",functionTick:"Function Tick",function:"Function",item:"Item",lootTable:"Loot Table",recipe:"Recipe",script:"Script",spawnRule:"Spawn Rule",mcstructure:"Structure",tradeTable:"Trade Table",clientManifest:"Client Manifest",geometry:"Geometry",clientAnimation:"Client Animation",clientAnimationController:"Client Animation Controller",attachable:"Attachable",clientEntity:"Client Entity",clientItem:"Client Item",fog:"Fog",particle:"Particle",renderController:"Render Controller",textureSet:"Texture Set",itemTexture:"Item Texture",clientBlock:"Client Block",terrainTexture:"Terrain Texture",flipbookTexture:"Flipbook Texture",clientBiome:"Client Biome",soundDefinition:"Sound Definition",musicDefinition:"Music Definition",clientSound:"Client Sound",skins:"Skins",langDef:"Language Definitions",lang:"Language",molang:"Molang",unknown:"Other",simpleFile:"Simple Files"},actions:{newProject:{name:"Neues Projekt",description:"Erstelle ein neues Projekt"},newFile:{name:"Neue Datei",description:"Erstelle ein neues Add-On Feature"},openFile:{name:"Öffne Datei",description:"Suche und öffne eine Datei deines momentanen Projektes"},saveFile:{name:"Speichere Datei",description:"Speichere die aktuelle Datei"},closeFile:{name:"Schließe Datei",description:"Schließe die aktuelle Datei"},settings:{name:"Einstellungen",description:"Öffne bridge.'s Appeinstellungen"},extensions:{name:"Erweiterungen",description:"Installiere und verwalte Erweiterungen"},copy:{name:"Kopieren",description:"Kopiere ausgewählten Text"},cut:{name:"Schneiden",description:"Kopiere ausgewählten Text und entferne ihn aus dem ursprünglichen Kontext"},paste:{name:"Einfügen",description:"Füge kopierten Text ein"},docs:{name:"Dokumentation",description:"Öffne die Minecraft Add-On Dokumentation"},releases:{name:"Updates",description:"Sehe die neusten Updates"},bugReports:{name:"Fehler Melden",description:"Melde einen Fehler der App"},pluginAPI:{name:"Erweiterungs API",description:"Lese mehr über bridge.'s Erweiterungs API"},gettingStarted:{name:"So Geht's Los!",description:"Lies unser Tutorial, wie du mit bridge. loslegst."},faq:{name:"FAQ",description:"Informiere dich über häufig gestellte Fragen"},reloadAutoCompletions:{name:"Autovervollständigung Neuladen",description:"Lade alle Autovervollständigungen neu"},pluginInstallLocation:{global:{name:"Global Installieren",description:"Globale Erweiterungen sind in allen Projekten aktiv"},local:{name:"Lokal Installieren",description:"Lokale Erweiterungen sind in deinem aktuellen Projekt aktiv"}}},toolbar:{file:{name:"Datei",preferences:{name:"Präferenzen"}},edit:{name:"Editieren"},tools:{name:"Werkzeuge"},help:{name:"Hilfe"}},sidebar:{compiler:{name:"Compiler"},extensions:{name:"Erweiterungen"},notifications:{discord:{message:"Discord Server"},gettingStarted:{message:"So Geht's los!"},installApp:{message:"App Installieren"},updateAvailable:{message:"Update Verfügbar"}}},welcome:{title:"Willkommen zu bridge.",subtitle:"Add-On Entwicklung einfach gemacht!",quickActions:"Aktionen",recentFiles:"Zuletzt Verwendet",recentProjects:"Letzte Projekte"},windows:{common:{confirm:{title:"Bestätigung"},dropdown:{confirm:"Bestätigung"},information:{confirm:"Okay"},input:{confirm:"Bestätigung"}},loadingWindow:{title:"Laden..."},openFile:{title:"Öffnen",search:"Datei suchen...",noData:"Keine Ergebnisse..."},createProject:{welcome:"Willkommen to bridge.!",welcomeDescription:"Erstelle dein erstes Projekt, um loszulegen.",omitPack:"Nicht Ausgewählt",selectedPack:"Ausgewählt",title:"Projekt Erstellen",packIcon:"Projekt Logo (optional)",projectName:"Projekt Name",projectDescription:"Projekt Beschreibung (optional)",projectPrefix:"Project Präfix",projectAuthor:"Project Author",projectTargetVersion:"Projekt Zielversion",create:"Erstellen!"},createPreset:{title:"Erstelle Preset",searchPresets:"Suche Presets..."},deleteProject:{confirm:"Löschen",cancel:"Abbrechen",description:"Bist du sicher, dass du das Projekt entfernen willst?"},discord:{title:"Discord",content:"Trete dem offizielen bridge. Discord Server bei!",join:"Beitreten",later:"Später"},projectChooser:{title:"Projekte",searchProjects:"Suche Projekte..."},selectFolder:{title:"Ordner Aussuchen",content:"Wähle einen Ordner, indem bridge. deinen Projekte speichern soll.",select:"Auswählen!"},packExplorer:{title:"Paket Explorer",searchFiles:"Suche Dateien...",categories:"Kategorien"},settings:{title:"Einstellungen",searchSettings:"Suche Einstellungen...",appearance:{name:"Aussehen",colorScheme:{name:"Farbschema",description:"Wähle ein Farbschema für bridge.'s Benutzeroberfläche"},darkTheme:{name:"Dunkles Theme",description:"Select the default dark theme bridge. uses"},lightTheme:{name:"Helles Theme",description:"Select the default light theme bridge. uses"},localDarkTheme:{name:"Lokales Dunkles Theme",description:"Choose a dark theme for the currently active project"},localLightTheme:{name:"Lokales Helles Theme",description:"Choose a light theme for the currently active project"},sidebarRight:{name:"Rechte Seitenleiste",description:"Bewege die Seitenleiste auf die rechte Seite des Screens"},shrinkSidebarElements:{name:"Kleine Seitenleistenelemente",description:"Schrumpfe die Seitenleistenelemente, sodass sie weniger Platz benötigen"}},general:{name:"Allgemein",language:{name:"Sprache",description:"Wähle eine Sprache für bridge. aus"},collaborativeMode:{name:"Kollaborativer Modus",description:"Lädt den Cache komplett neu, wenn du die Projekte wechselst. Kann deaktiviert werden, wenn du alleine arbeitest und du nur bridge. für dein Projekt nutzt"},packSpider:{name:"Pack Spider",description:"Pack Spider erkennt Verbindungen zwischen Dateien deines Projektes und bildet diese in einem Virtuellen Dateiensystem ab"},openLinksInBrowser:{name:"Öffne Links im Browser",description:"Öffne Links in deinem Browser anstelle von Applikationsfenstern"},resetBridgeFolder:{name:"Wähle bridge. Ordner",description:"Wähle dein Hautpordner, auf dem bridge. arbeitet"}},developer:{name:"Entwickler",simulateOS:{name:"OS Simulieren",description:"Simuliere ein anderes OS, um platformspezifische Features zu testen"},devMode:{name:"Developermodus",description:"Aktiviere den Developermodus für diese App"}},actions:{name:"Aktionen"}},projectFolder:{title:"Projekte Ordner",content:"bridge. benötigt Zugriff auf deinen Projekteordner."},extensionStore:{title:"Erweiterungen",searchExtensions:"Suche Erweiterungen..."},pluginInstallLocation:{title:"Wähle Installationsart"},unsavedFile:{title:"Bestätigen",description:"Möchtest du die Änderungen an dieser Datei speichern?",cancel:"Abbrechen",noSave:"Schließen",save:"Spichern & Schließen"},browserUnsupported:{title:"Keine Browserunterstützung!",description:"bridge. unterstützt deinen Browser momentan nicht. Bitte nutze Chrome (Desktop) or Edge (Chromium), um bridge. zu nutzen!"}},taskManager:{tasks:{packIndexing:{title:"Paketindizierung",description:"bridge. sammelt Daten aus deinem Paket, die es für seine intelligenten Features benötigt"},compiler:{title:"Projektkompilierung",description:"bridge. kompiliert dein Projekt, um es für die Nutzung in Minecraft vorzubereiten"}}}}),Jm=c(l({},me),{languageName:"Nederlands",general:{yes:"Ja",no:"Nee",okay:"Oke",confirm:"Bevestig",cancel:"Annuleer",close:"Sluit",reload:"Herlaad",information:"Informatie",continue:"Doorgaan",delete:"Verwijderen",select:"Selecteren",skip:"Overslaan",save:"Opslaan",more:"Meer...",selectFolder:"Selecteer Map",fileName:"Bestandsnaam",inactive:"Inactief",active:"Actief",confirmOverwriteFile:"Er bestaat al een bestand met deze naam. Wil je het overschrijven?",fileSystemPolyfill:"Vanwege de browser die u gebruikt, moet u uw projecten downloaden om uw voortgang daadwerkelijk op te slaan. Dit is niet nodig als u Chrome of Edge gebruikt!",successfulExport:{title:"Exporteren succesvol",description:"U kunt het geëxporteerde pakket hier vinden"},experimentalGameplay:"Experimental Gameplay"},packType:{behaviorPack:{name:"Gedragspakket",description:"Creëer nieuwe spelmechanismen en verander hoe Minecraft zich gedraagt"},resourcePack:{name:"Resourcepakket",description:"Wordt gebruikt voor het veranderen van Minecraft's uiterlijk en geluid"},skinPack:{name:"Skin Pakket",description:"Voorziet nieuwe uiterlijken die de speler kan selecteren voor hun karakter"},worldTemplate:{name:"Wereldsjabloon",description:"Geef spelers een wereld om te verkennen"}},fileType:{manifest:"Manifest",animation:"Animation",animationController:"Animation Controller",biome:"Biome",block:"Block",bridgeConfig:"Projectconfiguratie",dialogue:"Dialogue",entity:"Entity",feature:"Feature",featureRule:"Feature Rule",functionTick:"Function Tick",function:"Function",item:"Item",lootTable:"Loot Table",recipe:"Recipe",clientScript:"Client Script",serverScript:"Server Script",script:"Script",spawnRule:"Spawn Rule",mcstructure:"Structure",tradeTable:"Trade Table",clientManifest:"Client Manifest",skinManifest:"Skin Manifest",geometry:"Geometry",customCommand:"Command",customComponent:"Component",clientAnimation:"Client Animation",clientAnimationController:"Client Animation Controller",attachable:"Attachable",clientEntity:"Client Entity",clientItem:"Client Item",clientLang:"Language",fog:"Fog",particle:"Particle",renderController:"Render Controller",texture:"Texture",textureSet:"Texture Set",itemTexture:"Item Texture",clientBlock:"Client Block",terrainTexture:"Terrain Texture",flipbookTexture:"Flipbook Texture",clientBiome:"Client Biome",soundDefinition:"Sound Definition",musicDefinition:"Music Definition",clientSound:"Client Sound",skins:"Skins",langDef:"Language Definitions",lang:"Language",molang:"Molang",gameTest:"Game Test",unknown:"Other",simpleFile:"Simple Files",ui:"UI",volume:"Volume",worldManifest:"World Manifest"},actions:{newProject:{name:"Nieuw Project",description:"Maak een nieuw bridge. project"},newFile:{name:"Nieuw Bestand",description:"Maak een nieuwe Add-On functie"},openFile:{name:"Open Bestand",description:"Zoek en open een bestand in het huidige project"},searchFile:{name:"Zoek Bestand",description:"Zoek en open een bestand in het huidige project"},saveFile:{name:"Bestand Opslaan",description:"Sla het momenteel geopende bestand op"},saveAs:{name:"Opslaan Als",description:"Sla het momenteel geopende bestand op onder een andere naam"},saveAll:{name:"Alles Opslaan",description:"Alle momenteel geopende bestanden opslaan"},closeFile:{name:"Bestand Sluiten",description:"Sluit het momenteel geopende bestand"},settings:{name:"Instellingen",description:"Open de app instellingen van bridge."},extensions:{name:"Extensies",description:"Beheer uw geïnstalleerde extensies"},copy:{name:"Kopiëren",description:"Kopieer geselecteerde tekst naar het klembord"},cut:{name:"Knippen",description:"Kopieer geselecteerde tekst naar het klembord en verwijder deze uit de oorspronkelijke context"},paste:{name:"Plakken",description:"Plak de inhoud van het klembord"},docs:{name:"Documentatie",description:"Opent de Minecraft Add-On documentatie"},releases:{name:"Releases",description:"Bekijk de nieuwste bridge. releases"},bugReports:{name:"Foutmeldingen",description:"Meld een probleem met bridge."},pluginAPI:{name:"Plugin API",description:"Lees meer over de plugin API van bridge"},gettingStarted:{name:"Beginnen",description:"Lees onze gids om aan de slag te gaan met bridge."},faq:{name:"FAQ",description:"Lees veelgestelde vragen over het ontwikkelen van Add-Ons met bridge."},reloadAutoCompletions:{name:"Herlaad automatische aanvullingen",description:"Herlaadt alle gegevens voor automatisch aanvullen opnieuw"},reloadExtensions:{name:"Herlaad Extensies",description:"Laadt alle extensies opnieuw"},moveToSplitScreen:{name:"Verplaats naar gesplitst scherm",description:"Opent een gesplitste schermweergave en verplaatst dit tabblad ernaar"},closeTab:{name:"Sluit Tab",description:"Sluit dit tabblad"},closeAll:{name:"Sluit Alles",description:"Sluit alle tabbladen"},closeTabsToRight:{name:"Sluit tabbladen aan de rechterkant",description:"Sluit alle tabbladen aan de rechterkant van dit tabblad"},closeAllSaved:{name:"Sluit alle opgeslagen",description:"Sluit alle opgeslagen tabbladen"},closeOtherTabs:{name:"Sluit andere tabbladen",description:"Sluit alle tabbladen behalve dit tabblad"},clearAllNotifications:{name:"Wis Alle Meldingen",description:"Wist alle huidige meldingen"},pluginInstallLocation:{global:{name:"Globaal Installeren",description:"Globale extensies zijn toegankelijk in al uw projecten"},local:{name:"Locaal Installeren",description:"Lokale extensies zijn alleen toegankelijk binnen de projecten waaraan u ze toevoegt"}},toObject:{name:"Transformeren naar Object"},toArray:{name:"Transformeren naar Reeks"},documentationLookup:{name:"Documentatie bekijken",noDocumentation:"Geen documentatie beschikbaar voor"},toggleReadOnly:{name:"Schakel Alleen-Lezen Modus",description:"Schakel alleen-lezen modus voor het momenteel geopende bestand"},keepInTabSystem:{name:"Houd in Tab Systeem",description:"Converteert dit tabblad naar een permanent tabblad"},importBrproject:{name:"Project importeren",description:"Een project importeren uit een .brproject bestand"},downloadFile:{name:"Download bestand",description:"Download het momenteel geopende bestand"},undo:{name:"Ongedaan maken",description:"De laatste actie ongedaan maken"},redo:{name:"Opnieuw uitvoeren",description:"Voer de laatste actie opnieuw uit"}},toolbar:{project:{name:"Project"},file:{name:"Bestand",preferences:{name:"Voorkeuren"}},edit:{name:"Bewerk"},tools:{name:"Hulpmiddelen"},help:{name:"Help"}},sidebar:{compiler:{name:"Compiler",default:{name:"Default Config",description:'Voer bridge.\'s compiler uit met de standaard compilerconfiguratie die deel uitmaakt van het "config.json" bestand van uw project.'}},extensions:{name:"Extensies"},notifications:{discord:{message:"Discord Server"},gettingStarted:{message:"Beginnen"},installApp:{message:"Installeer App"},updateAvailable:{message:"Update Beschikbaar"},updateExtensions:"Werk alle extensies bij"}},welcome:{title:"Welkom bij bridge.",subtitle:"Het maken van Minecraft addons is nog nooit zo gemakkelijk geweest!",quickActions:"Snelle Acties",recentFiles:"Recente Bestanden",recentProjects:"Recente Projecten"},experimentalGameplay:{cavesAndCliffs:{name:"Caves and Cliffs",description:"Maakt automatische aanvullingen mogelijk voor de nieuwe berggeneratie in biomen."},holidayCreatorFeatures:{name:"Holiday Creator Features",description:"Schakelt automatische aanvullingen in voor de gegevensgestuurde item- en blokfuncties."},creationOfCustomBiomes:{name:"Creation of Custom Biomes",description:"Maakt het maken van aangepaste biomen, features en feature rules mogelijk."},additionalModdingCapabilities:{name:"Additional Modding Capabilities",description:"Schakelt de Scripting API in het manifest in en stelt u in staat om scripts te maken met automatische aanvullingen."},upcomingCreatorFeatures:{name:"Upcoming Creator Features",description:"Maakt het maken van fog volume bestanden mogelijk en biedt automatische aanvullingen voor entity eigenschappen."},enableGameTestFramework:{name:"Enable GameTest Framework",description:"Schakelt de GameTest gerelateerde modules in het manifest in en stelt u in staat om GameTest scripts te maken met automatische aanvullingen."},experimentalMolangFeatures:{name:"Experimental Molang Features",description:"Schakelt automatische aanvullingen in voor experimentele Molang queries."},educationEdition:{name:"Enable Education Edition",description:"Schakelt automatische aanvullingen in voor educatieve functies, zoals recepten voor materiaalreductie."}},windows:{changelogWindow:{title:"Wat is er nieuw?"},openFile:{title:"Openen",search:"Zoek bestand...",noData:"Geen resultaten..."},createProject:{welcome:"Welkom bij bridge.!",welcomeDescription:"Maak alstublieft uw eerste project aan om aan de slag te gaan.",omitPack:"Weglaten",selectedPack:"Geselecteerd",title:"Project Maken",packIcon:"Projectpictogram (optioneel)",projectName:{name:"Projectnaam",invalidLetters:"U mag alleen alfanumerieke tekens gebruiken",mustNotBeEmpty:"U moet een projectnaam invoeren"},projectDescription:"Projectbeschrijving (optioneel)",projectPrefix:"Projectvoorvoegsel",projectAuthor:"Project Auteur",projectTargetVersion:"Doelversie van het project",rpAsBpDependency:"Registreer resourcepakket als afhankelijkheid van gedragspakket",useLangForManifest:"Voeg de naam/beschrijving van het pakket rechtstreeks toe aan het manifest",create:"Creëer!",saveCurrentProject:"Wilt u uw huidige project opslaan voordat u een nieuwe maakt? Alle niet-opgeslagen wijzigingen gaan verloren!",individualFiles:{name:"Individuele Bestanden",file:{player:{name:"player.json",description:"Bewerk hoe de standaardspeler zich gedraagt"},tick:{name:"tick.json",description:"Definieer welke functies elke tick moeten worden uitgevoerd"},skins:{name:"skins.json",description:"Registreer de skins die je hebt gemaakt"},blocks:{name:"blocks.json",description:"Wordt gebruikt om te definiëren hoe meerdere blokvlakken worden gecombineerd tot een enkel blok"},terrainTexture:{name:"terrain_texture.json",description:"Wordt gebruikt om texturen toe te wijzen aan de vlakken van een blok"},itemTexture:{name:"item_texture.json",description:"Wordt gebruikt om texturen aan items toe te wijzen"},flipbookTextures:{name:"flipbook_textures.json",description:"Gebruikt voor het animeren van blok texturen"},biomesClient:{name:"biomes_client.json",description:"Wordt gebruikt om te definiëren hoe bioom specifieke effecten worden weergegeven"},sounds:{name:"sounds.json",description:"Gebruikt om geluiden te definiëren voor specifieke gamefuncties"},soundDefinitions:{name:"sound_definitions.json",description:"Wordt gebruikt om id's te registreren voor geluidsbestanden die elders in het project kunnen worden gebruikt"}}}},createPreset:{title:"Voorinstelling maken",searchPresets:"Voorinstellingen zoeken...",overwriteFiles:"Deze voorinstelling overschrijft één of meerdere bestaande bestanden. Wilt u doorgaan?",overwriteFilesConfirm:"Doorgaan",overwriteUnsavedChanges:"Deze voorinstelling overschrijft een of meer bestanden met niet-opgeslagen wijzigingen. Wil je doorgaan?",overwriteUnsavedChangesConfirm:"Doorgaan",validationRule:{alphanumeric:"U mag alleen alfanumerieke tekens en/of onderstrepingstekens gebruiken",lowercase:"U mag alleen kleine letters gebruiken",required:"Dit veld is verplicht",noEmptyFolderNames:"De mapnaam mag niet leeg zijn"}},deleteProject:{confirm:"Verwijderen",description:"Weet u zeker dat u dit project wilt verwijderen?"},discord:{title:"Socials",content:"Bekijk onze Twitter, Github en sluit je aan bij de officiële bridge. Discord server!",discord:"Discord",twitter:"Twitter",github:"Github"},projectChooser:{title:"Projecten",description:"Selecteer het momenteel actieve project",searchProjects:"Zoek Projecten...",newProject:{name:"Nieuw Project",description:"Maak een nieuw bridge. project."},saveCurrentProject:{name:"Project Opslaan",description:"Download uw huidige project als een .brproject bestand om de aangebrachte wijzigingen op te slaan."},openNewProject:{name:"Open Project",description:"Open een ander project door het bijbehorende .brproject bestand te selecteren.",saveCurrentProject:"Wilt u uw huidige project opslaan voordat u het nieuwe laadt?"},wrongFileType:"Project moet een .brproject bestand zijn",addPack:"Pakket Toevoegen"},filePath:{title:"Kies Bestandspad"},packExplorer:{title:"Pack Explorer",searchFiles:"Zoek bestanden...",categories:"Categorieën",refresh:{name:"Vernieuw Project",description:"Haal het huidige project op voor nieuw toegevoegde bestanden"},restartDevServer:{name:"Herstart Dev Server",description:"Weet u zeker dat u de dev server van de compiler opnieuw wilt starten? Dit kan enige tijd duren, afhankelijk van de grootte van uw project."},createPreset:"Nieuw Bestand",projectConfig:{name:"Projectconfiguratie openen",missing:"Het lijkt erop dat dit project geen config.json bestand heeft. Elk project heeft een projectconfiguratie nodig om correct te kunnen werken."},exportAsMcaddon:{name:"Exporteer als .mcaddon"},exportAsMctemplate:{name:"Exporteer als .mctemplate",chooseWorld:"Kies een wereld"},exportAsMcworld:{name:"Exporteer als .mcworld",chooseWorld:"Kies een wereld"},exportAsBrproject:{name:"Exporteer als .brproject"},fileActions:{delete:{name:"Verwijderen",description:"Verwijder een bestand of map",confirmText:"Weet u zeker dat u dit bestand wilt verwijderen? U kunt het later niet meer herstellen!"},rename:{name:"Hernoemen",description:"Een bestand hernoemen"},duplicate:{name:"Dupliceren",description:"Een bestand dupliceren"},viewCompilerOutput:{name:"Uitvoer van compiler bekijken",description:"Bekijk de huidige compiler output voor dit bestand",fileMissing:"Het lijkt erop dat dit bestand nog niet is gecompileerd."},revealFilePath:{name:"Bestandspad onthullen",description:"Geeft de locatie van een bestand of map weer"},createFile:{name:"Bestand aanmaken",description:"Maak een nieuw bestand"},createFolder:{name:"Map aanmaken",description:"Maak een nieuwe map"}}},settings:{title:"Instellingen",searchSettings:"Zoek instellingen...",sidebar:{name:"Zijbalk",sidebarRight:{name:"Zijbalk Rechts",description:"Verplaatst de zijbalk naar de rechterkant van het scherm"},sidebarSize:{name:"Grootte zijbalk",description:"Wijzigt de breedte van het uitgevouwen zijbalkgebied."},shrinkSidebarElements:{name:"Zijbalkelementen verkleinen",description:"De grootte van bridge.'s zijbalkelementen verkleinen"}},appearance:{name:"Uiterlijk",colorScheme:{name:"Kleurenschema",description:"Kies het kleurenschema voor de gebruikersinterface van bridge."},darkTheme:{name:"Donker Thema",description:"Selecteer het standaard donkere thema dat door bridge. wordt gebruikt"},lightTheme:{name:"Licht Thema",description:"Selecteer het standaard lichte thema dat door bridge. wordt gebruikt"},localDarkTheme:{name:"Lokaal Donker Thema",description:"Kies een donker thema voor het momenteel actieve project"},localLightTheme:{name:"Lokaal Licht Thema",description:"Kies een licht thema voor het momenteel actieve project"},fontSize:{name:"Lettergrootte",description:"Wijzig de lettergrootte van de tekst van bridge."},editorFontSize:{name:"Code Lettergrootte",description:"Wijzig de lettergrootte van de code editor van bridge."},editorFont:{name:"Code Lettertype",description:"Wijzig het lettertype van de code editor van bridge."},font:{name:"Lettertype",description:"Wijzig het lettertype dat in de gebruikersinterface van bridge. wordt gebruikt"}},general:{name:"Algemeen",language:{name:"Taal",description:"Kies een taal die bridge. moet gebruiken"},collaborativeMode:{name:"Samenwerkingsmodus",description:"Forceert een volledige verversing van de cache bij het wisselen van project. Schakel uit als u alleen werkt en alleen bridge. gebruikt om uw project te bewerken"},packSpider:{name:"Pack Spider",description:"Pack Spider verbindt bestanden binnen uw projecten en presenteert de verbindingen aan u in een virtueel bestandssysteem"},formatOnSave:{name:"Opmaken na opslaan",description:"Maakt uw tekstbestanden op na het opslaan"},openLinksInBrowser:{name:"Open koppelingen in de standaardbrowser",description:"Open links in uw standaardbrowser in plaats van een native app-venster"},restoreTabs:{name:"Herstel tabbladen",description:"Herstel uw tabbladen van de laatste keer dat u bridge. gebruikte bij het openen van de app"},resetBridgeFolder:{name:"Selecteer Werkmap",description:"Kies de hoofdmap waarop bridge. werkt"},openProjectChooserOnAppStartup:{name:"Projectkiezer openen",description:"Open automatisch de projectkiezer bij het starten van bridge."}},developer:{name:"Ontwikkelaar",simulateOS:{name:"Simuleer OS",description:"Simuleer een ander besturingssysteem om platformspecifiek gedrag te testen"},devMode:{name:"Ontwikkelaarsmodus",description:"Schakel de ontwikkelaarsmodus in voor deze app"}},audio:{name:"Audio",volume:{name:"Audio Ingeschakeld",description:"Alle brige geluiden in- of uitschakelen"}},actions:{name:"Acties"},editor:{jsonEditor:{name:"JSON Editor",description:"Kies hoe u JSON bestanden wilt bewerken"},wordWrap:{name:"Woordomloop",description:"Wikkel woorden om horizontaal scrollen uit te schakelen"},wordWrapColumns:{name:"Woordomloop Kolommen",description:"Definieert na hoeveel kolommen de editor woorden moet laten omlopen"},compactTabDesign:{name:"Compact tabbladontwerp",description:"Toon tabbladen in het tabbladsysteem op een compactere manier"},automaticallyOpenTreeNodes:{name:"Automatisch Tree Nodes Openen",description:"Binnen in bridge.'s tree editor, open automatisch nodes wanneer je ze selecteert"},dragAndDropTreeNodes:{name:"Tree Nodes Slepen en Neerzetten",description:"Schakel tussen slepen & neerzetten voor tree nodes in bridge.'s tree editor"}}},projectFolder:{title:"Project Map",content:"bridge. heeft toegang tot zijn projectmap nodig om correct te werken."},extensionStore:{title:"Uitbreiding Winkel",searchExtensions:"Extensie zoeken...",deleteExtension:"Extensie Verwijderen",activateExtension:"Extensie Activeren",deactivateExtension:"Extensie Deactiveren",offlineError:"Kan extensies niet laden. Controleer of uw apparaat een actieve netwerkverbinding heeft."},pluginInstallLocation:{title:"Kies Installatielocatie"},unsavedFile:{description:"Wilt u uw wijzigingen in dit bestand opslaan voordat u het sluit?",save:"Opslaan & Afsluiten"},browserUnsupported:{title:"Niet-ondersteunde browser",description:"Uw browser wordt momenteel niet ondersteund. Gebruik Chrome (Desktop) of Edge (Chromium) om aan de slag te gaan met bridge.!",continue:"Toch doorgaan"},invalidJson:{title:"Ongeldige JSON",description:'bridge.\'s tree editor kan geen bestanden openen die ongeldige JSON bevatten. U kunt binnen de instellingen overschakelen naar het editortype "Onbewerkte Tekst" om het probleem handmatig op te lossen.'},loadingWindow:{titles:{loading:"Bezig met laden..."}}},taskManager:{tasks:{packIndexing:{title:"Pakketten Indexeren",description:"bridge. verzamelt gegevens over uw pakket die nodig zijn voor zijn intelligente functies."},compiler:{title:"Project Compileren",description:"bridge. compileert uw project om het klaar te maken om in Minecraft te importeren."},unzipper:{name:"ZIP uitpakken",description:"bridge. is momenteel bezig met het uitpakken van een ZIP-bestand."},loadingSchemas:{name:"Automatische Aanvullingen Laden",description:"bridge. is momenteel bezig met het laden van de gegevens voor automatische aanvullingen."}}},fileDropper:{importFiles:"Zet bestanden hier neer om ze te importeren!",importFailed:"bridge. kon de volgende bestanden niet importeren:",andMore:"...en meer!",importMethod:"Importeer Methode",saveToProject:{title:"Save to Project",description1:"Het bestand opslaan ",description2:" in uw project."},openFile:{title:"Open bestand",description1:"Open het bestand ",description2:" en sla de bewerkingen op in het originele bestand."}},comMojang:{folderDropped:"Wilt u deze map instellen als uw standaard com.mojang map?",title:'Toegang tot map "com.mojang"',permissionRequest:'bridge. heeft toegang nodig tot uw "com.mojang" map om er projecten naar te kunnen compileren.',status:{sucess:"Het synchroniseren van uw projecten met com.mojang is correct ingesteld.",deniedPermission:"U heeft com.mojang synchronisatie ingesteld, maar u heeft bridge. geen toestemming verleend voor de map.",notSetup:"U heeft com.mojang synchronisatie nog niet ingesteld.",notAvailable:"Het synchroniseren van projecten naar de com.mojang map is alleen beschikbaar voor Chrome en Edge gebruikers."}},findAndReplace:{name:"Zoek & Vervang",search:"Zoeken",replace:"Vervangen",replaceAll:"Vervang Alles",noResults:"Geen resultaten gevonden.",noSearch:"Zodra u begint met typen, worden de resultaten voor uw zoekopdracht hier weergegeven."},preview:{name:"Voorbeeld",viewAnimation:"Bekijk Animatie",viewModel:"Bekijk Model",viewParticle:"Bekijk Particle",viewEntity:"Bekijk Entity",viewBlock:"Bekijk Blok",failedClientEntityLoad:"Kon de verbonden client entity niet laden",invalidEntity:"Kan voorbeeld niet openen voor een entiteit met ongeldige JSON. Corrigeer JSON-fouten in het bestand en probeer het opnieuw.",chooseGeometry:"Kies Geometrie",noGeometry:"Geen geldige geometrie gevonden in dit bestand. Zorg ervoor dat uw JSON geldig is en dat de bestandsstructuur correct is."},initialSetup:{welcome:"Welkom bij bridge. v2!",welcomeCaption:"Een krachtige IDE voor Minecraft Add-Ons",step:{installApp:{name:"bridge. installeren",description:"Voor de beste ervaring, installeert u bridge. v2 als app op uw computer."},bridge:{name:"bridge. Map",description:"Maak een map waarin bridge. app-gerelateerde gegevens en uw add-on-projecten kan opslaan."},bridgeProject:{name:"bridge. Project",description:"Wilt u een nieuw project aanmaken of een bestaand project importeren vanuit een .brproject-bestand?",createNew:{name:"Nieuw Project",description:"Maak een nieuw project."},importExisting:{name:"Importeer Project",description:"Importeer een bestaand project."}},comMojang:{name:"com.mojang Map",description:"Sleep nu je com.mojang map naar bridge. om het synchroniseren van projecten naar deze map in te stellen. Hierdoor zijn uw add-ons automatisch toegankelijk in Minecraft voor Windows 10. Het instellen van com.mojang synchronisatie kan op elk moment wanner bridge. is geopend.",extraDescription:"Sleep uw map com.mojang naar bridge."},editorType:{name:"Kies Editor Type",description:"Hoe wilt u JSON bestanden bewerken? U kunt uw keuze later in de instellingen van bridge. wijzigen!",rawText:{name:"Onbewerkte Tekst",description:"Bewerk JSON als onbewerkte tekst. Ideaal voor gemiddelde tot gevorderde ontwikkelaars. Wordt geleverd met geavanceerde automatische aanvullingen en JSON-validatie."},treeEditor:{name:"Tree Editor",description:"Bewerk JSON als een boomachtige structuur die weinig tot geen JSON kennis vereist. Ideaal voor beginners en gemiddelde makers."}}}},editors:{treeEditor:{addObject:"Object Toevoegen",addArray:"Reeks Toevoegen",addValue:"Waarde Toevoegen",edit:"Bewerk"}}}),qm=c(l({},ge),{languageName:"한국어",toolbar:{installApp:"Install app",file:{name:"파일",newFile:"새로운 파일",import:{name:"파일 가져오기",openFile:"파일 열기",importOBJ:"OBJ 모델 가져오기"},saveFile:"파일 저장",saveAs:"다른 이름으로 저장",saveAll:"모두 저장",closeEditor:"편집 창 닫기",clearAllNotifications:"알림 전부 지우기",preferences:{name:"환경 설정",settings:"설정",extensions:"플러그인"}},edit:{name:"편집",selection:{name:"선택",unselect:"선택 취소",selectParent:"어버이 선택",selectNext:"다음 선택",selectPrevious:"이전 선택"},jsonNodes:{name:"JSON 개체",toggleOpen:"개체 여닫기",toggleOpenChildren:"개체 자식 여닫기",moveDown:"아래로 이동",moveUp:"위로 이동",commentUncomment:"활성화/비활성화"},delete:"삭제",undo:"실행 취소",redo:"재실행",copy:"복사",cut:"자르기",paste:"붙여넣기",alternativePaste:"다른 붙여넣기"},tools:{name:"도구",docs:"정보 기록문",presets:"프리셋",snippets:"부분적 인용",goToFile:"파일로 이동"},help:{name:"도움말",about:"정보",releases:"최신 릴리스",bugReports:"버그 제보",pluginAPI:"플러그인 API",gettingStarted:"bridge. 시작하는 법",faq:"FAQ"},dev:{name:"개발자 옵션",reloadBrowserWindow:"브라우저 창 재실행",reloadEditorData:"편집 데이터 재실행",developerTools:"개발자 도구"}},sidebar:{explorer:{name:"익스플로러"},vanillaPacks:{name:"바닐라 팩"},debugLog:{name:"디버그 로그"},extensions:{name:"프로그램 확장",intro:{description:"bridge.를 플러그인을 통해 커스터마이즈 해보세요!!",themes:"테마",snippets:"부분적 인용",presets:"프리셋",uiElements:"UI 요소",andMore:"그리고 더 많습니다!!",viewExtensions:"프로그램 확장들 보기"}}},welcome:{title:"bridge.",subtitle:"마인크래프트 애드온을 만들기 더욱 쉽게!!",syntaxHighlighting:"Syntax 하이라이트 기능",richAutoCompletions:"다양한 자동완성 기능",projectManagement:"쉬운 작업 관리",customSyntax:"커스텀 애드온 syntax",customComponents:"커스텀 요소",customCommands:"커스텀 커맨드",plugins:"플러그인을 통해 프로그램 커스텀 가능"},windows:{common:{confirm:{title:"확인"},dropdown:{confirm:"확인"},information:{confirm:"예"},input:{confirm:"확인"}},discord:{content:"bridge.의 공식 디스코드 서버에 들어오세요!!",join:"들어가기",later:"나중에"},selectFolder:{title:"폴더 선택",content:"프로젝트 저장 위치를 선택하거나 이미 존재하는 디렉토리를 선택하세요.",select:"선택!!"},projectFolder:{title:"프로젝트 폴더",content:"bridge.가 제대로 작동하기 위해서는 프로젝트 폴더에 대한 접근 권한이 필요합니다."},managePlugin:{name:"플러그인 관리",done:"완료"}}}),Km=c(l({},fe),{languageName:"中文(臺灣)",general:{yes:"是",no:"否",okay:"好",confirm:"確認",cancel:"取消",close:"關閉",reload:"重新載入",information:"資訊",continue:"繼續",delete:"刪除",skip:"跳過",selectFolder:"選取資料夾",fileName:"檔案名稱",confirmOverwriteFile:"已存在相同名稱的檔案，是否要覆寫?"},packType:{behaviorPack:{name:"行為包",description:"在遊戲中創造新的機制，以及修改Minecraft的行為。"},resourcePack:{name:"資源包",description:"用於修改Minecrat的外觀和音效"},skinPack:{name:"外觀包",description:"創建可以讓玩家自由使用的全新外觀。"},worldTemplate:{name:"世界範本",description:"創造讓玩家能夠體驗你的專案的世界。"}},fileType:{manifest:"Manifest",animation:"動畫",animationController:"動畫控制器",biome:"生態域",block:"方塊",bridgeConfig:"bridge.專案設定",dialogue:"對話框",entity:"實體",feature:"地物",featureRule:"地物生成規則",functionTick:"Tick函數",function:"函數",item:"物品",lootTable:"戰利品表",recipe:"合成配方",clientScript:"使用者端腳本",serverScript:"伺服器端腳本",script:"腳本",spawnRule:"生成規則",mcstructure:"結構",tradeTable:"交易表",clientManifest:"使用者端Manifest",skinManifest:"外觀Manifest",geometry:"幾何體",customComponent:"組件",clientAnimation:"使用者端動畫",clientAnimationController:"使用者端動畫控制器",attachable:"可附加物品",clientEntity:"使用者端實體",clientItem:"使用者端物品",clientLang:"語言",fog:"霧",particle:"粒子",renderController:"渲染控制器",texture:"材質",textureSet:"材質集",itemTexture:"物品材質",clientBlock:"使用者端方塊",terrainTexture:"地形材質",flipbookTexture:"Flipbook材質",clientBiome:"使用者端生態域",soundDefinition:"聲音定義",musicDefinition:"音樂定義",clientSound:"使用者端聲音",skins:"外觀",langDef:"語言定義",lang:"語言",molang:"Molang",gameTest:"遊戲測試",unknown:"其他",simpleFile:"純檔案",ui:"UI",volume:"功能域",worldManifest:"世界Manifest"},actions:{newProject:{name:"新建專案",description:"新建一個bridge.專案"},newFile:{name:"新增檔案",description:"新建一個Add-On功能"},openFile:{name:"開啟檔案",description:"從此專案開啟檔案"},searchFile:{name:"搜尋檔案",description:"在此專案中搜尋"},saveFile:{name:"儲存檔案",description:"儲存開啟的檔案"},saveAs:{name:"另存新檔",description:"以不同檔名儲存開啟的檔案"},saveAll:{name:"全部儲存",description:"儲存全部開啟的檔案"},closeFile:{name:"關閉檔案",description:"關閉開啟的檔案"},settings:{name:"設定",description:"開啟bridge.的設定"},extensions:{name:"擴充元件",description:"安裝和管理擴充元件"},copy:{name:"複製",description:"將選取的文字複製到剪貼簿"},cut:{name:"剪下",description:"將選取的文字剪下"},paste:{name:"貼上",description:"貼上剪貼簿的內容"},docs:{name:"文檔",description:"開啟Minecraft Add-On文檔"},releases:{name:"發行版",description:"查看最新的bridge.發行版"},bugReports:{name:"問題回報",description:"回報bridge.的問題"},extensionAPI:{name:"擴充元件API",description:"查看bridge.擴充元件API的說明"},gettingStarted:{name:"新手上路",description:"查看我們的bridge.入門指南"},faq:{name:"常見問題",description:"查看使用bridge.開發Add-On常見的問題"},reloadAutoCompletions:{name:"重新載入自動完成",description:"重新載入自動完成的資料"},reloadExtensions:{name:"重新載入擴充元件",description:"重新載入所有擴充元件"},moveToSplitScreen:{name:"移至分割視窗",description:"將這個頁籤移至新開啟的分割視窗"},closeTab:{name:"關閉頁籤",description:"關閉這個頁籤"},closeAll:{name:"全部關閉",description:"關閉全部的頁籤"},closeTabsToRight:{name:"關閉右邊的頁籤",description:"關閉右邊所有的頁籤"},closeAllSaved:{name:"關閉已儲存的頁籤",description:"關閉所有已儲存的頁籤"},closeOtherTabs:{name:"關閉其他頁籤",description:"關閉其他的頁籤"},clearAllNotifications:{name:"清除全部通知",description:"清除全部的通知"},pluginInstallLocation:{global:{name:"全域安裝",description:"所有專案皆可使用全域擴充元件"},local:{name:"區域安裝",description:"僅有安裝該擴充元件的專案可以使用"}},toObject:{name:"轉換成物件"},toArray:{name:"轉換成陣列"}},toolbar:{file:{name:"檔案",preferences:{name:"偏好設定"}},edit:{name:"編輯"},tools:{name:"工具"},help:{name:"幫助"}},sidebar:{compiler:{name:"編譯器"},extensions:{name:"擴充元件"},notifications:{socials:{message:"社群媒體"},gettingStarted:{message:"新手上路"},installApp:{message:"安裝應用程式"},updateAvailable:{message:"有更新可用"},updateExtensions:"更新全部的擴充元件"}},welcome:{title:"歡迎使用bridge.",subtitle:"製作Minecraft Add-On從沒如此便捷過!",quickActions:"快捷動作",recentFiles:"最近開啟的檔案",recentProjects:"最近的專案"},windows:{loadingWindow:{titles:{loading:"載入中...",downloadingData:"下載新資料..."}},changelogWindow:{title:"新功能"},openFile:{title:"開啟",search:"搜尋檔案...",noData:"沒有結果..."},createProject:{welcome:"歡迎使用bridge.!",welcomeDescription:"新增你的第一個專案。",omitPack:"忽略",selectedPack:"已選取",title:"新增專案",packIcon:"專案圖示(選擇性)",projectName:"專案名稱",projectDescription:"專案簡介(選擇性)",projectPrefix:"專案前綴",projectAuthor:"專案作者",projectTargetVersion:"專案對應的Minecraft版本",scripting:"啟用腳本API",gameTest:"啟用遊戲測試框架",rpAsBpDependency:"將資源包註冊為行為包的套件相依性",useLangForManifest:"直接將包名和簡介添加至manifest檔案",create:"新增"},createPreset:{title:"新增預設集",searchPresets:"搜尋預設集...",overwriteFiles:"這個預設集會覆寫一或多個檔案，是否繼續?",overwriteFilesConfirm:"確認",overwriteUnsavedChanges:"這個預設集會覆寫一或多個未儲存變更的檔案，是否繼續?",overwriteUnsavedChangesConfirm:"確認",validationRule:{alphanumeric:"只能使用英數符號或者下劃線",lowercase:"只能使用小寫",required:"此欄位為必填",noEmptyFolderNames:"資料夾名稱不可空白"}},deleteProject:{confirm:"刪除",description:"是否要刪除這個專案?"},socials:{title:"社群媒體",content:"查看bridge.的官方Twitter和Github，以及加入Discord群組!",discord:"Discord",twitter:"Twitter",github:"Github"},projectChooser:{title:"專案",searchProjects:"搜尋專案...",newProject:"新增專案"},filePath:{title:"選擇檔案路徑"},packExplorer:{title:"套件瀏覽器",searchFiles:"搜尋檔案...",categories:"類別",refresh:{name:"重新載入專案",description:"重新載入目前專案中新增的檔案"},restartDevServer:{name:"重新啟動Dev Server",description:"是否要重啟編譯器的Dev Server? 花費的時間依照你的專案大小而定。"},createPreset:"新增檔案",projectConfig:{name:"開啟專案設定檔",missing:"看來這個檔案沒有config.json。專案需要該檔案才能正常運作。"},fileActions:{delete:{name:"刪除",description:"刪除檔案或資料夾",confirmText:"是否要刪除這個檔案? 此動作無法還原!"},rename:{name:"重新命名",description:"重新命名檔案"},duplicate:{name:"拷貝",description:"拷貝檔案"},revealFilePath:{name:"顯示檔案路徑",description:"顯示檔案或資料夾的實際位置"}}},settings:{title:"設定",searchSettings:"搜尋設定...",sidebar:{name:"側邊欄",sidebarRight:{name:"側邊欄移至右方",description:"將側邊欄移至螢幕右方"},sidebarSize:{name:"側邊欄大小",description:"更改展開的側邊欄寬度。"},shrinkSidebarElements:{name:"收合側邊欄元素",description:"收合bridge.的側邊欄元素"}},appearance:{name:"外觀",colorScheme:{name:"配色方案",description:"選取bridge. UI的配色方案"},darkTheme:{name:"深色主題",description:"選取bridge.預設的深色主題"},lightTheme:{name:"淺色主題",description:"選取bridge.預設的淺色主題"},localDarkTheme:{name:"區域深色主題",description:"選取目前專案的深色主題"},localLightTheme:{name:"淺色主題",description:"選取目前專案的淺色主題"}},general:{name:"一般",language:{name:"語言",description:"選取bridge.的語言"},collaborativeMode:{name:"協作模式",description:"強制在切換專案時重新載入快取檔案。僅有您一人使用bridge.編輯專案時關閉此選項。"},packSpider:{name:"套件爬蟲",description:"套件爬蟲會用虛擬檔案系統為專案中的檔案建立連結，並顯示他們的關聯。"},formatOnSave:{name:"儲存時格式化",description:"在儲存時格式化檔案"},openLinksInBrowser:{name:"在瀏覽器中開啟連結",description:"使用系統預設瀏覽器開啟連結。"},restoreTabs:{name:"回復頁籤",description:"開啟birdge.時回復上一次開啟的頁籤。"},resetBridgeFolder:{name:"選取根目錄",description:"選取bridge.運作的主要目錄"}},developer:{name:"開發人員",simulateOS:{name:"模擬作業系統",description:"模擬作業系統用於測試特定的行為"},devMode:{name:"開發人員模式",description:"開啟開發人員模式"}},audio:{name:"音效",volume:{name:"音效已開啟",description:"開啟或關閉bridge.的音效"}},actions:{name:"動作"},editor:{jsonEditor:{name:"JSON編輯器",description:"選擇編輯JSON檔案的方式"},wordWrap:{name:"自動換行",description:"程式碼自動換行"}}},projectFolder:{title:"專案資料夾",content:"bridge.必須存取專案資料夾"},extensionStore:{title:"擴充元件商店",searchExtensions:"搜尋擴充元件...",activateExtension:"啟用擴充元件",deactivateExtension:"停用擴充元件",offlineError:"無法載入擴充元件，請確認裝置已連上網路。"},pluginInstallLocation:{title:"選擇安裝位置"},unsavedFile:{description:"是否在關閉檔案前儲存變更?",save:"儲存 & 關閉"},browserUnsupported:{title:"不支援的瀏覽器",description:"bridge.不支援你的瀏覽器，請使用電腦版的Chrome或Edge!"},invalidJson:{title:"無效的JSON",description:"bridge.的樹狀編輯器無法開啟無效JSON檔案，你可以切換成「純文本編輯器」修改檔案。"}},taskManager:{tasks:{dataLoader:{title:"下載資料...",description:"下載編輯器的最新資料"},packIndexing:{title:"檢索套件中",description:"bridge.正在為你的專案功能蒐集必要的資訊"},compiler:{title:"編譯專案",description:"bridge.正在編譯可匯入至Minecraft的套件"}}},fileDropper:{importFiles:"將檔案拖放到這裡匯入!",importFailed:"bridge.無法匯入以下檔案:",andMore:"...和更多!",importMethod:"匯入方法",saveToProject:{title:"儲存至專案",description1:"儲存檔案",description2:"至你的專案。"},openFile:{title:"開啟檔案",description1:"開啟檔案",description2:"將變更儲存至原始檔案。"}},comMojang:{folderDropped:"是否將這個資料夾設為預設的com.mojang資料夾?",permissionRequest:"bridge.必須存取你的com.mojang資料夾才能編譯專案。"},findAndReplace:{name:"尋找 & 取代",search:"尋找",replace:"取代",replaceAll:"全部取代",noResults:"沒有結果。",noSearch:"輸入文字，這裡就會顯示搜尋結果。"},preview:{name:"預覽",viewAnimation:"檢視動畫",viewModel:"檢視模型",viewParticle:"檢視粒子",viewEntity:"檢視實體",viewBlock:"檢視方塊",failedClientEntityLoad:"無法載入連接的使用者端實體",invalidEntity:"實體JSON無效，無法開啟。請修正錯誤後再試一次。",chooseGeometry:"選擇幾何體",noGeometry:"此檔案中未找到有效的幾何體。請檢查JSON是否有效，檔案結構是否正確，以及含有指定的幾何體識別符。"},initialSetup:{welcome:"歡迎使用bridge. v2!",welcomeCaption:"一款強大的Minecraft Add-On IDE。",step:{installApp:{name:"安裝bridge.",description:"為求最佳使用體驗，將bridge. v2安裝到電腦。"},bridge:{name:"bridge.的資料夾",description:"請新增一個資料夾，用於存放bridge.的相關資料與Add-On專案。"},comMojang:{name:"com.mojang資料夾",description:"將您的com.mojang資料夾拖曳至bridge.，將其與專案資料夾同步。這樣可以讓Windows 10版Minecraft直接偵測到你的Add-On。之後可再修改com.mojang資料夾的同步設定。",extraDescription:"將您的com.mojang資料夾拖曳至bridge..."},editorType:{name:"選取編輯器模式",description:" 您想要如何編輯JSON檔案? 之後可再修改設定。",rawText:{name:"純文本",description:"以純文本模式編輯JSON，有先進的自動完成和JSON偵錯系統，適合中階以及進階開發者。"},treeEditor:{name:"樹狀編輯器",description:"以樹狀模式編輯JSON，無須JSON知識，適合初階以及中階開發者。"}}}},editors:{treeEditor:{addObject:"加入物件",addArray:"新增陣列",addValue:"新增値",edit:"編輯"}}});u.use(we),u.config.productionTip=!1;const Qm=new we({lang:{locales:{nl:Jm,de:Gm,en:Um,ko:qm,zhTW:Km}},breakpoint:{mobileBreakpoint:"xs"},theme:{dark:!0,options:{customProperties:!0,variations:!1},themes:{dark:{primary:"#0073FF",secondary:"#0073FF",accent:"#0073FF",background:"#121212",sidebarNavigation:"#1F1F1F",expandedSidebar:"#1F1F1F",menu:"#424242",footer:"#111111",tooltip:"#1F1F1F"},light:{primary:"#0073FF",secondary:"#0073FF",accent:"#0073FF",background:"#fafafa",sidebarNavigation:"#FFFFFF",expandedSidebar:"#FFFFFF",tooltip:"#424242",toolbar:"#e0e0e0",footer:"#f5f5f5"}}}}),Xm=new u({vuetify:Qm,render:e=>e(zm)});Xm.$mount("#app");self.MonacoEnvironment={getWorker:(e,t)=>"json"===t?new ve:"css"===t||"scss"===t||"less"===t?new ye:"html"===t||"handlebars"===t||"razor"===t?new be:"typescript"===t||"javascript"===t?new ke:new Se},Yp.main(Xm);
